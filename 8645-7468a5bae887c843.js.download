(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8645],{92:(e,t,a)=>{"use strict";a.d(t,{Cy:()=>m,vg:()=>h});var s=a(7336),r=a(80644);a(67320),a(37328);var n=a(46087),l=a(27628),i=a(14184),o=a(72070),c=a(79822),d=a(51621),u=a(9097);function m(e){let{citations:t}=e;return t.map(e=>{let t="cite-".concat(e.messageId,"-").concat(e.index);return(0,s.jsx)(n.t,{id:t,children:(0,s.jsxs)("a",{className:"inline-flex min-w-0 items-baseline gap-1 no-underline",href:e.url,rel:"noopener noreferrer",target:"_blank",children:[(0,s.jsx)("span",{className:"line-clamp-1",children:e.title}),(0,s.jsx)(l.A,{className:"size-3 shrink-0"})]})},t)})}function h(e){let{urls:t,className:a}=e,[n,l]=(0,r.useState)(0),m=["Browsing search results"];null==t||t.forEach((e,t)=>{let a=e.replace(/^https?:\/\//,"");m[t+1]="Browsing web page: ".concat(a)}),m[Object.keys(m).length]="Synthesizing ".concat(null==t?void 0:t.length," source").concat((null==t?void 0:t.length)===1?"":"s");let h=Object.keys(m).length;return((0,r.useEffect)(()=>{(async()=>{for(let e=0;e<h;e++)0!==e&&await (0,u.yy)(2e3),l(e)})()},[h]),t&&0!==t.length)?(0,s.jsx)("div",{className:(0,o.A)("!mt-[6px]",a),children:(0,s.jsx)("div",{className:"shimmer relative flex items-center gap-1.5 text-gray-500",children:(0,s.jsxs)(c.N,{mode:"popLayout",presenceAffectsLayout:!0,children:[(0,s.jsx)(i.A,{className:"size-4 shrink-0 leading-[normal]"}),(0,s.jsx)("div",{className:"mask relative grow leading-[15px]",children:(0,s.jsx)(c.N,{initial:!1,mode:"popLayout",presenceAffectsLayout:!0,children:(0,s.jsx)(d.P.span,{animate:{y:0},className:"inline-block grow text-ellipsis whitespace-nowrap text-[15px] leading-none md:w-[calc(100%_-_100px)]",exit:{y:-24},initial:{y:24},layout:!0,transition:{type:"tween",duration:.3},children:m[n]},"carousel-".concat(n))})})]})})}):null}a(81616);function p(e){let{index:t}=e;return _jsxs("span",{className:"block size-4 select-none",children:[_jsx("span",{className:"flex size-4 shrink-0 items-center justify-center rounded-full bg-gray-200 p-0.5 font-mono group-hover/citation:hidden",children:_jsx("span",{className:"text-[10px] text-gray-500",children:t})},"index"),_jsx("span",{className:"hidden size-4 shrink-0 items-center justify-center group-hover/citation:flex",children:_jsx(ArrowUpRightSmall,{className:"mt-[1px] text-[#656565]",size:16})},"icon")]})}},166:(e,t,a)=>{"use strict";a.d(t,{W:()=>c,v:()=>d});var s=a(7336),r=a(81616),n=a(18730),l=a(91064),i=a(76989),o=a(20524);function c(e){let{messageId:t}=e,{chatId:a}=(0,n.xz)(),r=new URL("/chat/internal/chats",window.location.origin);return a?(r.searchParams.set("chatId",a),r.searchParams.set("messageId",t),(0,s.jsx)(l.N,{external:!0,href:r.toString(),children:(0,s.jsxs)(i.DropdownMenuItem,{children:[(0,s.jsx)(o.w,{})," View Internal Page"]})})):null}function d(){let{chatId:e}=(0,n.xz)(),t=new URL("/chat/internal/chats",window.location.origin);return e?(t.searchParams.set("chatId",e),(0,s.jsx)(r.$,{onClick:()=>{window.open(t.href,"_blank")},className:"size-7 rounded-md",size:"sm",tooltip:{side:"bottom",content:"View Internal Page (AI Team Only)"},variant:"ghost",children:(0,s.jsx)(o.w,{})})):null}},747:(e,t,a)=>{"use strict";a.d(t,{SqlExecutionProvider:()=>c,n:()=>o});var s=a(7336),r=a(80644),n=a(10299),l=a(59103);let i=(0,r.createContext)({sqlExecutionStates:{},updateSqlExecutionState:()=>{}});function o(e){let t=(0,r.useContext)(i);if(!t)throw Error("useSqlExecutionState must be used within a SqlExecutionProvider");return{sqlExecutionState:e?t.sqlExecutionStates[e]:void 0,updateSqlExecutionState:a=>{e&&t.updateSqlExecutionState(e,a)},allSqlExecutionStates:t.sqlExecutionStates}}function c(e){let{children:t}=e,[a,o]=(0,r.useState)({}),c=(0,n.useParams)().chatId,{data:d}=(0,l.Ay)(c?["blocks-execution-states",c]:null,{revalidateOnFocus:!1,revalidateOnReconnect:!1});return(0,r.useEffect)(()=>{d&&o(d)},[d]),(0,s.jsx)(i.Provider,{value:{sqlExecutionStates:a,updateSqlExecutionState:(e,t)=>{o(a=>({...a,[e]:t}))}},children:t})}},1510:(e,t,a)=>{"use strict";a.d(t,{f:()=>s});let s=(a(80644).cache||(e=>e))(function(e,t){var a;return(null===(a=e.membership)||void 0===a?void 0:a.entitlements)&&e.membership.entitlements.some(e=>"v0"===e.entitlement)||function(e){var t;let{user:a,team:s}=e;return"vercel"===s.slug&&!!(t=a)&&t.teams.includes("vercel")}({user:t,team:e})})},1808:(e,t,a)=>{"use strict";a.d(t,{t:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40af49e4433767273971eb275e727bb77ea9969861",s.callServer,void 0,s.findSourceMapURL,"linkVercelProject")},3388:(e,t,a)=>{"use strict";a.d(t,{_:()=>c});var s=a(7336),r=a(81616),n=a(80644),l=a(53155),i=a(67952),o=a(89434);function c(){let{loginUrl:e}=(0,l.AO)(),[t,a]=(0,n.useState)(!1),o=(0,i.k)("chatAuthButtons");if((0,l.Zu)())return(0,s.jsx)(d,{});let c=(0,s.jsx)("a",{href:"".concat(e,"&action=signup"),onClick:()=>a("signup"),children:o("signup")}),u=(0,s.jsx)("a",{href:e,onClick:()=>a("login"),children:o("signin")});return(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.$,{className:"h-7 rounded-md",asChild:!0,disabled:"login"===t,size:"sm",variant:"secondary",children:u}),(0,s.jsx)(r.$,{className:"h-7 rounded-md",asChild:!0,disabled:"signup"===t,size:"sm",children:c})]})}function d(){let e=(0,i.k)("signInDialog"),[t,a]=(0,n.useState)(!1);return(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(r.$,{size:"sm",onClick:()=>{a(!0),(0,o.Jv)("vercel")},disabled:t,children:e("authConnect")})})}},3650:(e,t,a)=>{"use strict";a.d(t,{g:()=>i});var s=a(15993),r=a(76907),n=a(48195),l=a(48473);async function i(e){let{projectName:t,chatId:a,onSuccess:i,includeSuccessToast:o=!0}=e,c=r.H.safeParse({name:t});if(!c.success)return{errors:c.error.flatten().fieldErrors};try{let{id:e,vercelProjectId:r,errors:c,success:d}=await (0,n.E)({name:t,icon:"icon-wand-sparkles"});if(c)return{errors:c};if(d&&e){if(o&&s.oR.success("Project created successfully"),a){let t=await (0,l.M)({payload:{chatId:a,projectId:e}});if(null==t?void 0:t.error)return{errors:{name:["Failed to add chat to newly created project."]}}}return null==i||i(e),{id:e,vercelProjectId:r}}return{errors:{name:["Failed to create project."]}}}catch(e){return console.error("Failed to create project:",e),s.oR.error("An unexpected error occurred. Please try again."),{errors:{name:["An unexpected error occurred. Please try again."]}}}}},4432:(e,t,a)=>{"use strict";a.d(t,{SidebarProjects:()=>d});var s=a(7336),r=a(99876),n=a(22705),l=a(80644),i=a(80730),o=a(76073),c=a(89021);function d(e){let{maxProjects:t=10}=e;return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)(h,{numProjects:Math.floor(t/2)}),children:(0,s.jsx)(u,{maxProjects:t})})}function u(e){let{maxProjects:t}=e,{data:a}=(0,n.j)({},"getProjects"),{activeScope:d,user:u}=(0,o.k6)(),h=(0,l.useMemo)(()=>!!(d&&"membership"in d&&"OWNER"===d.membership.role),[d]),p=(0,c.p)(a.filter(e=>null!==e.favoritedAt),"favoritedAt").slice(0,t),x=p.length?(0,s.jsx)(s.Fragment,{children:p.map(e=>{let t=e.creatorId===(null==u?void 0:u.id),a=e.name||"Untitled Project";return(0,s.jsxs)(r.SidebarListItem,{children:[(0,s.jsx)(r.SidebarListItemLink,{href:"/chat/projects/".concat(e.projectId),children:(0,s.jsx)("span",{title:a,children:a})}),(0,s.jsx)(r.SidebarListItemAction,{children:(0,s.jsx)(i.i,{project:e,canMakeProjectUpdates:t||h,side:"right"})})]},e.projectId)})}):(0,s.jsx)(r.SidebarEmptyState,{children:"Favorite projects that you use often."});return(0,s.jsx)(m,{children:(0,s.jsx)(r.SidebarList,{children:x})})}function m(e){let{children:t}=e;return(0,s.jsxs)(r.SidebarSection,{children:[(0,s.jsx)(r.SidebarLabel,{children:"Favorite Projects"}),t]})}function h(e){let{numProjects:t}=e;return(0,s.jsx)(m,{children:(0,s.jsx)(r.SidebarListSkeleton,{length:t})})}},4461:(e,t,a)=>{"use strict";a.d(t,{Dr:()=>h,bA:()=>p,rX:()=>u,sW:()=>m,xG:()=>g});var s=a(7336),r=a(15888),n=a(9097),l=a(62239),i=a(76989),o=a(38230),c=a.n(o),d=a(95805);function u(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(i.DropdownMenuGroup,{className:(0,n.cn)("flex flex-col gap-0.5",t),...r,children:a})}function m(e){let{label:t,Icon:a,children:r}=e;return(0,s.jsxs)("div",{className:"flex w-full justify-between gap-4 text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[a,(0,s.jsx)("span",{className:"text-nowrap text-sm font-normal text-gray-900",children:t})]}),r]})}function h(e){let{className:t,children:a,clickable:r=!0,...l}=e;return(0,s.jsx)(i.DropdownMenuItem,{className:(0,n.cn)(!r&&"hover:bg-transparent",t),onSelect:e=>e.preventDefault(),...l,children:a})}function p(e){let{action:t,disabled:a,...r}=e;return(0,s.jsx)(h,{asChild:!0,disabled:a,children:(0,s.jsx)("form",{action:t,children:(0,s.jsx)(x,{...r})})})}function x(e){let{label:t,Icon:a,children:n}=e,{pending:i}=(0,l.useFormStatus)();return(0,s.jsx)("button",{type:"submit",className:"w-full",children:(0,s.jsx)(m,{label:t,Icon:a&&i?(0,s.jsx)("div",{className:"flex size-4 items-center justify-center",children:(0,s.jsx)(r.X,{size:4})}):a,children:n})})}function g(e){let{href:t,external:a=!1,label:r,Icon:n,sameTab:l=!0,children:i,className:o}=e;return(0,s.jsx)(h,{className:o,asChild:!0,children:(0,s.jsx)(c(),{href:t,target:l?void 0:"_blank",children:(0,s.jsxs)(m,{label:r,Icon:n,children:[i||null,a&&!i?(0,s.jsx)(d.i,{}):null]})})})}},5778:(e,t,a)=>{"use strict";a.d(t,{o:()=>e2,r:()=>e6});var s=a(7336),r=a(18730),n=a(80644),l=a(91227),i=a(4495),o=a(38230),c=a.n(o),d=a(49388);function u(e){let{className:t,innerClassName:a,children:r,avatar:l,...o}=e,[u,m]=(0,n.useState)(!1),h=(0,n.useRef)(null);return(0,d.Wr)(h,()=>m(!1),"touchstart"),(0,s.jsx)("div",{className:(0,i.cn)("group w-full gap-2",t),"data-touch-active":u,onTouchStart:()=>m(!0),ref:h,role:"listitem",...o,children:(0,s.jsxs)("div",{className:(0,i.cn)("relative flex items-start gap-2",a),children:[o.id?(0,s.jsx)(c(),{className:"flex items-center",href:"#".concat(o.id),children:l}):l,(0,s.jsx)("div",{className:"min-w-0 flex-1 translate-y-[0.5px]",children:r})]})})}var m=a(93925);function h(e){let{loading:t,darken:a,children:r,className:n}=e;return(0,s.jsxs)("span",{"aria-hidden":!0,className:(0,i.cn)("relative size-6 items-center justify-center overflow-visible",n),children:[(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(p,{className:(0,i.cn)("h-full min-w-[25px] -translate-x-px transition-all duration-500",a&&"darken",t?"opacity-100":"opacity-0")})}),(0,s.jsx)("span",{className:"absolute inset-0 flex items-center justify-center",children:r||(0,s.jsx)(m.g,{className:(0,i.cn)("h-full min-w-[25px] -translate-x-px text-black transition-opacity duration-500",t?"opacity-0":"opacity-100")})})]})}function p(e){let{className:t}=e;return(0,s.jsxs)("svg",{className:(0,i.cn)(t,"v0-loader"),fill:"none",height:"18",viewBox:"15.5 41.5 100 41",width:"40",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"v-clip",children:(0,s.jsx)("rect",{height:"98",width:"128",x:"0",y:"46"})})}),(0,s.jsxs)("g",{clipPath:"url(#v-clip)",children:[(0,s.jsx)("path",{className:"bg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741"}),(0,s.jsx)("path",{className:"fg",d:"M 15 38 C 18.011 41.4115 41.0275 67.4845 48.5 77.3 c 5.9 6.8 5.8 6.7 5.8 -1.6 C 54.3 69.651 54.3 42.8741 54.3 42.8741",id:"v",pathLength:"1"})]}),(0,s.jsx)("path",{className:"bg",d:"M 102.9 48.5 L 75.7 75.2"}),(0,s.jsx)("path",{className:"fg",d:"M 102.9 48.5 L 75.7 75.2",id:"o-slash",pathLength:"1"}),(0,s.jsx)("path",{className:"bg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615"}),(0,s.jsx)("path",{className:"fg",d:"M73.4653 41.7309L97.3029 41.7309C101.815 41.7309 109.905 46.2887 109.905 54.1283V77.1615",id:"o-top",pathLength:"0.99"}),(0,s.jsx)("path",{className:"bg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209"}),(0,s.jsx)("path",{className:"fg",d:"M104.996 81.8855L81.0314 81.8855C75.5619 81.8855 68.5885 76.5073 68.5885 69.1236L68.5885 46.2209",id:"o-bottom",pathLength:"0.99"})]})}var x=a(15993),g=a(2115),f=a(29050),v=a(80743),j=a(72464),b=a(81616),y=a(92),w=a(67320),N=a(23914),k=a(67952),C=a(57748),S=a(65718),I=a(85625);function M(e){let{message:t}=e,a=(0,n.useRef)(null),r=(0,n.useRef)(null),{project:l}=(0,C.tZ)(),i=(0,k.k)("messageCitations"),o=(0,n.useMemo)(()=>JSON.stringify(t.content).includes("footnoteReference"),[t.content]);return"assistant"===t.role&&"context"in t&&t.context&&0!==t.context.length&&o?(0,s.jsxs)("div",{ref:a,children:[!t.streaming&&(0,s.jsxs)("div",{className:"grid gap-1.5",children:[(0,s.jsx)("p",{className:"select-none pl-px text-sm leading-none text-gray-500",children:i("title")}),(0,s.jsx)("div",{className:"no-scrollbar flex w-full -translate-x-1 gap-2 overflow-x-auto p-1 pb-3",children:t.context.map((e,t)=>{let a=new URL(e.url).hostname,n=e.url.includes("vercel-storage")&&void 0!==l;return"ui"===e.type?null:(0,s.jsx)(b.$,{asChild:!0,className:"group/citation flex h-auto w-[210px] flex-col items-start justify-start gap-1 whitespace-normal px-2 py-1.5 text-left text-sm",variant:"secondary",children:(0,s.jsxs)("a",{className:"min-w-0",href:e.url,ref:0===t?r:null,rel:"noopener noreferrer",target:"_blank",title:e.url,children:[(0,s.jsxs)("div",{className:"flex w-full items-center gap-1.5 font-medium",children:[n?(0,s.jsx)(S.h,{size:"xs",color:l.settings.color,icon:(0,I.KI)(l.settings.icon)}):(0,s.jsx)(w.o,{className:"shrink-0",knowledgeSource:a}),(0,s.jsx)("div",{className:"truncate",children:n?e.title:a}),(0,s.jsxs)("div",{className:"relative ml-auto flex size-4 shrink-0 items-center justify-center overflow-hidden rounded-full bg-gray-200 text-xs text-gray-500",children:[t+1,(0,s.jsx)("div",{className:"absolute inset-0 flex size-4 shrink-0 items-center justify-center bg-gray-200 text-gray-900 opacity-0 transition-all group-hover/citation:opacity-100 group-focus/citation:opacity-100 group-focus-visible/citation:opacity-100",children:(0,s.jsx)(N.m,{})})]})]}),(0,s.jsx)("div",{className:"w-full truncate break-all text-xs font-normal text-gray-500",children:l&&n?l.name:(0,s.jsxs)(s.Fragment,{children:[e.title,e.description&&(0,s.jsxs)(s.Fragment,{children:[" - ",e.description]})]})})]})},t)})})]}),(0,s.jsx)(y.Cy,{citations:t.context.filter(e=>!!e).map((e,a)=>({...e,knowledgeSource:new URL(e.url).hostname,index:a+1,messageId:t.id}))})]}):null}var z=a(72775),L=a(52014),P=a(26939);function R(e){let{actions:t,message:a,finishReason:r}=e,{user:n}=(0,P.J)(),l=function(e){let t=e.length;if(!t)return null;if(1===t){if(e.includes("delete-message"))return"Please delete your message and try again.";if(e.includes("edit-message"))return"Please edit your message and try again."}let a=2===e.length,s=a&&e.includes("new-chat")&&e.includes("delete-message"),r=a&&e.includes("edit-message")&&e.includes("delete-message"),n=a&&e.includes("delete-message")&&e.includes("retry");return s?"Please start a new chat or delete your message.":r?"Please edit or delete your message and try again.":n?"Please delete or retry your message.":"Please edit, retry or delete your message."}(t);return(0,s.jsxs)("div",{className:"flex h-[34px] flex-1 items-center gap-2 rounded-md bg-red-100 p-2 text-sm text-red-600",children:[(0,s.jsx)(L.V,{}),a," ",l,(null==n?void 0:n.isAdminMode)&&r?(0,s.jsxs)("p",{className:"font-bold",children:["[ADMIN_ONLY]: ",r]}):null]})}var D=a(19895),E=a(18867),A=a(24331),T=a(166),F=a(85168),O=a(95852);let U={"input-too-long":{message:"Your message or the text content of your attachment(s) exceeds the maximum length.",actions:["delete-message"]},"invalid-image":{message:"The image(s) attached could not be processed.",actions:["delete-message"]},"large-image":{message:"The image(s) attached exceed the maximum size.",actions:["delete-message"]},"too-many-attachments":{message:"You have reached the limit for total attachments in a single chat.",actions:["new-chat","delete-message"]},"content-filtering":{message:"The response was blocked by the content filtering policy.",actions:["delete-message","edit-message"]},"failed-to-process-image":{message:"Unable to process image.",actions:["delete-message","retry"]},"image-exceeds-dimensions":{message:"The image(s) attached exceed the maximum width and height allowed.",actions:["delete-message"]},overloaded:{message:"We are currently experiencing high traffic. Please try again in a few minutes.",actions:[]},default:{message:"Something went wrong.",actions:["retry","edit-message","delete-message"]}};var V=a(26569),_=a(66818),B=a(26163),H=a(3086),$=a(64332),q=a(21414),W=a(88551),Z=a(76989);function G(e){let{messageId:t}=e,{chatId:a}=(0,r.xz)(),{activeForkKey:l}=(0,r.Pk)(),[i,o]=(0,n.useTransition)(),c=(0,n.useCallback)(()=>{o(async()=>{if(!a){x.oR.error("Chat ID not found.");return}try{let e=null==l?void 0:l.indexOf(t);if(void 0===e||-1===e||!l){x.oR.error("Message not found in the active fork.");return}let s=l.slice(0,e+1),r=await (0,$.B)({payload:{chatId:a,messageIds:s}});if("error"in r)throw Error(r.error);let n=new Blob([JSON.stringify(r.messages,null,2)],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download="".concat(a,"-").concat(new Date().toISOString(),".json"),o.click(),URL.revokeObjectURL(i)}catch(e){(0,W.z)(e)||x.oR.error("Something went wrong. Please try again.")}})},[]);return(0,s.jsxs)(Z.DropdownMenuItem,{onClick:c,disabled:i,children:[(0,s.jsx)(q.f,{}),"Export Messages"]})}var K=a(23063),Y=a(74179),Q=a(46556),J=a(79546),X=a(10380),ee=a(84265),et=a(55200),ea=a(98898),es=a(59103),er=a(30009);let en=(0,er.createServerReference)("40a4f337eac34df35d74ec4dcbad17867b199d04a4",er.callServer,void 0,er.findSourceMapURL,"getRawMessageContent");var el=a(97210),ei=a(20685);function eo(){let{data:e,mutate:t}=(0,es.Ay)("showAdminRetryDialog",null,{fallbackData:null}),{user:a}=(0,P.J)();return{showAdminRetryDialog:(null==a?void 0:a.isAdminMode)?e:null,setAdminRetryDialog:t}}let ec=e=>{let{messageId:t}=e,{setAdminRetryDialog:a}=eo();return(0,s.jsxs)(Z.DropdownMenuItem,{onClick:()=>a(t),children:[(0,s.jsx)(ee.w,{}),"Edit Response"]})},ed=e=>{let{submit:t}=e,{showAdminRetryDialog:a,setAdminRetryDialog:r}=eo(),[l,i]=(0,d.Mj)("admin-retry-message",""),[o,c]=(0,n.useTransition)();return a?(0,s.jsx)(et.lG,{open:!!a,onOpenChange:()=>r(null),children:(0,s.jsxs)(et.Cf,{children:[(0,s.jsx)(et.c7,{children:(0,s.jsx)(et.L3,{children:"Retry Message (AI Team Only)"})}),(0,s.jsxs)("form",{onSubmit:e=>{l&&a&&(e.preventDefault(),r(null),t({action:"retry",forceResponse:l,assistantMessageId:a}))},children:[(0,s.jsx)(ea.T,{asChild:!0,children:(0,s.jsx)(ei.o,{value:l,onChange:e=>i(e.target.value),placeholder:"Enter your messsage here...",minHeight:80,maxHeight:192})}),(0,s.jsxs)(et.Es,{className:"mt-4 flex w-full items-center justify-between",children:[(0,s.jsxs)(b.$,{type:"button",variant:"secondary",onClick:()=>{c(async()=>{try{if(!a)throw Error("No message id");let e=await en({payload:{messageId:a}});if("error"in e)throw Error(e.error);if(!e.rawContent)throw Error("No raw content saved in message");i(e.rawContent)}catch(e){if(e instanceof Error){x.oR.error(e.message);return}x.oR.error("An error occurred")}})},disabled:o,children:["Sync Raw Content",o?(0,s.jsx)(el.y,{}):null]}),(0,s.jsx)(b.$,{type:"submit",children:"Submit"})]})]})]})}):null};var eu=a(51621),em=a(24806);function eh(e){let{text:t,isLoading:a,files:r,displayFiles:n}=e,l=(0,k.k)("messages"),i=r?r.map(e=>({file:e,component:(0,s.jsxs)("div",{className:"flex items-center font-mono text-[13px]",children:[(0,s.jsx)("span",{className:"mr-2",children:"•"}),e]},e)})).map((e,t)=>{let{file:r,component:n}=e;return a?(0,s.jsx)(eu.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.3+.1*t,duration:.2},children:n},r):n}):null;return(0,s.jsx)(em.p,{text:t||l("loadingText"),forceOpen:n,isLoading:a,children:i})}function ep(e){let{type:t,botMessage:a,...n}=e,l=(0,k.k)("botMessage"),{activeForkKey:i}=(0,r.Pk)(),o=(0,r.jo)(),{chatId:c,messageId:d,messageText:u,userId:m,promptMessageId:h}=(0,v.q)({messageId:a.id}),{isLoading:p,canVote:j}=(0,Y.q)();if(p||!j)return null;let y=async()=>{let e=(0,F.K1)(i);h&&d&&u&&e&&((0,g.u)("SubmitUpvote",{messageId:d,leafMessageId:e,messageText:JSON.stringify({text:u})}),(0,x.oR)(l("successToast")),o(e=>({messages:e.messages.map(e=>"id"in e&&e.id===d?{...e,vote:"upvote"}:e)})),await (0,f.p)({feedback:"",reasons:[],chatId:c,messageId:d,leafMessageId:e,userId:m,type:"upvote",promptMessageId:h}))};return(0,s.jsx)(b.$,{"aria-label":l("upvote"),disabled:"upvote"===a.vote,onClick:y,tooltip:l("upvote"),type:t,...n,children:(0,s.jsx)(A.b,{})})}function ex(e){let t,{message:a,endChildren:o,isLastMessage:d,isLoading:m,isStreaming:p,forkKeyOptions:f,submit:v}=e,y=(0,k.k)("botMessage"),w=(0,D.oQ)(),N=(0,D.eu)(),{user:C}=(0,P.J)(),{isCopied:S,copyToClipboard:I}=(0,_.C)({timeout:2e3}),[L]=(0,H.d)(),A=(null==L?void 0:L.remaining)===0,{isLoading:F,canVote:$}=(0,Y.q)(),{cf:q}=(0,K.D)(),{chatId:W}=(0,r.Pk)(),ee="flex";((m||p)&&d||F)&&(ee=a.continuingMessageId||F?"invisible":"hidden");let et=(0,n.useId)().replace(/:/g,"");if(m&&d)return null;let{isLlmError:ea,errorCategory:es="default"}=(0,O.c)(a),{message:er,actions:en}=U[es],el=en.includes("retry"),ei="reverted-block"===a.type,eo="added-integration"===a.type,eu=!p&&!m&&Array.isArray(a.content)&&0===a.content.length,em=ea||a.content.some(e=>!!Array.isArray(e)&&0===e[0])||eu,ex=ea||eu,eg=(0,s.jsxs)("div",{className:(0,i.cn)("flex items-center gap-1",ee),children:[ea?null:(0,s.jsx)(b.$,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",size:"xs",onClick:async()=>{try{var e;let t=null===(e=document.getElementById(et))||void 0===e?void 0:e.querySelector("[data-seg=root]");if(!t)throw Error("Root container not found");let a=new DocumentFragment;t.childNodes.forEach(e=>{a.appendChild(e.cloneNode(!0))});let s=(0,j.l)(a,t,!1,!1,!1);await I(s),x.oR.success(y("copiedToClipboard"))}catch(e){console.error(e),x.oR.error("Failed to copy message to clipboard")}},tooltip:y("copy"),variant:"ghost",children:(0,s.jsx)(B.U,{isCopied:S})}),"message"!==a.type&&"added-integration"!==a.type&&a.type?null:(0,s.jsxs)(s.Fragment,{children:[!ea||el?(0,s.jsx)(b.$,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",disabled:m||A,"aria-label":"Retry Message",onClick:async()=>{await Promise.all([(null==N?void 0:N.messageId)===a.id?w(!1):null,v({action:"retry",assistantMessageId:a.id}),(0,g.u)("SubmitRetryBotMessage",{messageId:a.id})])},size:"xs",tooltip:"".concat(y("retry")).concat(A?" - ".concat(y("limitReached")):""),variant:"ghost",children:(0,s.jsx)(E.j,{})}):null,$?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ep,{botMessage:a,className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",size:"xs",variant:"ghost"}),(0,s.jsx)(l.H,{className:"size-6 rounded-md text-gray-600 hover:text-gray-900 focus:text-gray-900",messageId:a.id,tooltip:y("downvote"),variant:"message"})]}):null,(0,s.jsx)(V.I,{forkKeyOptions:f,message:a}),q||(null==C?void 0:C.isAdminMode)?(0,s.jsx)("div",{className:"ml-1 mr-1.5 h-4 w-px shrink-0 bg-gray-300"}):null,q&&!(null==C?void 0:C.isAdminMode)&&(0,s.jsx)(b.$,{className:(0,i.cn)("ml-1 gap-1 border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-200 focus:bg-gray-200 focus-visible:border-gray-200 focus-visible:bg-gray-200 has-[>svg]:pl-1.5 has-[>svg]:pr-2 [&>svg]:size-3.5"),size:"xs",variant:"secondary",tooltip:{side:"top",content:"Submit Corrections (Vercelian only)"},asChild:!0,children:(0,s.jsxs)(c(),{href:"/chat/internal/correct/".concat(W,"/new"),children:[(0,s.jsx)(J.S,{}),(0,s.jsx)("span",{className:"hidden sm:inline-block",children:"Correct"})]})})]}),(null==C?void 0:C.isAdminMode)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ed,{submit:v}),(0,s.jsxs)(Z.DropdownMenu,{children:[(0,s.jsx)(Z.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:(0,s.jsxs)(b.$,{className:"border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-200 focus:bg-gray-200 focus-visible:border-gray-200 focus-visible:bg-gray-200 has-[>svg]:pl-1.5 has-[>svg]:pr-2 [&>svg]:size-3.5",size:"xs",tooltip:"View Internal (AI Team only)",variant:"secondary",children:[(0,s.jsx)(Q.C,{})," Admin"]})}),(0,s.jsx)(Z.DropdownMenuContent,{align:"start",side:"bottom",children:(0,s.jsxs)(Z.DropdownMenuGroup,{children:[(0,s.jsx)(Z.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)(c(),{href:"/chat/internal/correct/".concat(W,"/new"),children:[(0,s.jsx)(J.S,{}),"Submit Correction"]})}),(0,s.jsx)(T.W,{messageId:a.id}),(0,s.jsx)(G,{messageId:a.id}),(0,s.jsx)(ec,{messageId:a.id})]})})]})]}):null]});if(ei)return(0,s.jsx)("div",{id:et,children:(0,s.jsx)(u,{avatar:(0,s.jsx)(h,{darken:em,loading:d&&(!em||p),className:"text-gray-500",children:(0,s.jsx)(X.Q,{})}),id:a.id,children:(0,s.jsxs)("div",{className:"prose-p:text-gray-500 prose-p:mb-2 flex min-w-0 flex-1 flex-col items-stretch gap-4",children:[(0,s.jsx)(z.P,{message:a,isLastMessage:d}),o]})})});if(d&&(p||m)&&!em)t=(0,s.jsx)(eh,{displayFiles:a.relevantFiles&&a.relevantFiles.length>0,files:a.relevantFiles,text:eo?"Thinking...":a.loadingText,isLoading:!0});else{let e=a.relevantFiles&&a.relevantFiles.length>0?(0,s.jsx)(eh,{files:a.relevantFiles,text:"Added context (".concat(a.relevantFiles.length," file").concat(1===a.relevantFiles.length?"":"s",")")}):null;t=(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)(z.P,{message:a,isLastMessage:d})]})}return(0,s.jsx)("div",{id:et,children:(0,s.jsx)(u,{avatar:eo?(0,s.jsx)("span",{className:"size-6"}):(0,s.jsx)(h,{darken:em,loading:d&&(!em||p)}),id:a.id,children:(0,s.jsxs)("div",{className:(0,i.cn)("flex min-w-0 flex-1 flex-col items-stretch gap-4",ea&&"gap-4"),children:[t,ex?(0,s.jsx)(R,{actions:en,finishReason:a.finishReason,message:er}):null,o,eg,(0,s.jsx)(M,{message:a}),(null==C?void 0:C.isAdminMode)?(0,s.jsxs)("div",{className:"mt-1 flex w-fit flex-wrap gap-3 whitespace-pre-wrap font-mono text-[10px] text-gray-600",children:[a.usage?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Completion:"}),a.usage.completionTokens]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Prompt:"}),a.usage.promptTokens]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Total:"}),a.usage.totalTokens]})]}):null,a.estimatedUsage?(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Estimation:"}),a.estimatedUsage]}):null,a.modelId?(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Model:"}),a.modelId]}):null]}):null]})})})}var eg=a(66785),ef=a(8899),ev=a(27185),ej=a(33190),eb=a(83748),ey=a(31342),ew=a(24607),eN=a(39717);let ek=n.memo(function(e){let{messageAuthorId:t}=e,{user:a}=(0,P.J)(),{authorId:r}=(0,C.tZ)(),n=t||r||(null==a?void 0:a.id);return n?(0,s.jsx)(ew.AvatarUser,{size:"sm",userId:n}):(0,s.jsx)(ew.Avatar,{size:"sm",children:(0,s.jsx)(eN.hSU,{})})});var eC=a(42394);let eS=(0,er.createServerReference)("4065c6b61ad6ef406f769214bfb9ed65ae6686a931",er.callServer,void 0,er.findSourceMapURL,"deleteMessage");var eI=a(80890),eM=a(65010),ez=a(64854),eL=a(10299),eP=a(38559),eR=a(64495),eD=a(95110),eE=a(85328);function eA(){let{data:e,mutate:t}=(0,es.Ay)("showDeleteMessageDialog",null,{fallbackData:null});return{showConfirmDelete:e,setConfirmDelete:t}}function eT(){let{chatId:e,messages:t,activeForkKey:a,isStreaming:l,isLoading:i}=(0,r.Pk)(),o=(0,r.jo)(),c=(0,D.eu)(),{showConfirmDelete:d,setConfirmDelete:u}=eA(),{setData:m,data:h}=(0,ez.m)(),[p,f]=(0,n.useTransition)(),v=(0,D.oQ)(),{stopLlmResponse:j}=(0,eR.yI)(),y=(0,eL.useRouter)(),w=(0,eE.al)(),N=(0,k.k)("deleteMessageDialog"),{history:C}=(0,eD.P6)({blockId:null==c?void 0:c.id,searchAll:!0}),{scrollToHash:S}=e6(),{setPulsePreview:I}=(0,eD.f8)(),M=(0,n.useCallback)(e=>{let t=C.toReversed().find(t=>t.messageId===e[e.length-1]);t&&!t.isLoading&&(v(!0,t),I({blockId:t.id}),S(t.messageId,150,!0,e))},[C,S,v,I]),z=(0,n.useMemo)(()=>{let e=t.find(e=>"user"===e.role&&e.id===d);if(!e)return null;let a=(0,F.RA)(t).get(e.parentId||F.pe)||[],s=a.findIndex(t=>t&&t.some(t=>t===e.id)),r=a[s];return a.length>1?(0,F.C1)([...t],a[0===s?1:s-1]):e.parentId&&r?r.slice(0,-1):null},[t,d]),L=(0,n.useCallback)(()=>{d&&!p&&(u(null),(l||i)&&j(),f(async()=>{let s=h?[...h]:[],r=[...t],n=c?{...c}:null;if(!t.find(e=>"user"===e.role&&e.id===d)){x.oR.error("Message not found. Please try again.");return}try{if((0,g.u)("SubmitDeleteUserMessage",{messageId:d}),z){w||setTimeout(()=>{var e;null===(e=document.getElementById("chat-main-textarea"))||void 0===e||e.focus()},0);let a=new Set((0,F.Ir)(t.map(e=>({...e,messageId:e.id})),d)),s=t.filter(e=>!("user"===e.role&&e.id===d||a.has(e.id)));M(z),o({messages:s,activeForkKey:z,saveLeafMessageId:!0}),await eS({payload:{messageId:d,chatId:e}}),x.oR.success("Messages successfully deleted.")}else v(!1),m(t=>t.filter(t=>t.chatId!==e)),await (0,eM._)({payload:{chatId:e}}),x.oR.success("Messages successfully deleted."),y.push("/chat");u(void 0)}catch(t){let e=(0,W.z)(t);m(e=>s),o({messages:r,activeForkKey:a}),n&&v(!0,n),e||x.oR.error("Something went wrong. Please try again.")}}))},[c,a,h,e,i,w,p,l,t,z,y,v,m,o,u,d,j,M]),P=null!==z?{TITLE:N("deleteMessageTitle"),DESCRIPTION:N("deleteMessageDescription")}:{TITLE:N("deleteChatTitle"),DESCRIPTION:N("deleteChatDescription")};return(0,s.jsxs)(eP.Modal,{onOpenChange:e=>{e||u(null)},open:null!==d,children:[(0,s.jsxs)(eP.ModalHeader,{children:[(0,s.jsx)(eP.ModalTitle,{children:P.TITLE}),(0,s.jsx)(eP.ModalDescription,{children:P.DESCRIPTION})]}),(0,s.jsxs)(eP.ModalFooter,{children:[(0,s.jsx)(eP.ModalClose,{asChild:!0,children:(0,s.jsx)(b.$,{size:"sm",variant:"secondary",children:N("cancel")})}),(0,s.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:p,onClick:L,size:"sm",variant:"destructive",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eI.X,{className:"size-4"}),N("deleting")]}):N("delete")})]})]})}var eF=a(76403),eO=a(70584),eU=a(1473),eV=a(7293);function e_(e){let{message:t,className:a}=e;return(0,s.jsx)(u,{avatar:(0,s.jsx)(ek,{}),className:a,id:t.id,children:(0,s.jsxs)("details",{children:[(0,s.jsxs)("summary",{className:"inline-flex items-center gap-1 rounded bg-green-600/15 px-1.5 py-0.5 text-sm text-green-800 cursor-pointer",children:[(0,s.jsx)(eU.A,{className:"h-3.5 w-3.5"}),"Established connection with local v0 dev server."]}),(0,s.jsx)("div",{className:"p-1",children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap font-mono bg-gray-100 p-2",children:t.content||"Established connection with local v0 dev server."})})]})})}function eB(e){let{message:t,className:a}=e;return(0,s.jsx)(u,{avatar:(0,s.jsx)(ek,{}),className:a,id:t.id,children:(0,s.jsxs)("details",{children:[(0,s.jsxs)("summary",{className:"inline-flex items-center gap-1 rounded bg-black/15 px-1.5 py-0.5 text-sm text-black cursor-pointer",children:[(0,s.jsx)(eV.A,{className:"h-3.5 w-3.5"}),"User has made some changes directly to the local project."]}),(0,s.jsx)("div",{className:"p-1",children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap font-mono bg-gray-100 p-2",children:t.content})})]})})}var eH=a(52735);let e$=["added-environment-variables","added-integration","forked-block","reverted-block"];function eq(e){var t;let{message:a,animateUser:r,forkKeyOptions:l}=e,o=a;"refinement"===o.type&&(o={...o,content:(0,eH.Fb)(o.content)});let c=(0,k.k)("userMessage"),{user:d}=(0,P.J)(),{setConfirmDelete:m}=eA(),[h,p]=n.useState(!1),f=(0,n.useMemo)(()=>(null==d?void 0:d.isAdminMode)?(0,eF.Z)([o]):void 0,[o,d]),[v]=(0,H.d)(),j=(null==v?void 0:v.remaining)===0;if(o.type&&e$.includes(o.type))return null;if((0,eO.pm)(o))return(0,s.jsx)(e_,{className:(0,i.cn)(r&&"animate-slideUpAndFade duration-500"),message:o});if((0,eO.pW)(o))return(0,s.jsx)(eB,{className:(0,i.cn)(r&&"animate-slideUpAndFade duration-500"),message:o});let b=""===o.content;return(0,s.jsx)(u,{avatar:(0,s.jsx)(ek,{messageAuthorId:o.authorId}),className:(0,i.cn)(r&&"animate-slideUpAndFade duration-500"),id:o.id,children:h?(0,s.jsx)(eg.x,{handleCancel:()=>p(!1),initialText:null!==(t=o.content)&&void 0!==t?t:"",messageId:o.id,thinkingMode:o.thinkingMode,content:a.content||"",type:o.type||"message",initialAttachments:o.attachments}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,i.cn)("flex flex-1 -translate-x-1 flex-col items-stretch",!(0,eO.ZW)(o)&&"gap-2"),children:["refinement"===o.type?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"ml-1 flex w-min items-center justify-center gap-1.5 whitespace-nowrap rounded-full bg-teal-100 px-2.5 py-1 text-xs font-semibold text-teal-900",children:[(0,s.jsx)("div",{className:"size-2 rotate-45 border-2 border-teal-900"}),(0,eH.Og)(a.content)]}),(0,s.jsxs)("div",{className:"flex items-start justify-start gap-2 pl-4",children:[(0,s.jsx)(ev.S,{className:"size-3 h-6 text-gray-500"}),(0,s.jsx)(z.P,{className:"",message:o})]})]}):(0,s.jsx)(z.P,{className:"pl-1",message:o}),(0,s.jsx)(ey.Cj,{attachments:o.attachments,className:(0,i.cn)("px-1 pb-3",!(0,eO.ZW)(o)&&"pt-1")}),(0,s.jsx)("div",{className:(0,i.cn)("pointer-events-none absolute inset-y-0 right-0 z-10"),children:(0,s.jsxs)(eC.Kn,{className:"pointer-events-auto sticky top-3 flex -translate-y-1.5 opacity-0 group-hover:opacity-100 has-[[data-state='delayed-open']]:opacity-100 has-[[data-state='instant-open']]:opacity-100 has-[[data-state=open]]:opacity-100 md:top-5 [[data-touch-active=true]_&]:opacity-100",children:[(0,s.jsx)(eC.rc,{"aria-label":c("editMessage"),className:"author-action",disabled:j,onClick:()=>{p(!0),(0,g.u)("OpenEditUserMessage",{messageId:o.id})},tooltip:j?c("limitReached"):c("editMessage"),children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(ej.Y,{className:"pointer-events-none"})})},o.id),(0,s.jsx)(eC.Sl,{className:"author-action"}),(0,s.jsx)(eC.rc,{"aria-label":c("deleteMessage"),className:"author-action",onClick:()=>{m(o.id),(0,g.u)("OpenDeleteMessage",{messageId:o.id})},tooltip:c("deleteMessage"),children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(eb.l,{className:"pointer-events-none"})})},o.id+"@delete"),!b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eC.Sl,{className:"author-action"}),(0,s.jsx)(eC.rc,{"aria-label":c("copyMessage"),onClick:()=>navigator.clipboard.writeText(o.content||"").then(()=>x.oR.success(c("copiedToClipboard"))).catch(()=>x.oR.error("Failed to copy message to clipboard")),tooltip:c("copyMessage"),children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(ef.Q,{className:"pointer-events-none"})})})]})]})})]}),(0,s.jsx)(V.I,{className:"pt-2",forkKeyOptions:l,message:o}),(null==d?void 0:d.isAdminMode)&&(0,s.jsxs)("div",{className:"mt-4 w-fit flex-wrap gap-3 whitespace-pre-wrap font-mono text-[10px] text-gray-600",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Estimation:"}),f]})]})})}let eW=n.memo(function(e){let{message:t,endChildren:a,isLastMessage:r,isLoading:n,isStreaming:l,animateUser:i,forkKeyOptions:o,submit:c}=e;return"user"===t.role?(0,s.jsx)(eq,{animateUser:r&&i,forkKeyOptions:o,message:t},"user-message-".concat(t.id)):(0,s.jsx)(ex,{endChildren:a,forkKeyOptions:o,isLastMessage:r,isLoading:n,isStreaming:l,message:t,submit:c},"bot-message-".concat(t.id))});var eZ=a(34210),eG=a(22931);function eK(e){let{animate:t=!0,isRestoring:a,lastMessageType:r}=e;return(0,s.jsx)(u,{avatar:"added-integration"===r?(0,s.jsx)("span",{className:"size-6"}):(0,s.jsx)(h,{loading:!0}),className:(0,i.cn)("flex px-4 pb-10 pt-3 duration-500",a&&"w-full",t&&"animate-slideUpAndFade"),"data-testid":"spinner-message",innerClassName:(0,i.cn)(a&&"w-full"),children:(0,s.jsx)(em.p,{isLoading:!0,text:"added-integration"===r?"Thinking...":a?"is restoring...":void 0})})}var eY=a(99942),eQ=a(53155),eJ=a(95813),eX=a(61774),e0=a(77011),e1=a(53508),e5=a(54851);let e3=[];function e2(e){let{isMobile:t,animateUser:a,onSubmit:l}=e,{messages:o,isLoading:c,isStreaming:d,initialStreamPromise:u,activeForkKey:m,isRestoring:h}=(0,r.Pk)(),{expectUser:p}=(0,P.J)(),{setShowSignInDialog:g}=(0,eQ.AO)(),[f]=(0,H.d)(),{canWriteToChat:v}=(0,C.tZ)(),j=!!((null==f?void 0:f.remaining)!==void 0&&f.remaining<=0),b=(0,eX.C)(),y=(0,n.useCallback)(e=>{g({prompt:"new"===e.action&&e.input||""})},[g]),w=(0,n.useMemo)(()=>{if(!o.length)return null;let e=o.filter(e=>"user"===e.role);return e.length>1?e[e.length-1]:null},[o]),N=c&&!d,k=(0,V.H)(o),S=(0,n.useMemo)(()=>new Map(o.map(e=>[e.id,e])),[o]),I=(0,n.useMemo)(()=>m&&0!==m.length?m[m.length-1].startsWith(eR.tg)?m.slice(0,m.length-1).map(e=>S.get(e)):m.map(e=>S.get(e)):[],[m,S]),{scrollDownButton:M,vlistRef:z,scrollToBottom:L,scrollToHash:R,handleScroll:D,containerRef:E}=(0,eJ.I)({count:I.length,pushToBottom:!N&&d});e6({scrollToBottom:L,scrollToHash:R});let A=(0,n.useCallback)(()=>{l(),L()},[l,L]),{submit:T,stopLlmResponse:O}=(0,eR.yI)({onSubmit:A}),{showTopBorder:U,topRef:_,bottomRef:B}=(0,e5.Y)({containerRef:E});!function(e){let{submit:t,initialStreamPromise:a}=e,{prefillOptions:s}=(0,r.Pk)(),l=(0,eL.useRouter)(),{setUpgradePromptOpen:i}=(0,e0.g)(),o=(0,n.useRef)(!1),c=(0,r.jo)(),{setMetadata:d}=(0,C.tZ)(),{user:u}=(0,P.J)();(0,n.useEffect)(()=>{let e=!1;return(async()=>{if(!a||!s||o.current||null===u)return;let r=await a;if(!e){if(o.current=!0,"error"===r.status){let e=Error(r.message);(0,W.z)(e,l)||x.oR.error("Failed to submit chat. Start a new chat or refresh the page."),c({initialStreamPromise:void 0,messages:[]}),d({isEmpty:!0});return}e||t({action:"new",input:s.query},r)}})(),()=>{e=!0}},[a,s,l,u,i,t,c,d])}({submit:T,initialStreamPromise:u});let $=(0,n.useMemo)(()=>m?I.map(e=>{let t=e.id===m[0],r=e.id===m[m.length-1];return(0,s.jsx)("div",{className:(0,i.cn)("flex w-full px-4 py-3 empty:hidden [&>div]:w-full",{"pt-2":t,"pb-10":r&&!N}),children:(0,s.jsx)(eW,{animateUser:a&&!u,forkKeyOptions:k.get(e.parentId||F.pe)||e3,isLastMessage:r&&!h,isLoading:c,isStreaming:d,message:e,submit:T},(0,eZ.B)(e))},(0,eZ.B)(e)+"-container")}):[],[m,I,N,a,u,k,c,d,T,h]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{"aria-roledescription":"chat messages",className:"relative size-full","data-testid":"chat-messages-container",id:eG.cJ,role:"list",style:{contain:"strict"},children:(0,s.jsxs)("div",{className:(0,i.cn)("relative h-full w-full overflow-y-auto border-t transition-opacity duration-150 ease-in",U?"border-alpha-200":"border-transparent"),ref:E,style:{overflowAnchor:"none"},id:eG.tu,children:[(0,s.jsx)("div",{ref:_,className:"absolute inset-x-0 top-0 h-px w-full"}),(0,s.jsxs)("div",{className:"mx-auto w-full max-w-3xl",children:[(0,s.jsx)(e1.YV,{scrollRef:E,ref:z,onScroll:D,children:$}),N&&(0,s.jsx)(eK,{isRestoring:h,animate:!u,lastMessageType:null==w?void 0:w.type})]}),(0,s.jsx)("div",{ref:B,className:"absolute inset-x-0 bottom-0 h-px w-full"})]})}),v?(0,s.jsx)(eY.BW,{isMobile:t,isNewChat:!1,isSignedIn:p,isAnonymous:!!(!p&&b),scrollDownButton:M,stop:O,submit:p||b&&!j?T:y}):(0,s.jsx)("div",{className:"sticky inset-x-0 bottom-0",children:M}),(0,s.jsx)(eT,{})]})}function e6(e){let{data:t,mutate:a}=(0,es.Ay)("scroll-functions",null,{fallbackData:e?{scrollToHash:e.scrollToHash,scrollToBottom:e.scrollToBottom}:void 0});return(0,n.useEffect)(()=>{e&&a({scrollToHash:e.scrollToHash,scrollToBottom:e.scrollToBottom})},[null==e?void 0:e.scrollToHash,null==e?void 0:e.scrollToBottom,a,e]),null!=t?t:{scrollToHash:()=>{},scrollToBottom:()=>{}}}},7228:(e,t,a)=>{"use strict";a.d(t,{c:()=>v,n:()=>j});var s=a(7336),r=a(35330),n=a(81616),l=a(96378),i=a(23042),o=a(60586),c=a(80644),d=a(81226),u=a(23063),m=a(50688),h=a(52014),p=a(97947),x=a(2115),g=a(4495),f=a(73769);function v(e){let{count:t=3,isV3:a}=e;return(0,s.jsx)("div",{className:"grid gap-4 overflow-y-auto p-4 sm:grid-cols-2",children:Array.from({length:t}).map((e,t)=>(0,s.jsx)(r.Zp,{className:"h-[116px]",children:(0,s.jsxs)(r.Wu,{className:(0,g.cn)("flex flex-col gap-4 p-3",a&&"gap-0"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsx)(m.E,{className:"h-8 w-8 rounded-full"}),(0,s.jsx)(m.E,{className:"h-8 w-16"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.E,{className:"h-4 w-24"}),(0,s.jsx)(m.E,{className:"h-3 w-full"})]})]})},t))})}function j(e){let{vercelProjectId:t,onIntegrationClick:a,vercelProjectName:m,teamSlug:j,isV3:b}=e,{mi:y}=(0,u.D)(),[w,N]=(0,c.useState)({}),k=(e,t)=>{N(a=>({...a,[e]:t}))},{integrations:C,refetch:S}=(0,i.A)({integrationIds:d.ud,isEnabled:y||b}),{connections:I,stores:M,isLoading:z,error:L,refetch:P}=(0,o.g)({projectId:t}),{connectedIntegrationItems:R,unconnectedIntegrationItems:D}=(0,c.useMemo)(()=>{if(z)return{connectedIntegrationItems:[],unconnectedIntegrationItems:[]};let e=new Map;I.data.forEach(t=>{e.set(t.slug,{url:"https://vercel.com/".concat(j,"/~/integrations/").concat(t.slug,"/").concat(t.id),type:"connection"})}),M.data.forEach(t=>{var a;t.product&&e.set(t.product.slug,{url:"https://vercel.com/".concat(j,"/").concat(m,"/stores/integration/").concat(t.id,"/settings"),type:"store",billingPlan:(null===(a=t.billingPlan)||void 0===a?void 0:a.name)||"No billing plan"})});let t=[],a=[];return C.forEach(s=>{let r=e.get(s.slug);r?t.push({...s,connectionUrl:r.url,type:r.type,billingPlan:r.billingPlan}):a.push(s)}),{connectedIntegrationItems:t,unconnectedIntegrationItems:a}},[I,M,C,z,j,m]);return L?(0,s.jsx)("div",{className:"flex grow items-center justify-center p-3",children:(0,s.jsx)(p.Sv,{children:(0,s.jsxs)(p.HY,{children:[(0,s.jsx)(p.Ft,{className:"[&>svg]:!text-red-700",children:(0,s.jsx)(h.V,{})}),(0,s.jsx)(p.cz,{children:"Error Loading Integrations"}),(0,s.jsx)(p.Ou,{children:null==L?void 0:L.message}),(0,s.jsx)(n.$,{size:"sm",onClick:()=>{P(),S()},children:"Retry"})]})})}):z?(0,s.jsx)(v,{isV3:b}):(0,s.jsxs)("div",{className:(0,g.cn)("grid gap-4 overflow-y-auto p-4",b&&"grid-cols-1 !p-0"),children:[R.map(e=>(0,s.jsxs)(r.Zp,{className:(0,g.cn)("overflow-hidden",b&&"w-full !shadow-none"),children:[(0,s.jsx)(r.Wu,{className:"flex flex-col gap-4 !border-none p-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,s.jsx)(l.default,{src:e.icon,alt:e.name,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("h3",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-gray-500",children:e.description})]})]}),(0,s.jsx)("a",{target:"_blank",href:e.connectionUrl,children:(0,s.jsx)(n.$,{variant:"outline",size:"sm",children:"Manage"})})]})}),"store"===e.type&&e.billingPlan&&(0,s.jsx)(r.wL,{className:"bg-muted border-t px-3 py-2",children:(0,s.jsx)("span",{className:"text-sm text-gray-500",children:e.billingPlan})})]},e.id)),D.map(e=>(0,s.jsx)(r.Zp,{className:(0,g.cn)("overflow-hidden",b&&"w-full shadow-none"),children:(0,s.jsx)(r.Wu,{className:(0,g.cn)("flex flex-col gap-4 p-3",b&&"gap-0"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,s.jsx)(l.default,{src:e.icon,alt:e.name,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("h3",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]}),(0,s.jsx)(f.V,{integration:e,onConnect:async e=>{let t=d.Dk.some(t=>t.has(e.slug)&&R.some(e=>t.has(e.slug)));await a(e,t),(0,x.u)("ClickAddIntegration",{integration:e})},status:w[e.slug],vercelProjectId:t,onStatusChange:k})]})})},e.id))]})}},7407:(e,t,a)=>{"use strict";function s(e,t){return e.slice().sort(t)}a.d(t,{n:()=>s})},7877:(e,t,a)=>{"use strict";a.d(t,{a:()=>i});var s=a(7336),r=a(4495),n=a(81616),l=a(24582);function i(e){let{children:t,Icon:a,selected:i,className:o,onClick:c}=e;return(0,s.jsxs)(n.$,{className:(0,r.cn)("focus:bg-background flex h-12 items-center justify-between gap-1 px-4 font-medium text-gray-900 shadow-none transition-colors hover:focus:bg-gray-100",i&&"border border-blue-700 bg-blue-100 text-blue-600 hover:border-blue-700 hover:bg-blue-100 hover:brightness-[97%] focus:border-blue-700 focus:bg-blue-100 hover:focus:bg-blue-100 focus-visible:border-blue-700",o),onClick:c,size:"sm",type:"button",variant:"secondary",children:[(0,s.jsxs)("div",{className:"shrink-1 flex items-center gap-2 overflow-hidden",children:[a&&(0,s.jsx)(a,{className:"h-4 w-4 shrink-0"}),(0,s.jsx)("span",{className:"overflow-hidden text-ellipsis",children:t})]}),(0,s.jsx)("div",{className:(0,r.cn)("flex size-4 shrink-0 items-center justify-center rounded-sm border text-white",i&&"border-0 bg-blue-600"),children:i?(0,s.jsx)(l.J,{className:"stroke-background h-2 w-2"}):null})]})}},8463:(e,t,a)=>{"use strict";a.d(t,{P:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40588c031e5fef2cbca7af386a65492fe4beb2b126",s.callServer,void 0,s.findSourceMapURL,"setAdminMode")},8871:(e,t,a)=>{"use strict";a.d(t,{g:()=>l,m:()=>n});var s=a(80644),r=a(59103);function n(e){let{blockId:t,loadingPath:a,files:n}=e,{data:l,mutate:i}=(0,r.Ay)(["block:activeFile",t]),{data:o,mutate:c}=(0,r.Ay)(["block:autoSwitch",t]),d=void 0===o||o,u=(0,s.useMemo)(()=>{var e,t;let a=null==n?void 0:null===(e=n.findLast(e=>!e.isMerged))||void 0===e?void 0:e.meta.file;return a||(null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.meta.file)},[n,t]),m=l;return d&&a&&(m=a),m||(m=u),{activeFilePath:m,setActiveFilePath:i,autoSwitch:d,setAutoSwitch:c}}function l(e){let{blockId:t}=e,{mutate:a}=(0,r.Ay)(["block:activeFile",t]);return a}},9207:(e,t,a)=>{"use strict";function s(e){return!0===e||"object"==typeof e&&"warning"in e}a.d(t,{O:()=>s})},11572:(e,t,a)=>{"use strict";a.d(t,{o:()=>x});var s=a(7336),r=a(8605),n=a(81455),l=a(4678),i=a(77936),o=a(43080),c=a(34555),d=a(11348),u=a(68022),m=a(31939),h=a(4495);let p=(0,a(72244).G)('<g clip-path="url(#clip0_872_3178)">\n  <path d="M13.7974 2.11525C12.3195 -0.0135593 9.37709 -0.637288 7.26183 0.705085L3.53302 3.09153C2.51607 3.72881 1.81098 4.77288 1.60759 5.95254C1.43132 6.94237 1.58048 7.95932 2.05505 8.84068C1.72963 9.32881 1.51268 9.87119 1.41776 10.4407C1.20082 11.6475 1.48556 12.8949 2.19065 13.8847C3.68217 16.0136 6.61098 16.6373 8.72624 15.2949L12.4551 12.922C13.472 12.2847 14.1771 11.2407 14.3805 10.061C14.5567 9.07119 14.4076 8.05424 13.933 7.17288C14.2584 6.68475 14.4754 6.14237 14.5703 5.57288C14.8008 4.35254 14.5161 3.10508 13.7974 2.11525Z" fill="currentColor"/>\n  <path d="M6.8958 14.0881C5.68902 14.4 4.428 13.9254 3.72292 12.9085C3.28902 12.3119 3.12631 11.5661 3.24834 10.8339C3.27546 10.7119 3.30258 10.6034 3.3297 10.4814L3.3975 10.2644L3.58733 10.4C4.03478 10.7254 4.52292 10.9695 5.05173 11.1322L5.18733 11.1729L5.17377 11.3085C5.16021 11.4983 5.21445 11.7017 5.32292 11.8644C5.53987 12.1763 5.91953 12.3254 6.28563 12.2305C6.36699 12.2034 6.44834 12.1763 6.51614 12.1356L10.2314 9.76271C10.4212 9.64068 10.5433 9.46441 10.5839 9.24746C10.6246 9.03051 10.5704 8.8 10.4483 8.62373C10.2314 8.31186 9.85173 8.17627 9.48563 8.27119C9.40428 8.29831 9.32292 8.32542 9.25512 8.3661L7.83139 9.27458C7.60089 9.42373 7.34326 9.5322 7.07207 9.6C5.86529 9.91187 4.60428 9.43729 3.89919 8.42034C3.47885 7.82373 3.30258 7.07797 3.43817 6.34576C3.56021 5.64068 3.99411 5.00339 4.60428 4.62373L8.33309 2.25085C8.5636 2.1017 8.82123 1.99322 9.09241 1.91186C10.2992 1.6 11.5602 2.07458 12.2653 3.09153C12.6992 3.68814 12.8619 4.4339 12.7399 5.1661C12.7128 5.28814 12.6856 5.39661 12.645 5.51864L12.5772 5.73559L12.3873 5.6C11.9399 5.27458 11.4517 5.03051 10.9229 4.8678L10.7873 4.82712L10.8009 4.69153C10.8144 4.50169 10.7602 4.29831 10.6517 4.13559C10.4348 3.82373 10.0551 3.68814 9.68902 3.78305C9.60767 3.81017 9.52631 3.83729 9.45851 3.87797L5.74326 6.25085C5.55343 6.37288 5.43139 6.54915 5.39072 6.7661C5.35004 6.98305 5.40428 7.21356 5.52631 7.38983C5.74326 7.7017 6.12292 7.83729 6.48902 7.74237C6.57038 7.71525 6.65173 7.68814 6.71953 7.64746L8.14326 6.73898C8.37377 6.58983 8.63139 6.48136 8.90258 6.4C10.1094 6.08814 11.3704 6.56271 12.0755 7.57966C12.5094 8.17627 12.6721 8.92203 12.55 9.65424C12.428 10.3593 11.9941 10.9966 11.3839 11.3763L7.65512 13.7492C7.42461 13.8983 7.16699 14.0068 6.8958 14.0881Z" fill="white"/>\n  </g>\n  <defs>\n  <clipPath id="clip0_872_3178">\n  <rect width="16" height="16" fill="white"/>\n  </clipPath>\n  </defs>');function x(e){let{lang:t,fill:a}=e,x={className:"size-4"},f={...x,className:(0,h.cn)(a?"[&_path]:".concat(a):"[&_path]:currentColor",x.className)};switch(t){case"typescript":return(0,s.jsx)(n.V,{...x});case"javascript":return(0,s.jsx)(r.F,{...x});case"powershell":case"shellscript":return(0,s.jsx)(g,{...x});case"typescriptreact":case"javascriptreact":return(0,s.jsx)(c.z,{...f});case"html":case"xml":return(0,s.jsx)(l.Y,{...x});case"svelte":return(0,s.jsx)(p,{...x});case"plaintext":return(0,s.jsx)(o.i,{...x});case"vue":case"vue-html":return(0,s.jsx)(d.w,{...x,...f});case"python":return(0,s.jsx)(u.M,{...x,...f});case"sql":return(0,s.jsx)(m.W,{...x,...f});default:return(0,s.jsx)(i.Z,{...x})}}function g(e){return(0,s.jsxs)("svg",{fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,s.jsxs)("g",{clipPath:"url(#clip0_3211_43963)",children:[(0,s.jsx)("path",{d:"M4 7L6 5.5L4 4",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,s.jsx)("path",{d:"M7 9H10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,s.jsx)("path",{d:"M13.4444 1H2.55556C1.69645 1 1 1.69645 1 2.55556V13.4444C1 14.3036 1.69645 15 2.55556 15H13.4444C14.3036 15 15 14.3036 15 13.4444V2.55556C15 1.69645 14.3036 1 13.4444 1Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_3211_43963",children:(0,s.jsx)("rect",{fill:"white",height:"16",width:"16"})})})]})}},11913:(e,t,a)=>{"use strict";a.d(t,{ChatActions:()=>$,$:()=>Z});var s=a(7336),r=a(80644),n=a(81616),l=a(4495),i=a(76989),o=a(2115),c=a(37522),d=a(83748),u=a(33190),m=a(13870),h=a(39444),p=a(85328),x=a(77299),g=a(72244);let f={hover:{opacity:1,y:[0,2,0],transition:{...x.Ez,y:{...x.Ez,duration:1.1,repeat:Number.POSITIVE_INFINITY}}}},v=e=>({opacity:[0,1],y:[16,0],scaleX:1,scaleY:1,interruptible:!1,transition:{ease:[.13,.65,.14,1],duration:.25,delay:e}}),j=(0,g.G)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75011 3.56062L11.2501 6.06062L12.3108 4.99996L8.70722 1.39641C8.3167 1.00588 7.68353 1.00588 7.29301 1.39641L3.68945 4.99996L4.75011 6.06062L7.25011 3.56062V13.5H8.75011V3.56062Z" fill="currentColor"/>'),b=(0,g.G)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75011 3.56062L11.2501 6.06062L12.3108 4.99996L8.70722 1.39641C8.3167 1.00588 7.68353 1.00588 7.29301 1.39641L3.68945 4.99996L4.75011 6.06062L7.25011 3.56062V11H8.75011V3.56062Z" fill="currentColor"/>'),y=(0,g.G)('<path clip-rule="evenodd" d="M13.5 13.5L13.5 8.5L15 8.5L15 14C15 14.5523 14.5523 15 14 15L2 15C1.44771 15 1 14.5523 1 14L1 8.5L2.5 8.5L2.5 13.5L13.5 13.5Z" fill="currentColor" fill-rule="evenodd"/>'),w=(0,s.jsxs)(x.kd,{hideOverflow:!0,children:[(0,s.jsx)(x.Dp,{variants:{...f,idle:{opacity:0},tap:{opacity:0,y:-16,interruptible:!1,transition:{ease:[.33,.03,.94,.42],duration:.5}}},children:(0,s.jsx)(j,{})}),(0,s.jsx)(x.Dp,{variants:{...f,idle:{opacity:1},tap:v(.4)},children:(0,s.jsx)(b,{})}),(0,s.jsx)(x.Dp,{variants:{hover:{opacity:0,y:4,scaleX:0,scaleY:.5,transition:x.Ez},idle:{opacity:1,scaleX:1,scaleY:1},tap:v(.47)},children:(0,s.jsx)(y,{})})]});var N=a(7363),k=a(27362),C=a(93774),S=a(75720),I=a(67952),M=a(15993),z=a(64854),L=a(10299),P=a(26939),R=a(66818),D=a(76073),E=a(45449),A=a(17777),T=a(38230),F=a.n(T),O=a(22705),U=a(30009);let V=(0,U.createServerReference)("4094f0a1b16f412d9fa6e151cd65bf016eb8851396",U.callServer,void 0,U.findSourceMapURL,"unfavoriteChat"),_=(0,U.createServerReference)("40886a1a633b7ec6acb913d1c278dae8a57d02d6de",U.callServer,void 0,U.findSourceMapURL,"favoriteChat");var B=a(89021);function H(e){let{chat:t,setChatHistoryData:a}=e,{user:n}=(0,P.J)(),{setShareDialog:l}=(0,N.B)(),{setUpdateChatTitleDialogForChatId:c}=(0,k.d)(),{setDeleteDialogForChatId:m}=(0,C.v)(),{setMobileSheetOpen:h}=(0,S.e)(),{activeScope:p}=(0,D.k6)(),x=(0,I.k)("chatActions"),g=t.authorId===(null==n?void 0:n.id),f=(0,r.useMemo)(()=>!!(p&&"membership"in p&&"OWNER"===p.membership.role),[p]),v=g||f,{copyToClipboard:j}=(0,R.C)({timeout:2e3}),b=null==n?void 0:n.isVercelian;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.DropdownMenuItem,{onSelect:()=>{if(h(!1),v){var e;l({chatId:t.chatId,privacy:null!==(e=t.privacy)&&void 0!==e?e:"private"})}else j(window.location.href),M.oR.success("Share link copied!")},children:[w,(0,s.jsx)("span",{children:x("share")})]}),g&&(0,s.jsxs)(i.DropdownMenuItem,{onSelect:()=>{h(!1),(0,o.u)("RenameChat",{targetChatId:t.chatId}),c(t.chatId)},children:[(0,s.jsx)(u.Y,{}),(0,s.jsx)("span",{children:x("rename")})]}),g?(0,s.jsx)(Z,{chat:t,setChatHistoryData:a}):null,b&&(0,s.jsx)(F(),{href:"/chat/v3/".concat(t.chatId),children:(0,s.jsxs)(i.DropdownMenuItem,{children:[(0,s.jsx)(E.s,{}),(0,s.jsx)("span",{children:"Open in New Editor"}),(0,s.jsx)(A.E,{variant:"secondary",size:"sm",children:"Internal"})]})}),g&&(0,s.jsxs)(i.DropdownMenuItem,{onSelect:()=>{h(!1),m(t.chatId)},variant:"destructive",children:[(0,s.jsx)(d.l,{}),(0,s.jsx)("span",{children:x("delete")})]})]})}function $(e){let{chat:t,onOpenChange:a,open:r,className:o,side:d="bottom",setChatHistoryData:u,disabled:m,...h}=e,x=(0,p.al)();return(0,s.jsxs)(i.DropdownMenu,{onOpenChange:a,open:r,children:[(0,s.jsx)(i.DropdownMenuTrigger,{asChild:!0,disabled:m,children:(0,s.jsxs)(n.$,{className:(0,l.cn)("relative z-10 size-7 shrink-0 rounded-md p-0 transition-none has-[>svg]:p-0 ",o),"cmdk-item-actions":"",size:"sm",variant:"ghost",...h,children:[(0,s.jsx)(c.a,{}),(0,s.jsx)("span",{className:"sr-only",children:"Open chat actions"})]})}),(0,s.jsx)(i.DropdownMenuContent,{align:x?"end":"right"===d?"start":"end",side:x?"bottom":d,sideOffset:8,children:(0,s.jsx)(i.DropdownMenuGroup,{children:(0,s.jsx)(H,{chat:t,side:d,setChatHistoryData:u})})})]})}function q(e){let{setChatHistoryData:t,setChatFavoritesData:a,chat:n}=e,l=(0,I.k)("chatActions"),c=(0,L.usePathname)(),d=(0,L.useRouter)(),{data:{favorites:u,history:p},mutate:x}=(0,O.j)({},"getChats"),[g,f]=(0,r.useTransition)(),[v,j]=(0,r.useOptimistic)(n.favorite);return(0,s.jsxs)(i.DropdownMenuItem,{variant:v?"gold":"default",disabled:g,onSelect:async()=>{let e={...n,title:n.title||"",privacy:"private",shareable:!1,authorId:"",updatedAt:n.updatedAt||new Date};n.favorite?((0,o.u)("UnfavoriteChat",{targetChatId:n.chatId}),await x({serverMutate:V(n.chatId),optimisticData:{favorites:u.filter(e=>e.chatId!==n.chatId),history:(0,B.p)([...p,e],"updatedAt")}})):((0,o.u)("FavoriteChat",{targetChatId:n.chatId}),await x({serverMutate:_(n.chatId),optimisticData:{favorites:(0,B.p)([...u,e],"updatedAt"),history:p.filter(e=>e.chatId!==n.chatId)}})),f(()=>{j(e=>!e),n.favorite?(t(e=>{let t=e.findIndex(e=>e.updatedAt&&n.updatedAt&&e.updatedAt<n.updatedAt),a={...n,authorId:"",privacy:"private",shareable:!1,favorite:!1};return t<0?[...e,a]:[...e.slice(0,t),a,...e.slice(t)]}),a(e=>e.filter(e=>e.chatId!==n.chatId))):(t(e=>e.filter(e=>e.chatId!==n.chatId)),a(e=>{let t=e.findIndex(e=>e.updatedAt&&n.updatedAt&&e.updatedAt<n.updatedAt),a={...n,authorId:"",privacy:"private",shareable:!1,favorite:!0};return t<0?[...e,a]:[...e.slice(0,t),a,...e.slice(t)]})),"/chat/history"===c&&d.refresh()})},children:[v?(0,s.jsx)(h.e,{}):(0,s.jsx)(m.F,{}),(0,s.jsx)("span",{children:l(v?"unfavorite":"favorite")})]})}function W(e){let{...t}=e,{setData:a}=(0,z.m)(),{setData:r}=(0,z.r)();return(0,s.jsx)(q,{...t,setChatHistoryData:a,setChatFavoritesData:r})}function Z(e){let{...t}=e;return t.setChatHistoryData&&t.setChatFavoritesData?(0,s.jsx)(q,{...t,setChatHistoryData:t.setChatHistoryData,setChatFavoritesData:t.setChatFavoritesData}):(0,s.jsx)(W,{...t})}},14167:(e,t,a)=>{"use strict";a.d(t,{o:()=>o});var s=a(7336),r=a(80644),n=a(15993),l=a(4495),i=a(26163);function o(e){let{hideIcon:t,displayLink:a,link:o,asChild:c,className:d,children:u,ref:m,suffix:h,iconPrefix:p,showToast:x,disabled:g,...f}=e,[v,j]=(0,r.useState)(!1),b=(0,r.useCallback)(()=>{j(!0),n.oR.promise(navigator.clipboard.writeText(o),{error:"Failed to copy link",success:x?"Link copied":void 0}),setTimeout(()=>j(!1),3e3)},[o,x]);return c?(0,s.jsx)("div",{className:d,onClick:b,children:u}):(0,s.jsxs)("button",{className:(0,l.cn)("group flex h-8 w-full items-center justify-between gap-1 rounded-md border border-gray-200 px-2 text-left text-sm font-normal transition-all hover:border-gray-300",g&&"pointer-events-none opacity-50",h?"pr-0":"pr-2",d),disabled:g,onClick:b,ref:m,...f,children:[p?(0,s.jsx)("div",{className:"-mr-1 h-full",children:p}):null,(0,s.jsx)("span",{className:"flex-1 truncate",children:null!=a?a:o}),(0,s.jsx)(i.U,{className:(0,l.cn)("text-gray-500 transition-colors group-hover:text-current group-focus-visible:text-current",t&&"hidden"),isCopied:v}),h?(0,s.jsx)("div",{className:"h-full pl-1",children:h}):null]})}},14276:(e,t,a)=>{"use strict";a.d(t,{ThemeProvider:()=>o,D:()=>c});var s=a(7336),r=a(80644);"(function() {\n  !function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()\n  var html = document.documentElement;\n  var meta = document.querySelector('meta[name=\"theme-color\"]');\n  if (!meta) {\n    meta = document.createElement('meta');\n    meta.setAttribute('name', 'theme-color');\n    document.head.appendChild(meta);\n  }\n  function updateThemeColor() {\n    window.themeClass = html.className;\n    var isDark = html.classList.contains('dark');\n    meta.setAttribute('content', isDark ? '".concat("hsl(240deg 3% 6%)","' : '").concat("hsl(0 0% 100%)","');\n  }\n  var observer = new MutationObserver(updateThemeColor);\n  observer.observe(html, { attributes: true, attributeFilter: ['class'] });\n  updateThemeColor();\n})();");let n=()=>{!function(){!function(){try{let e=document.documentElement,t=e.classList;t.remove("light","dark");let a=localStorage.getItem("theme");if("system"!==a&&a)a&&t.add(a||"");else{let a="(prefers-color-scheme: dark)",s=window.matchMedia(a);s.media!==a||s.matches?(e.style.colorScheme="dark",t.add("dark")):(e.style.colorScheme="light",t.add("light"))}("light"===a||"dark"===a)&&(e.style.colorScheme=a)}catch(e){}}();let e=document.documentElement,t=document.querySelector('meta[name="theme-color"]');function a(){window.themeClass=e.className;let a=e.classList.contains("dark");null==t||t.setAttribute("content",a?"${DARK_THEME_COLOR}":"${LIGHT_THEME_COLOR}")}t||((t=document.createElement("meta")).setAttribute("name","theme-color"),document.head.appendChild(t)),new MutationObserver(a).observe(e,{attributes:!0,attributeFilter:["class"]}),a()}()},l=(0,r.createContext)({theme:"",setTheme:e=>{}}),i=e=>{window.themeClass=e,document.documentElement.className=e,document.documentElement.style.colorScheme=e};function o(e){let{children:t}=e,a="";a=localStorage.getItem("theme")||document.documentElement.className||"";let[o,c]=(0,r.useState)(a),d=(0,r.useMemo)(()=>({theme:o,setTheme:e=>{!function(e){try{localStorage.setItem("theme",e)}catch(e){console.error(e)}let t=e;"system"===e&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),i(t)}(e),c(e)}}),[o,c]);return(0,r.useEffect)(()=>{n()},[]),(0,r.useEffect)(()=>{if("system"!==d.theme)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{"system"===d.theme&&i(e.matches?"dark":"light")};return e.addEventListener("change",t),t(e),()=>e.removeEventListener("change",t)},[d]),(0,s.jsx)(l.Provider,{value:d,children:t})}function c(){return(0,r.useContext)(l)}},15067:(e,t,a)=>{"use strict";a.d(t,{D:()=>n});var s=a(9097),r=a(59103);function n(){let{data:e,isLoading:t}=(0,r.Ay)("/chat/api/projects",s.GO);return{projects:e,isReady:!t&&void 0!==e}}},15765:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var s=a(80644),r=a(59103),n=a(18730),l=a(23063);function i(e,t){let{mi:a}=(0,l.D)(),{chatId:i}=(0,n.xz)(),o=(0,s.useRef)(null),c=new URLSearchParams;i&&c.set("chatId",i),c.set("source",e.source),e.messageId&&c.set("messageId",e.messageId);let{data:d,mutate:u,isLoading:m}=(0,r.Ay)(i&&a?"/chat/api/integrations/marketplace/link?".concat(c.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration links");return await t.json()},{refreshInterval:e=>3e3*(null!=e&&!!e.shouldContinuePolling),revalidateOnFocus:!0,onSuccess:e=>{let{activeLinks:a}=e;if(0!==a.length){if(o.current){let e=o.current,s=[];for(let t of a){let a=e.find(e=>e.integrationLinkId===t.integrationLinkId);a&&!a.connected&&t.connected&&s.push(t)}s.length>0&&t(s)}o.current=a}}});return{connectedLinks:null==d?void 0:d.connectedLinks,refetchLinks:u,isLoading:m}}},15888:(e,t,a)=>{"use strict";a.d(t,{X:()=>i});var s=a(7336),r=a(86991),n=a.n(r),l=a(72070);function i(e){let{size:t=2,height:a,className:r}=e;return(0,s.jsxs)("span",{className:(0,l.A)(n().loading,r),"data-geist-loading-dots":"","data-version":"v1",style:{"--loading-dots-height":a?o(a):void 0,"--loading-dots-size":2!==t?o(t):void 0},children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{}),(0,s.jsx)("span",{})]})}let o=e=>"number"==typeof e?"".concat(e,"px"):e},16081:(e,t,a)=>{"use strict";a.d(t,{Cy:()=>l,Ln:()=>i,bP:()=>n});let s={claude:3.2,"meta.llama3-8b-instruct-v1:0":4,"llama3-70b-8192":4.5,"meta.llama3-70b-instruct-v1:0":4,"gpt-4o-mini":4,default:4};function r(e){let t=s.default;return e in s?t=s[e]:e.includes("claude")&&(t=s.claude),t}function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anthropic.claude-3-5-sonnet-20240620-v1:0",a=r(t);return Math.round(.9*Math.ceil(("string"==typeof e?e.trim().length:e.charCount)/a))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anthropic.claude-3-5-sonnet-20240620-v1:0";return Math.round(e*r(t)*(1/.9))}function i(e){return Math.round(1334*(("number"==typeof e?e:e.size)/1048576))}},16363:(e,t,a)=>{"use strict";a.d(t,{O:()=>r});var s=a(30009);let r=(0,s.createServerReference)("609254faa4b24c06969d805a2664846b8bc9e8d9e8",s.callServer,void 0,s.findSourceMapURL,"forkBlock")},17781:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var s=a(80644);let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:900;return e<t},n=()=>{let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=window.matchMedia("(max-width: ".concat(899,"px)")),a=()=>{t(r(window.innerWidth))};return e.addEventListener("change",a),a(),()=>e.removeEventListener("change",a)},[]),e}},18056:(e,t,a)=>{"use strict";a.d(t,{Switch:()=>i});var s=a(7336),r=a(80644),n=a(70141),l=a(4495);let i=r.forwardRef((e,t)=>{let{className:a,thumbClassName:r,...i}=e;return(0,s.jsx)(n.bL,{className:(0,l.cn)("focus-visible:ring-offset-background peer inline-flex h-4 w-8 shrink-0 cursor-pointer items-center rounded-full border outline-none ring-blue-600 transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=unchecked]:bg-gray-100",a),...i,ref:t,children:(0,s.jsx)(n.zi,{className:(0,l.cn)("bg-background pointer-events-none block size-[calc(theme(spacing.4)_-2px)] rounded-full shadow-sm ring-0 transition-transform data-[state=checked]:translate-x-[theme(spacing.4)] data-[state=unchecked]:translate-x-0 dark:bg-black",r)})})});i.displayName=n.bL.displayName},18867:(e,t,a)=>{"use strict";a.d(t,{j:()=>l});var s=a(7336),r=a(77299),n=a(74654);function l(e){return(0,s.jsx)(r.Dp,{variants:{hover:{rotate:60},tap:{rotate:360,interruptible:!1,transition:{duration:1,ease:[.27,.34,.22,.97]}},idle:{rotate:0}},children:(0,s.jsx)(n.g,{"aria-hidden":!0,...e})})}a(80644)},19291:(e,t,a)=>{"use strict";a.d(t,{e:()=>f});var s=a(7336),r=a(42794),n=a(99876),l=a(52106),i=a(90098),o=a(43390),c=a(73669),d=a(99887),u=a(4432),m=a(80644),h=a(33437);function p(e){let{v3:t=!1}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.SidebarHeader,{children:[(0,s.jsx)(i.SidebarScopeSwitcher,{}),(0,s.jsx)(r.SidebarMainNav,{})]}),(0,s.jsxs)(n.SidebarContent,{children:[(0,s.jsx)(u.SidebarProjects,{}),(0,s.jsx)(c.SidebarFavorites,{v3:t}),(0,s.jsx)(l.SidebarRecents,{v3:t})]}),(0,s.jsx)(m.Suspense,{children:(0,s.jsx)(h.NewFeatureBanner,{})}),(0,s.jsx)(n.SidebarFooter,{className:"pl-2 pr-3",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(o.SidebarUserMenu,{}),(0,s.jsx)(d.NewChatButton,{v3:t,variant:"logo",className:"h-3.5 w-7 text-gray-400"})]})})]})}var x=a(4495),g=a(82420);function f(e){let{v3:t=!1,mobileTriggerClassName:a}=e,c=(0,s.jsxs)(n.SidebarPopover,{isv3:t,className:"hidden sm:flex",children:[(0,s.jsx)(n.SidebarHeader,{children:(0,s.jsx)(i.W,{})}),(0,s.jsx)(n.SidebarContent,{className:"border-y border-y-gray-200 pt-3",children:(0,s.jsx)(r.SidebarMainNav,{variant:"popover",v3:t})}),(0,s.jsx)(n.SidebarContent,{children:(0,s.jsx)(l.SidebarRecents,{maxChats:4,noMoreMenu:!0,noActiveChat:!0,v3:t})}),t?null:(0,s.jsx)(n.SidebarFooter,{className:"border-t pl-2 pr-3",children:(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(o.SidebarUserMenu,{}),(0,s.jsx)(g.Y,{})]})})]}),d=(0,s.jsx)(n.SidebarTrigger,{className:(0,x.cn)("sm:hidden",a)}),u=(0,s.jsx)(n.SidebarMobile,{children:(0,s.jsx)(p,{v3:t})});return(0,s.jsxs)(s.Fragment,{children:[c,d,u]})}},19461:(e,t,a)=>{"use strict";a.d(t,{KO:()=>S,Ay:()=>k,vX:()=>w,Yh:()=>N,xH:()=>C});var s=a(80644),r=a(53155),n=a(15993),l=a(7393),i=a(34481),o=a(10299),c=a(30009);let d=(0,c.createServerReference)("40ccbe6dd3178b9f60335b2f67d143b94f4de521f7",c.callServer,void 0,c.findSourceMapURL,"importChat");var u=a(64854),m=a(46902),h=a(5099),p=a(16081),x=a(50809),g=a(2115),f=a(34444),v=a(1958),j=a(76073),b=a(22931);let y=[{mimeType:"image/gif",bytes:[71,73,70]},{mimeType:"image/png",bytes:[137,80,78,71]},{mimeType:"image/jpeg",bytes:[255,216]},{mimeType:"image/webp",bytes:[82,73,70,70]}],w=e=>new Promise((t,a)=>{let s=new Image;s.onload=()=>{t({width:s.naturalWidth,height:s.naturalHeight})},s.onerror=()=>{a(Error("Failed to load image"))},s.src=URL.createObjectURL(e)});async function N(e){let{file:t,config:s,setLocalFileInfos:r}=e;if(!(0,m.Ye)(t.type))return t;let n=s.image.maxSizeBytes;if(t.size<=n)return t;let l=(0,f.l)(),i={id:l,name:t.name,url:URL.createObjectURL(t),status:"compressing",size:t.size,isImage:t.type.startsWith("image/"),tokens:0,v0Type:t.v0Type};r(e=>[...e,i]),await new Promise(requestAnimationFrame);let{short:o,long:c}=s.image.maxDimensionsPixels,d=n/t.size+.1,u=null;for(;null===u;)try{let e=await function(e,t,s,r){return new Promise((n,l)=>{let i=new Worker(a.tu(new URL(a.p+a.u(5914),a.b)));i.onmessage=t=>{let{blob:a,error:s}=t.data;s?l(Error(s)):a&&n(new File([a],e.name,{type:a.type})),i.terminate()},i.onerror=e=>{l(Error(e.message)),i.terminate()},i.postMessage({file:e,quality:t,shortLimit:s,longLimit:r})})}(t,d,o,c);if(e.size>n)throw Error("File size still too large");(u=e).v0Type=t.v0Type}catch(e){d<=0?u=t:d-=.1}return r(e=>e.filter(e=>e.id!==l)),u}let k=e=>{let{isSignedIn:t,dragContainerRef:a,projectId:c,onFinish:y,onSuccess:k,onUploadStart:I,disablePaste:M,disableDrag:z,saveToDrafts:L=!0}=e,P=c?"project-source":"prompt-attachment",{draft:R,handleSavePromptDraft:D}=(0,h.jh)(),E=(0,s.useRef)(null),[A,T]=(0,s.useState)(!1),[F,O]=(0,s.useState)(L&&(null==R?void 0:R.source)==="cookie"&&R.localFileInfos||[]),{user:U,isTeam:V}=(0,j.k6)(),_=(0,x.f)(),{revalidate:B}=(0,u.m)(),[H,$]=(0,s.useState)(!1),q=(0,o.useRouter)(),{setShowSignInDialog:W}=(0,r.AO)(),[Z,G]=(0,s.useState)(new Map);(0,s.useEffect)(()=>{L&&(null==R?void 0:R.source)!=="cookie"&&(O((null==R?void 0:R.localFileInfos)||[]),G(new Map(Object.entries((null==R?void 0:R.fileMap)||{}))))},[L,R]);let K=(0,s.useCallback)(async e=>{try{if(!t){W({prompt:!1});return}if(Z.size+e.length>b.qN[P]){n.oR.error("You can only upload up to ".concat(b.qN[P]," files"));return}T(!0);let s=[],r=[];async function a(e){let t,a;let o=await N({file:e,config:_,setLocalFileInfos:O}),u=(0,f.l)();if(o.name.startsWith(i.Q)&&(null==U?void 0:U.isAdminMode)&&!c){let e=await d({payload:{file:o}});return"error"in e?{status:"error",message:e.error}:(B(),n.oR.success("Chat imported successfully"),q.push("/chat/".concat(e.chatId)),{status:"success"})}if("application/zip"===o.type){let e=await o.arrayBuffer();return s.push({id:u,name:o.name,size:o.size,isImage:!1,tokens:0,v0Type:"zip",url:"",contentType:"application/zip",content:e,status:"done"}),{status:"success"}}if((0,m.Ye)(o.type)){let e=_.image.maxSizeBytes,{short:t,long:a}=_.image.maxDimensionsPixels;if(o.size>e)return{status:"error",message:"".concat(o.name," is larger than ").concat((0,m.IG)(e))};let s=await w(o),r=Math.max(s.width||0,s.height||0),n=Math.min(s.width||0,s.height||0);if(r>a||n>t)return{status:"error",message:"".concat(o.name," exceeds the maximum dimensions. Long side must be less than or equal to ").concat(a,"px and short side must be less than or equal to ").concat(t,"px.")}}(0,m.Lu)(o.type,o.name.split(".").pop())&&(t=await o.text());let h=o.type.startsWith("image/")?(0,p.Ln)(o):(0,p.bP)(t||""),x={id:u,name:o.name,url:URL.createObjectURL(o),content:t,status:"uploading",size:o.size,isImage:o.type.startsWith("image/"),tokens:h,v0Type:o.v0Type};O(e=>[...e,x]),null==I||I(x);let{pathname:j,clientPayload:b}=await S({file:o,component:P});try{a=await (0,l.Se)(j,o,{access:"public",handleUploadUrl:"/chat/api/chat/upload",clientPayload:JSON.stringify(b)})}catch(t){(0,g.u)("FileUploadError",{fileName:o.name,fileType:o.type,errorMsg:String(t)}),console.error("Failed to upload ".concat(o.name,": ").concat(String(t))),O(e=>e.filter(e=>e.id!==u));let e="Failed to upload file "+o.name;return t instanceof v.CW&&(e="File type not allowed"),{status:"error",message:e}}if(c){var y;(0,g.u)("UploadSource",{projectId:c,extension:null===(y=o.name.split(".").pop())||void 0===y?void 0:y.toLowerCase(),type:o.type});let e={projectId:c,filename:o.name,url:a.url},t=await fetch("/chat/api/projects/sources",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});if(!t.ok){let e;try{e=(await t.json()).error}catch(t){e="Failed to start file indexing"}return{status:"error",message:e}}}let k={...a,name:o.name,size:o.size,v0Type:o.v0Type};return O(e=>{let t=e.map(e=>e.id===u?{...e,status:"done",url:a.url,contentType:a.contentType}:e);return L&&D({localFileInfos:t.map(e=>({...e,isSavedDraft:!0}))}),t}),r.push(k),G(e=>{let t=new Map(e).set(u,k);return L&&D({fileMap:Object.fromEntries(t)}),t}),s.push(x),{status:"success"}}let o=await Promise.allSettled(e.map(a)),u=!1;for(let e of o){if("rejected"===e.status){u=!0,n.oR.error("Failed to upload file");continue}if("error"===e.value.status){u=!0,n.oR.error(e.value.message);continue}}u||await (null==k?void 0:k(r,s))}catch(e){n.oR.error("Unexpected error while uploading files")}T(!1),null==y||y()},[y,t,Z.size,P,W,_,null==U?void 0:U.isAdminMode,c,I,B,q,L,D,k]),Y=(0,s.useCallback)(async e=>{if($(!1),A||(e.preventDefault(),e.stopPropagation(),!e.dataTransfer))return;if(!t){W({prompt:!1});return}let{files:a,items:s}=e.dataTransfer,r=s?await C(Array.from(s)):await C(Array.from(a));r.ok&&await K(r.value)},[t,W,K,A,$]);(0,s.useEffect)(()=>{if(M)return;let e=async e=>{if(e.clipboardData){let t=e.clipboardData.items,a=[],s=async()=>{for(let e of t)if("file"===e.kind){let t=e.getAsFile();if(t){if((0,m.Ye)(t.type)){let e=_.image.maxSizeBytes;if(t.size>e){n.oR.error("".concat(t.name," is larger than ").concat((0,m.IG)(e)));return}}a.push(t)}}a.length>0&&await K(a)};await s()}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}},[_.image.maxSizeBytes,t,W,K,M]),(0,s.useEffect)(()=>{let e=document.documentElement;if(z)return;let t=(null==a?void 0:a.current)||window,s=()=>{$(!0)},r=()=>{$(!1)},n=e=>{e.preventDefault(),e.stopPropagation()};return t.addEventListener("dragenter",s),e.addEventListener("mouseleave",r),t.addEventListener("dragover",n),t.addEventListener("drop",Y),()=>{t.removeEventListener("dragenter",s),e.removeEventListener("mouseleave",r),t.removeEventListener("dragover",n),t.removeEventListener("drop",Y)}},[Y,a,z]);let Q=async e=>{if(!e.target.files)return;let t=await C(Array.from(e.target.files));t.ok&&(await K(t.value),e.target.value="")};return{blobs:Array.from(Z.values()),reset:()=>{O([]),G(new Map),L&&D({localFileInfos:[],fileMap:{}})},uploading:A,localFileInfos:F,isDraggingFile:H,inputFileRef:E,onInputChange:Q,removeFile:e=>{O(t=>{let a=t.filter(t=>t.id!==e);return L&&D({localFileInfos:a}),a}),G(t=>{let a=new Map(t);return a.delete(e),L&&D({fileMap:Object.fromEntries(a)}),a}),L&&D({fileMap:Object.fromEntries(Array.from(Z).filter(t=>{let[a]=t;return a!==e}))})},uploadFiles:K}};async function C(e){let t=[];if(!(null==e?void 0:e.length))return{ok:!1};let a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.isFile)return[await new Promise(t=>e.file(t))];if(e.isDirectory){let s=e.createReader(),r=await new Promise(e=>s.readEntries(e));return(await Promise.all(r.map(s=>a(s,t+e.name+"/")))).flat()}return[]},s=[];for(let a of e)if("webkitGetAsEntry"in a){let e=a.webkitGetAsEntry();e&&s.push(e)}else t.push(a);for(let e of s){let s=await a(e);t.push(...s)}let r=[];for(let e=0;e<t.length;e++){var l;let a=null===(l=t[e].name.split(".").pop())||void 0===l?void 0:l.toLowerCase();if(".DS_Store"!==t[e].name){if(!a)return n.oR.error("Unsupported file type "+a),{ok:!1};r.push(t[e])}}return{ok:!0,value:r}}async function S(e){var t,a;let{file:s,component:r}=e,n=s.name,l=s.type,i=null===(t=s.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();if(s.type.startsWith("image/")){let e=function(e){for(let{bytes:t,mimeType:a}of y)if(e.length>=t.length&&t.every((t,a)=>e[a]===t))return a}(new Uint8Array(await s.arrayBuffer()));l=null!=e?e:s.type,i=null!==(a=null==e?void 0:e.split("/")[1])&&void 0!==a?a:i,n=s.name.endsWith(".".concat(i))?s.name:"".concat(s.name,".").concat(i)}return{pathname:n,clientPayload:{component:r,fileType:l,extension:i}}}(0,s.createContext)({hasUploadedFiles:!1,isUploadingFiles:!1})},19895:(e,t,a)=>{"use strict";a.d(t,{I4:()=>d,eu:()=>c,oQ:()=>m,y6:()=>u,z6:()=>h});var s=a(61202),r=a(85168),n=a(18730),l=a(80644),i=a(59103),o=a(77674);function c(){let{chatId:e}=(0,n.xz)(),{data:t}=(0,i.Ay)(["active-block",e]);return t}function d(){let{chatId:e}=(0,n.xz)(),{data:t}=(0,i.Ay)(["block-view",e]);return!!t}function u(){let{chatId:e}=(0,n.xz)(),{mutate:t}=(0,o.iX)();return(0,l.useCallback)(a=>{t(["active-block",e],null!=a?a:null,!1)},[e,t])}function m(){let{chatId:e}=(0,n.xz)(),{mutate:t}=(0,o.iX)();return(0,l.useCallback)((a,s)=>{a?t(["active-block",e],s,!1):t(["active-block",e],null,!1),t(["block-view",e],a,!1)},[e,t])}function h(){let{messages:e}=(0,n.Pk)(),t=c(),a=m();return(0,l.useCallback)((n,l)=>{if(!t)return;let i=()=>{let t;if(!l)return void a(!1);let r=-1;for(let a of e.map(e=>{var t;return(0,s.sY)(null!==(t=e.content)&&void 0!==t?t:"",e.id)}).flat()){if(!a)continue;let e=l.findIndex(e=>e===a.messageId);e>-1&&e>=r&&(r=e,t=a)}if(!t){a(!1);return}a(!0,t)};if(!n){a(!1);return}if(n===t.messageId){i();return}new Set((0,r.Ir)(e.map(e=>({...e,messageId:e.id})),n)).has(t.messageId)&&i()},[t,e,a])}},20172:(e,t,a)=>{"use strict";a.d(t,{LX:()=>l,P5:()=>n,RQ:()=>i});var s=a(80644),r=a(59103);function n(e){let{blockId:t,isPreviewable:a}=e,n=(0,s.useMemo)(()=>!0===a||"object"==typeof a&&"warning"in a,[a]),{data:l,mutate:i}=(0,r.Ay)(["block:activeTab",t],{fallbackData:n?"preview":"code"});return(0,s.useEffect)(()=>{n&&i("preview")},[n,i]),{hasBlockPreview:a,activeTab:l,setActiveTab:i}}let l=e=>{let{data:t}=(0,r.Ay)(["block:activeTab",e]);return t},i=e=>{let{mutate:t}=(0,r.Ay)(["block:activeTab",e]);return t}},22748:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});var s=a(18730),r=a(59103),n=a(80644);function l(){let{chatId:e}=(0,s.xz)(),{data:t,mutate:a}=(0,r.Ay)(["blocks-deployed",e]);return{getBlockDeployed:(0,n.useCallback)(e=>null==t?void 0:t.get(e),[t]),setBlockDeployed:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)))},[t,a])}}},22913:(e,t,a)=>{"use strict";a.d(t,{JB:()=>n,L2:()=>d,Uf:()=>i,ej:()=>l,lu:()=>c,zz:()=>o});var s=a(7336),r=a(48222);let n=(0,r.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.93934 2.06066L8 1L9.06066 2.06066L13.9393 6.93934L15 8L13.9393 9.06066L9.06066 13.9393L8 15L6.93934 13.9393L2.06066 9.06066L1 8L2.06066 6.93934L6.93934 2.06066ZM3.12132 8L8 12.8787L12.8787 8L8 3.12132L3.12132 8Z" fill="#1D4ED8"/>'),l=(0,r.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6.47141 3.13809L6.94281 2.66669L6 1.72388L5.5286 2.19528L2.19526 5.52861C1.93491 5.78896 1.93491 6.21107 2.19526 6.47142L5.5286 9.80476L6 10.2762L6.94281 9.33335L6.47141 8.86195L4.35948 6.75002H9.66667C10.0497 6.75002 10.429 6.82546 10.7828 6.97204C11.1367 7.11861 11.4582 7.33345 11.7291 7.60429C11.9999 7.87513 12.2147 8.19666 12.3613 8.55053C12.5079 8.90439 12.5833 9.28366 12.5833 9.66669C12.5833 10.0497 12.5079 10.429 12.3613 10.7828C12.2147 11.1367 11.9999 11.4582 11.7291 11.7291C11.4582 11.9999 11.1367 12.2148 10.7828 12.3613C10.429 12.5079 10.0497 12.5834 9.66667 12.5834H7.33333H6.58333V14.0834H7.33333H9.66667C10.2467 14.0834 10.821 13.9691 11.3569 13.7472C11.8927 13.5252 12.3796 13.1999 12.7897 12.7897C13.1998 12.3796 13.5252 11.8927 13.7471 11.3569C13.9691 10.821 14.0833 10.2467 14.0833 9.66669C14.0833 9.08668 13.9691 8.51235 13.7471 7.9765C13.5252 7.44065 13.1998 6.95376 12.7897 6.54363C12.3796 6.13351 11.8927 5.80818 11.3569 5.58622C10.821 5.36426 10.2467 5.25002 9.66667 5.25002H4.35948L6.47141 3.13809Z" fill="currentColor"/>'),i=(0,r.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5304 2.13629L10.0001 1.60596L8.93942 2.66662L9.46975 3.19695L11.5228 5.24995H6.33341C5.16204 5.24995 4.03865 5.71528 3.21036 6.54356C2.38207 7.37185 1.91675 8.49524 1.91675 9.66662C1.91675 10.2466 2.03099 10.8209 2.25295 11.3568C2.47491 11.8927 2.80023 12.3795 3.21036 12.7897C4.03865 13.618 5.16204 14.0833 6.33341 14.0833H8.66675H9.41675V12.5833H8.66675H6.33341C5.55987 12.5833 4.818 12.276 4.27102 11.729C4.00018 11.4582 3.78534 11.1366 3.63877 10.7828C3.49219 10.4289 3.41675 10.0496 3.41675 9.66662C3.41675 8.89307 3.72404 8.1512 4.27102 7.60422C4.818 7.05724 5.55987 6.74995 6.33341 6.74995H11.5228L9.46975 8.80295L8.93942 9.33328L10.0001 10.3939L10.5304 9.86361L13.8637 6.53028C14.1566 6.23739 14.1566 5.76251 13.8637 5.46962L10.5304 2.13629Z" fill="currentColor"/>'),o=(0,r.G4)('<path fill-rule="evenodd" clip-rule="evenodd" d="M1.78027 1.78009L2.29198 3.24697L6.04198 13.997L6.59312 15.5769L7.40575 14.1142L9.76699 9.86393C9.78966 9.82312 9.82331 9.78948 9.86412 9.76681L14.1144 7.40556L15.5771 6.59293L13.9972 6.04179L3.24716 2.29179L1.78027 1.78009ZM11.9232 6.90695L9.13565 8.45557C8.84998 8.61428 8.61446 8.8498 8.45575 9.13547L6.90714 11.923L4.21998 4.2198L11.9232 6.90695Z" fill="currentColor"/>'),c=e=>{let{size:t="medium"}=e,a="small"===t?14:16;return(0,s.jsxs)("span",{className:"flex w-min items-center gap-0.5 font-mono leading-none",style:{height:a},children:[(0,s.jsx)("span",{className:"mt-[2px]",style:{fontSize:a+4},children:"⌘"}),(0,s.jsx)("span",{style:{fontSize:a-2},children:"/"})]})},d=(0,r.G4)('<path d="M6.79322 9.2069V6.31034H4.37943V7.27586V8.24138H1.00012L1 7.5V1H4.37943V2.93103H10.8967C10.8967 2.93103 15.0001 2.93103 15.0001 7.27586C15.0001 7.27586 12.8277 6.31034 10.1725 6.31034V9.2069M6.79322 9.2069H10.1725M6.79322 9.2069V15M10.1725 9.2069V15" stroke="currentColor" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>')},23042:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(59103),r=a(76073);function n(e){let{integrationIds:t,isEnabled:a}=e,{activeScopeSlug:n}=(0,r.k6)(),l=new URLSearchParams;l.set("integrationIds",t.join(",")),l.set("scope",null!=n?n:"");let{data:i,error:o,isLoading:c,mutate:d}=(0,s.Ay)(a&&t.length?"/chat/api/integrations/marketplace/options?".concat(l.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration options data");return t.json()});return{integrations:((null==i?void 0:i.integrations)||[]).filter(e=>!["upstash-vector","upstash-qstash"].includes(e.slug)),isLoading:c,error:o||null,refetch:d}}},24331:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var s=a(7336),r=a(62500),n=a(77299);function l(){return(0,s.jsx)(n.Dp,{variants:{hover:{y:-2,x:-1,rotate:-12}},children:(0,s.jsx)(r.k,{"aria-hidden":!0})})}a(80644)},24806:(e,t,a)=>{"use strict";a.d(t,{W:()=>u,p:()=>d});var s=a(7336);a(80644);var r=a(79822),n=a(51621),l=a(57942),i=a(4495),o=a(59977),c=a(67952);function d(e){let{text:t,children:a,isLoading:d=!1,forceOpen:m=!1,triggerClassName:h}=e,p=(0,c.k)("messages"),x=null!=t?t:p("loadingText"),g=(0,s.jsx)(l.X,{className:"!text-gray-500 transition-colors group-hover/thinking:!text-gray-900"}),f=(0,s.jsx)(o.UC,{className:"group/content data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden pt-2",children:(0,s.jsx)("div",{className:"transition-[filter,opacity] duration-500 group-data-[state=closed]/content:opacity-0 group-data-[state=open]/content:opacity-100 group-data-[state=closed]/content:blur-lg group-data-[state=open]/content:blur-0",children:a})}),v=(0,s.jsxs)("div",{className:(0,i.cn)("group/thinking flex w-full min-w-0 flex-1 flex-row items-center gap-1 text-sm",h),children:[(0,s.jsx)("div",{className:"transition-colors group-hover/thinking:text-gray-900",children:x}),(0,s.jsx)("div",{className:(0,i.cn)("translate-y-[1px] transition-all group-[&[data-state=open]]/trigger:rotate-180"),children:a?g:null})]});return(0,s.jsx)(o.bL,{className:"text-gray-500 [&:not(:first-child)]:-mt-1 [&_+_.block-preview]:mt-4",type:"single",collapsible:!0,value:m?"thinking":void 0,children:(0,s.jsxs)(o.q7,{value:"thinking",children:[(0,s.jsx)(o.l9,{className:(0,i.cn)("group/trigger w-full",!a&&"pointer-events-none -translate-y-px"),tabIndex:a?void 0:-1,children:(0,s.jsx)(r.N,{mode:"wait",children:(0,s.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex",children:d?(0,s.jsx)(u,{children:v}):v},x)})}),a||m?f:null]})})}function u(e){let{children:t,className:a}=e;return(0,s.jsx)(n.P.div,{animate:{backgroundPosition:["100% 50%","-100% 50%"]},transition:{duration:1.5,repeat:Number.POSITIVE_INFINITY,ease:"linear"},style:{background:"linear-gradient(90deg, hsl(var(--gray-400)) 0%, hsl(var(--gray-400)) 35%, hsl(var(--gray-900)) 50%, hsl(var(--gray-400)) 65%, hsl(var(--gray-400)) 100%)",backgroundSize:"200% 100%",WebkitBackgroundClip:"text",backgroundClip:"text"},className:(0,i.cn)("flex items-center text-transparent",a),children:t})}},25109:(e,t,a)=>{"use strict";a.d(t,{j:()=>r});var s=a(30009);let r=(0,s.createServerReference)("405ca959e88d96ea6f32549091030d7760fa9a9c40",s.callServer,void 0,s.findSourceMapURL,"unfavoriteProject")},25374:(e,t,a)=>{"use strict";a.d(t,{V:()=>r});var s=a(30009);let r=(0,s.createServerReference)("408c780df1fae60c2f34b171983570a15fd9ffdde1",s.callServer,void 0,s.findSourceMapURL,"exportChat")},26439:(e,t,a)=>{"use strict";a.d(t,{hJ:()=>ev,t$:()=>ew});var s=a(7336),r=a(9097);let n=e=>{let{className:t}=e;return(0,s.jsx)("svg",{"aria-label":"Vercel Logo",className:(0,r.cn)(t,"fill-black dark:fill-white"),fill:"none",height:22,viewBox:"0 0 235 203",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M117.082 0L234.164 202.794H0L117.082 0Z",fill:"currentColor"})})};var l=a(81616),i=a(4495),o=a(86807),c=a(18730),d=a(67952),u=a(80644),m=a(19895),h=a(95110),p=a(10299),x=a(59103);function g(e,t,a){let s=(0,p.useRouter)(),{updateBlockData:r}=(0,h.P6)({blockId:t}),n=async a=>{if(!e||!t)return;let n=await fetch(a);if(!n.ok)return Error("Failed to fetch deployment status");let l=await n.json();return("READY"===l.readyState||"ERROR"===l.readyState)&&(t&&r({blockId:t,data:{latestDeploymentInfo:{aliasUrl:l.url,deploymentId:e,readyState:l.readyState||"READY"}}}),s.refresh()),l},{data:l,error:i,isLoading:o,mutate:c}=(0,x.Ay)(e&&t&&!a?"/chat/api/chat/deployment-status?id=".concat(e,"&bid=").concat(t):null,n,{refreshInterval:3e3,revalidateOnFocus:!1,suspense:!0}),d=l&&l instanceof Error;return{readyState:d?"ERROR":null==l?void 0:l.readyState,url:null==l?void 0:l.url,isLoading:o,isError:d||i,inspectorUrl:null==l?void 0:l.inspectorUrl,revalidate:c,id:null==l?void 0:l.id}}var f=a(83030),v=a(91302),j=a(76073),b=a(88551),y=a(15993),w=a(57748),N=a(99982),k=a(33508),C=a(97210),S=a(91064),I=a(84274),M=a(93874),z=a(22748),L=a(50688),P=a(43665),R=a(48473),D=a(4304),E=a(23063);function A(e){var t;let{variant:a="default",blockId:r,lang:n,source:o,deploymentStatus:p,deployment:x,activeBlock:g,isActivelyDeploying:A,startedDeployment:T}=e,{activeScopeSlug:F,activeScope:U}=(0,j.k6)(),[V,_]=(0,u.useTransition)(),{isStreaming:B,chatId:H}=(0,c.Pk)(),{project:$}=(0,w.tZ)(),{handleReassignProject:q,reassignPending:W}=(0,k.Z)(),Z=(0,d.k)("deployBlockPopover"),[G,K]=(0,u.useState)(!1),Y=(0,m.y6)(),{setBlockDeployed:Q}=(0,z.G)(),{updateBlockData:J}=(0,h.P6)({blockId:r}),{ocd:X,gs:ee}=(0,E.D)(),et=(0,f.m)({data:{lang:n,source:o}},v.P),ea=(0,u.useCallback)(()=>{g&&r&&(K(!0),_(async()=>{try{let e=await fetch("/chat/api/git/push?scope=".concat(F),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blockId:r})}),t=await e.json();if("error"in t)throw Error(t.error);if(e.ok&&t.deployment){let e=t.deployment;Y({...g,latestDeploymentInfo:{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}}),Q(r,{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}),J({blockId:r,data:{latestDeploymentInfo:{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}}}),await (null==p?void 0:p.revalidate())}else throw console.error(t),Error("Failed to deploy block to Vercel")}catch(e){console.error("Error pushing to repo:",e),(0,b.z)(e,void 0,"Failed to push")||y.oR.error("Failed to push")}finally{K(!1)}}))},[g,r,F,Y,Q,J,p]),es=(0,u.useCallback)(()=>{g&&r&&(K(!0),_(async()=>{try{let e=await fetch("/chat/b/".concat(r,"/deploy?scope=").concat(F),{method:"POST"}),t=await e.json();if("error"in t)throw Error(t.error);if(e.ok)Y({...g,latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}),Q(r,{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}),J({blockId:r,data:{latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}}),await (null==p?void 0:p.revalidate());else throw console.error(t),Error("Failed to deploy block to Vercel")}catch(e){(0,b.z)(e,void 0,"Failed to deploy block to Vercel")||y.oR.error("Failed to deploy block to Vercel. You may lack permissions to create new Vercel projects.")}finally{K(!1)}}))},[g,r,F,Y,Q,J,p]);if(!r||!et)return null;let er=null!==(t=null==g?void 0:g.meta.title)&&void 0!==t?t:null==g?void 0:g.meta.project;if(er&&/[_-]/.test(er)&&(er=er.split(/[_-]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")),!$&&(x||!X))return(0,s.jsx)(N.o,{handleProjectSelect:q,modalClassName:"z-[9999]",quickCreate:!0,projectName:er,onSuccess:e=>{H&&(0,R.M)({payload:{chatId:H,projectId:e}})},triggerButton:(0,s.jsx)(l.$,{className:"w-full max-w-full",type:"submit",disabled:B,size:"sm",children:Z(x?"addChatToProjectRedeploy":"addChatToProject")}),disabled:W});if(!$)return(0,s.jsx)(D.Q,{className:"w-full",pending:!0,children:"Creating Project"});if(!$.vercelProjectId){let e=$.isCreator,t=!!U&&((0,P.W)(U)?e:"OWNER"===U.membership.role);return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"border-0.5 flex items-center gap-4 rounded-sm border border-yellow-600 p-4 text-sm text-yellow-600",children:[(0,s.jsx)(I.N,{className:"size-5 shrink-0"}),(0,s.jsxs)("p",{children:["This block is linked to a v0 project (",(0,s.jsx)(S.N,{className:"inline-flex w-fit font-medium",href:"/chat/projects/".concat($.projectId),children:$.name}),") without a Vercel project connection. Please link a Vercel project to deploy this block."]})]}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,s.jsx)(M.f8,{v0ProjectId:$.projectId,size:"sm",readOnly:!(e||t)}),(0,s.jsx)(l.$,{variant:"secondary",size:"sm",onClick:()=>q(null),children:"Unlink v0 Project"})]})]})}return x&&!A?(0,s.jsx)(L.E,{className:"h-8 w-full"}):(null==p?void 0:p.readyState)?(0,s.jsx)(O,{variant:a,deploymentStatus:p}):(0,s.jsx)(l.$,{className:(0,i.cn)("w-full max-w-full gap-2","secondary"===a&&"bg-gray-100 hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200 disabled:bg-gray-100"),variant:"secondary"===a?"ghost":"default",size:"sm",type:"submit",disabled:B||V||G||T,onClick:ee?ea:es,children:G||T?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.y,{size:16})," ",Z("initiatingDeployment")]}):ee?"Push":Z("confirmAndDeploy")})}let T=["QUEUED"],F=["BUILDING","INITIALIZING","NOTREADY"];function O(e){let{variant:t,deploymentStatus:a}=e,r=(0,d.k)("deployBlockPopover");return T.includes(a.readyState||"")?(0,s.jsxs)(l.$,{disabled:!0,className:(0,i.cn)("w-full gap-2","secondary"===t&&"bg-gray-100 hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200 disabled:bg-gray-100"),variant:"secondary"===t?"ghost":"default",size:"sm",type:"submit",children:[(0,s.jsx)(C.y,{size:16})," ",r("initiatingDeployment")]}):F.includes(a.readyState||"")?(0,s.jsxs)(l.$,{disabled:!0,className:(0,i.cn)("w-full gap-2","secondary"===t&&"bg-gray-100 hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200 disabled:bg-gray-100"),variant:"secondary"===t?"ghost":"default",size:"sm",type:"submit",children:[(0,s.jsx)(C.y,{size:16})," ",r("deploying")]}):null}var U=a(35740),V=a(8999),_=a(53616),B=a(403),H=a(21491),$=a(30182),q=a(23914),W=a(64373),Z=a(18342);let G=async e=>{let t=await fetch(e);return t.ok?t.json():Error("Failed to fetch deployment status")};var K=a(2115),Y=a(52220),Q=a(30009);let J=(0,Q.createServerReference)("40ba47dd99951806eb0ce812c9fc861333e4965ec5",Q.callServer,void 0,Q.findSourceMapURL,"assignVercelAlias");var X=a(95805),ee=a(82399),et=a(22931);function ea(e){let{deploymentId:t,activeBlock:a,editedAlias:r,setEditedAlias:n,revalidateDeploymentStatus:o,goBack:c,vercelProjectId:p}=e,x=(0,d.k)("shareBlockPopover"),[g,f]=(0,u.useTransition)(),v=g||!a||!r,j=(0,m.y6)(),{updateBlockData:w}=(0,h.P6)({blockId:null==a?void 0:a.id}),[N,k]=(0,u.useState)(null),[I,M]=(0,u.useState)(null),z=(0,u.useCallback)(()=>{v||(k(null),f(async()=>{try{(0,K.u)("SubmitAssignVercelAlias",{blockId:a.id,alias:r});let s=await J({deploymentId:t,alias:r,vercelProjectId:p});if(s.success){var e;await (null==o?void 0:o()),y.oR.success(x("domainAssigned"));let r={aliasUrl:s.assignedAlias,deploymentId:t,readyState:(null===(e=a.latestDeploymentInfo)||void 0===e?void 0:e.readyState)||"READY"};j({...a,latestDeploymentInfo:r}),w({blockId:a.id,data:{latestDeploymentInfo:r}}),c()}else{let e=s.errorCode||ee.dD,t=e in et.jW?et.jW[e]:s.errorMessage;if(t)M(s.redirectTo||null),k(t);else throw Error(e)}}catch(e){(0,b.z)(e)||y.oR.error("Failed to set custom domain. Please try again.")}}))},[v,a,r,t,p,o,x,j,w,c]),L=(0,u.useRef)(null),P=null==r?void 0:r.includes("."),R=(0,s.jsx)("div",{className:"h-8 max-h-full pl-0.5",children:(0,s.jsx)("div",{className:"flex h-full items-center rounded-r-lg bg-gray-100 px-2 text-sm text-gray-500",children:P?"Custom":".vercel.app"})}),D=null;if(N){let e=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W.$,{}),I?"Please add this domain to Vercel.":N]});D=I?(0,s.jsxs)(S.N,{target:"_blank",href:I,className:"flex items-center justify-start gap-2 text-sm font-medium text-red-600 hover:underline",children:[e,(0,s.jsx)(X.i,{})]}):(0,s.jsx)("div",{className:"flex items-center justify-start gap-2 text-sm font-medium text-red-600",children:e})}return(0,s.jsxs)("form",{onSubmit:e=>(e.preventDefault(),z()),children:[(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3 p-4",children:[(0,s.jsx)(Y.p,{autoCapitalize:"off",className:(0,i.cn)("disabled:bg-background flex-1"),name:"subdomain",onChange:e=>{n(e.target.value.replace(/^(https?:\/\/)?/,"").replace(/\.vercel\.app\/?$/,"")||"")},placeholder:x("enterCustomDomain"),ref:L,size:"sm",suffix:R,value:r||""}),D]}),(0,s.jsxs)("div",{className:"border-alpha-400 bg-muted flex items-center justify-end gap-2 border-t p-3",children:[(0,s.jsx)(l.$,{onClick:c,size:"sm",type:"button",variant:"secondary",children:x("cancel")}),(0,s.jsxs)(l.$,{disabled:v,onClick:z,size:"sm",type:"submit",children:[x("saveDomain"),g?(0,s.jsx)(C.y,{className:"text-foreground",size:16}):null]})]})]})}var es=a(95057),er=a(77011),en=a(35330),el=a(93881);function ei(e){return"v0 does not currently support deploying ".concat(e)}function eo(e){return/\.(js|jsx|ts|tsx)$/.test(e)}let ec="v0 currently only supports deploying React or Next.js";var ed=a(3650),eu=a(79822),em=a(51621),eh=a(28730),ep=a(45419);let ex=async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch deployment build logs");return t.json()};var eg=a(64495);let ef=e=>{let{deploymentId:t}=e,{logs:a}=function(e){let[t,a]=(0,u.useState)({allLogs:[],since:Date.now()-6e4}),{data:s,error:r,isLoading:n,mutate:l}=(0,x.Ay)(e?"/chat/api/chat/deployment-build-logs?id=".concat(e,"&since=").concat(t.since):null,ex,{refreshInterval:1500,revalidateOnFocus:!1,dedupingInterval:1e3}),i=(0,u.useCallback)(e=>{a(t=>{let a=[...t.allLogs];for(let t of e.logs)a.some(e=>e.id===t.id||e.created===t.created&&e.text===t.text)||a.push(t);return{allLogs:a,since:Math.max(t.since,e.nextSince)}})},[]);return(0,u.useEffect)(()=>{s&&i(s)},[s,i]),{logs:(0,u.useMemo)(()=>[...t.allLogs].sort((e,t)=>(e.created||0)-(t.created||0)),[t.allLogs]),error:r,isLoading:n,mutate:l}}(t),r="Your deployment will be ready soon. You can safely navigate away.",n="Your deployment will be ready soon.",l=a.length>0?a[a.length-1].text:"";return(0,s.jsx)("div",{className:"relative h-5",children:(0,s.jsxs)("div",{className:"absolute -inset-y-1 inset-x-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"from-background absolute inset-x-0 top-0 z-10 h-2.5 w-full bg-gradient-to-b to-transparent"}),(0,s.jsx)(eu.N,{initial:!1,children:(0,s.jsxs)(em.P.span,{initial:{y:"100%"},animate:{y:0},exit:{y:"-100%"},transition:{duration:.35,ease:[0,0,.35,1]},className:"absolute inset-0 flex items-center text-sm text-gray-500",children:[(0,s.jsx)("span",{className:"hidden md:inline",children:(l||r).length>70?(l||r).slice(0,70)+"...":l||r}),(0,s.jsx)("span",{className:"md:hidden",children:(l||n).length>45?(l||n).slice(0,45)+"...":l||n})]},l)}),(0,s.jsx)("div",{className:"from-background absolute inset-x-0 bottom-0 z-10 h-2 w-full bg-gradient-to-t to-transparent"})]})})};function ev(e){var t;let{className:a}=e,r=(0,d.k)("deployBlockPopover"),n=(0,m.eu)(),{getBlockDeployed:p}=(0,z.G)(),x=(null==n?void 0:n.id)?p(n.id):void 0,g=null==n?void 0:n.latestDeploymentInfo,[f,v]=(0,u.useState)("idle"),[N,k]=(0,u.useState)(null),{activeScopeSlug:S}=(0,j.k6)(),{project:I,title:M}=(0,w.tZ)(),{chatId:L}=(0,c.Pk)(),P=(0,m.y6)(),{setBlockDeployed:R}=(0,z.G)(),{updateBlockData:D}=(0,h.P6)({blockId:null==n?void 0:n.id}),{ocd:A,gs:T}=(0,E.D)(),[F,O]=(0,u.useState)({}),U=(0,ep.Ok)(null!==(t=null==I?void 0:I.projectId)&&void 0!==t?t:void 0),V=(0,u.useCallback)(async e=>{var t,a;let s=e?null==N?void 0:N.commonDeployError:null;if(k(null),A&&"idle"===f){if(!n||!n.id||g||!S)return;if(O(e=>({...e,[n.id]:!0})),"code-project"===n.type&&!e){v("collectDeployWarnings");let e=await (0,eh.i)({blockId:n.id});if("warning"in e){v("idle"),k(e);return}}if(!I){v("creating-project");let e="Fork of ",a=null!==(t=n.meta.title)&&void 0!==t?t:M;a.startsWith(e)&&(a=a.slice(e.length)),await (0,ed.g)({projectName:a,onSuccess:()=>{},chatId:L,includeSuccessToast:!1})}if(T){if(U.vercelProjectWithDashboard&&!(null===(a=U.vercelProjectWithDashboard.dashboardProject)||void 0===a?void 0:a.link)){v("creating-repo");return}v("idle");return}v("deploying"),(0,u.startTransition)(async()=>{try{let e=await fetch("/chat/b/".concat(n.id,"/deploy?scope=").concat(S),{method:"POST",body:JSON.stringify({skippedDeployWarning:s})}),t=await e.json();if("error"in t)throw Error(t.error);if(e.ok)P({...n,latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}),R(n.id,{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}),D({blockId:n.id,data:{latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}});else throw console.error(t),Error("Failed to deploy block to Vercel")}catch(e){(0,b.z)(e,void 0,"Failed to deploy block to Vercel")||y.oR.error("Failed to deploy block to Vercel. You may lack permissions to create new Vercel projects.")}finally{v("idle")}})}},[A,f,null==N?void 0:N.commonDeployError,n,g,S,I,T,M,L,U.vercelProjectWithDashboard,P,R,D]);if(!n)return null;let _=(0,s.jsx)(o.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{size:"sm",className:"flex h-7 items-center gap-0.5 rounded-md px-1.5",children:[(0,s.jsx)(C.y,{size:16}),(0,s.jsx)("span",{className:"px-1 text-sm",children:r("deploying")})]})});return(0,s.jsxs)(o.AM,{children:[(0,s.jsx)(u.Suspense,{fallback:_,children:(0,s.jsx)(ej,{activeBlock:n,deployState:f,deployment:x||null,handleDeployClick:()=>V()})}),(0,s.jsx)(o.hl,{align:"end",className:(0,i.cn)("h-50 flex w-[370px] flex-col items-stretch gap-0 p-0 md:w-[515px]",a),sideOffset:8,withOverlay:!0,children:(0,s.jsx)(u.Suspense,{fallback:F[n.id]?(0,s.jsx)(eD,{}):(0,s.jsx)(eR,{}),children:(0,s.jsx)(ew,{deployState:f,activeBlock:n,deployment:x||null,deployWarning:N,handleByPassDeployWarning:()=>{V(!0)}})})})]})}function ej(e){var t,a;let{activeBlock:r,deployState:i,handleDeployClick:m,deployment:h}=e,p=(0,d.k)("deployBlockPopover"),{isStreaming:x}=(0,c.Pk)(),{getBlockDeployed:f}=(0,z.G)(),v=g(null==h?void 0:h.deploymentId,r.id,(null===(t=r.latestDeploymentInfo)||void 0===t?void 0:t.readyState)==="READY"||(null===(a=r.latestDeploymentInfo)||void 0===a?void 0:a.readyState)==="ERROR"),j=(0,u.useMemo)(()=>ey.includes(v.readyState||""),[v.readyState]),b=(0,u.useMemo)(()=>!!r.source&&function(e,t){let{fileName:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("code-project"===t){let t=(0,el.A)({source:e||"",blockType:"code-project",blockId:"fake"}),a=e=>e.endsWith(".astro"),s=[{regex:/from ['"]@expo\//,packageName:"Expo"},{regex:/from ['"]react-native/,packageName:"React Native"},{regex:/from ['"]express['"]/,packageName:"Express"},{regex:/require\(['"]express['"]\)/,packageName:"Express"},{regex:/from ['"]@prisma\/client['"]/,packageName:"Prisma"},{regex:/from ['"]next\/font\/local['"]/,packageName:"Next.js font/local"},{regex:/from ['"]https:\/\/deno\.land\//,packageName:"Deno"}],r=!1,n=!1,l=!1,i=!1,o=!1,c=!1,d=!1,u=!1,m=!1,h=!1,p=!1,x=!1,g=!1,f=!1,v=0,j=!1;for(let e of t){let t=e.meta.file||"",b=e.source,y=/\.(tsx|jsx|js|ts)$/.test(t);if(t.endsWith(".php")&&v++,(e.meta.file.endsWith(".html")||e.meta.file.endsWith(".htm"))&&(l=!0),/^src\/App\.(js|jsx|ts|tsx)$/.test(e.meta.file)&&(f=!0),e.meta.file.endsWith("manifest.json"))try{let e=JSON.parse(b);void 0!==e.manifest_version&&(g=!0)}catch(e){g=!1}if((e.meta.file.endsWith("app.py")||e.meta.file.endsWith("backend/app.py"))&&(c=!0),e.meta.file.endsWith("main.py")&&(u=!0),e.meta.file.endsWith("manage.py")&&(p=!0),e.meta.file.endsWith("settings.py")&&(x=!0),e.meta.file.startsWith("templates/")&&(m=!0),e.meta.file.includes("models.py")&&(d=!0),e.meta.file.startsWith("frontend/")&&(h=!0),(e.meta.file.startsWith("pages/")||e.meta.file.startsWith("src/pages/"))&&(i=!0),(e.meta.file.startsWith("app/")||e.meta.file.startsWith("src/app/"))&&(o=!0),a(t))return{error:ei("Astro")};for(let e of(t.includes("app.module.")&&y&&(j=!0),s))if(e.regex.test(b))return{error:ei(e.packageName)};eo(t)&&(r=!0),/\.(jsx|tsx)$/.test(t)&&(n=!0)}return v>t.length/2?{error:ei("PHP applications")}:j?{error:ei("Angular")}:f?{error:ei("Create React App")}:g?{error:ei("Chrome Extensions")}:(c||u||d)&&(m||h)?{error:ei("Flask")}:p||x?{error:ei("Django")}:i&&!o?{error:ei("Next.js Pages Router")}:(o||l||n)&&(!!r||!!l)||{error:ec}}return"v0"!==t&&"react"!==t?{error:ec}:!!(a&&eo(a))||{error:ec}}(r.source,r.type,{fileName:r.meta.file}),[r.meta.file,r.source,r.type]),y=x||!0!==b,w=(0,u.useMemo)(()=>f(r.id),[r.id,f]);if(!j&&w)return(0,s.jsx)(o.Wv,{asChild:!0,children:(0,s.jsxs)(l.$,{disabled:y,size:"sm",className:"h-7 rounded-md",children:[(0,s.jsx)(B.q,{height:16,width:16}),(0,s.jsx)("span",{className:"text-sm",children:p("deployed")})]})});let N=!0===b?"div":es.Tooltip,k="object"==typeof b&&"error"in b?{content:b.error}:{};return(0,s.jsx)(o.Wv,{asChild:!0,children:(0,s.jsx)(N,{...k,children:(0,s.jsx)("span",{tabIndex:!0===b?0:-1,children:(0,s.jsxs)(l.$,{disabled:y&&"idle"===i,size:"sm",className:"h-7 select-none items-center gap-0.5 rounded-md px-1.5 has-[>svg]:px-1.5",onClick:m,children:["idle"!==i||j?(0,s.jsx)(C.y,{size:16}):(0,s.jsx)(n,{className:"size-4 p-0.5"}),(0,s.jsx)("span",{className:"px-1 text-sm",children:p("idle"!==i||j?"deploying":"deploy")})]})})})})}let eb=["READY","CANCELED","ERROR"],ey=["QUEUED","BUILDING","INITIALIZING","NOTREADY"];function ew(e){var t,a,r,n;let{activeBlock:l,deployment:o,variant:c="default",deployState:p,deployWarning:f,handleByPassDeployWarning:v}=e,N=(0,d.k)("deployBlockPopover"),{setUpgradePromptOpen:k}=(0,er.g)(),{activeScope:C,activeScopeSlug:S,user:I}=(0,j.k6)(),{planSlug:M}=(0,U.N)(!0,null==C?void 0:C.id),{project:P}=(0,w.tZ)(),R=(0,u.useRef)(null),[T,F]=(0,u.useTransition)(),[O,V]=(0,u.useTransition)(),{customAlias:H,inspectorUrl:$}=function(e){let t=async e=>{let t=await fetch(e);return t.ok?await t.json():Error("Failed to fetch deployment status")},{data:a,error:s,isLoading:r,mutate:n}=(0,x.Ay)(e?"/chat/api/chat/deployment-status?id=".concat(e):null,t,{refreshInterval:5e3,revalidateOnFocus:!0,revalidateOnMount:!0,suspense:!0}),l=a&&a instanceof Error,i=!a||l||s?void 0:a.inspectorUrl;return{readyState:l?"ERROR":null==a?void 0:a.readyState,url:null==a?void 0:a.url,isLoading:r,isError:l||s,inspectorUrl:i,revalidate:n,customAlias:null==a?void 0:a.customAlias}}(null==o?void 0:o.deploymentId),{gs:W}=(0,E.D)(),Y=g(null==o?void 0:o.deploymentId,null==l?void 0:l.id,(null==l?void 0:null===(t=l.latestDeploymentInfo)||void 0===t?void 0:t.readyState)==="READY"||(null==l?void 0:null===(a=l.latestDeploymentInfo)||void 0===a?void 0:a.readyState)==="ERROR"),Q=(0,u.useMemo)(()=>ey.includes(Y.readyState||""),[Y.readyState]),J=null!==(n=null==H?void 0:H.alias)&&void 0!==n?n:null==o?void 0:o.aliasUrl,X=Y.readyState||(null==o?void 0:o.readyState),ee=(null==o?void 0:o.deploymentId)||Y.id,et=eb.includes(X||""),el=(null==H?void 0:H.alias)!==void 0,{submit:ei}=(0,eg.yI)(),eo=null==l?void 0:null===(r=l.latestDeploymentInfo)||void 0===r?void 0:r.readyState,{data:ec}=function(e){let{data:t,error:a,isLoading:s,mutate:r}=(0,Z.A)(e?"/chat/api/chat/deployment-build-errors?id=".concat(e):null,G,{suspense:!0});return{data:t,error:t&&t instanceof Error||a,isLoading:s,mutate:r}}("ERROR"===eo?null==o?void 0:o.deploymentId:void 0),ed=(0,m.y6)(),{setBlockDeployed:eu}=(0,z.G)(),{updateBlockData:em}=(0,h.P6)({blockId:null==l?void 0:l.id}),[eh,ep]=(0,u.useState)(null),[ex,ev]=(0,u.useState)("deployment-info"),ej="v0-level0"===M&&!(null==I?void 0:I.isV0Admin)&&!(null==I?void 0:I.isVercelian)&&!(null==I?void 0:I.hasPremiumOverride),ew=(0,u.useCallback)(()=>{if(Q){y.oR.error("Deployment already in progress");return}F(async()=>{if(l)try{let e=l.id,t=await fetch("/chat/api/git/push?scope=".concat(S),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blockId:e})}),a=await t.json();if("error"in a)throw Error(a.error);if(t.ok&&a.deployment){let e=a.deployment;ed({...l,latestDeploymentInfo:{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}}),eu(l.id,{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}),em({blockId:l.id,data:{latestDeploymentInfo:{aliasUrl:e.url,deploymentId:e.id,readyState:e.readyState}}})}else throw console.error(a),Error("Failed to deploy block to Vercel")}catch(e){console.error("Error pushing to repo:",e),(0,b.z)(e,void 0,"Failed to push")||y.oR.error("Failed to push")}})},[l,S,Q,ed,eu,em]),ez=(0,u.useCallback)(()=>{if(Q){y.oR.error("Deployment already in progress");return}F(async()=>{if(l)try{let e=await fetch("/chat/b/".concat(l.id,"/deploy?scope=").concat(S),{method:"POST"}),t=await e.json();if("error"in t)throw Error(t.error);if(e.ok)ed({...l,latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}),eu(l.id,{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}),em({blockId:l.id,data:{latestDeploymentInfo:{aliasUrl:t.url,deploymentId:t.id,readyState:t.readyState}}});else throw console.error(t),Error("Failed to deploy block to Vercel")}catch(e){(0,b.z)(e,void 0,"Failed to redeploy block to Vercel")||y.oR.error("Failed to redeploy block to Vercel. You may lack permissions to create new Vercel projects.")}})},[l,S,Q,ed,eu,em]),eR=W?ew:ez,eD=(0,u.useCallback)(()=>{V(async()=>{if(l&&o)try{if((await fetch("/chat/api/chat/deployment",{method:"DELETE",body:JSON.stringify({deploymentId:o.deploymentId,blockId:l.id})})).ok)y.oR.success("Deployment successfully deleted"),ed({...l,latestDeploymentInfo:void 0}),eu(l.id,void 0),em({blockId:l.id,data:{latestDeploymentInfo:void 0}});else throw Error("Failed to delete deployment")}catch(e){(0,b.z)(e,void 0,"Failed to delete deployment")||y.oR.error("Failed to delete deployment")}})},[l,o,ed,eu,em]),eA=(0,u.useMemo)(()=>{if("custom-domain"===ex)return null;let e="ERROR"===eo||"ERROR"===X,t=P&&P.vercelProjectId,a=(null==ec?void 0:ec.formattedError)||(null==ec?void 0:ec.fullErrorText);return f&&"idle"===p?(0,s.jsx)(eS,{variant:c,onFix:()=>{l&&(0,K.u)("FixDeployWarning",{blockId:l.id,warning:f.warning}),ei({action:"fix-with-v0",type:"fix-with-v0",input:"An error occurred during deployment. Please fix:\n\n```\n".concat(f.prompt,"\n```")})},onContinue:v}):"collectDeployWarnings"===p?(0,s.jsx)(D.Q,{className:"w-full",pending:!0,children:"Scanning Files"}):"creating-project"===p?(0,s.jsx)(D.Q,{className:"w-full",pending:!0,children:"Creating Project"}):e&&t?(0,s.jsx)(eI,{variant:c,showFixWithV0:!!a,disabled:!P.vercelProjectId||T||Q||!J,onFix:()=>ei({action:"fix-with-v0",type:"fix-with-v0",input:"An error occurred during deployment. Please fix:\n\n```\n".concat(a,"\n```")}),onRetry:eR,isRetrying:T}):!e&&t&&et&&J?(0,s.jsx)(eM,{variant:c,deploymentUrl:J,inspectorUrl:$,aliasComplete:el,onRedeploy:eR,isRedeploying:T,isDeploying:Q,onUnpublish:eD,isUnpublishing:O}):(0,s.jsx)(A,{activeBlock:l,variant:"card"===c?"secondary":"default",blockId:null==l?void 0:l.id,source:null==l?void 0:l.source,lang:null==l?void 0:l.language,deploymentStatus:Y,deployment:o,isActivelyDeploying:Q,startedDeployment:"deploying"===p})},[ex,eo,X,P,null==ec?void 0:ec.formattedError,null==ec?void 0:ec.fullErrorText,f,p,et,J,l,c,Y,o,Q,v,ei,T,eR,$,el,eD,O]),eT=(0,u.useMemo)(()=>{if("card"===c)return null;let e=null==l?void 0:l.id,t=et&&!Q&&!T;return e&&o?(0,s.jsxs)("div",{className:(0,i.cn)("flex flex-col gap-2"),children:[(0,s.jsx)("h4",{className:"text-[13px] font-medium text-gray-500",children:N("settings")}),(0,s.jsx)(es.Tooltip,{content:ej?"Upgrade to set custom domains":t?null:"Configure custom domains after deployment completes",children:(0,s.jsxs)("button",{className:(0,i.cn)("inline-flex items-center justify-between gap-4 pl-1.5 text-sm",!t&&"cursor-not-allowed opacity-50"),onClick:()=>{ej?k(!0):t&&ev("custom-domain")},children:[(0,s.jsxs)("span",{className:"inline-flex flex-1 items-center gap-2 text-start",children:[(0,s.jsx)(B.q,{}),N("customDomain.setCustomDomain")]}),(0,s.jsxs)("span",{className:"inline-flex items-center font-medium",children:[N("configure"),(0,s.jsx)(_.b,{})]})]})})]}):null},[null==l?void 0:l.id,o,et,Q,T,k,N,ej,c]),eF=(0,u.useMemo)(()=>{let e="ERROR"===eo||"ERROR"===X,t=P&&P.vercelProjectId;return e&&t?(0,s.jsx)(eC,{inspectorUrl:$,variant:c}):J&&X&&ee?(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[et?el?(0,s.jsx)(eE,{href:(0,i.ik)(H.alias),label:(0,i.ik)(H.alias),disabled:!1,ref:R}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(L.E,{className:"h-5 w-64"}),(0,s.jsx)(q.m,{})]}):(0,s.jsx)(ef,{deploymentId:ee}),(0,s.jsx)(eL,{readyState:X,deploymentId:ee,inspectorUrl:$?(0,i.ik)($):void 0})]}),eT]}):null},[eo,X,P,J,ee,et,el,null==H?void 0:H.alias,$,eT,c]),eO=(0,s.jsx)(ek,{variant:c});return f?eO=(0,s.jsx)(eN,{deployWarning:f,variant:c}):eF&&(eO=eF),(0,s.jsxs)(s.Fragment,{children:["deployment-info"===ex&&("card"===c?o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en.Wu,{className:"p-3",children:eF}),(0,s.jsx)(en.wL,{className:"p-2 pt-0",children:(0,s.jsx)(u.Suspense,{fallback:(0,s.jsx)(L.E,{className:"h-8 w-full"}),children:eA})})]}):(0,s.jsx)(ek,{variant:c}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex w-full flex-col gap-4 p-4",children:eO}),(0,s.jsx)("div",{className:"border-alpha-400 bg-muted border-t p-3",children:(0,s.jsx)(u.Suspense,{fallback:(0,s.jsx)(L.E,{className:"h-8 w-full"}),children:eA})})]})),"custom-domain"===ex&&o&&(null==P?void 0:P.vercelProjectId)?(0,s.jsx)(eP,{goBack:()=>{ev("deployment-info"),ep(null)},title:N("customDomain.setCustomDomain"),children:(0,s.jsx)(ea,{deploymentId:o.deploymentId,revalidateDeploymentStatus:Y.revalidate,activeBlock:l,editedAlias:eh||"",setEditedAlias:ep,vercelProjectId:P.vercelProjectId,goBack:()=>{ev("deployment-info"),ep(null)}})}):null]})}function eN(e){let{deployWarning:t,variant:a}=e;return(0,s.jsxs)("div",{className:"bg-muted flex flex-col items-center gap-2 rounded-md p-4 text-center text-sm",children:[(0,s.jsx)("div",{className:(0,i.cn)("rounded-full border border-amber-200 bg-red-50 p-2 text-amber-600"),children:(0,s.jsx)(I.N,{})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h3",{className:(0,i.cn)("m-0 py-2 text-sm font-medium text-gray-900"),children:t.isSecurityRisk?"Security Risk Found":"Warning"}),(0,s.jsx)("p",{className:(0,i.cn)("max-w-96 text-gray-500","card"===a&&"mb-0"),children:t.warning})]})]})}function ek(e){let{variant:t}=e,a=(0,d.k)("deployBlockPopover");switch(t){case"default":return(0,s.jsxs)("div",{className:"bg-muted flex h-[107.5px] flex-col items-center justify-center rounded-md py-4 text-center text-sm",children:[(0,s.jsx)("h3",{className:"mb-2 font-medium text-gray-900",children:a("deployToVercel")}),(0,s.jsx)("p",{className:"max-w-96 text-gray-500",children:a("deployToVercelDescription")})]});case"card":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en.aR,{className:"mb-1 p-3 pb-0 font-medium",children:a("deployToVercel")}),(0,s.jsx)(en.Wu,{className:"p-3 pt-0 text-gray-500",children:a("deployToVercelDescription")})]})}}function eC(e){let{inspectorUrl:t,variant:a="default"}=e,r=(0,d.k)("deployBlockPopover");return(0,s.jsxs)("div",{className:"bg-muted animate-in fade-in flex flex-col items-center gap-2 rounded-md p-4 text-center text-sm",children:[(0,s.jsx)("div",{className:(0,i.cn)("rounded-full border border-red-200 bg-red-50 p-2 text-red-600"),children:(0,s.jsx)(W.$,{})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h3",{className:(0,i.cn)("m-0 py-2 text-sm font-medium text-gray-900"),children:r("deploymentFailed")}),(0,s.jsx)("p",{className:(0,i.cn)("max-w-96 text-gray-500","card"===a&&"mb-0"),children:r("deploymentFailedDescription",t)})]})]})}function eS(e){let{onFix:t,onContinue:a,variant:r}=e;return(0,s.jsxs)("div",{className:(0,i.cn)("flex w-full items-center justify-end gap-2","card"===r&&"flex-col"),children:[(0,s.jsxs)(l.$,{className:(0,i.cn)("card"===r&&"w-full"),onClick:t,size:"sm",type:"button",children:["Fix with ",(0,s.jsx)(H.o,{className:"-ml-1 mt-[1px]"})]}),(0,s.jsx)(l.$,{className:(0,i.cn)("card"===r&&"w-full"),onClick:a,size:"sm",type:"button",variant:"secondary",children:"Continue"})]})}function eI(e){let{disabled:t,onFix:a,onRetry:r,isRetrying:n,showFixWithV0:o,variant:c}=e,u=(0,d.k)("deployBlockPopover");return(0,s.jsxs)("div",{className:(0,i.cn)("flex w-full items-center justify-end gap-2","card"===c&&"flex-col"),children:[o&&(0,s.jsxs)(l.$,{className:(0,i.cn)("card"===c&&"w-full"),disabled:t,onClick:a,size:"sm",type:"button",children:["Fix with ",(0,s.jsx)(H.o,{className:"-ml-1 mt-[1px]"})]}),(0,s.jsx)(l.$,{disabled:t,className:(0,i.cn)("card"===c&&"w-full"),onClick:r,size:"sm",type:"button",variant:"secondary",children:n?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(C.y,{size:16})," ",u("redeploying")]}):u("tryAgain")})]})}function eM(e){let{variant:t,deploymentUrl:a="default",inspectorUrl:r,aliasComplete:n,onRedeploy:o,isRedeploying:c,isDeploying:u,onUnpublish:m,isUnpublishing:h}=e,p=(0,d.k)("deployBlockPopover");return"card"===t?(0,s.jsx)(l.$,{className:"w-full bg-gray-100 hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200 disabled:bg-gray-100",disabled:!r,variant:"ghost",size:"sm",asChild:!0,children:r?(0,s.jsx)(S.N,{target:"_blank",href:(0,i.ik)(r),children:"View on Vercel"}):"View on Vercel"}):(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,s.jsx)(l.$,{disabled:!a||h||u,onClick:m,size:"sm",type:"button",variant:"ghost",children:h?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(C.y,{className:"size-2"})," ",p("deleting")]}):p("delete")}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.$,{size:"sm",onClick:o,disabled:c||h,variant:"secondary",children:c&&!h?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(C.y,{size:16})," ",p("redeploying")]}):p("update")}),(0,s.jsx)(l.$,{asChild:!0,size:"sm",disabled:!a||u||!n,children:(0,s.jsx)(S.N,{href:(0,i.ik)(a),external:!0,children:p("visitSite")})})]})]})}let ez={QUEUED:{primaryColor:"text-gray-500",secondaryColor:"bg-gray-100",label:"Queued"},BUILDING:{primaryColor:"text-amber-600",secondaryColor:"bg-amber-100",label:"Building"},ERROR:{primaryColor:"text-red-600",secondaryColor:"bg-red-100",label:"Error"},INITIALIZING:{primaryColor:"text-amber-600",secondaryColor:"bg-amber-100",label:"Initializing"},READY:{primaryColor:"text-green-600",secondaryColor:"bg-green-100",label:"Ready"},CANCELED:{primaryColor:"text-red-600",secondaryColor:"bg-red-100",label:"Canceled"},NOTREADY:{primaryColor:"text-gray-500",secondaryColor:"bg-gray-100",label:"Not Ready"}};function eL(e){let{readyState:t,deploymentId:a,inspectorUrl:r}=e,{primaryColor:n,secondaryColor:l,label:o}=ez[t];return(0,s.jsxs)("span",{className:(0,i.cn)(n,"inline-flex items-center gap-2 text-sm"),children:[(0,s.jsx)($.S,{className:(0,i.cn)(l,"rounded-full")}),(0,s.jsx)("span",{className:"font-medium text-gray-900",children:o}),r?(0,s.jsx)("a",{className:"text-[13px] text-gray-600",href:r,target:"_blank",children:a.slice(0,8)}):(0,s.jsx)("span",{className:"text-[13px] text-gray-600 ",children:a.slice(0,8)})]})}function eP(e){let{goBack:t,children:a,title:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)(l.$,{className:"border-alpha-400 hover:border-b-alpha-400 flex h-[52px] w-full justify-start gap-2 rounded-none border-x-0 border-b border-t-0 p-4 text-sm font-medium hover:border-b hover:bg-transparent",variant:"ghost",onClick:t,children:[(0,s.jsx)(V.n,{className:"ml-1 size-5"}),(0,s.jsx)("h1",{children:r})]}),a]})}function eR(){return(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-3",children:[(0,s.jsx)(L.E,{className:"h-[124.5px]"}),(0,s.jsx)("div",{className:"",children:(0,s.jsx)(L.E,{className:"h-8 w-full"})})]})}function eD(){let e=(0,d.k)("deployBlockPopover");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex w-full flex-col gap-4 p-4",children:(0,s.jsx)(ek,{variant:"default"})}),(0,s.jsx)("div",{className:"border-alpha-400 bg-muted border-t p-3",children:(0,s.jsx)(D.Q,{className:"w-full",variant:"secondary",pending:!0,children:e("initiatingDeployment")})})]})}function eE(e){let{href:t,label:a,ref:r,disabled:n}=e;return(0,s.jsxs)(S.N,{className:(0,i.cn)("flex items-center text-sm text-gray-900 hover:underline",n&&"cursor-default text-gray-500"),href:t,ref:r,disabled:n,target:"_blank",children:[a,!n&&(0,s.jsx)(q.m,{})]})}},26569:(e,t,a)=>{"use strict";a.d(t,{H:()=>p,I:()=>x});var s=a(7336),r=a(18730),n=a(80644),l=a(81616),i=a(53616),o=a(367),c=a(85168),d=a(19895),u=a(4495),m=a(23638),h=a(35339);function p(e){let t=(0,n.useRef)(["",null]);return(0,n.useMemo)(()=>{let[a,s]=t.current,r=e.reduce((e,t)=>e+"@"+t.id,"");if(a===r)return s;let n=(0,c.RA)(e);return t.current=[r,n],n},[e])}let x=(0,n.memo)(function(e){let{forkKeyOptions:t,message:a,className:p}=e,{messages:x}=(0,r.Pk)(),g=(0,r.jo)(),f=(t||[]).findIndex(e=>e&&e.some(e=>e===a.id)),v=(0,d.z6)(),{forkKeyCache:j}=(0,m.f)(),b=(0,h.F)(x),y=(0,n.useCallback)(e=>{let s=t[e];if(!s)return;let r=(0,c.K1)(s),n=r?j[r]:void 0;if(n){let e=new Set(b.current.map(e=>e.id)),t=!0;for(let a of n)e.has(a)||(t=!1);t&&(s=n)}let l=(0,c.C1)([...b.current],s);v(a.id,l),g({activeForkKey:l})},[t,g,j,v,a,b]);return!t||t.length<2?null:(0,s.jsxs)("div",{className:(0,u.cn)("flex items-center gap-0.5 text-sm font-medium",p),children:[(0,s.jsx)(l.$,{"aria-label":"Previous message version",className:"disabled:bg-background size-6 rounded-md disabled:border-none",disabled:0===f,onClick:()=>y(f-1),size:"xs",variant:"ghost",children:(0,s.jsx)(o.M,{})}),(0,s.jsxs)("span",{className:"whitespace-nowrap",children:[f+1," / ",t.length]}),(0,s.jsx)(l.$,{"aria-label":"Next message version",className:"disabled:bg-background size-6 rounded-md disabled:border-none",disabled:f===t.length-1,onClick:()=>y(f+1),size:"xs",variant:"ghost",children:(0,s.jsx)(i.b,{})})]})})},27021:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>m,Es:()=>p,L3:()=>x,c7:()=>h,lG:()=>o,rr:()=>g,zM:()=>c});var s=a(7336),r=a(80644),n=a(54924),l=a(39717),i=a(9097);let o=n.bL,c=n.l9,d=n.ZL;n.bm,d.displayName=n.ZL.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-gray-950/95 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),ref:t,...r})});u.displayName=n.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:a,dialogOverlayClassName:o,children:c,style:m,showClose:h=!0,...p}=e,[x,g]=r.useState(0),f=r.useRef(null);return r.useEffect(()=>{f.current=document.body,g(e=>e+1)},[]),(0,s.jsxs)(d,{container:f.current,children:[(0,s.jsx)(u,{className:o}),(0,s.jsxs)(n.UC,{className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 rounded-[12px] bg-white px-6 py-8 outline-none duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] lg:w-full",a),ref:t,style:{boxShadow:"var(--ds-shadow-modal)",...m},...p,children:[c,h?(0,s.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.MKb,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}):null]})]})});m.displayName=n.UC.displayName;let h=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col items-center space-y-2 text-center",t),...a})};h.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hE,{className:(0,i.cn)("whitespace-nowrap text-2xl font-semibold tracking-tight",a),ref:t,...r})});x.displayName=n.hE.displayName;let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{className:(0,i.cn)("text-zinc-600",a),ref:t,...r})});g.displayName=n.VY.displayName},28089:(e,t,a)=>{"use strict";a.d(t,{_:()=>u,default:()=>m});var s=a(7336),r=a(38559),n=a(81616),l=a(26939),i=a(80644),o=a(15993),c=a(23204),d=a(59103);function u(){let{data:e,mutate:t}=(0,d.Ay)("teamRequestAccessDialog",null,{fallbackData:null});return{teamRequestAccessDialog:e,setTeamRequestAccessDialog:t}}function m(){let{teamRequestAccessDialog:e,setTeamRequestAccessDialog:t}=u(),{user:a}=(0,l.J)(),{refreshScopes:d}=(0,c.b)(),[m,h]=(0,i.useTransition)(),p=(0,i.useCallback)(()=>{m||h(async()=>{if(e){if(!(await fetch("/chat/api/team/request-access/".concat(e.slug),{method:"POST"})).ok){o.oR.error("Failed to request access");return}o.oR.success("Access requested"),t(null),d()}})},[m,d,t,e]);return e&&a?(0,s.jsxs)(r.Modal,{onOpenChange:()=>t(null),open:!!e,children:[(0,s.jsxs)(r.ModalHeader,{children:[(0,s.jsx)(r.ModalTitle,{children:"Request Access"}),(0,s.jsxs)(r.ModalDescription,{children:["Your account"," ",(0,s.jsx)("b",{className:"font-medium",children:a.name||a.username})," does not have permission to use v0 in"," ",(0,s.jsx)("b",{className:"font-medium",children:e.name||e.slug})," ","Team. Request access, or switch to a different Team."]})]}),(0,s.jsxs)(r.ModalFooter,{children:[(0,s.jsx)(r.ModalClose,{asChild:!0,children:(0,s.jsx)(n.$,{size:"sm",variant:"secondary",children:"Cancel"})}),(0,s.jsx)(n.$,{disabled:m,onClick:p,size:"sm",children:"Request Access"})]})]}):null}},28148:e=>{e.exports={circle:"gauge_circle__8qHPe",content:"gauge_content__Ha_5u",animate:"gauge_animate__l7E7z",arc:"gauge_arc__vkhZw",arcSecondary:"gauge_arcSecondary__KCzRC",fadeIn:"gauge_fadeIn__gi7G_"}},28730:(e,t,a)=>{"use strict";a.d(t,{i:()=>r});var s=a(30009);let r=(0,s.createServerReference)("404aa13e7456c5f5d1ea6cab1cd7b490467ee90a29",s.callServer,void 0,s.findSourceMapURL,"collectBlockDeployWarnings")},29050:(e,t,a)=>{"use strict";a.d(t,{p:()=>r});var s=a(30009);let r=(0,s.createServerReference)("408c4e84c5477435e244d8ff320c9340f4c4f540fe",s.callServer,void 0,s.findSourceMapURL,"sendMessageFeedback")},29381:(e,t,a)=>{"use strict";a.d(t,{e:()=>c});var s=a(93774),r=a(7363),n=a(59103),l=a(10299),i=a(57748),o=a(35478);function c(){let{data:e,mutate:t}=(0,n.Ay)("sidebar-sheet-open",{fallbackData:!1}),{showDeleteDialogForChatId:a}=(0,s.v)(),{showShareDialog:c}=(0,r.B)(),d=(0,l.usePathname)(),u=(0,o.x)(),{isEmpty:m}=(0,i.tZ)();return{sheetOpen:e,setSheetOpen:t,hidden:!!(!m||u&&d.includes(u)),actionChatId:a||("object"==typeof c?c.chatId:null)}}},31342:(e,t,a)=>{"use strict";a.d(t,{Cj:()=>M,pj:()=>P,pw:()=>L});var s=a(7336),r=a(87608),n=a(81616),l=a(67437),i=a(4495),o=a(97210),c=a(27021),d=a(85328),u=a(77936),m=a(43080),h=a(3816),p=a(55509),x=a(477),g=a(43707),f=a(96378),v=a(80644),j=a(26939),b=a(53155),y=a(66544),w=a(11192),N=a(58978),k=a(46902);let C=(0,w.default)(()=>Promise.all([a.e(9299),a.e(9713),a.e(3036)]).then(a.bind(a,33036)).then(e=>e.Table),{loadableGenerated:{webpack:()=>[33036]}});function S(e){var t,a;return(null===(t=e.contentType)||void 0===t?void 0:t.startsWith("video/"))&&!(null===(a=e.name)||void 0===a?void 0:a.endsWith(".ts"))}function I(e){var t;return null===(t=e.contentType)||void 0===t?void 0:t.startsWith("audio/")}function M(e){let{attachments:t,className:a}=e,r=(0,v.useRef)(null);return(null==t?void 0:t.length)?(0,s.jsx)("div",{className:(0,i.cn)("flex w-full items-center gap-2 overflow-x-auto",a),ref:r,children:t.map(e=>(0,s.jsx)(L,{attachment:e},e.url))}):null}function z(e){var t;let{attachment:a}=e,r=null===(t=a.contentType)||void 0===t?void 0:t.startsWith("image/"),n=S(a),l=I(a);return r?(0,s.jsx)(g._,{}):n?(0,s.jsx)(x.C,{}):l?(0,s.jsx)(p.M,{}):"text/csv"===a.contentType?(0,s.jsx)(m.i,{}):(0,s.jsx)(u.Z,{})}function L(e){var t,a;let{className:r,attachment:c,...u}=e,m=null===(t=c.contentType)||void 0===t?void 0:t.startsWith("image/"),p=S(c),[x,g]=(0,v.useState)(800*!!p),[y,w]=(0,v.useState)(600*!!p),[N,k]=(0,v.useState)(!1),[C,I]=(0,v.useState)(null),{content:M,isLoading:L}=(0,l.k)(C),{user:R}=(0,j.J)(),{setShowSignInDialog:D}=(0,b.AO)(),A=(0,d.al)(),T=E(c),F=c.name?(0,i.QY)(c.name,50):"",O=c.name?(0,i.QY)(c.name,20):"";"figma"===c.v0Type&&(O=O.split(".png")[0]),(0,v.useEffect)(()=>{M&&(0,v.startTransition)(()=>{k(!0)})},[M]);let U=(0,s.jsx)(z,{attachment:c});!m&&L?U=(0,s.jsx)(o.y,{}):m&&(U=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.default,{alt:null!==(a=c.name)&&void 0!==a?a:"Image Preview",className:(0,i.cn)("border-alpha-400 aspect-square rounded-sm border object-cover","figma"===c.v0Type?"invisible":""),fill:!0,onLoad:e=>{let t=e.target,a=t.naturalWidth/t.naturalHeight,s=.8*window.innerWidth,r=.8*window.innerHeight,n=r*a,l=r;a>1&&(n=s,l=s/a),g(n),w(l)},src:c.url}),"figma"===c.v0Type?(0,s.jsx)(h.Y,{}):null]}));let V=(0,s.jsxs)(n.$,{className:(0,i.cn)("h-14 w-full basis-[210px] gap-2 py-2 pl-2 pr-3 text-left ",T||m?"hover:bg-gray-200 focus:bg-gray-200 focus-visible:bg-gray-200":"hover:bg-background focus:bg-background focus-visible:bg-background cursor-default",r),onClick:e=>R?T||m?void(M||(e.preventDefault(),I(c.url))):(e.preventDefault(),!1):(e.preventDefault(),D({prompt:!1,customMessage:"A Vercel account is required to view attachments"}),!1),title:c.name,tooltip:A?void 0:F,variant:"secondary",...u,children:[(0,s.jsx)("div",{className:"flex size-10 shrink-0 -translate-x-px items-center justify-center overflow-hidden rounded-sm bg-gray-100 text-gray-500 transition-colors",children:U}),(0,s.jsxs)("div",{className:"grid flex-1 -translate-x-px gap-1 py-0.5 text-sm leading-none text-gray-900 ",children:[(0,s.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:O}),(0,s.jsx)("div",{className:"line-clamp-1 aspect-auto font-normal text-gray-500",children:c.size?(0,i.v7)(c.size):c.contentType})]})]});return(0,s.jsx)(P,{setOpen:k,attachment:c,open:N,triggerButton:V,width:x,height:y,content:M})}function P(e){var t;let{attachment:a,open:r,setOpen:n,triggerButton:l,width:o,height:d,content:u}=e,m=null===(t=a.contentType)||void 0===t?void 0:t.startsWith("image/"),h=S(a),p=I(a),x=E(a),g=(0,v.useRef)(null),f=a.name?(0,i.QY)(a.name,50):"";return"figma"===a.v0Type&&(f=f.replace(".png","")),(0,s.jsxs)(c.lG,{onOpenChange:e=>{if(n(e),e){var t;null===(t=g.current)||void 0===t||t.focus()}},open:r,children:[l?(0,s.jsx)(c.zM,{asChild:!0,children:l}):null,(0,s.jsxs)(c.Cf,{className:(0,i.cn)("w-full max-w-[90vw] auto-rows-min gap-2 rounded-xl p-0 lg:max-w-4xl [&>button:last-child]:invisible",(m||h)&&"aspect-[--aspect-ratio] h-[--height] max-h-[80vh] w-[--width] max-w-[90vw] border-none bg-transparent lg:w-auto",p&&"w-full bg-transparent lg:max-w-4xl",!m&&!h&&!p&&"w-full"),style:{"--width":"".concat(o,"px"),"--height":"".concat(d,"px"),"--aspect-ratio":"".concat(o/d)},children:[(0,s.jsx)(c.L3,{className:"sr-only",children:a.name}),(0,s.jsx)(c.rr,{className:"sr-only",children:a.name}),(0,s.jsx)("button",{className:"absolute -left-full",ref:g}),(0,s.jsx)(v.Suspense,{children:m||h||p?(0,s.jsx)(D,{attachment:a,caption:f,height:d,width:o,isVideo:h,isAudio:p}):u&&r&&x&&(0,s.jsx)(R,{attachment:a,content:u,onClose:()=>n(!1)})})]})]},a.url)}function R(e){let{attachment:t,onClose:a,content:n}=e;switch(t.contentType){case"application/zip":return(0,s.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"flex items-center justify-between p-4 pb-0 text-sm font-medium text-gray-600",children:(0,s.jsx)("span",{children:t.name})}),(0,s.jsx)("div",{className:"flex gap-2 p-4 text-gray-500",children:"v0 does not support previewing ZIP files at this time."})]});case"text/csv":return(0,s.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 pb-0 text-sm font-medium text-gray-600",children:[(0,s.jsx)("span",{children:t.name}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(N.C,{allowClose:!0,allowCopyCode:!0,allowDownloadCode:!0,caller:"inline",closeHandler:a,fileName:t.name,value:n,isTabbed:!1,closed:!1,originalCode:void 0,blockId:"attachment-preview-".concat(t.name)})})]}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(C,{source:n})})]});default:var l,i;let o=(0,y.SR)((null===(l=t.name)||void 0===l?void 0:l.split(".").pop())||(null===(i=t.contentType)||void 0===i?void 0:i.split("/")[1])||"plaintext");return(0,s.jsxs)("div",{className:"relative max-h-[80vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"absolute left-10 top-0 z-10 flex h-14 items-center text-sm font-medium text-gray-600",children:t.name}),(0,s.jsx)(r.N,{allowClose:!0,caller:"inline",className:"rounded-xl border-none [&>div:last-child]:!pt-0 [&_code]:!whitespace-pre",closeHandler:a,showQuickEditAnimation:!1,fileName:t.name,headerClassName:"h-14 border-none px-4 bg-background/70",language:o,showLineNumbers:!0,value:n,wrapLongLines:!0,originalCode:void 0,blockId:"attachment-preview-".concat(t.name),closed:!0})]})}}function D(e){var t;let{attachment:a,width:r,height:n,caption:l,isVideo:i,isAudio:o}=e;return(0,s.jsxs)(s.Fragment,{children:[i?(0,s.jsxs)("video",{className:"bg-alpha-950 rounded-lg object-contain",controls:!0,children:[(0,s.jsx)("source",{src:a.url,type:a.contentType}),"Your browser does not support the video tag."]}):o?(0,s.jsxs)("audio",{className:"rounded-lg object-contain",controls:!0,children:[(0,s.jsx)("source",{src:a.url,type:a.contentType}),"Your browser does not support the audio tag."]}):(0,s.jsx)(f.default,{alt:null!==(t=a.name)&&void 0!==t?t:"Image Preview",className:"bg-alpha-950 rounded-lg object-contain",height:n,src:a.url,width:r}),(0,s.jsx)("div",{className:"line-clamp-1 max-w-3xl text-sm text-gray-500",children:l})]})}let E=e=>{var t,a;let s=new Set(["pdf","doc","docx","xls","xlsx"]),r=(null===(t=e.contentType)||void 0===t?void 0:t.split("/")[1])||"none",n=(null===(a=e.name)||void 0===a?void 0:a.split(".").pop())||"none";return k.lg.includes(n)&&(r="plain"),!s.has(r)}},31508:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var s=a(80644),r=a(23204),n=a(78566),l=a(43665);function i(){let{user:e}=(0,n.Y)(),{scopes:t}=(0,r.b)(),a=(0,s.useMemo)(()=>t?t.filter(e=>!(0,l.W)(e)):[],[t]);return(0,s.useMemo)(()=>{var t;return null===(t=a.find(t=>t.id===(null==e?void 0:e.defaultTeamId)))||void 0===t?void 0:t.slug},[a,e])}},32921:(e,t,a)=>{"use strict";a.d(t,{b:()=>ee,n:()=>et});var s=a(7336),r=a(23124),n=a(13658),l=a(52246),i=a(67023),o=a(55850),c=a(90836),d=a(50841),u=a(4702),m=a(87736),h=a(57268),p=a(6241),x=a(93171),g=a(3814),f=a(24581),v=a(88365),j=a(91657),b=a(39498),y=a(93097),w=a(54961),N=a(14184),k=a(36430),C=a(52705),S=a(35059),I=a(15131),M=a(87942),z=a(22360),L=a(11333),P=a(64674),R=a(80329),D=a(94521),E=a(6169),A=a(91137),T=a(31853),F=a(69941),O=a(21050),U=a(93709),V=a(41371),_=a(40966),B=a(82589),H=a(58435),$=a(87307),q=a(90304),W=a(92081),Z=a(24498),G=a(80255),K=a(58472),Y=a(7293),Q=a(94052),J=a(84527),X=a(32913);let ee={"icon-alarm-clock":r.A,"icon-apple":n.A,"icon-app-window-mac":l.A,"icon-atom":i.A,"icon-bar-chart":o.A,"icon-blocks":c.A,"icon-book-text":d.A,"icon-briefcase":u.A,"icon-bug":m.A,"icon-calendar":h.A,"icon-camera":p.A,"icon-code":x.A,"icon-fingerprint":g.A,"icon-flame":f.A,"icon-flask-conical":v.A,"icon-folder-closed":j.A,"icon-gamepad":b.A,"icon-github":y.A,"icon-gitlab":w.A,"icon-globe":N.A,"icon-heart":k.A,"icon-home":C.A,"icon-image":S.A,"icon-key-square":I.A,"icon-laptop":M.A,"icon-layers":z.A,"icon-lightbulb":L.A,"icon-link":P.A,"icon-lock":R.A,"icon-mail":D.A,"icon-message-square-text":E.A,"icon-palette":A.A,"icon-paint-roller":T.A,"icon-pie-chart":F.A,"icon-rocket":O.A,"icon-scroll-text":U.A,"icon-settings":V.A,"icon-shield-check":_.A,"icon-smartphone":B.A,"icon-siren":H.A,"icon-sprout":$.A,"icon-square-function":q.A,"icon-traffic-cone":W.A,"icon-trending-down":Z.A,"icon-trending-up":G.A,"icon-trophy":K.A,"icon-user":Y.A,"icon-wand-sparkles":Q.A,"icon-wrench":J.A,"icon-zap":X.A};function et(e){let{name:t}=e,a=ee[t];return(0,s.jsx)(a,{})}},33437:(e,t,a)=>{"use strict";a.d(t,{NewFeatureBanner:()=>c});var s=a(7336),r=a(20287),n=a(81616),l=a(80644),i=a(99876),o=a(22705);function c(){let[e,t]=(0,l.useState)(!0),{data:{lastClickedFeature:a,newFeatureInfo:c}}=(0,o.j)({},"getNewFeatureBanner"),d=(null==c?void 0:c.visible)&&a!==c.description,u=d?c.url:"",m=d?c.description:"",h=(0,l.useCallback)(()=>{m&&r.A.set("last-clicked-feature",m,{expires:30})},[m]);return e&&d?(0,s.jsxs)(i.SidebarFooter,{className:"relative w-full py-0",children:[(0,s.jsx)("div",{className:"from-muted pointer-events-none absolute inset-x-0 -top-4 z-10 h-4 w-full bg-gradient-to-t"}),(0,s.jsx)("a",{href:u,target:"_blank",rel:"noreferrer",onClick:()=>h(),className:"relative z-20 block h-fit w-full",children:(0,s.jsxs)("section",{className:"bg-background border-alpha-400 flex flex-col gap-1.5 rounded-lg border p-3 drop-shadow-sm transition-[transform,border] hover:-translate-y-0.5 hover:border-gray-300 hover:drop-shadow-md",children:[(0,s.jsxs)("span",{className:"flex items-center justify-between text-gray-500",children:[(0,s.jsx)("h5",{className:"text-[13px] font-medium",children:"New Feature"}),(0,s.jsx)("span",{className:"sr-only",children:"Learn more"}),(0,s.jsx)(n.$,{tooltip:"Close",size:"xs",className:"size-5 rounded-sm text-gray-500",variant:"ghost",onClick:e=>{e.preventDefault(),h(),t(!1)},children:(0,s.jsx)("span",{className:"text-lg",children:"\xd7"})})]}),(0,s.jsx)("p",{className:"text-sm",children:m})]})})]}):null}},33508:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var s=a(57748),r=a(18730),n=a(80644),l=a(15993),i=a(76073),o=a(88551),c=a(48473);function d(){let{project:e,setMetadata:t}=(0,s.tZ)(),{chatId:a}=(0,r.xz)(),{activeScope:d}=(0,i.k6)(),[u,m]=(0,n.useTransition)();return{reassignPending:u,handleReassignProject:(0,n.useCallback)(s=>{var r,n;if(!a||!d)return;let i=e?{...e}:void 0;t({project:s?{projectId:s.projectId,name:s.name,settings:{color:(null===(r=s.settings)||void 0===r?void 0:r.color)||null,icon:(null===(n=s.settings)||void 0===n?void 0:n.icon)||null},vercelProjectId:s.vercelProjectId,isCreator:s.creatorId===d.id}:void 0}),m(async()=>{try{let e=await (0,c.M)({payload:{chatId:a,projectId:(null==s?void 0:s.projectId)||null}});if(null==e?void 0:e.error)throw Error(e.error)}catch(e){(0,o.z)(e)||l.oR.error("Something went wrong. Please try again."),t({project:i})}})},[a,t,e,d])}}},34210:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});let s=e=>"user"===e.role?e.id:e.continuingMessageId||e.id},34444:(e,t,a)=>{"use strict";a.d(t,{Ok:()=>r,_I:()=>l,l:()=>n});var s=a(44900);let r=()=>(0,s.$C)(32),n=()=>(0,s.$C)(21),l=()=>(0,s.$C)(11)},34481:(e,t,a)=>{"use strict";a.d(t,{Q:()=>m,Z:()=>h});var s=a(7336),r=a(80644),n=a(81616),l=a(18730),i=a(25374),o=a(15993),c=a(97210),d=a(79193),u=a(88551);let m="v0-chat-export";function h(){let[e,t]=(0,r.useTransition)(),{chatId:a}=(0,l.xz)();return(0,s.jsx)(n.$,{disabled:e,onClick:()=>{t(async()=>{if(!a){o.oR.error("Chat ID not found.");return}try{let e=await (0,i.V)({payload:{chatId:a}});if("error"in e)throw Error(e.error);let t=new Blob([JSON.stringify(e.data)],{type:"application/json"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="".concat(m,"-").concat(a,"-").concat(new Date().toISOString(),".json"),r.click(),URL.revokeObjectURL(s)}catch(e){(0,u.z)(e)||o.oR.error("Something went wrong. Please try again.")}})},className:"size-7 rounded-md",size:"sm",tooltip:{side:"bottom",content:"Export Chat (AI Team only)"},variant:"ghost",children:e?(0,s.jsx)(c.y,{}):(0,s.jsx)(d.A,{})})}},35339:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});var s=a(80644);function r(e){let t=(0,s.useRef)(e);return(0,s.useEffect)(()=>{t.current=e},[e]),t}},35478:(e,t,a)=>{"use strict";a.d(t,{x:()=>o});var s=a(10299),r=a(20802);let n=["blocks","button","community","enterprise","explore","git","hackathon","home","history","id","internal","keys","pricing","projects","settings","upgrade"],l=/\/chat(?:\/v0pprvariant[^\/]*)?(?:\/v3)?\/?$/,i=/\/chat(?:\/v0pprvariant[^\/]*)?(?:\/v3)?\/([^\/]+)\/?$/;function o(){return function(e){var t;if(l.test(e))return;let a=null===(t=e.match(i))||void 0===t?void 0:t[1];if(a&&!n.includes(a))return(0,r.Kv)(a)}((0,s.usePathname)())}},35616:(e,t,a)=>{"use strict";a.d(t,{L:()=>s});let s=[{text:"Apps",value:"apps"},{text:"Games",value:"games"},{text:"Sites",value:"sites"},{text:"Components",value:"components"},{text:"Blocks",value:"blocks"}]},36024:(e,t,a)=>{"use strict";a.d(t,{E:()=>o,PortalProvider:()=>l,W:()=>i});var s=a(7336),r=a(80644);let n=(0,r.createContext)({containers:{},setContainers:()=>{}});function l(e){let{children:t}=e,[a,l]=(0,r.useState)({});return(0,s.jsx)(n.Provider,{value:{containers:a,setContainers:l},children:t})}function i(){return(0,r.useContext)(n)}function o(e){let t=(0,r.useRef)(null),{setContainers:a}=i();return(0,r.useEffect)(()=>(a(a=>({...a,[e]:t.current})),()=>{a(t=>{let{[e]:a,...s}=t;return s})}),[e,a]),t}},37328:(e,t,a)=>{"use strict";a.d(t,{Et:()=>c,d0:()=>o,jc:()=>i});var s=a(7336),r=a(80644),n=a(53349),l=a(9097);let i=n.bL,o=n.l9,c=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,...o}=e;return(0,s.jsx)(n.ZL,{children:(0,s.jsx)(n.UC,{align:r,className:(0,l.cn)("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),ref:t,sideOffset:i,...o})})});c.displayName=n.UC.displayName},37644:(e,t,a)=>{"use strict";a.d(t,{A:()=>m,W:()=>h});var s=a(7336),r=a(59103),n=a(81616),l=a(80644),i=a(67952),o=a(2829),c=a(63016),d=a(38559),u=a(3650);function m(){let{data:e,mutate:t}=(0,r.Ay)("showQuickProjectCreateDialog",null,{fallbackData:!1});return{showQuickProjectCreateDialog:e,setShowQuickProjectCreateDialog:t}}function h(e){let{description:t,chatId:a,onSuccess:r}=e,[h,p]=(0,l.useState)({}),[x,g]=(0,l.useState)(""),{showQuickProjectCreateDialog:f,setShowQuickProjectCreateDialog:v}=m(),[j,b]=(0,l.useState)(!1),y=(0,i.k)("quickProjectCreateDialog"),w=(0,l.useCallback)(async e=>{e.preventDefault(),p({}),b(!0);try{let e=await (0,u.g)({projectName:x,chatId:a,onSuccess:e=>{null==r||r(e),v(!1),g("")}});e.errors&&p(e.errors)}catch(e){console.error("Failed to create project:",e),p({name:["An unexpected error occurred. Please try again."]})}finally{b(!1)}},[x,a,r,v]);return(0,s.jsxs)(d.Modal,{onOpenChange:v,open:f,responsive:!1,children:[(0,s.jsxs)(d.ModalHeader,{children:[(0,s.jsx)(d.ModalTitle,{children:y("title")}),t&&(0,s.jsx)(d.ModalDescription,{children:t})]}),(0,s.jsx)(d.ModalContent,{children:(0,s.jsx)("form",{className:"flex flex-col gap-6",onSubmit:w,children:(0,s.jsx)(c.t,{name:x,onChange:e=>g(e.target.value),errors:h,placeholder:y("inputPlaceholder"),disabled:j})})}),(0,s.jsxs)(d.ModalFooter,{children:[(0,s.jsx)(d.ModalClose,{asChild:!0,children:(0,s.jsx)(n.$,{size:"sm",variant:"secondary",children:y("cancel")})}),(0,s.jsx)(n.$,{"data-testid":"confirm-delete-message",disabled:j,onClick:w,size:"sm",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.IconSpinner,{className:"size-4"}),y("creating")]}):y("create")})]})]})}},38597:(e,t,a)=>{"use strict";a.d(t,{W:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40ca37e4b0cb69f9f8ef101cfb619447b55cc7de6e",s.callServer,void 0,s.findSourceMapURL,"doSqlExecution")},38917:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});let s=a(39797).vt({});function r(e,t){let a=s.clone(e);if(Array.isArray(t)&&9===t[1]&&9===t[2]){let e=t[0].slice(0,-1),s=t[0].slice(-1),r=a;for(let t of e){if("string"==typeof r[t])return r[t]+=s,a;r=r[t]}}return s.patch(a,t),a}},39215:(e,t,a)=>{"use strict";a.d(t,{ErrorComponent:()=>i});var s=a(7336),r=a(2115),n=a(52014),l=a(80644);function i(e){let{error:t}=e;(0,l.useEffect)(()=>{(0,r.u)("ErrorBoundaryError",{message:t.message,stack:t.stack,digest:t.digest,cause:t.cause,name:t.name})},[t]);let a=t.message.includes("#482");return(0,s.jsx)("div",{className:"mx-auto flex h-full max-w-2xl items-center justify-center px-4 text-lg font-medium text-red-600 md:text-xl lg:text-2xl",children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 text-red-600",children:[(0,s.jsx)("div",{className:"border-border bg-background flex size-8 items-center justify-center rounded-sm border p-2",children:(0,s.jsx)(n.V,{})}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,s.jsxs)("h1",{className:"text-base font-medium",id:"error",children:["An Error Occurred"," "]}),t.message?(0,s.jsx)("h2",{className:"text-center text-sm font-normal text-gray-500",children:(0,s.jsx)("code",{className:"tracking-tight",children:t.message})}):null,a?(0,s.jsx)("h2",{className:"text-center text-sm font-normal text-gray-500",children:"This error is likely caused by a bug with your browser extensions. Please try disabling extensions and programs that modify the page."}):null]})]})})}},40295:(e,t,a)=>{"use strict";a.d(t,{TemplateEditButton:()=>D,TemplateEditDialog:()=>E,I:()=>R});var s=a(7336),r=a(80644),n=a(38559),l=a(81616),i=a(52220),o=a(15066),c=a(67952),d=a(59103),u=a(97237),m=a(98898),h=a(15993),p=a(30009);let x=(0,p.createServerReference)("402b7f5ad9f16a675869f8ab32fe030c18e0ae00ad",p.callServer,void 0,p.findSourceMapURL,"editTemplateAction"),g=(0,p.createServerReference)("402a80bb1aed50279f5fb230decf0223fb53d03bed",p.callServer,void 0,p.findSourceMapURL,"deleteTemplateAction");var f=a(20685),v=a(4304),j=a(10299),b=a(54851),y=a(4495),w=a(42843),N=a(19895),k=a(76989),C=a(30757),S=a(83748),I=a(77177),M=a(25357),z=a(90352),L=a(78088),P=a(35616);function R(){let{data:e,mutate:t}=(0,d.Ay)("templateEditDialogOpen",null,{fallbackData:!1});return{templateEditDialogOpen:e,setTemplateEditDialogOpen:t}}function D(){let{setTemplateEditDialogOpen:e}=R();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.$,{onClick:()=>e(!0),size:"sm",className:"size-7 rounded-md px-0 sm:hidden",tooltip:"Settings",variant:"secondary",children:(0,s.jsx)(M.H,{})}),(0,s.jsx)(l.$,{onClick:()=>e(!0),size:"sm",className:"hidden sm:block",tooltip:"Settings",variant:"secondary",children:(0,s.jsx)(M.H,{})})]})}function E(e){var t;let{templateCanonId:a,blockId:d,description:p,category:b,imageUrl:y,shouldReturnToCreatedDialog:M=!1,activeBlock:D,envVarKeys:E}=e,{templateEditDialogOpen:T,setTemplateEditDialogOpen:F}=R(),{setTemplateCreatedDialogOpen:O}=(0,w.qn)(),U=(0,c.k)("templateShareDialog"),[V,_]=r.useTransition(),{files:B,setFiles:H,setInitialFiles:$,uploading:q,removeFile:W,inputFileRef:Z,onInputChange:G}=(0,u.Lb)({initialImages:y?[{url:y,name:"Current Image"}]:[],disableDrag:!T}),[K,Y]=(0,r.useState)({description:p,category:b,envVarKeys:E}),Q=(0,j.useRouter)(),J=(0,N.y6)(),{setTemplateCreatedInfo:X}=(0,w._d)(),[ee,et]=(0,r.useState)(null===y);r.useEffect(()=>{T||setTimeout(()=>{et(null===y),$(y?[{url:y,name:"Current Image"}]:[]),Y({description:p,category:b,envVarKeys:E})},500)},[B,W,H,$,F,T,p,b,y,et,E]);let ea=(0,r.useCallback)(()=>{_(async()=>{var e,t,a;let s=await x({...K,blockId:d,imageUrl:null!==(t=null===(e=B[0])||void 0===e?void 0:e.url)&&void 0!==t?t:null});if(s.error){h.oR.error(s.error);return}Q.refresh(),h.oR.success("Update successful"),F(!1),M&&(await X({description:K.description,category:K.category,envVarKeys:K.envVarKeys,imageUrl:(null===(a=B[0])||void 0===a?void 0:a.url)||y||void 0}),setTimeout(()=>void O(!0),100))})},[B,Q,F,O,M,d,y,K,X]),es=r.useCallback(()=>{_(async()=>{let e=await g(d);if(e.error){h.oR.error(e.error);return}h.oR.success("Deleted successfully"),await F(!1),M?setTimeout(()=>{D&&J({...D,templateCanonId:void 0,templateVersionId:void 0})},500):Q.push("/chat/community")})},[Q,F,d,D,J,M]),er=(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(o.Label,{htmlFor:"description",className:"font-medium text-gray-900",children:U("modalDescriptionLabel")}),(0,s.jsx)(m.T,{asChild:!0,children:(0,s.jsx)(f.o,{maxHeight:192,minHeight:80,disabled:V,id:"description",maxLength:z.Kx,name:"description",placeholder:U("modalDescriptionPlaceholder"),spellCheck:!1,onChange:e=>Y(t=>({...t,description:e.target.value})),value:K.description||""})})]}),en=(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)(L.l6,{defaultValue:null!==(t=K.category)&&void 0!==t?t:void 0,disabled:V,onValueChange:e=>Y(t=>({...t,category:e})),required:!0,children:[(0,s.jsxs)(o.Label,{htmlFor:"category",className:"font-medium text-gray-900",children:[U("modalCategoryLabel"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(L.bq,{id:"category",children:(0,s.jsx)(L.yv,{placeholder:"Select a category"})}),(0,s.jsx)(L.gC,{children:P.L.map(e=>(0,s.jsx)(L.eb,{value:e.value,children:e.text},e.value))})]})}),el=(0,s.jsxs)("fieldset",{className:"flex flex-col items-start gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("legend",{className:"flex items-center gap-0.5 text-sm font-medium",children:U("modalImageLabel")}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:U("modalImageDescription")})]}),(0,s.jsx)("div",{className:"h-32 w-full",children:B.length||ee?(0,s.jsxs)("div",{className:"flex h-full w-[169px] flex-col gap-2",children:[(0,s.jsx)("div",{className:"bg-muted relative flex-1 overflow-hidden rounded-md border",children:ee?(0,s.jsx)("div",{className:"pointer-events-none aspect-video",children:(0,s.jsx)(I.TemplateImage,{templateCanonId:a,alt:"Template Preview",src:void 0})}):(0,s.jsx)("div",{className:"pointer-events-none aspect-video data-[status=uploading]:opacity-50","data-status":B[0].status,children:(0,s.jsx)(I.TemplateImage,{alt:B[0].file.name,src:B[0].url,templateCanonId:a})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm font-medium",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 contain-inline-size",children:(0,s.jsx)("div",{className:"line-clamp-1 w-full break-all",children:ee?(0,s.jsx)("span",{children:"Current Image"}):(0,s.jsx)("span",{children:B[0].file.name})})}),(0,s.jsxs)(k.DropdownMenu,{children:[(0,s.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"ghost",size:"xs",className:"size-6 rounded-md p-0",children:(0,s.jsx)(C.A,{className:"size-4"})})}),(0,s.jsx)(k.DropdownMenuContent,{align:"start",children:(0,s.jsx)(k.DropdownMenuGroup,{children:(0,s.jsxs)(k.DropdownMenuItem,{onClick:()=>ee?et(!1):W(B[0].id),variant:"destructive",children:[(0,s.jsx)(S.l,{}),(0,s.jsx)("span",{children:"Remove Image"})]})})})]})]})]}):(0,s.jsxs)("label",{className:"hover:bg-muted data-[dragging=true]:bg-muted flex size-full cursor-pointer flex-col gap-1 rounded-md border border-dashed p-4 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"pointer-events-none flex min-h-24 flex-col items-center justify-center text-sm",children:(0,s.jsx)("div",{className:"text-gray-500",children:U("modalImagePlaceholder")})}),(0,s.jsx)("input",{accept:"image/*",className:"sr-only",max:1,type:"file",onChange:G,ref:Z})]})})]}),ei=E.length?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(o.Label,{htmlFor:"envVarKeys",className:"flex items-center gap-0.5 font-medium text-gray-900",children:"Environment Variables"}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:E.map((e,t)=>(0,s.jsx)(i.p,{autoComplete:"off",disabled:V,id:"envVarKeys-".concat(t),maxLength:32,minLength:2,name:"envVarKeys-".concat(t),placeholder:"KEY",required:!0,spellCheck:!1,value:K.envVarKeys[t],onChange:e=>{let a=[...K.envVarKeys];a[t]=e.target.value,Y(e=>({...e,envVarKeys:a}))}},t))})]}):null,eo=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.$,{className:"mr-auto",onClick:es,disabled:V||q,variant:"ghost",size:"sm",children:(0,s.jsx)("span",{children:"Delete"})}),(0,s.jsx)(n.ModalClose,{asChild:!0,children:(0,s.jsx)(l.$,{size:"sm",variant:"secondary",disabled:V||q,onClick:()=>{F(!1),M&&setTimeout(()=>void O(!0),100)},children:U("modalCancelButton")})}),(0,s.jsx)(v.Q,{form:"template-edit-dialog",size:"sm",pending:V||q,children:(0,s.jsx)("span",{children:"Update"})})]});return(0,s.jsxs)(n.Modal,{open:T,onOpenChange:F,onInteractOutside:e=>{(V||q)&&e.preventDefault()},className:"flex flex-col md:max-h-[90vh]",children:[(0,s.jsx)(n.ModalHeader,{children:(0,s.jsx)(n.ModalTitle,{children:(0,s.jsx)("span",{children:"Edit Details"})})}),(0,s.jsx)(A,{children:(0,s.jsxs)("form",{className:"flex flex-col gap-4",id:"template-edit-dialog",onSubmit:e=>{e.preventDefault(),ea()},children:[en,er,ei,el]})}),(0,s.jsx)("div",{className:"bg-muted border-alpha-400 sticky bottom-0 flex w-full items-center justify-end gap-2 border-t p-4 pl-3",children:eo})]})}function A(e){let{children:t}=e,{showTopBorder:a,containerRef:r,topRef:l,bottomRef:i}=(0,b.Y)();return(0,s.jsx)(n.ModalContent,{ref:r,className:(0,y.cn)("flex flex-col overflow-y-auto border-t border-transparent transition-[border-color]",a&&"border-gray-200"),children:(0,s.jsxs)("div",{className:"relative flex h-fit w-full flex-col gap-4",children:[(0,s.jsx)("div",{ref:l,className:"absolute inset-x-0 top-0 h-px w-full"}),t,(0,s.jsx)("div",{ref:i,className:"absolute inset-x-0 bottom-0 h-px w-full"})]})})}},41796:()=>{},42161:(e,t,a)=>{"use strict";a.d(t,{L:()=>p,default:()=>x});var s=a(7336),r=a(38559),n=a(81616),l=a(24582),i=a(67952),o=a(35740),c=a(862),d=a(38230),u=a.n(d),m=a(2115),h=a(59103);function p(){let{data:e,mutate:t}=(0,h.Ay)("teamUpgradeDialog",null,{fallbackData:null});return{teamUpgradeDialog:e,setTeamUpgradeDialog:t}}function x(){var e;let{teamUpgradeDialog:t,setTeamUpgradeDialog:a}=p(),d=(0,i.k)("teamUpgradeDialog"),{planInfo:h,isLoading:x}=(0,o.N)(!0,null==t?void 0:t.id),g=null==h?void 0:null===(e=h.plans)||void 0===e?void 0:e.find(e=>"v0-team"===e.slug);if(!t||x||!g)return null;let f=(0,c.m9)(g);return(0,s.jsxs)(r.Modal,{onOpenChange:()=>a(null),open:!!t,children:[(0,s.jsxs)(r.ModalHeader,{className:"!pb-4",children:[(0,s.jsx)(r.ModalTitle,{children:d("title")}),(0,s.jsx)(r.ModalDescription,{children:d("description",t.name||t.slug)})]}),(0,s.jsxs)(r.ModalContent,{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"border-alpha-200 bg-muted m-0 space-y-3 rounded-sm border !p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{className:"font-semibold",children:d("planName","Team")}),(0,s.jsxs)("div",{className:"inline-flex items-center gap-0.5",children:[(0,s.jsx)("p",{className:"text-xl font-semibold leading-7",children:f}),(0,s.jsx)("p",{className:"leading-5 text-gray-500",children:d("userPerMonth")})]})]}),(0,s.jsx)("p",{className:"font-semibold",children:d("forFastMovingTeams")}),(0,s.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.J,{size:20})," ",d("everythingInPremium")]}),(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.J,{size:20})," ",d("evenHigherLimits")]}),(0,s.jsxs)("li",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.J,{size:20})," ",d("centralizedBilling")]})]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:d("learnMore")})]}),(0,s.jsxs)(r.ModalFooter,{children:[(0,s.jsx)(r.ModalClose,{asChild:!0,children:(0,s.jsx)(n.$,{size:"sm",variant:"secondary",children:d("cancel")})}),(0,s.jsx)(n.$,{asChild:!0,onClick:()=>{(0,m.u)("ClickGoToUpgradeTeamPage",{teamId:t.id}),a(null)},size:"sm",children:(0,s.jsx)(u(),{href:"/chat/upgrade?teamId=".concat(t.id),children:d("startTeamPlan")})})]})]})}},42179:(e,t,a)=>{"use strict";a.d(t,{P:()=>r});var s=a(30009);let r=(0,s.createServerReference)("4086722253289447c1520a31ba0c619beb5e73cb20",s.callServer,void 0,s.findSourceMapURL,"setDemoMode")},42394:(e,t,a)=>{"use strict";a.d(t,{Kn:()=>o,Sl:()=>d,rc:()=>c});var s=a(7336),r=a(80644),n=a(4495),l=a(81616),i=a(88293);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("bg-background flex w-fit items-center gap-1 rounded-[10px] p-1 shadow-sm",a),ref:t,...r})});o.displayName="ActionGroup";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.$,{className:(0,n.cn)("hover:bg-alpha-200 focus:bg-alpha-200 focus-visible:bg-alpha-200 h-6 min-w-6 rounded-md px-1 text-sm text-gray-500 hover:text-gray-900 focus:text-gray-900 focus-visible:text-gray-900 has-[>kbd]:gap-[6px] has-[>svg]:px-1",a),ref:t,size:"xs",variant:"ghost",...r})});c.displayName="Action";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.Separator,{className:(0,n.cn)("bg-alpha-400 h-5 w-px",a),ref:t,...r})});d.displayName="ActionSeparator"},42794:(e,t,a)=>{"use strict";a.d(t,{SidebarMainNav:()=>j});var s=a(7336),r=a(99876),n=a(99887),l=a(29381),i=a(4495);function o(e){let{v3:t=!1,className:a}=e,{setSheetOpen:r}=(0,l.e)();return(0,s.jsx)(n.NewChatButton,{className:(0,i.cn)(a),onButtonClick:()=>r(!1),variant:"sidebar",v3:t})}var c=a(47064),d=a(90),u=a(14363),m=a(30542),h=a(37644),p=a(10299);a(80644);var x=a(18730),g=a(48473),f=a(67952),v=a(35399);function j(e){let{variant:t="default",v3:a=!1}=e,n=(0,f.k)("sidebar"),l=(0,p.useRouter)(),{chatId:i}=(0,x.xz)(),{setFeedbackDialog:j}=(0,v.f)(),b=(0,s.jsx)(r.SidebarListItem,{children:(0,s.jsxs)(r.SidebarListItemButton,{onClick:()=>j(!0),tooltip:n("feedback"),children:[(0,s.jsx)(m.v,{}),(0,s.jsx)("span",{children:"Feedback"})]})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.W,{onSuccess:e=>{i?(0,g.M)({payload:{chatId:i,projectId:e}}):l.push("/chat/projects/".concat(e))}}),(0,s.jsx)(r.SidebarSection,{children:(0,s.jsxs)(r.SidebarList,{children:[(0,s.jsx)(o,{v3:a,className:"default"===t?"mb-2":"mb-1"}),(0,s.jsx)(r.SidebarListItem,{children:(0,s.jsxs)(r.SidebarListItemLink,{href:"/chat/history",altmatches:["/chat/blocks"],children:[(0,s.jsx)(c.z,{}),(0,s.jsx)("span",{children:"Recents"})]})}),(0,s.jsx)(r.SidebarListItem,{children:(0,s.jsxs)(r.SidebarListItemLink,{href:"/chat/projects",children:[(0,s.jsx)(d.K,{}),(0,s.jsx)("span",{children:"Projects"})]})}),(0,s.jsx)(r.SidebarListItem,{children:(0,s.jsxs)(r.SidebarListItemLink,{href:"/chat/community",altmatches:["/chat/community/submissions","/chat/community/pending"],tooltip:n("community"),children:[(0,s.jsx)(u.Kv,{}),(0,s.jsx)("span",{children:n("community")})]})}),"default"===t?b:null]})})]})}},42843:(e,t,a)=>{"use strict";a.d(t,{_d:()=>x,qn:()=>p,vn:()=>g});var s=a(7336),r=a(80644),n=a(38559),l=a(81616),i=a(59103),o=a(38230),c=a.n(o),d=a(77177),u=a(67921),m=a(40295),h=a(57748);function p(){let{data:e,mutate:t}=(0,i.Ay)("templateCreatedDialogOpen",null,{fallbackData:!1});return{templateCreatedDialogOpen:e,setTemplateCreatedDialogOpen:t}}function x(){let{data:e,mutate:t}=(0,i.Ay)("templateCreatedInfo",null,{fallbackData:null});return{templateCreatedInfo:e,setTemplateCreatedInfo:t}}function g(e){var t,a,i,o;let{activeBlock:g}=e,{project:f,title:v}=(0,h.tZ)(),{setTemplateEditDialogOpen:j}=(0,m.I)(),{templateCreatedInfo:b}=x(),{templateCreatedDialogOpen:y,setTemplateCreatedDialogOpen:w}=p(),[N]=r.useTransition(),k=null!==(a=null==f?void 0:f.name)&&void 0!==a?a:v,C=r.useMemo(()=>{var e;let t=(0,u.D)(null!==(e=g.templateCanonId)&&void 0!==e?e:"",k);return"".concat(window.location.origin,"/chat/community/").concat(t)},[g,k]),S=b?(0,s.jsxs)(c(),{href:C,target:"_blank",className:"group relative flex flex-col items-stretch overflow-hidden rounded-md border text-sm",children:[(0,s.jsxs)("div",{className:"bg-muted pointer-events-none relative aspect-video overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gradient-to-t from-[hsla(0,0%,100%,0.3)] to-[hsla(0,0%,40%,0.3)] opacity-0 transition-opacity group-hover:opacity-100",children:(0,s.jsx)(l.$,{size:"sm",children:"View"})}),(0,s.jsx)(d.TemplateImage,{showScreenshotMessage:!0,src:b.imageUrl,templateCanonId:g.templateCanonId})]}),(0,s.jsxs)("div",{className:"border-alpha-200 flex flex-col gap-1 border-t px-4 py-3",children:[(0,s.jsx)("p",{className:"font-medium",children:k}),(0,s.jsx)("p",{className:"line-clamp-1 truncate text-gray-500",children:b.description})]})]}):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Modal,{open:y,onOpenChange:w,onInteractOutside:e=>{N&&e.preventDefault()},className:"flex flex-col md:max-h-[90vh]",children:[(0,s.jsxs)(n.ModalHeader,{children:[(0,s.jsx)(n.ModalTitle,{children:(0,s.jsx)("span",{children:"Published to Community"})}),(0,s.jsx)(n.ModalDescription,{children:(0,s.jsx)("span",{children:"Your submission is in review."})})]}),(0,s.jsx)(n.ModalContent,{className:"flex flex-col gap-4",children:S}),(0,s.jsxs)("div",{className:"bg-muted border-alpha-400 sticky bottom-0 flex w-full items-center justify-end gap-2 border-t p-4",children:[(0,s.jsx)(l.$,{className:"mr-auto",onClick:()=>{w(!1),setTimeout(()=>void j(!0),100)},disabled:N,variant:"ghost",size:"sm",children:(0,s.jsx)("span",{children:"Edit"})}),(0,s.jsx)(l.$,{asChild:!0,disabled:N,variant:"secondary",size:"sm",children:(0,s.jsx)(c(),{href:C,target:"_blank",children:"View"})}),(0,s.jsx)(n.ModalClose,{asChild:!0,children:(0,s.jsx)(l.$,{size:"sm",disabled:N,children:"Done"})})]})]}),(0,s.jsx)(m.TemplateEditDialog,{templateCanonId:g.templateCanonId,blockId:g.id,description:null!==(i=null==b?void 0:b.description)&&void 0!==i?i:void 0,category:null!==(o=null==b?void 0:b.category)&&void 0!==o?o:null,imageUrl:null,shouldReturnToCreatedDialog:!0,activeBlock:g,envVarKeys:(null==b?void 0:b.envVarKeys)||(null===(t=g.env)||void 0===t?void 0:t.map(e=>e.key))||[]})]})}},42975:(e,t,a)=>{"use strict";a.d(t,{j:()=>c,r:()=>d});var s=a(7336);a(80644);var r=a(91284),n=a(4678),l=a(65410),i=a(98335),o=a(9207);function c(e){return"v0-preview-".concat(e)}function d(e){let{hasBlockPreview:t,activeTab:a,setActiveTab:c}=e,{isPublished:d}=(0,i.usePublishedPage)(),u=(0,s.jsx)(r.Tabs,{className:"w-full",onValueChange:c,value:a,children:(0,s.jsxs)(r.TabsList,{className:"relative h-10 [&>*]:flex-1",children:[(0,s.jsxs)(r.TabsTrigger,{className:"h-8 w-full flex-1",disabled:!(0,o.O)(t),value:"preview",children:[(0,s.jsx)(l.p,{}),(0,s.jsx)("span",{className:"select-none",children:"Preview"})]}),(0,s.jsxs)(r.TabsTrigger,{className:"h-8 flex-1",value:"code",children:[(0,s.jsx)(n.Y,{}),(0,s.jsx)("span",{className:"select-none",children:"Code"})]})]})});return d?(0,s.jsx)("div",{className:"flex w-full items-center gap-2",children:u}):null}},43390:(e,t,a)=>{"use strict";a.d(t,{SidebarUserMenu:()=>O});var s=a(7336),r=a(80644),n=a(76989),l=a(81616),i=a(50688),o=a(67952),c=a(70608),d=a(84984),u=a(25357),m=a(67204),h=a(76995),p=a(39715),x=a(59952),g=a(91284),f=a(4495),v=a(95057),j=a(14276);function b(e){let{className:t}=e,{theme:a,setTheme:r}=(0,j.D)(),n=(0,o.k)("sidebar.themeSwitcher");return(0,s.jsx)(g.Tabs,{variant:"secondary",className:t,onClick:e=>e.stopPropagation(),onValueChange:e=>r(e),value:a,children:(0,s.jsxs)(g.TabsList,{id:"theme-switcher",className:(0,f.cn)("h-fit overflow-hidden rounded-full border p-0 focus-within:overflow-visible [&>[role=tab]]:size-6","[&>[role=tab]>.absolute]:-inset-px [&>[role=tab]>.absolute]:rounded-full [&>[role=tab]>.absolute]:border [&>[role=tab]>.absolute]:bg-transparent"),children:[(0,s.jsx)(v.Tooltip,{content:n("system"),children:(0,s.jsxs)(g.TabsTrigger,{value:"system",children:[(0,s.jsx)(h.L,{size:12}),(0,s.jsx)("span",{className:"sr-only",children:"System"})]})}),(0,s.jsx)(v.Tooltip,{content:n("light"),children:(0,s.jsxs)(g.TabsTrigger,{value:"light",children:[(0,s.jsx)(x.b,{size:12}),(0,s.jsx)("span",{className:"sr-only",children:"Light"})]})}),(0,s.jsx)(v.Tooltip,{content:n("dark"),children:(0,s.jsxs)(g.TabsTrigger,{value:"dark",children:[(0,s.jsx)(p.A,{size:12}),(0,s.jsx)("span",{className:"sr-only",children:"Dark"})]})})]})})}var y=a(78088),w=a(77160),N=a(39060),k=a(30009);let C=(0,k.createServerReference)("00019b601cb070bff293d03a2170f0dc518b7b163b",k.callServer,void 0,k.findSourceMapURL,"logoutAction");var S=a(77011),I=a(8463),M=a(42179),z=a(24607),L=a(4461),P=a(63057),R=a(95559),D=a(18056),E=a(17777),A=a(35740),T=a(43665),F=a(76073);function O(e){let{className:t,isV3ChatSidebar:a=!1,...h}=e,p=(0,o.k)("sidebar.scopeSwitcher"),[x,g]=(0,r.useState)(!1),{setUpgradePromptOpen:v}=(0,S.g)(),{activeScope:j,user:y}=(0,F.k6)(),w=(0,T.W)(j),{planInfo:N}=(0,A.N)(!!w||!(null==j?void 0:j.limited),null==j?void 0:j.id),k=(0,r.useCallback)(()=>{v(!0),g(!1)},[v]),[O,_]=(0,r.useTransition)(),[B,H]=(0,r.useState)(null==y?void 0:y.isAdminMode),[$,q]=(0,r.useTransition)(),[W,Z]=(0,r.useState)(null==y?void 0:y.isDemoMode);if(!y)return(0,s.jsx)(i.E,{className:"m-0.5 size-6 rounded-full"});let G=(null==N?void 0:N.currentPlanSlug)==="v0-enterprise",K=y.isAdminMode,Y=(null==N?void 0:N.currentPlanSlug)==="v0-platinum";return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(n.DropdownMenu,{open:x,onOpenChange:g,children:[(0,s.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(l.$,{className:(0,f.cn)("hover:bg-alpha-400 focus:bg-alpha-400 size-fit border-0 p-0.5",x&&"bg-alpha-400",K&&"bg-blue-200 ring-2 ring-blue-700 hover:bg-blue-600/50 hover:ring-blue-900 focus:bg-blue-600/50 focus:ring-blue-900",t),rounded:!0,variant:"ghost",tooltip:a&&K?"You are in Admin Mode":"Profile",...h,children:(0,s.jsx)(z.AvatarUser,{userId:y.id,className:"size-6 rounded-full"})})}),(0,s.jsxs)(n.DropdownMenuContent,{align:"start",className:"w-[224px]",side:"top",sideOffset:8,children:[(0,s.jsx)(L.rX,{children:(0,s.jsx)("div",{className:"h-11 content-center px-1.5",children:(0,s.jsx)(R.Xh,{scope:y,user:y,showEmail:!0})})}),(0,s.jsx)(n.mB,{}),(0,s.jsxs)(L.rX,{children:[(0,s.jsx)(L.xG,{label:p("billing"),Icon:(0,s.jsx)(c.y,{}),href:"/chat/settings/billing"}),(0,s.jsx)(L.xG,{label:p("settings"),Icon:(0,s.jsx)(u.H,{}),href:"/chat/settings"}),(0,s.jsx)(L.xG,{label:"Discord",sameTab:!1,className:"group",Icon:(0,s.jsx)(m.O,{className:"[&_path]:fill-gray-500 group-hover:[&_path]:fill-gray-900"}),href:"https://discord.gg/4ECCp2V5y9"}),(0,s.jsx)(L.bA,{label:p("signOut"),Icon:(0,s.jsx)(d.f,{}),action:C})]}),(0,s.jsx)(n.mB,{}),y.isVercelian?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(L.rX,{children:[(0,s.jsx)("div",{className:"flex h-8 items-center px-1.5",children:(0,s.jsx)("span",{className:"text-[13px] font-medium leading-[16px] text-gray-500",children:p("preferences")})}),(0,s.jsxs)(L.Dr,{disabled:O,onClick:()=>{let e=!B;H(e),_(async()=>{await (0,I.P)(e)})},children:[(0,s.jsx)(L.sW,{label:"Admin Mode"}),(0,s.jsx)(D.Switch,{className:"pointer-events-none",checked:B})]}),(0,s.jsxs)(L.Dr,{disabled:$,onClick:()=>{let e=!W;Z(e),q(async()=>{await (0,M.P)(e)})},children:[(0,s.jsx)(L.sW,{label:"Demo Mode"}),(0,s.jsx)(D.Switch,{className:"pointer-events-none",checked:W})]})]}),(0,s.jsx)(n.mB,{})]}):null,(0,s.jsxs)(L.rX,{children:[(0,s.jsx)("div",{className:"flex h-8 items-center px-1.5",children:(0,s.jsx)("span",{className:"text-[13px] font-medium leading-[16px] text-gray-500",children:p("preferences")})}),(0,s.jsx)(V,{onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===(t=document.getElementById("theme-switcher"))||void 0===t||t.focus())},label:p("theme"),children:(0,s.jsx)(b,{})}),(0,s.jsx)(V,{onKeyDown:e=>{var t;"Enter"===e.key&&(e.preventDefault(),null===(t=document.getElementById("locale-switcher"))||void 0===t||t.focus())},label:p("language"),children:(0,s.jsx)(U,{})})]}),G||Y?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.mB,{}),(0,s.jsx)(L.rX,{children:(0,s.jsx)(P._2,{asChild:!0,children:(0,s.jsx)(l.$,{size:"sm",onClick:k,"data-testid":"upgrade-cta-button",children:(0,s.jsx)("span",{children:p("upgradePlan")})})})})]})]})]}),K&&!a?(0,s.jsx)(E.E,{size:"sm",className:"rounded-sm",variant:"blue",children:"Admin Mode"}):null]})}function U(){let{locale:e,setLocale:t}=(0,w.useLocale)();return(0,s.jsxs)(y.l6,{onValueChange:e=>t(e),value:e,children:[(0,s.jsx)(y.bq,{id:"locale-switcher",className:"h-7 max-w-[5rem] gap-1 px-2 [&>svg]:w-3 [&>svg]:shrink-0","data-testid":"language-selector",children:(0,s.jsx)("div",{className:"truncate text-xs",children:(0,s.jsx)(y.yv,{placeholder:N.YZ[e]})})}),(0,s.jsx)(y.gC,{children:(0,s.jsx)(y.s3,{children:Object.keys(N.YZ).map(e=>(0,s.jsx)(y.eb,{value:e,children:N.YZ[e]},e))})})]})}function V(e){let{label:t,children:a,className:r,...n}=e;return(0,s.jsxs)(L.Dr,{className:(0,f.cn)("cursor-default items-center justify-between gap-4 focus:bg-transparent focus-visible:bg-gray-100",r),svgStyling:!1,...n,children:[(0,s.jsx)("span",{className:"text-sm font-normal text-gray-900",children:t}),a]})}},43554:(e,t,a)=>{"use strict";a.d(t,{e:()=>o});var s=a(80644),r=a(19895),n=a(18730),l=a(61202);let i=e=>"last-opened-block:".concat(e);function o(){let{messages:e,chatId:t,activeForkKey:a}=(0,n.Pk)(),o=(0,r.oQ)();return{reopenLastBlock:(0,s.useCallback)(()=>{var s,r;let n=localStorage.getItem(i(t));if(n)for(let t of e.filter(e=>null==a?void 0:a.includes(e.id))){let e=(0,l.sY)(null!==(s=t.content)&&void 0!==s?s:"",t.id).find(e=>e.id===n);if(e)return o(!0,e),!0}for(let t of[...e].reverse().filter(e=>null==a?void 0:a.includes(e.id))){let e=(0,l.sY)(null!==(r=t.content)&&void 0!==r?r:"",t.id);return o(!0,e[e.length-1]),!0}return!1},[e,o,t,a]),saveLastOpenedBlock:(0,s.useCallback)(e=>{e?localStorage.setItem(i(t),e):localStorage.removeItem(i(t))},[t])}}},44999:(e,t,a)=>{"use strict";a.d(t,{lA:()=>U,rH:()=>O,ed:()=>F});var s=a(7336),r=a(80644),n=a(59103),l=a(14363),i=a(83748),o=a(18730),c=a(38559),d=a(30757),u=a(19895),m=a(30009);let h=(0,m.createServerReference)("407a779aba2fad8423d944cb510b27b759da04073e",m.callServer,void 0,m.findSourceMapURL,"createTemplateAction");var p=a(15993),x=a(42843),g=a(67952),f=a(38230),v=a.n(f),j=a(67921),b=a(15066),y=a(47587),w=a(81616),N=a(98898),k=a(55330),C=a(97237),S=a(76989),I=a(4495),M=a(54851),z=a(20685),L=a(90352),P=a(4304),R=a(77177),D=a(80890),E=a(78088),A=a(35616),T=a(57748);function F(){let{data:e,mutate:t}=(0,n.Ay)("publishBlockDialogOpen",null,{fallbackData:!1});return{publishBlockDialogOpen:e,setPublishBlockDialogOpen:t}}function O(e){let{activeBlock:t,name:a}=e,{publishBlockDialogOpen:n,setPublishBlockDialogOpen:l}=F(),{setTemplateCreatedDialogOpen:o}=(0,x.qn)(),m=(0,g.k)("templatePublishDialog"),[f,v]=(0,r.useState)({name:a,description:"",category:""}),j=(0,r.useMemo)(()=>(function(e){if(!e)return[];let t=/process(?:\.|\?\.)?env(?:\.|\?\.|\[['"])([A-Z_][A-Z0-9_]*)(?:['"]\])?/g,a=new Set;try{let s;for(;null!==(s=t.exec(e));)a.add(s[1])}catch(e){console.error("Error extracting environment variables:",e)}return Array.from(a)})(t.source),[t]),I=(0,r.useMemo)(()=>{var e;return(null===(e=t.env)||void 0===e?void 0:e.map(e=>e.key).toSorted((e,t)=>j.includes(e)&&!j.includes(t)?-1:!j.includes(e)&&j.includes(t)?1:e.localeCompare(t)))||[]},[t.env,j]),{values:M,toggle:T,has:O}=(0,k.L)(j),{files:U,uploading:_,removeFile:B,setInitialFiles:H,inputFileRef:$,onInputChange:q}=(0,C.Lb)({initialImages:[],disableDrag:!n}),{handleCreateTemplate:W,createTemplatePending:Z}=function(e){let[t,a]=(0,r.useTransition)(),s=(0,u.eu)(),n=(0,u.y6)(),{setTemplateCreatedInfo:l}=(0,x._d)();return{handleCreateTemplate:(0,r.useCallback)(t=>{let{description:r,category:i,envVarKeys:o,imageUrl:c}=t;a(async()=>{if(!s)throw Error("No active block");let t={blockId:s.id,description:r,category:i,publishedToCommunity:!1,imageUrl:c,envVarKeys:o},a=await h(t);if(a.error){p.oR.error(a.error);return}n({...s,templateCanonId:a.templateId,templateVersionId:a.templateVersionId}),await l({description:t.description,category:t.category,envVarKeys:t.envVarKeys,imageUrl:a.imageUrl}),e()})},[s,e,n,l]),createTemplatePending:t}}((0,r.useCallback)(()=>{l(!1),o(!0)},[l,o]));(0,r.useEffect)(()=>{n||setTimeout(()=>{H([]),v({name:a,description:"",category:""})},500)},[a,n,H]);let G=(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(b.Label,{htmlFor:"description",className:"font-medium text-gray-900",children:m("modalDescriptionLabel")}),(0,s.jsx)(N.T,{asChild:!0,children:(0,s.jsx)(z.o,{maxHeight:192,minHeight:80,disabled:Z,id:"description",maxLength:L.Kx,name:"description",placeholder:m("modalDescriptionPlaceholder"),spellCheck:!1,onChange:e=>v(t=>({...t,description:e.target.value})),value:f.description||""})})]}),K=(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)(E.l6,{disabled:Z,onValueChange:e=>v(t=>({...t,category:e})),required:!0,children:[(0,s.jsxs)(b.Label,{htmlFor:"category",className:"font-medium text-gray-900",children:[m("modalCategoryLabel"),(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(E.bq,{id:"category",children:(0,s.jsx)(E.yv,{placeholder:"Select a category"})}),(0,s.jsx)(E.gC,{children:A.L.map(e=>(0,s.jsx)(E.eb,{value:e.value,children:e.text},e.value))})]})}),Y=I.length?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)(b.Label,{htmlFor:"description",className:"font-medium text-gray-900",children:"Environment Variables"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Mark the required environment variables for this generation to run."}),(0,s.jsx)("div",{className:"border-alpha-200 flex max-h-96 min-h-0 w-full flex-col gap-1 overflow-y-auto rounded-xl border p-1.5",children:I.map(e=>(0,s.jsxs)("label",{htmlFor:e,className:"hover:bg-alpha-200 flex min-w-0 items-center gap-3 rounded-md px-2 py-1.5",children:[(0,s.jsx)(y.Checkbox,{variant:"black",id:e,checked:O(e),onCheckedChange:()=>T(e),disabled:Z}),(0,s.jsx)("div",{className:"truncate text-sm font-medium",children:e})]},e))})]}):null,Q=(0,s.jsxs)("fieldset",{className:"flex flex-col items-start gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("legend",{className:"flex items-center gap-0.5 text-sm font-medium",children:[m("modalImageLabel")," (Optional)"]}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:m("modalImageDescription")})]}),(0,s.jsx)("div",{className:"h-32 w-full",children:U.length?(0,s.jsxs)("div",{className:"flex h-full w-[169px] flex-col gap-2",children:[(0,s.jsx)("div",{className:"bg-muted relative flex-1 overflow-hidden rounded-md border",children:(0,s.jsxs)("div",{className:"pointer-events-none aspect-video data-[status=uploading]:opacity-50","data-status":U[0].status,children:[(0,s.jsx)(R.TemplateImage,{alt:U[0].file.name,src:U[0].url,templateCanonId:""}),_&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(D.X,{})})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 text-sm font-medium",children:[(0,s.jsx)("div",{className:"min-w-0 flex-1 contain-inline-size",children:(0,s.jsx)("div",{className:"line-clamp-1 w-full break-all",children:(0,s.jsx)("span",{children:U[0].file.name})})}),(0,s.jsxs)(S.DropdownMenu,{children:[(0,s.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(w.$,{variant:"ghost",size:"xs",className:"size-6 rounded-md p-0",children:(0,s.jsx)(d.A,{className:"size-4"})})}),(0,s.jsx)(S.DropdownMenuContent,{align:"start",children:(0,s.jsx)(S.DropdownMenuGroup,{children:(0,s.jsxs)(S.DropdownMenuItem,{onClick:()=>B(U[0].id),variant:"destructive",children:[(0,s.jsx)(i.l,{}),(0,s.jsx)("span",{children:"Remove Image"})]})})})]})]})]}):(0,s.jsxs)("label",{className:"hover:bg-muted data-[dragging=true]:bg-muted flex size-full cursor-pointer flex-col gap-1 rounded-md border border-dashed p-4 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"pointer-events-none flex min-h-24 flex-col items-center justify-center text-sm",children:(0,s.jsx)("div",{className:"text-gray-500",children:m("modalImagePlaceholder")})}),(0,s.jsx)("input",{accept:"image/*",className:"sr-only",max:1,type:"file",onChange:q,ref:$})]})})]});return(0,s.jsxs)(c.Modal,{className:"flex flex-col md:max-h-[90vh]",open:n,onOpenChange:l,onInteractOutside:e=>{(Z||_)&&e.preventDefault()},children:[(0,s.jsxs)(c.ModalHeader,{children:[(0,s.jsx)(c.ModalTitle,{children:m("modalTitle")}),(0,s.jsx)("span",{children:(0,s.jsx)("p",{className:"text-foreground text-sm",children:m("modalDescription")})})]}),(0,s.jsx)(V,{children:(0,s.jsxs)("form",{className:"flex flex-col gap-4",id:"publish-block-button",onSubmit:e=>{var t;e.preventDefault(),W({description:f.description,category:f.category,envVarKeys:M,imageUrl:null===(t=U[0])||void 0===t?void 0:t.url})},children:[K,G,Y,Q]})}),(0,s.jsxs)("div",{className:"bg-muted border-alpha-400 sticky bottom-0 flex w-full items-center justify-end gap-2 border-t p-4",children:[(0,s.jsx)(w.$,{size:"sm",disabled:Z,onClick:()=>l(!1),type:"button",variant:"secondary",children:"Cancel"}),(0,s.jsx)(P.Q,{disabled:_,form:"publish-block-button",size:"sm",pending:Z,children:"Publish"})]})]})}function U(e){var t;let{activeBlock:a,isMenuItem:n=!1,className:i,onClick:c}=e,{isStreaming:d}=(0,o.Pk)(),{title:u,project:m}=(0,T.tZ)(),{setPublishBlockDialogOpen:h}=F(),p=(0,r.useMemo)(()=>a.templateCanonId&&a.templateVersionId,[a.templateCanonId,a.templateVersionId]),x=null!==(t=null==m?void 0:m.name)&&void 0!==t?t:u,g=(0,r.useMemo)(()=>{var e;return"/chat/community/".concat((0,j.D)(null!==(e=a.templateCanonId)&&void 0!==e?e:"",x))},[a.templateCanonId,x]),f=(0,r.useCallback)(()=>{h(!0),null==c||c()},[c,h]);return n?(0,s.jsx)(S.DropdownMenuItem,{asChild:!!p||void 0,disabled:d,onClick:p?void 0:f,children:p?(0,s.jsxs)(v(),{href:g,children:[(0,s.jsx)(l.Kv,{}),(0,s.jsx)("span",{children:"View in Community"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Kv,{}),(0,s.jsx)("span",{children:"Publish to Community"})]})}):p?(0,s.jsx)(w.$,{asChild:!0,disabled:d,size:"sm",variant:"secondary",className:(0,I.cn)("h-7 rounded-md",i),children:(0,s.jsx)(v(),{href:g,children:(0,s.jsx)("span",{children:"Published"})})}):(0,s.jsx)(w.$,{onClick:f,disabled:d,size:"sm",variant:"secondary",className:(0,I.cn)("h-7 rounded-md",i),children:(0,s.jsx)("span",{children:"Publish"})})}function V(e){let{children:t}=e,{showTopBorder:a,containerRef:r,topRef:n,bottomRef:l}=(0,M.Y)();return(0,s.jsx)(c.ModalContent,{ref:r,className:(0,I.cn)("flex flex-col overflow-y-auto border-t border-transparent transition-[border-color]",a&&"border-gray-200"),children:(0,s.jsxs)("div",{className:"relative flex h-fit w-full flex-col gap-4",children:[(0,s.jsx)("div",{ref:n,className:"absolute inset-x-0 top-0 h-px w-full"}),t,(0,s.jsx)("div",{ref:l,className:"absolute inset-x-0 bottom-0 h-px w-full"})]})})}},45333:(e,t,a)=>{"use strict";a.d(t,{G:()=>r});var s=a(26596);let r=(e,t)=>s.Pp(e.trim(),t.trim())},45453:(e,t,a)=>{"use strict";a.d(t,{R:()=>g});var s=a(7336),r=a(30009);let n=(0,r.createServerReference)("70c17bdb950d6b2f14d712ee0eaad7720cfb0a65dc",r.callServer,void 0,r.findSourceMapURL,"updateProjectSettingsIcon");var l=a(51372),i=a(65718),o=a(81616),c=a(50688),d=a(4495),u=a(11192),m=a(80644),h=a(85625);let p=(0,u.default)(()=>Promise.resolve().then(a.bind(a,51372)).then(e=>e.IconPicker),{loadableGenerated:{webpack:()=>[51372]},loading:()=>(0,s.jsx)(c.E,{className:"size-12 rounded-xl"})}),x=(0,u.default)(()=>Promise.resolve().then(a.bind(a,51372)).then(e=>e.IconPickerContent),{loadableGenerated:{webpack:()=>[51372]},loading:()=>(0,s.jsx)(l.IconPickerSkeleton,{})});function g(e){let{projectId:t,icon:a,color:r,size:l="lg",readOnly:c,isNewPage:u=!1,onSelect:g,random:f}=e,[v,j]=(0,m.useState)(!1),[b,y]=(0,m.useState)(!1),[w,N]=(0,m.useState)({name:(0,h.KI)(a),color:null!=r?r:""});return(0,m.useEffect)(()=>{N({name:(0,h.KI)(a),color:null!=r?r:""})},[a,r]),(0,s.jsx)(p,{random:f,icon:w,onValueChange:e=>{g&&g(e.name),N(e),y(!0),u||(0,m.startTransition)(()=>{n(t,e.name,e.color)})},trigger:(0,s.jsx)(o.$,{className:(0,d.cn)("aspect-square p-0","xs"===l&&"size-5 rounded-sm","sm"===l&&"size-8 rounded-lg","lg"===l&&"size-12 rounded-xl"),"data-testid":"project-icon-picker",disabled:c,onFocus:()=>y(!!b),onMouseEnter:()=>y(!1),tooltip:c?void 0:{open:!b&&v,onOpenChange:j,content:"Change icon"},variant:"ghost",children:(0,s.jsx)(i.h,{color:w.color,icon:w.name,size:"lg"})}),children:(0,s.jsx)(x,{})})}},46087:(e,t,a)=>{"use strict";a.d(t,{O:()=>m,t:()=>h});var s=a(7336),r=a(62239),n=a(36024),l=a(95357),i=a(86595),o=a(49239),c=a(80644),d=a(85328);function u(e){let{id:t}=e,a=(0,n.E)(t);return(0,s.jsx)("span",{ref:a})}function m(e){let{label:t,idPrefix:a}=e,[r,n]=(0,c.useState)(!1),m=(0,d.al)(),{refs:h,floatingStyles:p,context:x}=(0,l.we)({placement:m?"top":"top-start",middleware:[(0,i.BN)({padding:6}),(0,i.cY)(4),(0,i.UU)({padding:6})],open:r,onOpenChange:n,whileElementsMounted:o.ll}),g=(0,l.Mk)(x,{handleClose:(0,l.iB)({buffer:1})}),{getReferenceProps:f,getFloatingProps:v}=(0,l.bv)([g]),j="".concat(a).concat(t);return"vercel_knowledge_base"===t?null:(0,s.jsxs)("span",{ref:h.setReference,...f(),className:"-mt-1 ml-0.5 inline-flex size-4 align-text-top",children:[(0,s.jsx)("a",{className:"bg-alpha-200 hover:bg-alpha-400 focus:bg-alpha-400 inline-block size-4 select-none rounded-full text-center font-mono text-[10px] leading-4 text-gray-700 no-underline transition-colors focus:text-black",href:"#def-".concat(j),id:"ref-".concat(j),onBlur:()=>n(!1),onFocus:()=>n(!0),tabIndex:0,children:t}),r?(0,s.jsx)("span",{ref:h.setFloating,style:p,...v(),className:"bg-background shadow-base z-10 select-none rounded-md p-2 text-xs",children:(0,s.jsx)(u,{id:j})}):null]})}function h(e){let{id:t,children:a}=e,{containers:s}=(0,n.W)(),l=s[t];return l?(0,r.createPortal)(a,l):null}},46732:(e,t,a)=>{"use strict";a.d(t,{b:()=>eY,P:()=>eK});var s=a(7336),r=a(80644),n=a(81616),l=a(58365),i=a(64826),o=a(25357),c=a(8999),d=a(64297),u=a(86358),m=a(95805),h=a(45419),p=a(97947),x=a(67952),g=a(99982),f=a(33508),v=a(15993),j=a(76989),b=a(37522),y=a(85303),w=a(83748),N=a(81521),k=a(403),C=a(91064),S=a(15067),I=a(61934),M=a(1808),z=a(93874),L=a(50688),P=a(4495),R=a(59246),D=a(35330);a(88293);var E=a(96378),A=a(38230),T=a.n(A),F=a(59103);function O(e){let{projectId:t,alias:a}=e;return(0,s.jsxs)(D.Zp,{className:"group/block-card group relative flex min-h-[275px] w-full flex-col transition-all hover:shadow-md",children:[(0,s.jsx)(T(),{className:"absolute inset-0 z-10 cursor-pointer overflow-hidden rounded-lg",href:(0,P.sT)(a),target:"_blank",children:(0,s.jsx)("span",{className:"sr-only",children:"Visit deployment"})}),(0,s.jsx)("div",{className:"relative h-full flex-1",children:(0,s.jsx)(U,{projectId:t})})]})}function U(e){let{projectId:t}=e,{data:a}=(0,F.Ay)(["project:screenshot",t]);return a?(0,s.jsx)(E.default,{src:a,alt:"Screenshot for deployment",className:"pointer-events-none rounded-lg object-cover",fill:!0}):(0,s.jsx)(V,{})}function V(){return(0,s.jsx)("div",{className:"text-muted-foreground bg-background from-background via-muted/50 to-background animate-shimmer flex h-full animate-pulse items-center justify-center bg-gradient-to-r bg-[length:200%_100%]"})}var _=a(23063),B=a(10299),H=a(16363),$=a(95057),q=a(17276),W=a(76073),Z=a(30009);let G=(0,Z.createServerReference)("40ea4cd1b4a494e8e923d588900394243f181cdf03",Z.callServer,void 0,Z.findSourceMapURL,"createChatFromGit");function K(e){let{setSaving:t,vercelProjectWithDashboard:a,isLoading:r,v0ProjectId:n,closeSettingsSheet:l}=e;return r?(0,s.jsx)(J,{}):a?(0,s.jsx)(Y,{vercelProjectWithDashboard:a,setSaving:t,v0ProjectId:n,closeSettingsSheet:l}):(0,s.jsx)(Q,{setSaving:t,v0ProjectId:n})}function Y(e){var t;let{vercelProjectWithDashboard:a,setSaving:n,v0ProjectId:l,closeSettingsSheet:i}=e,{activeScopeSlug:o}=(0,W.k6)(),[c,d]=(0,r.useTransition)(),{refetchVercelProject:u}=(0,h.Ok)(l),p=(0,x.k)("projectSettings"),g=(0,x.k)("blockActions"),f=(0,_.D)(),b=(0,h.LP)(),[S,M]=(0,r.useState)(!1),z=null===(t=a.dashboardProject)||void 0===t?void 0:t.link,L=(0,r.useCallback)(()=>{n(!0),d(async()=>{try{let e=await (0,I.y)({v0ProjectId:l});"error"in e||!e.success?v.oR.error(p("projectUnlinkError")):(v.oR.success(p("projectUnlinkSuccess")),await u())}catch(e){v.oR.error(p("projectUnlinkError"))}finally{d(()=>{n(!1)})}})},[l,n,p,u]),D=(0,B.useRouter)(),{vercelProject:E,deploymentId:A,alias:T,prodBlockInfo:F,allAliases:U}=(0,r.useMemo)(()=>{var e,t,s,r;return{vercelProject:a.project,deploymentId:null===(t=a.dashboardProject)||void 0===t?void 0:null===(e=t.productionDeployment)||void 0===e?void 0:e.id,alias:null===(s=a.dashboardProject)||void 0===s?void 0:s.domain,prodBlockInfo:a.prodBlockInfo,allAliases:null===(r=a.dashboardProject)||void 0===r?void 0:r.aliases}},[a]),V=(0,r.useCallback)(()=>{if(z)try{d(async()=>{let e=await G({projectId:l});if(!e||"string"!=typeof e){v.oR.error("error");return}D.push("/chat/".concat(e)),i()})}catch(e){console.log(e),v.oR.error("error")}},[z,l,D,i]),Z=(0,r.useCallback)(()=>{let e=null==F?void 0:F.blockId;if(e)try{d(async()=>{let t=await (0,H.O)(e);if(!t||"string"!=typeof t){v.oR.error("error");return}D.push("/chat/".concat(t)),i()})}catch(e){console.log(e),v.oR.error("error")}},[i,null==F?void 0:F.blockId,D]);return(0,s.jsxs)(R.wn,{label:p("vercelProject"),info:"Your v0 project is linked to this Vercel project.",children:[f.ppe&&A&&T?(0,s.jsx)(O,{projectId:l,alias:T}):null,(0,s.jsxs)("div",{className:(0,P.cn)("flex h-[62px] w-full items-center justify-between rounded-lg border p-3",c&&"opacity-50"),children:[(0,s.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,s.jsx)("p",{className:"text-sm font-medium leading-5 text-gray-900",children:E.name}),A&&T?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(C.N,{className:"flex items-center gap-0.5 text-[13px] leading-[16px] text-gray-500",external:!0,disabled:c,href:(0,P.sT)(T),children:T}),(null==U?void 0:U.length)?(0,s.jsx)($.Tooltip,{delayDuration:500,open:S,onOpenChange:M,disableHoverableContent:!1,content:(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("h1",{className:"text-gray-500",children:"Assigned Domains"}),(0,s.jsx)("ul",{children:U.map(e=>(0,s.jsx)("li",{className:"flex items-center space-x-1",children:(0,s.jsx)("a",{href:(0,P.sT)(e),target:"_blank",className:"hover:underline",children:e})},e))})]}),children:(0,s.jsx)(q.R,{className:"h-3 w-3 text-gray-400"})}):null]}):null]}),(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{disabled:c,children:(0,s.jsx)(R.eC,{className:"size-7",label:p("manageVercelProject")})}),(0,s.jsx)(j.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,s.jsxs)(j.DropdownMenuGroup,{children:[f.ppe&&F?(0,s.jsx)(C.N,{href:"/chat/".concat(F.chatId,"?b=").concat(F.blockId,"&f=0"),onClick:e=>{e.metaKey||i()},children:(0,s.jsxs)(j.DropdownMenuItem,{children:[(0,s.jsx)(y.k,{}),(0,s.jsx)("span",{children:g("openInChat")})]})}):null,f.gs&&z||F?(0,s.jsxs)(j.DropdownMenuItem,{onSelect:()=>{f.gs&&z?V():Z()},children:[(0,s.jsx)(N.Z,{}),(0,s.jsx)("span",{children:g("fork")})]}):null,(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,s.jsx)(m.i,{className:"size-3"}),(0,s.jsx)("span",{children:p("viewOnVercel")})]})}),f.ppe&&b?(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:"https://vercel.com/".concat(o,"/").concat(E.name,"/settings/domains"),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,s.jsx)(k.q,{className:"size-3"}),(0,s.jsx)("span",{children:p("setCustomDomain")})]})}):null,b&&(0,s.jsxs)(j.DropdownMenuItem,{variant:"destructive",disabled:c,onClick:L,children:[(0,s.jsx)(w.l,{}),(0,s.jsx)("span",{children:p("unlinkVercelProject")})]})]})})]})]})]})}function Q(e){let{setSaving:t,v0ProjectId:a}=e,l=(0,x.k)("projectSettings"),{setSelectedProjectId:o}=(0,h._t)(),{projects:c,isReady:d}=(0,S.D)(),[u,m]=(0,r.useTransition)(),[p,g]=(0,r.useState)(!1),[f,b]=(0,r.useState)(""),y=(0,r.useMemo)(()=>(null==c?void 0:c.length)&&c.length>0,[c]),w=(null==c?void 0:c.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())))||[],N=(0,r.useCallback)(e=>{o(e.id)},[o]),k=(0,r.useCallback)(e=>{e&&(t(!0),m(async()=>{try{let t=await (0,M.t)({v0ProjectId:a,vercelProjectId:e.id});"error"in t||!t.success||v.oR.success(l("projectLinkSuccess"))}catch(e){v.oR.error(l("projectLinkError"))}finally{m(()=>{t(!1)})}}))},[a,t,l]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.wn,{label:l("vercelProject"),info:"Link to a Vercel Project to enable deployments from v0 to Vercel.",children:(0,s.jsx)(R.pp,{className:"h-[62px]",children:y?(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.$,{"aria-label":l("connectVercelProject"),variant:"secondary",size:"sm",disabled:u||!d,children:[(0,s.jsx)(i.F,{}),l("connectVercelProject")]})}),(0,s.jsx)(j.DropdownMenuContent,{align:"center",className:"w-[calc(100vw-32px)] overflow-y-auto md:max-w-[467px]",side:"bottom",sideOffset:20,children:(0,s.jsx)(z.e$,{filteredProjects:w,searchQuery:f,setSearchQuery:b,isLoading:!d,selectedProject:void 0,handleLinkProject:k,setShowCreateModal:g})})]}):(0,s.jsxs)(n.$,{"aria-label":l("connectVercelProject"),variant:"secondary",size:"sm",disabled:u||!d,onClick:()=>g(!0),children:[(0,s.jsx)(i.F,{}),l("connectVercelProject")]})})}),(0,s.jsx)(z.Dm,{v0ProjectId:a,onClose:()=>g(!1),open:p,onProjectCreated:N})]})}function J(){let e=(0,x.k)("projectSettings");return(0,s.jsx)(R.wn,{label:e("vercelProject"),children:(0,s.jsxs)("div",{className:"flex h-[62px] items-center justify-between rounded-lg border p-3",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-between gap-2",children:[(0,s.jsx)(L.E,{className:"h-3 w-40"}),(0,s.jsx)(L.E,{className:"h-3 w-16"})]}),(0,s.jsx)(n.$,{className:"relative size-7 text-gray-500",size:"sm",variant:"ghost",disabled:!0,children:(0,s.jsx)(b.a,{})})]})})}var X=a(60586),ee=a(81226),et=a(17777);function ea(e){let{vercelProject:t,onAdd:a,teamSlug:l}=e,{connections:i,stores:o,isLoading:c}=(0,X.g)({projectId:null==t?void 0:t.id}),d=(0,h.LP)(),[u,p]=(0,r.useState)(!1),x=(0,r.useMemo)(()=>{let e=new Set(ee.ud);return[...i.data.map(t=>({...t,url:"https://vercel.com/".concat(l,"/~/integrations/").concat(t.slug,"/").concat(t.id),isRecommended:e.has(t.slug)})),...o.data.map(a=>{if(!a.product)return null;let s="upstash-kv"===a.product.slug?"upstash":a.product.slug,r=e.has(s),n="upstash-kv"===a.product.slug?"https://vercel.com/api/www/avatar/".concat(a.product.integration.icon):"https://vercel.com/api/www/avatar/".concat(a.product.iconUrl);return{id:a.id,slug:a.product.slug,name:a.product.name,description:a.product.shortDescription,icon:n,url:"https://vercel.com/".concat(l,"/").concat(null==t?void 0:t.name,"/stores/integration/").concat(a.id,"/settings"),isRecommended:r,providerLink:"https://vercel.com/api/marketplace/sso?integrationConfigurationId=".concat(a.product.integrationConfigurationId,"&teamId=").concat(a.ownerId)}}).filter(Boolean)].sort((e,t)=>e&&t?e.isRecommended!==t.isRecommended?e.isRecommended?-1:1:e.name.localeCompare(t.name):0)},[i,o,l,t]),g=x.length;if(c)return(0,s.jsx)(R.Zv,{title:"Integrations"});let f=g>ee._5,v=x.slice(0,u?g:ee._5);return(0,s.jsx)(R.wn,{label:"Integrations",badge:(0,s.jsx)(et.E,{variant:"blue",size:"sm",className:"ml-1",children:"Beta"}),onAdd:d&&t?a:void 0,info:"Connect your v0 project to external services from the Vercel marketplace.",children:g&&t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:v.map(e=>(0,s.jsx)(R.ck,{suffix:(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{children:(0,s.jsx)(R.eC,{className:"size-7",label:"Manage integration in Vercel"})}),(0,s.jsx)(j.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,s.jsxs)(j.DropdownMenuGroup,{children:[(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:e.url,target:"_blank",className:"flex items-center gap-2",children:[(0,s.jsx)(y.k,{}),(0,s.jsx)("span",{children:"Manage on Vercel"})]})}),e.providerLink&&(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:e.providerLink,target:"_blank",className:"flex items-center gap-2",children:[(0,s.jsx)(m.i,{}),(0,s.jsxs)("span",{children:["Open in ",e.name]})]})})]})})]}),children:(0,s.jsxs)("div",{className:(0,P.cn)("flex items-center gap-3",!e.isRecommended&&"opacity-60"),children:[(0,s.jsx)("div",{className:"relative h-8 w-8 overflow-hidden rounded-full",children:(0,s.jsx)(E.default,{src:e.icon,alt:e.name,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{className:"flex flex-col items-start gap-0.5 leading-5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"max-w-[200px] truncate text-sm font-medium sm:max-w-[300px]",children:e.name}),!e.isRecommended&&(0,s.jsx)($.Tooltip,{content:"Integration only works on vercel.com",children:(0,s.jsx)("button",{children:(0,s.jsx)(et.E,{size:"sm",children:"Vercel Only"})})})]}),(0,s.jsx)("span",{className:"text-[13px] leading-[18px] text-gray-500",children:e.description})]})]})},e.id))}),f&&(0,s.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>p(!u),children:u?"Show Less":"Show More"})]}):(0,s.jsx)(R.pp,{title:"No integrations",subtitle:t?"Add an integration this project should use.":"Connect to a Vercel project to use integrations."})})}var es=a(25733),er=a(84274),en=a(33190),el=a(21414),ei=a(19461),eo=a(99797),ec=a(66052),ed=a(97210);function eu(e){let{size:t,status:a,isUploaded:r,progress:n,showSuccess:l}=e,i=(0,x.k)("projectSettings");if("processing"===a)return(0,s.jsxs)("div",{className:"inline-flex items-center gap-1 text-gray-500",children:[r?(0,s.jsx)("span",{className:"text-[13px] leading-[18px]",children:i("isIndexing")}):(0,s.jsx)("span",{className:"text-[13px] leading-[18px]",children:i("isUploading")}),n?(0,s.jsxs)("span",{className:"text-[13px] leading-[18px]",children:["(",Math.round(100*n),"%)"]}):null]});if(l)return(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 text-[13px] leading-[18px] text-blue-600",children:[(0,s.jsx)(es.r,{size:12}),i("uploaded")]});if("error"===a)return(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 text-[13px] leading-[18px] text-red-600",children:[(0,s.jsx)(er.N,{size:12}),i("uploadError")]});let o=t?t>1048576?"".concat((t/1048576).toFixed(2),"MB"):"".concat((t/1024).toFixed(2),"KB"):"---";return(0,s.jsx)("div",{className:"inline-flex items-center text-[13px] leading-[18px] text-gray-500",children:o})}function em(e){let{source:t}=e,{metadata:a,url:l,sourceId:i,status:o,title:c,finishedAt:d,isOptimistic:u,progress:m}=t,p=c||"---",[g,f]=(0,r.useState)(!1),b=(0,x.k)("projectSettings"),y=(0,h.LP)(),[N,k]=(0,eo.useDeleteSourceModal)(),{setSource:C}=(0,ec.useRenameSourceModal)();(0,r.useEffect)(()=>{if("success"===o&&d&&Date.now()-new Date(d).getTime()<5e3){f(!0);let e=setTimeout(()=>{f(!1)},5e3);return()=>{clearTimeout(e)}}},[d,o]);let[S,I]=(0,r.useTransition)(),M=(0,r.useCallback)(()=>{l&&I(async()=>{try{let e=new URLSearchParams({url:l,type:"blob"}),t=await fetch("/chat/api/chat/download?".concat(e.toString())),a=await t.blob(),s=window.URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=p,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(s)}catch(e){v.oR.error(b("downloadSourceError",e instanceof Error?e.message:void 0))}})},[l,p,b]),z=(0,r.useMemo)(()=>"processing"!==o&&"error"===o?(0,s.jsx)(n.$,{onClick:()=>{k(i)},size:"sm",variant:"destructive",children:b("delete")}):(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{children:(0,s.jsx)(R.eC,{label:b("openSourceActions")})}),(0,s.jsx)(j.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,s.jsxs)(j.DropdownMenuGroup,{children:[y&&(0,s.jsxs)(j.DropdownMenuItem,{onSelect:()=>{C({sourceId:i,sourceName:p})},children:[(0,s.jsx)(en.Y,{}),(0,s.jsx)("span",{children:b("rename")})]}),l?(0,s.jsxs)(j.DropdownMenuItem,{onSelect:M,disabled:S,children:[(0,s.jsx)(el.f,{}),(0,s.jsx)("span",{children:b("download")}),S?(0,s.jsx)(ed.y,{}):null]}):null,y&&(0,s.jsxs)(j.DropdownMenuItem,{onSelect:()=>{k(i)},variant:"destructive",children:[(0,s.jsx)(w.l,{}),(0,s.jsx)("span",{children:b("delete")})]})]})})]}),[o,b,l,M,S,k,i,C,p,y]);return(0,s.jsx)(R.ck,{className:(0,P.cn)("processing"===o&&"animate-pulse bg-gray-100 odd:bg-gray-100"),suffix:y||l?z:null,children:(0,s.jsxs)("div",{className:"flex flex-col items-start gap-0.5 leading-5",children:[(0,s.jsx)("span",{className:"max-w-[200px] truncate text-sm font-medium sm:max-w-[300px]",children:p}),(0,s.jsx)(eu,{size:null==a?void 0:a.size,status:o,isUploaded:!u,progress:m,showSuccess:g})]})})}function eh(e){let{setSaving:t,projectId:a}=e,l=(0,x.k)("projectSettings"),{sources:i,isLoading:o,revalidateSources:c,setSources:d}=(0,h.py)(a),u=(0,h.LP)(),m=(0,r.useMemo)(()=>i.length||0,[i]),[g,f]=(0,r.useState)(!1),v=(0,r.useMemo)(()=>m>ee._5,[m]),j=(0,r.useMemo)(()=>i.slice(0,g?m:ee._5),[i,g,m]),b=(0,r.useRef)(null),{inputFileRef:y,onInputChange:w,uploading:N,isDraggingFile:k}=(0,ei.Ay)({isSignedIn:!0,disablePaste:!0,dragContainerRef:b,saveToDrafts:!1,onUploadStart:e=>{t(!0),d(t=>[{sourceId:e.id,title:e.name,type:"attachment",url:e.url,content:null,description:null,metadata:null,isOptimistic:!0,status:"processing",progress:null,finishedAt:null},...t||[]],{revalidate:!1})},projectId:a||void 0,onFinish:()=>{t(!1),c()}}),C=(0,r.useMemo)(()=>k?(0,s.jsxs)("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-blue-600 bg-blue-100 shadow-none",children:[(0,s.jsx)(p.cz,{className:"text-sm text-blue-600",children:l("dropHere")}),(0,s.jsx)(p.Ou,{className:"text-sm text-blue-600",children:l("dropHereDescription")})]}):null,[k,l]);return a?o?(0,s.jsx)(R.Zv,{title:l("sources")}):(0,s.jsxs)(R.wn,{label:l("sources"),onAdd:u?()=>{var e;null===(e=y.current)||void 0===e||e.click()}:void 0,info:"Sources let v0 use your files and information in responses.",children:[(0,s.jsxs)("div",{className:"relative flex flex-col",ref:b,"data-sources-drop-container":!0,children:[C,0===m?(0,s.jsx)("div",{className:"transition-all",ref:b,children:(0,s.jsx)(R.pp,{title:l("noSources"),subtitle:l("noSourcesDescription")})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"transition-all",children:j.map(e=>(0,s.jsx)(em,{source:e},e.sourceId))}),(0,s.jsx)(ec.default,{projectId:a}),(0,s.jsx)(eo.default,{projectId:a})]})]}),v&&(0,s.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>f(!g),children:g?l("showLess"):l("showMore")}),(0,s.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:N,multiple:!0,onChange:e=>{w(e)},ref:y,type:"file"})]}):null}var ep=a(4304),ex=a(99625),eg=a(58659);let ef=(0,Z.createServerReference)("6008df97c95357e83a5a3e69c5e2a8876f208b4ee1",Z.callServer,void 0,Z.findSourceMapURL,"updateProjectSettingsInstructions");var ev=a(88551),ej=a(20685),eb=a(98898);function ey(e){let{readOnly:t,projectId:a,initialInstructions:n,textAreaMinHeight:l,buttonVariant:i,onSubmit:o,onFinish:c}=e,[d,u]=(0,r.useState)(n),[m,p]=(0,r.useState)(!1),g=(0,B.useRouter)(),[f,j]=(0,r.useState)(!1),b=(0,x.k)("projectInstructions"),{updateInstructions:y}=(0,h.kL)(a),w=(0,r.useCallback)(async e=>{if(e&&e.preventDefault(),!t){p(!0),null==o||o();try{let e=await ef(a,d);if(!0===e)y(d),v.oR.success("Project Instructions updated"),j(!0),setTimeout(()=>j(!1),1e3),g.refresh();else throw Error(e.error)}catch(e){(0,ev.z)(e,g,"An error occurred while updating instructions")||v.oR.error("Error",{description:"An error occurred while updating instructions."})}finally{p(!1),null==c||c()}}},[t,o,a,d,y,g,c]),{formRef:N,onKeyDown:k}=(0,ex.w)({submitMessage:w,localFileInfos:[]});return(0,s.jsx)(D.Zp,{className:"bg-background flex flex-col border-0 shadow-none",children:(0,s.jsx)("form",{className:"flex flex-1 flex-col",onSubmit:w,ref:N,children:(0,s.jsxs)(D.Wu,{className:"flex flex-1 flex-col gap-3 p-0",children:[(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,s.jsx)("div",{className:"flex flex-1 flex-col",children:(0,s.jsx)(eb.T,{asChild:!0,children:(0,s.jsx)(ej.o,{className:"!pointer-events-auto",disabled:t,id:"instructions",maxLength:5e3,minHeight:l,onChange:e=>u(e.target.value),onKeyDown:k,placeholder:b("placeholder"),value:d})})}),(0,s.jsx)(eg.j,{count:d.length,max:5e3,message:"For larger context, consider using sources.",messageThreshold:5e3})]}),!t&&(0,s.jsx)(ep.Q,{className:"ml-auto w-full","data-testid":"save-instructions-button",disabled:f||d===n||m,pending:m,variant:i,children:b("save")})]})})})}function ew(e){let{setSaving:t,projectId:a}=e,r=(0,x.k)("projectInstructions"),{instructions:l,isLoading:i}=(0,h.kL)(a),o=(0,h.LP)();return a?(0,s.jsx)(R.wn,{label:r("title"),info:"Custom instructions for the model to improve responses.",children:i?(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)(L.E,{className:"h-36 w-full"}),(0,s.jsx)(n.$,{disabled:!0,variant:"secondary",size:"sm",children:r("save")})]}):(0,s.jsx)(ey,{readOnly:!o,projectId:a,initialInstructions:l,textAreaMinHeight:144,buttonVariant:"secondary",onSubmit:()=>{t(!0)},onFinish:()=>{t(!1)}})}):null}var eN=a(18730),ek=a(8899),eC=a(64459),eS=a(38559);let eI=(0,Z.createServerReference)("40bf02b108e48b54ed2b3a5009b0db3f1c5083f381",Z.callServer,void 0,Z.findSourceMapURL,"deleteEnvVars");var eM=a(70505),ez=a(52220),eL=a(15066),eP=a(49293),eR=a(68971);let eD={create:"Add Environment Variables",edit:"Edit Environment Variables",missing:"Missing Environment Variables"};function eE(){let{data:e,mutate:t}=(0,F.Ay)("showEnvModal",null,{fallbackData:!1}),{data:a,mutate:s}=(0,F.Ay)("envModalData",null,{fallbackData:{mode:"create",projectId:"",variables:[{key:"",value:""}]}});return{showEnvModal:e,setShowEnvModal:t,envModalData:a,setEnvModalData:s}}function eA(e){var t;let{v0ProjectId:a}=e,{showEnvModal:n,setShowEnvModal:l,envModalData:i,setEnvModalData:o}=eE(),c=null==i?void 0:i.mode,[d,u]=(0,r.useState)("create"===c?[{key:"",value:""}]:null!==(t=null==i?void 0:i.variables)&&void 0!==t?t:[{key:"",value:""}]),{refetchVercelProject:m}=(0,h.Ok)(a),[p,x]=(0,r.useTransition)(),{refresh:g}=(0,eR.Z)(),{chatId:f}=(0,eN.xz)(),j=(e,t,a)=>{let s=[...d];s[e]={...s[e],[t]:a},u(s)};return(0,s.jsx)(eS.Modal,{open:n,onOpenChange:()=>{l(!n),u([{key:"",value:""}]),o({mode:"create",projectId:a,variables:[{key:"",value:""}]})},children:(0,s.jsxs)("form",{action:()=>{x(async()=>{if(!(null==i?void 0:i.projectId))return;let e=await (0,eP.g)({envVars:d,v0ProjectId:i.projectId,autoCreateVercelProject:!1,chatId:f});e.success||v.oR.error(e.error),m(),l(!1),o({mode:"create",projectId:a,variables:[{key:"",value:""}]}),u([{key:"",value:""}]),g()})},children:[(0,s.jsxs)(eS.ModalHeader,{children:[(0,s.jsxs)(eS.ModalTitle,{className:"flex items-center gap-2 text-xl font-medium",children:["missing"===c&&(0,s.jsx)(eM.A,{className:"h-6 w-6 text-amber-600"}),(0,s.jsxs)("span",{children:[" ",c?eD[c]:"Add Environment Variables"]})]}),"create"===c&&(0,s.jsx)(eS.ModalDescription,{className:"text-muted-foreground text-left",children:"Environment variables will be encrypted and stored securely on Vercel."})]}),(0,s.jsxs)(eS.ModalContent,{children:["missing"===c&&(0,s.jsx)("p",{className:"text-muted-foreground mb-8 text-[15px]",children:"The functionality of this app will be limited without the following environment variables:"}),(0,s.jsx)("div",{className:"space-y-6",children:d.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:"create"===c?(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,s.jsx)(eL.Label,{htmlFor:"key-".concat(t),children:"Key"}),(0,s.jsx)(ez.p,{id:"key-".concat(t),value:e.key,onChange:e=>j(t,"key",e.target.value),placeholder:"API_KEY",className:"h-11 uppercase"})]}):(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(eL.Label,{htmlFor:"value-".concat(t),children:e.key})})}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[c&&"create"!==c?null:(0,s.jsx)(eL.Label,{htmlFor:"value-".concat(t),children:"Value"}),(0,s.jsx)(ez.p,{id:"value-".concat(t),value:e.value,onChange:e=>j(t,"value",e.target.value),placeholder:"my-api-key",className:"h-11"})]})]},t))})]}),(0,s.jsx)(eS.ModalFooter,{className:"border-border bg-muted flex border-t !p-4",children:(0,s.jsx)(ep.Q,{size:"sm",pending:p,children:"Save"})})]})})}function eT(e){let{envVar:t,setOpenDetailsModal:a,setSelectedEnvVar:l}=e,[i,o]=(0,r.useState)(!1),c=(0,x.k)("projectSettings");return(0,s.jsx)(R.ck,{suffix:(0,s.jsx)(R.eC,{onClick:()=>{a(!0),l(t)}}),children:(0,s.jsxs)("div",{className:"flex flex-col items-start gap-0.5 text-[13px] leading-5",children:[(0,s.jsx)("span",{className:"max-w-[200px] truncate font-mono uppercase sm:max-w-[300px]",children:t.key}),(0,s.jsxs)("span",{className:"inline-flex items-center",children:[i?(0,s.jsx)("code",{className:"max-w-[300px] truncate rounded-md bg-gray-200 px-1",children:t.value}):(0,s.jsx)("span",{className:"tracking-widest",children:"••••••••••••••••••"}),(0,s.jsx)(n.$,{variant:"ghost",className:"ml-1 size-5 text-gray-500",onClick:()=>o(!i),"aria-label":c(i?"hideValue":"showValue"),children:i?(0,s.jsx)(eC.X,{}):(0,s.jsx)(y.k,{})}),(0,s.jsx)(n.$,{variant:"ghost",className:"size-5 text-gray-500",onClick:()=>{navigator.clipboard.writeText(t.value),v.oR.success("Copied value of ".concat(t.key.toUpperCase()," to clipboard"))},"aria-label":"Copy",children:(0,s.jsx)(ek.Q,{})})]})]})})}function eF(e){let{setSaving:t,vercelProjectId:a,v0ProjectId:l}=e,[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),{envVars:u,isLoading:m,refetchVercelProject:p}=(0,h.Ok)(null!=l?l:void 0),g=u?Object.keys(u).length:0,[f,j]=(0,r.useTransition)(),{setEnvModalData:b,setShowEnvModal:y}=eE(),[w,N]=(0,r.useState)(!1),k=(0,x.k)("projectSettings"),C=(0,h.LP)(),{chatId:S}=(0,eN.xz)(),{refresh:I}=(0,eR.Z)(),M=(0,r.useCallback)(()=>{i&&l&&a&&(t(!0),j(async()=>{(await eI({envVarId:i.id,v0ProjectId:l,vercelProjectId:a,chatId:S})).success?v.oR.success(k("envVarDeleteSuccess",i.key)):v.oR.error(k("envVarDeleteError",i.key)),d(!1),p(),I()}))},[i,l,a,t,S,p,I,k]),L=(0,r.useCallback)(()=>{l&&(b({mode:"create",projectId:l}),y(!0))},[b,y,l]),P=(0,r.useMemo)(()=>u?Object.values(u).sort((e,t)=>{let a=e.updatedAt||e.createdAt;return(t.updatedAt||t.createdAt)-a}).slice(0,w?g:ee._5):[],[g,u,w]),D=(0,r.useMemo)(()=>g>ee._5,[g]);return m?(0,s.jsx)(R.Zv,{title:k("environmentVariables")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(R.wn,{label:k("environmentVariables"),info:"Store sensitive data like API keys. Synced with Vercel.",onAdd:C&&a?L:void 0,children:[0===g?(0,s.jsx)(R.pp,{title:k("noEnvVars"),subtitle:k("envVarSubtitle",a)}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:P.map(e=>(0,s.jsx)(eT,{envVar:e,setOpenDetailsModal:d,setSelectedEnvVar:o},e.id))}),D&&(0,s.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>N(!w),children:w?k("showLess"):k("showMore")})]}),(0,s.jsxs)(eS.Modal,{open:c,onOpenChange:d,children:[(0,s.jsx)(eS.ModalHeader,{children:(0,s.jsx)(eS.ModalTitle,{className:"flex items-center gap-2",children:k("envVarDetails")})}),(0,s.jsx)(eS.ModalContent,{children:(0,s.jsx)(z.oL,{envVar:i})}),C&&(0,s.jsx)(eS.ModalFooter,{className:"border-border bg-muted flex border-t !p-4",children:(0,s.jsx)(ep.Q,{size:"sm",pending:f,variant:"destructive",onClick:M,disabled:f,children:k("delete")})})]})]}),(0,s.jsx)(eA,{v0ProjectId:null!=l?l:""})]})}var eO=a(31508),eU=a(7228),eV=a(40683),e_=a(94944);function eB(e){var t;let{vercelProjectWithDashboard:a,isLoading:r}=e,{gs:n}=(0,_.D)();return n?r?(0,s.jsx)(eq,{}):(null==a?void 0:null===(t=a.dashboardProject)||void 0===t?void 0:t.link)?(0,s.jsx)(eH,{dashboardProject:a.dashboardProject,vercelProject:a.project,link:a.dashboardProject.link}):(0,s.jsx)(e$,{vercelProjectWithDashboard:a}):null}function eH(e){var t,a;let{dashboardProject:n,vercelProject:l,link:i}=e,[o]=(0,r.useTransition)(),c=(0,x.k)("projectSettings");return(0,s.jsx)(R.wn,{label:c("git"),info:"Your v0 project is linked to this Git repository.",children:(0,s.jsxs)("div",{className:(0,P.cn)("flex h-[62px] w-full items-center justify-between rounded-lg border p-3",o&&"opacity-50"),children:[(0,s.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,s.jsx)("p",{className:"text-sm font-medium leading-5 text-gray-900",children:i.repo}),(0,s.jsx)("div",{className:"flex items-center gap-0.5 text-[13px] leading-[16px] text-gray-500",children:i.type})]}),(0,s.jsxs)(j.DropdownMenu,{children:[(0,s.jsx)(j.DropdownMenuTrigger,{disabled:o,children:(0,s.jsx)(R.eC,{className:"size-7",label:c("manageVercelProject")})}),(0,s.jsx)(j.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,s.jsxs)(j.DropdownMenuGroup,{children:[(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:"".concat(l.url,"/settings/git"),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(e_.Y,{}),(0,s.jsx)("span",{children:c("manageGit")})]}),(0,s.jsx)(m.i,{className:"size-3"})]})}),(0,s.jsx)(j.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:"https://github.com/".concat(null===(t=n.link)||void 0===t?void 0:t.org,"/").concat(null===(a=n.link)||void 0===a?void 0:a.repo),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(eV.P,{className:"size-3"}),(0,s.jsx)("span",{children:c("viewOnGit","github"===i.type?"GitHub":i.type)})]}),(0,s.jsx)(m.i,{className:"size-3"})]})})]})})]})]})})}function e$(e){let{vercelProjectWithDashboard:t}=e,a=(0,x.k)("projectSettings");return(null==t?void 0:t.project)?(0,s.jsx)(R.wn,{label:a("git"),info:"Your v0 project is linked to this Git repository.",children:(0,s.jsx)(n.$,{asChild:!0,variant:"secondary",children:(0,s.jsxs)("a",{href:"".concat(t.project.url,"/settings/git"),target:"_blank",rel:"noopener noreferrer",children:["Connect to Git",(0,s.jsx)(m.i,{className:"size-3"})]})})}):null}function eq(){let e=(0,x.k)("projectSettings");return(0,s.jsx)(R.wn,{label:e("vercelProject"),children:(0,s.jsxs)("div",{className:"flex h-[62px] items-center justify-between rounded-lg border p-3",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-between gap-2",children:[(0,s.jsx)(L.E,{className:"h-3 w-40"}),(0,s.jsx)(L.E,{className:"h-3 w-16"})]}),(0,s.jsx)(n.$,{className:"relative size-7 text-gray-500",size:"sm",variant:"ghost",disabled:!0,children:(0,s.jsx)(b.a,{})})]})})}let eW=(0,Z.createServerReference)("40fe726d53c28c55c862f07b078620a0b4334dc496",Z.callServer,void 0,Z.findSourceMapURL,"createIntegrationLinkAction");var eZ=a(43665),eG=a(48473);async function eK(e){let{v0ProjectId:t,chatId:a,integration:s,dashboardProject:r,teamSlug:n,source:l,messageId:i,needPrefix:o}=e;if(!t)return"";let c=await eW({projectId:t,chatId:a||void 0,integrationId:s.id,integrationName:s.name,source:l,messageId:i});if(!c.success)return v.oR.error("Failed to start integration setup process."),"";let d=s.parentSlug||s.slug,u=new URLSearchParams;return(u.set("v0pid",t),u.set("token",c.token),o&&u.set("needPrefix","true"),s.parentSlug&&u.set("productId",s.id),r)?"https://vercel.com/v0/".concat(n,"/").concat(r.name,"/").concat(d,"?").concat(u.toString()):"https://vercel.com/v0/".concat(n,"/").concat(d,"?").concat(u.toString())}function eY(e){var t;let{v0ProjectId:a,chatTitle:v,isSheetOpen:j,onOpenChange:b,initiatePolling:y}=e,{mi:w}=(0,_.D)(),N=(0,x.k)("projectSettings"),k=(0,B.usePathname)(),{vercelProjectWithDashboard:C,isLoading:S}=(0,h.Ok)(a),{activeScope:I}=(0,W.k6)(),M=(0,eO._)(),{reassignPending:z,handleReassignProject:L}=(0,f.Z)(),{chatId:P}=(0,eN.xz)(),[R,D]=(0,r.useState)(!1),[E,A]=(0,r.useState)(!1),[F,O]=(0,r.useState)(!1),{activeScopeSlug:U}=(0,W.k6)(),{refetchVercelProject:V}=(0,h.Ok)(a),H=(0,r.useCallback)(e=>{b?b(e):D(e)},[b]),$=(0,r.useMemo)(()=>k.split("/").includes("projects"),[k]),q=(0,r.useCallback)(e=>{e.preventDefault(),e.target instanceof Element&&e.target.closest("[data-sources-drop-container]")||e.stopPropagation()},[]);return(0,s.jsxs)(l.cj,{open:void 0!==j?j:R,onOpenChange:e=>{H(e),!e&&E&&setTimeout(()=>{A(!1)},300)},children:[(0,s.jsx)(l.CG,{asChild:!0,children:(0,s.jsx)(n.$,{"aria-label":N("label"),className:"size-7 rounded-md px-1 py-1.5 text-gray-900",size:"sm",variant:"ghost",tooltip:{side:"bottom",content:"Project Settings"},children:(0,s.jsx)(o.H,{})})}),(0,s.jsx)(l.h,{className:"pointer-events-auto flex w-screen flex-col gap-0 p-0 data-[state=closed]:duration-300 data-[state=open]:duration-300 sm:max-w-[500px]","aria-describedby":void 0,onInteractOutside:e=>{F&&e.preventDefault()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onMouseLeave:e=>{e.preventDefault(),e.stopPropagation()},onDrop:q,side:"right",showClose:!1,children:E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Fm,{className:"sticky gap-1 border-b p-4",children:[(0,s.jsxs)(l.qp,{className:"flex items-center gap-2 text-base",children:[(0,s.jsx)(n.$,{"aria-label":"Go back",size:"xs",variant:"ghost",onClick:()=>{V(),A(!1)},children:(0,s.jsx)(c.n,{})}),"Integrations"," ",(0,s.jsx)(et.E,{variant:"blue",size:"sm",children:"Beta"})]}),(0,s.jsx)(l.Qs,{className:"text-left text-sm text-gray-900",children:"The following integrations are recommended for v0."})]}),(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)(eU.c,{isV3:!1}),children:(0,s.jsx)(eU.n,{isV3:!1,vercelProjectId:null==C?void 0:C.project.id,onIntegrationClick:async(e,t)=>{let s=await eK({v0ProjectId:a||"",chatId:P||"",integration:e,dashboardProject:null==C?void 0:C.dashboardProject,teamSlug:I&&(0,eZ.W)(I)?null!=M?M:"":null!=U?U:"",source:"settings",needPrefix:t});null==y||y(),s&&window.open(s,"_blank","width=1200,height=800")},vercelProjectName:null!==(t=null==C?void 0:C.project.name)&&void 0!==t?t:"",teamSlug:I&&(0,eZ.W)(I)?null!=M?M:"":null!=U?U:""})})]}):a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Fm,{className:"sticky gap-1 border-b p-4 text-left",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,s.jsx)(l.qp,{className:"text-base",children:N("label")}),(0,s.jsxs)("div",{className:"flex gap-2",children:[!$&&(0,s.jsx)(T(),{href:"/chat/projects/".concat(a),target:"_blank",children:(0,s.jsxs)(n.$,{variant:"outline",className:"h-7 rounded-md",size:"sm",children:["View Project ",(0,s.jsx)(m.i,{})]})}),(0,s.jsx)(l.kN,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"outline",className:"size-7",size:"sm",children:(0,s.jsx)(u.F,{})})})]})]}),(0,s.jsx)(l.Qs,{className:"text-sm text-gray-900",children:N("description")})]}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-4 overflow-y-auto p-4",children:[(0,s.jsx)(K,{setSaving:O,vercelProjectWithDashboard:C,isLoading:S,v0ProjectId:a,closeSettingsSheet:()=>H(!1)}),(0,s.jsx)(eB,{vercelProjectWithDashboard:C,isLoading:S}),(0,s.jsx)(eF,{setSaving:O,vercelProjectId:null==C?void 0:C.project.id,v0ProjectId:a}),w&&(0,s.jsx)(ea,{vercelProject:null==C?void 0:C.project,onAdd:()=>A(!0),teamSlug:I&&(0,eZ.W)(I)?null!=M?M:"":null!=U?U:""}),(0,s.jsx)(eh,{setSaving:O,projectId:a}),(0,s.jsx)(ew,{setSaving:O,projectId:a})]})]}):(0,s.jsxs)("div",{className:"bg-muted flex grow flex-col items-center justify-center gap-4 rounded-md px-9 py-12",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(p.Ft,{children:(0,s.jsx)(d.z,{})}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:"Add to a Project"}),(0,s.jsx)("p",{className:"text-center text-sm text-gray-500",children:"Add this chat to a project to add instructions, sources, environment variables, integrations, and more."})]}),(0,s.jsx)(g.o,{className:"w-auto",handleProjectSelect:L,projectName:v,onSuccess:e=>{P&&(0,eG.M)({payload:{chatId:P,projectId:e}})},quickCreate:!0,align:"center",triggerButton:(0,s.jsxs)(n.$,{size:"sm",variant:"secondary",disabled:z,children:[(0,s.jsx)(i.F,{}),"Add Project"]}),disabled:z})]})})]})}},46902:(e,t,a)=>{"use strict";function s(e){return e.startsWith("image/")&&!e.includes("svg")}function r(e){return(e/1048576).toFixed(2).replace(/\.?0+$/,"")+"MB"}a.d(t,{IG:()=>r,Lu:()=>i,Ye:()=>s,lg:()=>l});let n=["text/plain","text/markdown","text/html","application/json","text/csv","text/x-python","application/typescript","text/tsx","text/jsx","text/markdown","text/html","text/css","application/yaml","application/yml","application/sql","application/x-sql","application/xml"],l=["txt","md","json","csv","py","ts","tsx","js","jsx","log","html","css","yml","yaml","mermaid","mjs","mts","sql","map","xml"];function i(e,t){return n.includes(e)||l.includes(t)}},47587:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Checkbox:()=>c});var s=a(7336),r=a(80644),n=a(27020),l=a(4495),i=a(24582);let o=(0,a(15122).F)("disabled:bg-gray-150 disabled:hover:bg-gray-150 bg-background focus-visible:ring-offset-background peer size-4 shrink-0 rounded-sm border border-gray-400 text-gray-900 ring-blue-600 hover:border-gray-500 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:border-gray-300 disabled:hover:border-gray-300 data-[state=checked]:text-white",{variants:{variant:{default:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600",black:"data-[state=checked]:border-gray-900 data-[state=checked]:bg-gray-900"}},defaultVariants:{variant:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,...c}=e;return(0,s.jsx)(n.bL,{className:(0,l.cn)(o({variant:r,className:a})),ref:t,...c,children:(0,s.jsx)(n.C1,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(i.J,{className:"size-2.5"})})})});c.displayName=n.bL.displayName},48166:(e,t,a)=>{"use strict";a.d(t,{ProjectPageHeader:()=>S});var s=a(7336),r=a(80644),n=a(81616),l=a(38230),i=a.n(l),o=a(8999),c=a(88293),d=a(45453),u=a(85625),m=a(24607),h=a(9097),p=a(24582),x=a(86358),g=a(25867),f=a(15993),v=a(88551),j=a(58146),b=a(10299),y=a(45419);function w(e){let{initialTitle:t,projectId:a}=e,{projectName:l,updateProjectName:i}=(0,y.OT)(),[o,c]=(0,r.useState)(l||t),[d,u]=(0,r.useState)(!1),[m,w]=(0,r.useState)(!1),N=(0,b.useRouter)(),k=(0,r.useRef)(l||t),C=(0,r.useRef)(null);(0,r.useEffect)(()=>{d||(c(l||t),k.current=l||t)},[l,t,d]),(0,r.useEffect)(()=>{var e;d&&(null===(e=C.current)||void 0===e||e.focus())},[d]);let S=()=>{u(!0),k.current=o},I=()=>{u(!1),c(k.current)};async function M(e){w(!0);let t=e.get("name"),s=k.current;if(u(!1),c(t),t===s){w(!1);return}i(t),f.oR.success("Renamed project");try{let e=await (0,j.o)({projectId:a,name:t});if(!("success"in e)&&e.error)throw Error(e.error)}catch(e){i(s),c(s),u(!0),(0,v.z)(e,N,"Failed to rename project")||f.oR.error("Failed to rename project")}w(!1)}let z=(0,s.jsxs)("div",{className:"relative h-8 overflow-hidden",children:[(0,s.jsx)("input",{autoComplete:"off",className:(0,h.cn)("absolute inset-0 h-8 max-w-96 translate-y-[0.5px] border-b text-xl font-semibold leading-relaxed tracking-tight focus:!border-gray-500 focus:outline-none",!d&&"hidden"),"data-1p-ignore":!0,disabled:!d,id:"name",name:"name",onChange:e=>c(e.target.value),onKeyDown:e=>{"Escape"===e.key&&I()},ref:C,value:o}),(0,s.jsx)("h1",{className:(0,h.cn)("line-clamp-1 size-fit max-w-[150px] overflow-hidden whitespace-pre text-xl font-semibold leading-relaxed tracking-tight sm:max-w-96",d&&"invisible"),id:"name",children:o})]}),L=d?(0,s.jsxs)("div",{className:"gap animate-in slide-in-from-left-5 mb-0.5 flex",children:[(0,s.jsx)("div",{children:(0,s.jsx)(n.$,{"aria-label":"Update",className:"size-7",disabled:m,type:"submit",variant:"ghost",children:(0,s.jsx)(p.J,{className:"size-4"})})}),(0,s.jsx)(n.$,{"aria-label":"Cancel",className:"size-7",onClick:I,onTouchStart:I,type:"button",variant:"ghost",children:(0,s.jsx)(x.F,{className:"size-4"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{"aria-label":"Edit Project Name",className:"animate-in sm:slide-in-from-left-4 absolute inset-0 mb-0.5 items-center justify-end sm:hidden sm:cursor-text sm:group-hover:flex",onClick:S,type:"button",children:(0,s.jsx)(g.g,{className:"hidden size-3.5 translate-x-6 cursor-pointer sm:block"})}),(0,s.jsx)(n.$,{"aria-label":"Edit Project Name",className:"mb-0.5 inline-flex size-7 sm:hidden",onClick:S,type:"button",variant:"ghost",children:(0,s.jsx)(g.g,{className:"size-3.5"})})]});return(0,s.jsxs)("form",{className:"group relative flex items-center gap-2",onSubmit:async e=>{e.preventDefault();let t=new FormData(e.currentTarget);await M(t)},onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&d&&e.currentTarget.requestSubmit()},children:[z,L]})}var N=a(99876),k=a(4495),C=a(39695);function S(e){var t;let{project:a,canMakeProjectUpdates:r,projectAuthorData:n}=e;return a&&n?(0,s.jsx)("header",{className:"w-full px-4 pb-2 pt-9",children:(0,s.jsx)("div",{className:"mx-auto w-full max-w-screen-md",children:(0,s.jsxs)("div",{className:"flex flex-col items-start gap-3",children:[(0,s.jsx)(d.R,{color:a.color,readOnly:!r,icon:(0,u.KI)(a.icon),projectId:a.projectId}),(0,s.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,s.jsx)(w,{initialTitle:a.name,projectId:a.projectId}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m.AvatarUser,{size:"xs",userId:n.id}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-500",children:null!==(t=n.username)&&void 0!==t?t:"Vercel User"})]})]})]})})}):(0,s.jsx)(I,{})}function I(){let e=(0,C.t)();return(0,s.jsx)("header",{className:"bg-background grid auto-rows-min gap-4 border-b p-4 sm:p-6",children:(0,s.jsxs)("div",{className:"mx-auto w-full",children:[(0,s.jsxs)("div",{className:(0,k.cn)("flex h-8 items-center gap-2 sm:h-auto",!e&&"pl-9 sm:pl-0"),children:[(0,s.jsx)(N.SidebarTrigger,{}),(0,s.jsx)(c.Separator,{className:"bg-alpha-400 mr-2 h-6 sm:hidden",orientation:"vertical"}),(0,s.jsx)(n.$,{asChild:!0,className:"font-normal text-gray-500",size:"sm",variant:"link",children:(0,s.jsxs)(i(),{href:"/chat/projects",prefetch:!0,children:[(0,s.jsx)(o.n,{className:"size-4"}),(0,s.jsx)("span",{children:"All Projects"})]})})]}),(0,s.jsxs)("div",{className:"flex flex-col items-start justify-center gap-3 pt-4",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"New Project"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"You can attach resources and files to a project after it's been created."})]})]})})}},48195:(e,t,a)=>{"use strict";a.d(t,{E:()=>r});var s=a(30009);let r=(0,s.createServerReference)("408a5bd66d05cbbf4c1459efbb0e6053cf2518c310",s.callServer,void 0,s.findSourceMapURL,"newProjectAction")},48222:(e,t,a)=>{"use strict";a.d(t,{G4:()=>l});var s=a(7336);let r="0 0 ".concat(16," ").concat(16),n={top:"text-top",bottom:"text-bottom",middle:"middle",initial:null},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:a="currentColor",size:l,width:i,height:o,viewBox:c=r}=t;return function(t){let r=Math.random().toString(36).slice(2,11),{size:d,color:u=a||"currentColor",align:m="initial",className:h,width:p,height:x,style:g,...f}=t,v=n[m],j=l||16,b=e.replace(/__ADD_ID__/g,r);return(0,s.jsx)("svg",{className:h,dangerouslySetInnerHTML:{__html:b},"data-testid":"geist-icon",height:j,strokeLinejoin:"round",style:{...g,verticalAlign:v||void 0,width:i||p||d,height:o||x||d,color:u},viewBox:c,width:j,...f},r)}}},48473:(e,t,a)=>{"use strict";a.d(t,{M:()=>r});var s=a(30009);let r=(0,s.createServerReference)("400fd8e102a148af62218049fc8eaa786c4f9f36ad",s.callServer,void 0,s.findSourceMapURL,"assignProjectToChat")},48963:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var s=a(7336),r=a(81616),n=a(4495);function l(e){let{className:t,outline:a,active:l,...i}=e;return(0,s.jsx)(r.$,{className:(0,n.cn)("size-6 rounded-md",!a&&"text-gray-500",l&&"text-teal-600",t),size:"xs",variant:a?"secondary":"ghost",...i})}},49293:(e,t,a)=>{"use strict";a.d(t,{g:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40891013c8e4edd4dd5814199bcce1f78c1528535c",s.callServer,void 0,s.findSourceMapURL,"createEnvVars")},50809:(e,t,a)=>{"use strict";a.d(t,{DEFAULT_CHAT_MODEL_IMAGE_CONFIG:()=>r,f:()=>l});var s=a(59103);let r={maxSizeBytes:3932160,maxDimensionsPixels:{short:8e3,long:8e3},maxPerChat:20},n={attachmentMaxSizeBytes:3932160,contextWindow:199999,image:r};function l(){let{data:e}=(0,s.Ay)("model-config");return null!=e?e:n}},51372:(e,t,a)=>{"use strict";a.r(t),a.d(t,{IconPicker:()=>x,IconPickerContent:()=>g,IconPickerSkeleton:()=>v});var s=a(7336),r=a(80644),n=a(81616),l=a(86807),i=a(4495),o=a(85328),c=a(38559),d=a(50688),u=a(32921),m=a(85625);let h=r.createContext(null),p=()=>{let e=r.useContext(h);if(!e)throw Error("useIconPicker must be used within an IconPicker");return e},x=r.forwardRef((e,t)=>{let{children:a,className:n,trigger:d,icon:u,onValueChange:m,...p}=e,x=(0,o.al)(480),[g,f]=r.useState(!1);return(0,s.jsx)(h.Provider,{value:{icon:u,onValueChange:m,open:g,setOpen:f},children:x?(0,s.jsxs)(c.Modal,{onOpenChange:f,open:g,trigger:d,children:[(0,s.jsx)("div",{className:"sr-only",children:(0,s.jsxs)(c.ModalHeader,{children:[(0,s.jsx)(c.ModalTitle,{children:"Change icon"}),(0,s.jsx)(c.ModalDescription,{children:"Change the icon and color of your project."})]})}),(0,s.jsx)(c.ModalContent,{className:"p-0",children:a})]}):(0,s.jsxs)(l.AM,{onOpenChange:f,open:g,children:[(0,s.jsx)(l.Wv,{asChild:!0,children:d}),(0,s.jsx)(l.hl,{align:"start",className:(0,i.cn)("w-auto",n),ref:t,sideOffset:8,...p,children:a})]})})});function g(e){let{...t}=e,{setOpen:a,icon:r,onValueChange:n}=p();return(0,s.jsx)("div",{...t,children:(0,s.jsx)(f,{onValueChange:e=>{n({...r,name:e}),a(!1)},value:r.name})})}x.displayName="IconPicker";let f=r.memo(r.forwardRef((e,t)=>{let{value:a,onValueChange:l,className:o,...c}=e,[d,h]=r.useState(0),p=r.useCallback(e=>{switch(e.key){case"ArrowRight":h(e=>(e+1)%m.RN.length);break;case"ArrowLeft":h(e=>(e-1+m.RN.length)%m.RN.length);break;case"ArrowDown":h(e=>(e+10)%m.RN.length);break;case"ArrowUp":h(e=>(e-10+m.RN.length)%m.RN.length);break;case"Enter":-1!==d&&l(m.RN[d])}},[d,l]),x=r.useCallback(e=>{l(e)},[l]),g=r.useCallback(e=>{h(e)},[]),f=r.useCallback(e=>{h(e)},[]);return r.useEffect(()=>{if(-1!==d){var e;null===(e=document.querySelector('[data-index="'.concat(d,'"]')))||void 0===e||e.focus()}},[d]),(0,s.jsx)("div",{className:(0,i.cn)("grid min-h-[208px] grid-cols-10 gap-2 overflow-y-auto p-2",o),onKeyDown:p,...c,ref:t,children:Object.entries(u.b).map((e,t)=>{let[r,l]=e;return(0,s.jsx)(n.$,{"aria-label":r,className:"aspect-square w-8 shrink-0 text-gray-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 focus-visible:ring-offset-white data-[active=true]:bg-gray-200 data-[active=true]:text-black","data-active":r===a,"data-index":t,onClick:()=>x((0,m.KI)(r)),onFocus:()=>g(t),onMouseEnter:()=>g(t),onMouseLeave:()=>f(-1),size:"sm",title:r,variant:"ghost",children:(0,s.jsx)(l,{})},r)})})}));f.displayName="IconPickerItems";let v=()=>(0,s.jsx)("div",{className:"grid grid-cols-10 gap-2 overflow-y-auto p-2",children:Array.from({length:50}).map((e,t)=>(0,s.jsx)("div",{className:"flex aspect-square w-8 shrink-0 items-center justify-center",children:(0,s.jsx)(d.E,{className:"aspect-square w-4 shrink-0 rounded-md bg-gray-200"})},t))})},52106:(e,t,a)=>{"use strict";a.d(t,{SidebarRecents:()=>c});var s=a(7336),r=a(99876),n=a(11913),l=a(67921),i=a(80644),o=a(22705);function c(e){let{v3:t=!1,maxChats:a=50,noMoreMenu:r=!1,noActiveChat:n=!1}=e;return(0,s.jsx)(i.Suspense,{fallback:(0,s.jsx)(m,{numChats:a<5?a:Math.floor(a/2)}),children:(0,s.jsx)(d,{v3:t,maxChats:a,noMoreMenu:r,noActiveChat:n})})}function d(e){let{v3:t,maxChats:a,noMoreMenu:i,noActiveChat:c}=e,{data:{history:d}}=(0,o.j)({},"getChats"),m=d.slice(0,a),h=m.length?(0,s.jsx)(s.Fragment,{children:m.map(e=>{let a=e.title||"Untitled Chat";return(0,s.jsxs)(r.SidebarListItem,{children:[(0,s.jsx)(r.SidebarListItemLink,{noActive:c,href:"/chat/".concat(t?"v3/":"").concat((0,l.D)(e.chatId,e.title)),children:(0,s.jsx)("span",{title:a,children:a})}),i?null:(0,s.jsx)(r.SidebarListItemAction,{children:(0,s.jsx)(n.ChatActions,{chat:e,side:"right",tooltip:{content:"",hidden:!0}})})]},e.chatId)})}):(0,s.jsx)(r.SidebarEmptyState,{children:"You haven't created any chats yet."});return(0,s.jsx)(u,{children:(0,s.jsx)(r.SidebarList,{children:h})})}function u(e){let{children:t}=e;return(0,s.jsxs)(r.SidebarSection,{children:[(0,s.jsx)(r.SidebarLabel,{children:"Recents"}),t]})}function m(e){let{numChats:t}=e;return(0,s.jsx)(u,{children:(0,s.jsx)(r.SidebarListSkeleton,{length:t})})}},52295:(e,t,a)=>{"use strict";a.d(t,{DS:()=>s,Of:()=>n,_b:()=>r});let s=["javascript","typescript","python","sql"],r=["js","jsx","mjs","cjs","ts","tsx","mts","cts","py","sql"];function n(e){switch(e){case"plaintext":case"slim":case"shaderlab":return"text";case"bat":return"batch";case"dockercompose":return"yaml";case"git-rebase":case"git-commit":return"markdown";case"typescriptreact":return"tsx";case"javascriptreact":case"svelte":case"astro":return"jsx";case"jsonc":return"json5";case"objective-c":case"objective-cpp":return"objectivec";case"perl6":return"perl";case"shellscript":return"bash";case"terraform":return"hcl";case"bibtex":return"tex";case"cuda-cpp":return"cpp";case"jade":return"pascal";case"vue":case"vue-html":return"html";case"xsl":return"xml";default:return e}}},52735:(e,t,a)=>{"use strict";a.d(t,{Fb:()=>i,Og:()=>o,i_:()=>l,ru:()=>n});var s=a(7336),r=a(18742);let n=e=>{let{refinementElements:t,prompt:a}=e,s="<user_request_context>";for(let{file:e,componentName:a,sourceContext:r}of t)s+="\nUser's request is specifically about the file \"".concat(e,'" and the ').concat(a?'"'.concat(a,'" element'):"element"," at this specific position (including its inner content, too):\n\n```\n").concat(r,"\n```\n");return s+"Please apply a Quick Edit to this file and make the necessary changes.\n\n</user_request_context>\n\n<user_request>\n".concat(a,"\n</user_request>\n")},l=(e,t)=>{let a=e.split("<user_request>")[0];return"".concat(a,"\n<user_request>\n").concat(t,"\n</user_request>\n")},i=e=>e&&e.includes("<user_request>")?e.split("<user_request>")[1].split("</user_request>")[0].trim():e,o=e=>{if(!e)return"Refine";let t=e.match(/"([^"]+)" element/);if(!t)return"Refine";let a=e.match(/file "([^"]+)"/);return a?(0,s.jsxs)(s.Fragment,{children:[a[1],(0,s.jsx)(r.c,{className:"-mx-1 size-3"}),t[1]]}):"Refine"}},54851:(e,t,a)=>{"use strict";a.d(t,{Y:()=>r});var s=a(80644);function r(e){let[t,a]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),l=(0,s.useRef)(null),i=(null==e?void 0:e.containerRef)||l,o=(0,s.useRef)(null),c=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=i.current,t=o.current,s=c.current;if(!e||!t||!s)return;let r={root:e,threshold:0},l=new IntersectionObserver(e=>{let[t]=e;a(!t.isIntersecting)},r),d=new IntersectionObserver(e=>{let[t]=e;n(!t.isIntersecting)},r);return l.observe(t),d.observe(s),()=>{l.disconnect(),d.disconnect()}},[i]),{showTopBorder:t,showBottomBorder:r,containerRef:i,topRef:o,bottomRef:c}}},55074:(e,t,a)=>{"use strict";a.d(t,{BM:()=>c,Cs:()=>p,a0:()=>h,jP:()=>m});var s=a(27007),r=a(94585),n=a(72478),l=a(7222),i=a(88860);let o=new Map,c=(0,r.G)(o,()=>({awaitingChatSubmissionResponse:(0,s.eU)(!1),isStreaming:(0,s.eU)(!1),isStreamingBlock:(0,s.eU)(!1),lastStableBlock:(0,s.eU)(null),forkKeyCache:(0,s.eU)({}),userInitiatedAbort:(0,s.eU)(!1),getChatData:(0,s.eU)(n.F),getDeploymentInfo:(0,s.eU)(n.F),getChatPermissions:(0,s.eU)(n.F),getProjectForChat:(0,s.eU)(n.F)})),d=new Map,u=new Map,m=(0,r.G)(d,e=>{let t=c(e);return{...t,isAuthor:(0,s.eU)(e=>e(t.getChatPermissions).isAuthor),canWriteToChat:(0,s.eU)(e=>!!e(t.getChatPermissions).canWriteToChat),projectInfo:(0,s.eU)(e=>{let a=e(t.getProjectForChat);return!a||"error"in a?null:a}),activeForkKey:(0,s.eU)(e=>e(t.getChatData).activeForkKey),activeBlock:(0,s.eU)(e=>e(t.getChatData).activeBlock),hasMessages:(0,s.eU)(e=>e(t.getChatData).messages.length>0),messages:(0,s.eU)(e=>e(t.getChatData).messages),title:(0,s.eU)(e=>e(t.getChatData).title)}}),h=(0,r.G)(u,(e,t)=>({editingContent:(0,s.eU)(a=>{var s;let r=a(t).find(t=>t.id===e);return r&&"user"===r.role&&null!==(s=r.editingContent)&&void 0!==s?s:null}),editingAttachments:(0,s.eU)(a=>{var s;let r=a(t).find(t=>t.id===e);return r&&"user"===r.role&&null!==(s=r.editingAttachments)&&void 0!==s?s:null})}));function p(e){let t=c(e);return{setChatData:e=>l.M.set(t.getChatData,e),setActiveBlock:e=>{let a=l.M.get(t.getChatData);l.M.set(t.getChatData,{...a,activeBlock:e})},setIsStreamingBlock:e=>l.M.set(t.isStreamingBlock,e),setLastStableBlock:e=>l.M.set(t.lastStableBlock,e),setChatPermissions:e=>l.M.set(t.getChatPermissions,e),setAwaitingChatSubmissionResponse:e=>l.M.set(t.awaitingChatSubmissionResponse,e),setIsStreaming:e=>l.M.set(t.isStreaming,e),setMessages:e=>l.M.set(t.getChatData,{...l.M.get(t.getChatData),messages:e}),setChatTitle:e=>l.M.set(t.getChatData,{...l.M.get(t.getChatData),title:e}),setActiveForkKey:e=>l.M.set(t.getChatData,{...l.M.get(t.getChatData),activeForkKey:e}),updateForkKeyCache:e=>l.M.set(t.forkKeyCache,e),addToForkKeyCache:(e,a)=>l.M.set(t.forkKeyCache,{...l.M.get(t.forkKeyCache),[e]:a}),updateActiveForkKey:e=>{let a=l.M.get(t.getChatData);l.M.set(t.getChatData,{...a,activeForkKey:e})},appendMessage:e=>{let a=l.M.get(t.getChatData);l.M.set(t.getChatData,{...a,messages:[...a.messages,e]})},updateMessage:(e,a)=>{let s=l.M.get(t.getChatData);l.M.set(t.getChatData,{...s,messages:s.messages.map(t=>t.id===e?{...t,...a}:t)})},removeMessage:e=>{let a=l.M.get(t.getChatData);l.M.set(t.getChatData,{...a,messages:a.messages.filter(t=>t.id!==e)})},updateMessageAttachments:(e,a)=>{let s=l.M.get(t.getChatData),r=s.messages.find(t=>t.id===e);if(!r||"user"!==r.role)return;let n={...r,attachments:[...r.attachments||[],...a]};l.M.set(t.getChatData,{...s,messages:s.messages.map(t=>t.id===e?n:t)})},updateMessageEditingContent:(e,a,s)=>{let r=l.M.get(t.getChatData),n=r.messages.find(t=>t.id===e);if(!n||"user"!==n.role)return;let i={...n,editingContent:a,editingAttachments:s};l.M.set(t.getChatData,{...r,messages:r.messages.map(t=>t.id===e?i:t)})},setUserInitiatedAbort:e=>l.M.set(t.userInitiatedAbort,e),abortStreaming:()=>{if(!l.M.get(t.isStreaming))return;l.M.set(t.userInitiatedAbort,!0),(0,i.mU)(e);let a=l.M.get(t.getChatData);if(a.messages.length>0){let e=a.messages[a.messages.length-1];"assistant"===e.role&&l.M.set(t.getChatData,{...a,messages:[...a.messages.slice(0,-1),{...e,streaming:!1}]})}l.M.set(t.isStreaming,!1)}}}},55330:(e,t,a)=>{"use strict";a.d(t,{L:()=>r});var s=a(80644);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,a]=(0,s.useState)(new Set(e));return{values:[...t],has:e=>t.has(e),toggle:e=>a(t=>new Set(t.delete(e)?t:t.add(e))),clear:()=>a(new Set)}}},55556:(e,t,a)=>{"use strict";a.d(t,{A2:()=>r.A,F7:()=>i,GP:()=>l,L5:()=>n});var s=a(22931),r=a(93881);function n(e){let{blockType:t}=e,a="";for(let r of e.files.toSorted((e,t)=>e.moveToEnd&&!t.moveToEnd?1:!e.moveToEnd&&t.moveToEnd?-1:0)){for(let e of["isEdit","isMerged","isDeleted","isLocked","isMoved","isUserEdit"])r[e]?r.meta[e]="true":delete r.meta[e];delete r.meta.moveToEnd;let e=function(e){let t=[];for(let[a,s]of Object.entries(e))s&&t.push("".concat(a,'="').concat(s,'"'));if(t.length)return t.join(" ")}(r.meta),n=s.Vr[t];a&&(a+="\n"),a+="".concat(n).concat(r.lang).concat(e?":"+e:"","\n"),a+=r.source.trim()+"\n"}return a}a(66544);let l=(e,t)=>{let a=JSON.parse(JSON.stringify(t));for(let t of a)t.meta.file&&void 0!==e[t.meta.file]&&(t.source=e[t.meta.file]);return a};function i(e){let t={mapping:{}};for(let a of e)t.mapping[a.meta.file||""]=a.source;return t}},55681:(e,t,a)=>{"use strict";a.d(t,{q:()=>r});var s=a(7336);function r(){return(0,s.jsxs)("svg",{className:"download-icon overflow-visible",fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("style",{children:".download-icon {\n            cursor: pointer;\n            transform-origin: center;\n        }\n        .download-icon .arrow-part {\n            transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n             transform-origin: center;\n        }\n        button:has(.download-icon):hover .download-icon .arrow-part, button:has(.download-icon):focus-visible .download-icon .arrow-part {\n          transform: translateY(-1.5px);\n        }\n        "}),(0,s.jsx)("g",{className:"arrow-part",children:(0,s.jsx)("path",{clipRule:"evenodd",d:"M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75Z",fill:"currentColor",fillRule:"evenodd"})}),(0,s.jsx)("g",{className:"rectangle-part",children:(0,s.jsx)("path",{clipRule:"evenodd",d:"M13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z",fill:"currentColor",fillRule:"evenodd"})})]})}a(80644)},58139:()=>{},58365:(e,t,a)=>{"use strict";a.d(t,{CG:()=>d,Fm:()=>g,Qs:()=>v,cj:()=>c,h:()=>x,kN:()=>u,qp:()=>f});var s=a(7336),r=a(80644),n=a(54924),l=a(15122),i=a(9097),o=a(86358);let c=n.bL,d=n.l9,u=n.bm,m=n.ZL,h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hJ,{className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80 ease-in-out dark:bg-white/80",a),...r,ref:t})});h.displayName=n.hJ.displayName;let p=(0,l.F)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 gap-4 p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 border-b",bottom:"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 border-t",left:"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=r.forwardRef((e,t)=>{let{side:a="right",className:r,children:l,showClose:c=!0,...d}=e;return(0,s.jsxs)(m,{children:[(0,s.jsx)(h,{}),(0,s.jsxs)(n.UC,{className:(0,i.cn)(p({side:a}),r),ref:t,...d,children:[c?(0,s.jsxs)(n.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute right-4 top-4 z-10 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,s.jsx)(o.F,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}):null,l]})]})});x.displayName=n.UC.displayName;let g=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})};g.displayName="SheetHeader";let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hE,{className:(0,i.cn)("text-foreground text-lg font-semibold leading-none",a),ref:t,...r})});f.displayName=n.hE.displayName;let v=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{className:(0,i.cn)("text-muted-foreground text-sm",a),ref:t,...r})});v.displayName=n.VY.displayName},58978:(e,t,a)=>{"use strict";a.d(t,{C:()=>C});var s=a(7336),r=a(66818),n=a(80644),l=a(48963),i=a(86358),o=a(77215),c=a(55681),d=a(26163),u=a(67952),m=a(81279),h=a(22931),p=a(4495);let x=e=>{let{size:t=16,className:a}=e;return(0,s.jsxs)("svg",{className:(0,p.cn)("trash-icon overflow-visible",a),fill:"none",stroke:"currentColor",height:t,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M10.0001 1.33203H4.00008C3.64646 1.33203 3.30732 1.47251 3.05727 1.72256C2.80722 1.9726 2.66675 2.31174 2.66675 2.66536V13.332C2.66675 13.6857 2.80722 14.0248 3.05727 14.2748C3.30732 14.5249 3.64646 14.6654 4.00008 14.6654H12.0001C12.3537 14.6654 12.6928 14.5249 12.9429 14.2748C13.1929 14.0248 13.3334 13.6857 13.3334 13.332V4.66536L10.0001 1.33203Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6 6.66797H10",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M8 8.66797V4.66797",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6 11.332H10",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"square",strokeLinejoin:"round"})]})};var g=a(38597),f=a(81792),v=a(30009);let j=(0,v.createServerReference)("7046c41c9f3f140e352cb3de00b7fc58fe540eb868",v.callServer,void 0,v.findSourceMapURL,"transformExecutionOutputToEvents");var b=a(97210),y=a(2115),w=a(76073),N=a(57748),k=a(15993);function C(e){let{fileName:t="file.txt",value:a,caller:p,additionalHeaderActions:v,allowCopyCode:C,allowDownloadCode:S,closeHandler:I,isTabbed:M,allowClose:z,blockId:L,originalCode:P,closed:R,isExecutable:D,transactionMeta:E,language:A,onExecutionComplete:T}=e,{isCopied:F,copyToClipboard:O}=(0,r.C)({timeout:2e3}),{setShowDiffs:U,diffs:V,showDiffs:_}=(0,m.s)({blockId:L,fileName:t,originalCode:P,newCode:a}),B=(0,u.k)("codeBlockActions"),[H,$]=(0,n.useState)(!1),{activeScopeSlug:q}=(0,w.k6)(),{project:W}=(0,N.tZ)(),Z=null==W?void 0:W.projectId,G=async()=>{if(A&&!H){$(!0);try{let e;if("sql"===A){if(!q){k.oR.error("Error",{description:"Missing active scope"});return}if(!Z){k.oR.error("Error",{description:"Missing project ID"});return}e=await (0,g.W)({props:{language:A,blockId:L,source:a,meta:{file:t,transaction:E},closed:R,originalCode:P,isPreviewable:!0},projectId:Z})}else e=await (0,f.M)({language:A,blockId:L,source:a,meta:{file:t,transaction:E},closed:R,originalCode:P,isPreviewable:!0});if("error"in e)k.oR.error("Error",{description:"Error executing code"}),null==T||T([{type:"output",blockId:L,fileName:t||"untitled",content:e.error,timestamp:new Date().toISOString(),method:"stderr"}]);else{let a=await j(e,L,t||"untitled");null==T||T(a)}}finally{$(!1)}}},K=async()=>{if(!F)switch(await O(a),p){case"inline":return(0,y.u)("CopyCodeInline",{code:a});case"executable":return(0,y.u)("CopyCodeExecutable",{code:a});case"v0":return(0,y.u)("CopyCodeV0",{code:a})}};return(0,s.jsxs)(s.Fragment,{children:[v&&v.length>0?v:null,D&&A&&(0,s.jsx)(l.Z,{"aria-label":"Run Code",onClick:G,disabled:H,tooltip:{side:"bottom",content:H?"Running...":"Run Code"},children:(0,s.jsx)("span",{"aria-hidden":!0,children:H?(0,s.jsx)(b.y,{size:16}):(0,s.jsx)(o.N,{})})}),R&&(null==V?void 0:V.length)&&(0,s.jsx)(l.Z,{"aria-label":B(_?"hideDiff":"showDiff"),active:_,onClick:()=>{U(!_),setTimeout(()=>{let e=document.getElementById(h.yj);e&&e.scrollIntoView({behavior:"instant"})},0)},outline:!M,tooltip:M?{side:"bottom",content:B(_?"hideDiff":"showDiff")}:B(_?"hideDiff":"showDiff"),children:(0,s.jsx)(x,{size:"inline"===p?14:void 0})}),C&&(0,s.jsx)(l.Z,{"aria-label":B("copy"),onClick:K,outline:!M,tooltip:M?{side:"bottom",content:B("copy")}:B("copy"),children:(0,s.jsx)(d.U,{isCopied:F,size:"inline"===p?14:void 0})}),S&&(0,s.jsx)(l.Z,{"aria-label":B("download"),onClick:()=>{let e=t.split("/").pop(),s=window.prompt("Enter file name",e);if(!s)return;let r=new Blob([a],{type:"text/plain"}),n=URL.createObjectURL(r),l=document.createElement("a");switch(l.download=s,l.href=n,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n),p){case"executable":return(0,y.u)("DownloadCodeExecutable",{code:a});case"v0":return(0,y.u)("DownloadCodeV0",{code:a})}},outline:!M,tooltip:M?{side:"bottom",content:B("download")}:B("download"),children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(c.q,{})})}),z&&I&&(0,s.jsx)(l.Z,{"aria-label":B("close"),onClick:I,outline:!M,tooltip:M?{side:"bottom",content:B("close")}:B("close"),children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(i.F,{})})})]})}},59246:(e,t,a)=>{"use strict";a.d(t,{Zv:()=>v,ck:()=>f,eC:()=>g,pp:()=>x,wn:()=>p});var s=a(7336),r=a(81616),n=a(15066),l=a(37522),i=a(64826),o=a(95057),c=a(97947),d=a(50688),u=a(67952),m=a(4495),h=a(17276);function p(e){let{children:t,label:a,badge:l,onAdd:c,info:d}=e,m=(0,u.k)("projectSettings");return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex h-7 items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(n.Label,{className:"text-sm font-medium text-gray-900",children:[a,l]}),d&&(0,s.jsx)(o.Tooltip,{content:(0,s.jsx)("div",{className:"text-center",children:d}),children:(0,s.jsx)(h.R,{className:"h-3 w-3 text-gray-400"})})]}),c&&(0,s.jsx)(r.$,{"aria-label":m("add",a),className:"size-7 text-gray-500",size:"sm",variant:"ghost",onClick:c,tooltip:{side:"bottom",content:"Add ".concat(a)},children:(0,s.jsx)(i.F,{})})]}),t]})}function x(e){let{title:t,subtitle:a,children:r,className:n}=e;return(0,s.jsx)(c.Sv,{className:(0,m.cn)("relative h-[156px] rounded-md border border-dashed border-gray-300 px-8",n),children:(0,s.jsxs)(c.HY,{children:[t&&(0,s.jsx)(c.cz,{className:"text-sm text-gray-500",children:t}),a&&(0,s.jsx)(c.Ou,{className:"text-sm text-gray-500",children:a}),r]})})}function g(e){let{className:t,label:a,onClick:n,disabled:i}=e,o=(0,u.k)("projectSettings"),c=a||o("moreOptions"),d=n?r.$:"div";return(0,s.jsxs)(d,{className:(0,m.cn)("flex size-6 items-center justify-center text-gray-500",t),size:"sm",variant:"ghost",disabled:i,onClick:n,"cmdk-item-actions":"",children:[(0,s.jsx)(l.a,{}),(0,s.jsx)("span",{className:"sr-only",children:c})]})}function f(e){let{children:t,suffix:a,className:r}=e;return(0,s.jsxs)("div",{className:(0,m.cn)("odd:bg-muted flex h-[58px] w-full items-center justify-between gap-2 rounded-lg p-2",r),children:[t,a]})}function v(e){let{title:t}=e;return(0,s.jsxs)(p,{label:t,onAdd:()=>{},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(f,{suffix:(0,s.jsx)(g,{}),children:(0,s.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,s.jsx)(d.E,{className:"h-3 w-40"}),(0,s.jsx)(d.E,{className:"h-3 w-16"})]})}),(0,s.jsx)(f,{suffix:(0,s.jsx)(g,{}),children:(0,s.jsxs)("div",{className:"flex flex-col gap-2.5",children:[(0,s.jsx)(d.E,{className:"h-3 w-40"}),(0,s.jsx)(d.E,{className:"h-3 w-16"})]})})]}),(0,s.jsx)(r.$,{size:"sm",variant:"secondary",disabled:!0,children:"Show More"})]})}},60586:(e,t,a)=>{"use strict";a.d(t,{g:()=>o});var s=a(59103),r=a(76073),n=a(43665),l=a(31508),i=a(45419);function o(e){let{projectId:t,refreshInterval:a=3e3}=e,{activeScope:o,activeScopeSlug:c}=(0,r.k6)(),d=(0,l._)(),{refetchVercelProject:u}=(0,i.Ok)(t),m=o&&(0,n.W)(o)?null!=d?d:"":null!=c?c:"",h=new URLSearchParams;h.set("projectId",null!=t?t:""),h.set("teamSlug",m);let{data:p,error:x,isLoading:g,mutate:f}=(0,s.Ay)(t?"/chat/api/integrations/marketplace/connections?".concat(h.toString()):void 0,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch integration connections data");return t.json()},{refreshInterval:a,revalidateOnReconnect:!0,keepPreviousData:!0}),{data:v,error:j,isLoading:b,mutate:y}=(0,s.Ay)(t?"/chat/api/integrations/marketplace/storage?".concat(h.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch storage stores");return t.json()},{refreshInterval:a,revalidateOnReconnect:!0});return{connections:{data:(null==p?void 0:p.integrations)||[],isLoading:g,error:x||null,refetch:async()=>{await Promise.all([f(),u()])}},stores:{data:(null==v?void 0:v.stores)||[],isLoading:b,error:j||null,refetch:async()=>{await Promise.all([y(),u()])}},isLoading:g||b,error:x||j||null,refetch:async()=>{await Promise.all([f(),y(),u()])}}}},61202:(e,t,a)=>{"use strict";a.d(t,{A4:()=>ta,sY:()=>ti,LU:()=>tc,h:()=>to,PQ:()=>tr});var s=a(7336),r=a(80644),n=a(81616),l=a(4495),i=a(25733),o=a(64373);function c(e){return(0,s.jsx)("div",{className:"bg-muted my-4 space-y-4 rounded-lg border px-4 pb-6 pt-2",children:e.children})}function d(e){let{value:t,selected:a,onClick:r,children:n,index:i}=e;return(0,s.jsxs)("label",{className:"flex w-full cursor-pointer flex-col",children:[(0,s.jsx)("input",{className:"size-0",defaultChecked:a,name:"answer",onClick:r,type:"radio",value:t}),(0,s.jsxs)("span",{className:(0,l.cn)("bg-background flex items-center justify-start gap-3 px-4 py-3 transition-colors",a&&"bg-blue-100"),children:[(0,s.jsx)("span",{className:(0,l.cn)("flex size-5 select-none items-center justify-center rounded-full bg-blue-100 text-center text-xs font-semibold text-blue-800 transition-colors",a&&"bg-blue-400 text-white"),children:String.fromCharCode(65+i)}),n]})]})}function u(e){let{correct:t,selected:a,className:r}=e;return t||a?(0,s.jsx)("span",{className:(0,l.cn)("inline-block size-6 shrink-0 rounded-full p-1 align-middle",t?"bg-blue-100 text-blue-600":"bg-red-100 text-red-500",r),children:t?(0,s.jsx)(i.r,{}):(0,s.jsx)(o.$,{})}):null}function m(e){let{answer:t,correctAnswer:a}=e;return(0,s.jsxs)("span",{className:(0,l.cn)("animate-slideDownAndFade flex select-none items-center justify-center gap-1 rounded-full py-1 pl-3 pr-5",t===a&&"bg-blue-100 text-blue-600",t&&t!==a&&"bg-red-100 text-red-500"),children:[void 0!==t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u,{correct:t===a,selected:!0})," "]}),void 0===t?(0,s.jsxs)(s.Fragment,{children:["The correct answer is: ",(0,s.jsx)("strong",{children:a})]}):t===a?(0,s.jsx)("span",{className:"font-bold text-blue-600",children:"Correct"}):(0,s.jsx)("span",{className:"font-bold text-red-500",children:"Incorrect"})]})}function h(e){let{answers:t,correctAnswer:a,question:l}=e,[i,o]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!1);return(0,s.jsxs)(c,{children:[(0,s.jsx)("p",{className:"text-md px-4 text-center font-semibold md:px-8 lg:px-12",children:l}),(0,s.jsx)("div",{className:"mx-0 flex flex-col divide-y overflow-hidden rounded-md border md:mx-8 lg:mx-12",children:t.map((e,t)=>(0,s.jsxs)(d,{index:t,onClick:()=>{x||o(e)},selected:e===i,value:e,children:[(0,s.jsx)("span",{className:"flex-1",children:e}),h?(0,s.jsx)(u,{className:"animate-slideDownAndFade ml-2",correct:e===a,selected:e===i}):null]},e))}),(0,s.jsx)("div",{className:"flex justify-center",children:h&&null!==i?(0,s.jsx)(m,{answer:i,correctAnswer:a}):(0,s.jsx)(n.$,{className:"h-9 select-none",disabled:null===i,onClick:()=>{p(!0),g(!0)},size:"sm",children:"Check answer"})})]})}var p=a(72070);function x(e){let{children:t,className:a,...r}=e;return(0,s.jsx)("div",{className:(0,p.A)("steps mb-12 ml-2 border-l border-gray-200 pl-5 sm:ml-4 sm:pl-6","[counter-reset:step]",a),...r,children:t})}a(69049);var g=a(11192);function f(e){let{title:t}=e;return(0,s.jsxs)("div",{className:"rounded-lg border border-gray-100 p-4 shadow-sm",children:[(0,s.jsx)("p",{className:"mb-2 mt-0 font-medium text-gray-600",children:t}),(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),(0,s.jsx)("div",{className:"mt-2 h-4 w-1/2 rounded bg-gray-200"}),(0,s.jsx)("div",{className:"mt-2 h-4 w-3/4 rounded bg-gray-200"})]})]})}var v=a(87608);function j(e){let{language:t,children:a,closed:r,sqlExecutionState:n,blockId:i="syntax-highlighter-block",transaction:o,type:c}=e;return(0,s.jsx)(v.N,{allowCopyCode:!0,allowDownloadCode:!1,caller:"inline",className:(0,l.cn)("not-prose max-h-[500px] md:max-h-[700px]","inline-sql"===c?"":"mb-6"),headerClassName:"bg-muted",language:t,showLineNumbers:!1,value:a,closed:r,blockId:i,originalCode:void 0,showQuickEditAnimation:!1,sqlExecutionState:n,transaction:o,type:c})}var b=a(99256),y=a(95357),w=a(86595),N=a(49239),k=a(72464),C=a(80912),S=a(49388),I=a(91227),M=a(57748),z=a(97629),L=a(67952);let P=(0,r.createContext)({}),R="function"==typeof Intl.Segmenter?new Intl.Segmenter("en",{granularity:"word"}):null,D=window.matchMedia("(prefers-reduced-motion: reduce)").matches;function E(e){let{streaming:t,readonly:a,children:l,messageId:i}=e,o=(0,L.k)("segmenterProvider"),{setQuote:c}=(0,M.sC)(),d=(0,r.useState)(()=>{let e=new Map,t=new Map,a=new Set,s=new Map,r=!1;return(n,l,i,o)=>{l.current&&(e.set(n,l),t.set(n,i),a.add(n),s.set(n,o),r||(r=!0,setTimeout(c,8)));async function c(){if(0===a.size){r=!1;return}let n=a.values().next().value;if(void 0===n){r=!1;return}for(let e of a)e<n&&(n=e);a.delete(n);let l=e.get(n),i=t.get(n),o=s.get(n);if(l&&l.current&&(null==o||o(),i&&i.current)){let e=l.current.textContent;i.current.startsWith(e)||(l.current.textContent="",e="");let t=function(e){let t=[];if(R)for(let{segment:a}of R.segment(e))t.push(a);else{let a=e.split(" ");for(let e=0;e<a.length;e++)e>0&&t.push(" "),t.push(a[e])}return t}(i.current.slice(e.length));for(let a=0;a<t.length&&(e+=t[a],l.current);a++)l.current.textContent=e," "!==t[a]&&await new Promise(e=>setTimeout(e,8))}setTimeout(c,8)}}})[0],u=!0!==a,m=(0,r.useRef)(null),[h,p]=(0,r.useState)(null),x=function(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{t("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)},[]),e}(),{refs:g,floatingStyles:f}=(0,y.we)({placement:x?"bottom":"top",middleware:[(0,w.cY)(12),(0,w.mG)(),(0,w.UU)({padding:6})],whileElementsMounted:N.ll}),v=(0,r.useRef)(()=>"");(0,r.useEffect)(()=>{let e=!1,t=()=>{var t;e=!1;let a=window.getSelection();if(null===a||!a.rangeCount){p(null);return}let s=a.getRangeAt(0);if(s.collapsed){p(null);return}let r=null===(t=m.current)||void 0===t?void 0:t.contains(s.commonAncestorContainer),n=m.current;if(!r){let e=!1,t=s.commonAncestorContainer;if(t instanceof HTMLElement){let a=t.closest('[data-seg="code-root"]');a&&a instanceof HTMLElement&&(e=!0,n=a)}if(!e){p(null);return}}for(;0===s.endOffset;)s.setEndBefore(s.endContainer);u&&g.setReference({getBoundingClientRect:()=>s.getBoundingClientRect(),getClientRects:()=>{let e=s.getClientRects(),t=[];t.item=e=>t[e];for(let a=0;a<e.length;a++){let s=e[a];s.width>.1&&s.height>.1&&t.push(s)}return t}}),e=!0,v.current=function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],a=s.cloneContents();return(0,k.l)(a,s.commonAncestorContainer,s.startOffset>0,(null===(e=s.endContainer.textContent)||void 0===e?void 0:e.length)!==s.endOffset,t)},u&&p(n)};function a(t){if(!e||!t.clipboardData)return;let a=v.current(!1);t.clipboardData.setData("text/markdown",a),t.clipboardData.setData("text/plain",a),t.preventDefault()}return document.addEventListener("selectionchange",t),document.addEventListener("keyup",t),document.addEventListener("copy",a),()=>{document.removeEventListener("selectionchange",t),document.removeEventListener("keyup",t),document.removeEventListener("copy",a)}},[g,u]);let[j,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=m.current;if(!e)return;let t=e=>{var t;null!==(t=g.floating.current)&&void 0!==t&&t.contains(e.target)||b(!0)},a=()=>{b(!1)};return e.addEventListener("pointerdown",t),e.addEventListener("pointerup",a),e.addEventListener("pointerleave",a),()=>{e.removeEventListener("pointerdown",t),e.removeEventListener("pointerup",a),e.removeEventListener("pointerleave",a)}},[g.floating]),(0,S.ML)("keydown",e=>{var t;"q"===e.key&&h&&(c(v.current()),null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),e.stopPropagation(),e.preventDefault())});let D=(0,r.useMemo)(()=>({animate:t?d:void 0}),[t,d]);return(0,s.jsxs)("div",{ref:m,className:"w-full",children:[h&&(0,s.jsx)(y.XF,{root:h,children:(0,s.jsxs)("div",{className:"bg-background shadow-base-expand absolute left-0 top-0 z-50 flex select-none items-center gap-1 rounded-lg p-1","data-quote-button":!0,ref:g.setFloating,style:{...f,pointerEvents:j?"none":void 0},children:[(0,s.jsxs)(n.$,{className:"hover:text-foreground rounded-md px-0.5 py-0 text-sm text-gray-500",onClick:()=>{var e;c(v.current()),null===(e=window.getSelection())||void 0===e||e.removeAllRanges()},size:"xs",variant:"ghost",children:[o("quote"),(0,s.jsx)(z.u,{variant:"secondary",children:"Q"})]}),(0,s.jsx)("div",{className:"bg-alpha-400 h-5 w-px"}),(0,s.jsx)(I.H,{className:"text-gray-500",messageId:i,quoteRef:v,tooltip:"Downvote Selection",variant:"quote"})]})}),(0,s.jsx)(C.s,{"data-seg":"root",children:(0,s.jsx)(P.Provider,{value:D,children:l})})]})}var A=a(95805),T=a(46087),F=a(26939),O=a(92),U=a(97210),V=a(73615),_=a(79822),B=a(54799);let H=B.bL,$=B.R6,q=B.Ke;var W=a(63e3),Z=a(18742);function G(e){let{name:t,files:a=[],animated:n=!0}=e,[i,o]=(0,r.useState)(n),[c,d]=(0,r.useState)(a.length<2);(0,r.useEffect)(()=>{if(!n){o(!1);return}let e=setTimeout(()=>o(!1),250);return()=>clearTimeout(e)},[a,n]);let u=n?"animate-shimmer translate-y-px bg-[length:800%_100%] bg-clip-text text-sm text-transparent":void 0,m=n?{backgroundImage:"linear-gradient(90deg,rgb(161 161 170) 0%,rgb(161 161 170) 35%,rgb(212 212 216) 50%,rgb(161 161 170) 65%,rgb(161 161 170) 100%)"}:void 0;return(0,s.jsx)("div",{className:"font-mono text-gray-500",children:(0,s.jsxs)(H,{open:c,onOpenChange:d,children:[(0,s.jsx)($,{asChild:!0,children:(0,s.jsx)("button",{className:(0,l.cn)(u,"mb-2 flex cursor-pointer items-center"),style:m,children:i?t?(0,s.jsxs)(s.Fragment,{children:["Scanning ",a.length," files inside /",t,"..."]}):(0,s.jsxs)(s.Fragment,{children:["Reading ",a.length," files..."]}):(0,s.jsxs)(s.Fragment,{children:[t?(0,s.jsxs)(s.Fragment,{children:["Scanned ",a.length," files inside ",t," "]}):(0,s.jsxs)(s.Fragment,{children:["Read ",a.length," files "]}),c?(0,s.jsx)(W.y,{className:"ml-1 h-3 w-3"}):(0,s.jsx)(Z.c,{className:"ml-1 h-3 w-3"})]})})}),(0,s.jsx)(q,{className:"border-l border-gray-200",children:(0,s.jsx)(_.N,{children:(0,s.jsx)("ul",{className:"m-0 flex list-none flex-col gap-2 p-0",children:a.map(e=>(0,s.jsx)("li",{className:"m-0 list-none p-0 text-sm",children:e},e))})})})]})})}let K=r.memo(e=>{let{source:t,streaming:a}=e,r=t.replace(/[^]*Tool call result:\n/,""),n=t.replace(/\nTool call result:[^]+/,""),l=null,i=null;try{l=JSON.parse(n),i=JSON.parse(r)}catch(e){}if(i&&((null==l?void 0:l.type)==="read_dir"||(null==l?void 0:l.type)==="read_file"))return(0,s.jsx)(G,{name:"read_dir"===l.type?l.dir:void 0,files:"read_dir"===l.type?"files"in i?i.files:[]:Object.keys(("content"in i?i.content:{})||{}),animated:a||!1});let o=(null==l?void 0:l.type)==="computer"&&"screenshot"===l.action&&i&&"data"in i;return(0,s.jsx)("p",{className:"inline-flex cursor-pointer rounded bg-cyan-600/10 px-1.5 py-0.5 text-sm text-cyan-700",children:(0,s.jsxs)("details",{children:[(0,s.jsxs)("summary",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)(V.A,{className:"h-3.5 w-3.5"}),n]}),(0,s.jsx)("div",{className:"mb-1 rounded bg-cyan-800/10 p-1 font-mono text-xs",children:o?(0,s.jsx)("img",{className:"max-h-64 max-w-full",src:"data:image/png;base64,".concat(i.data),alt:"Tool call result"}):r})]})})});K.displayName="Toolcall";var Y=a(51621),Q=a(35330),J=a(52220),X=a(49293),ee=a(45419),et=a(64495),ea=a(85303),es=a(64459),er=a(18816),en=a(19176),el=a(18730),ei=a(95057),eo=a(91064),ec=a(93874),ed=a(15067),eu=a(50688),em=a(15993),eh=a(3650),ep=a(4304);let ex={enter:e=>({y:e>0?40:-40,opacity:0}),center:{y:0,opacity:1},exit:e=>({y:e<0?40:-40,opacity:0})},eg=new Intl.ListFormat("en",{style:"long",type:"conjunction"});function ef(e){var t;let a,{messageId:n,names:l}=e;a="string"==typeof l?[l]:l||[];let o=(0,el.Pk)(),c=(0,M.tZ)(),{user:d}=(0,F.J)(),u=o.activeForkKey,m=!!u&&u[u.length-1],h=m&&m===n,p=null==u?void 0:u.indexOf(n),x=void 0!==p&&p<u.length?u[p+1]:void 0,g=x&&(null===(t=o.messages.find(e=>e.id===x))||void 0===t?void 0:t.type)==="added-environment-variables",[f,v]=(0,r.useState)({}),[j,b]=(0,r.useState)({}),[y,w]=(0,r.useState)(!1),[N,k]=(0,r.useState)(0),{selectedProjectId:C}=(0,ee._t)(),{submit:S}=(0,et.yI)(),[I,z]=(0,r.useState)(h?"unsubmit":g?"submitted":"cancelled"),{project:L,canWriteToChat:P}=(0,M.tZ)(),R=null==L?void 0:L.vercelProjectId,{projects:D,isReady:E}=(0,ed.D)(),A=null==D?void 0:D.find(e=>e.id===R),T=a.map(e=>({key:e,alreadyExists:null==A?void 0:A.env.find(t=>t===e)})),O=async()=>{if(!Object.keys(f).length)return em.oR.error("No environment variables to create. Please try again.");if(!Object.values(f).every(e=>e))return;let e=C;if(w(!0),!C){let t=await (0,eh.g)({projectName:c.title||"New V0 Project",chatId:o.chatId,includeSuccessToast:!1});if(!t.id)return em.oR.error("Failed to create v0 Project. Please add this chat to a project");e=t.id,await c.setMetadata({...c,project:{projectId:t.id,vercelProjectId:t.vercelProjectId||null,name:c.title||"New V0 Project",settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}})}if(!e)return em.oR.error("v0 Project ID not found. Please try again.");let t=[],s=await (0,X.g)({envVars:Object.entries(f).map(e=>{let[t,a]=e;return{key:t,value:a}}),v0ProjectId:e,autoCreateVercelProject:!1,chatId:o.chatId}).catch(e=>(t.push(e.message),[{success:!1}]));if(t.length)return w(!1),em.oR.error(t.join(". ")||"Failed to create environment variables.");if(!s){w(!1),em.oR.error("Failed to create environment variables.");return}"success"in s&&s.success?(v({}),k(-1),z("submitted"),await S({action:"new",attachments:[],input:"The environment variable".concat(a.length>1?"s":""," ").concat(eg.format(a)," ").concat(a.length>1?"have":"has"," been added to the [Vercel Project]()."),type:"added-environment-variables"})):(console.error(t),em.oR.error(t.join(". ")||"Failed to create environment variables."))};return E?(0,s.jsx)(Q.Zp,{className:"w-full max-w-[360px] overflow-hidden shadow-sm",children:(0,s.jsxs)(Q.Wu,{className:"my-0 p-3",children:[(0,s.jsxs)(_.N,{custom:N,mode:"wait",children:["submitted"===I&&(0,s.jsx)(Y.P.div,{custom:N,variants:ex,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-center space-y-4",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-2 py-3 text-center",children:[(0,s.jsx)("span",{className:"rounded-full border border-green-200 bg-green-100 p-1.5",children:(0,s.jsx)(i.r,{className:"!text-green-600"})}),(0,s.jsxs)("h2",{className:"flex items-center gap-1 text-sm font-medium",children:[(0,s.jsx)("span",{children:"Environment Variables Added"}),(0,s.jsx)(ei.Tooltip,{content:(0,s.jsx)("ul",{children:a.map(e=>(0,s.jsx)("li",{className:"flex items-center space-x-1",children:(0,s.jsx)("span",{children:e})},e))}),children:(0,s.jsx)("span",{className:"text-gray-500",children:(0,s.jsx)(en.f,{})})})]})]})},"info"),("unsubmit"===I||!C)&&h&&(0,s.jsxs)(Y.P.form,{custom:N,variants:ex,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col space-y-4",children:[R||A||!C?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-center",children:["This v0 Project has no"," ",(0,s.jsx)(eo.N,{href:"https://vercel.com/docs/projects/overview",external:!0,children:"Vercel Project"})," ","associated."]}),(0,s.jsx)(ec.KF,{currentProject:A,projects:D||[],v0ProjectId:C,readOnly:!P})]}),(0,s.jsxs)(s.Fragment,{children:[T.map((e,t)=>{let{key:a,alreadyExists:r}=e;return(0,s.jsx)("div",{className:"relative flex w-full",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("label",{className:"text-xs font-medium text-gray-500",children:[a," ",r&&(0,s.jsx)("span",{children:"*"})]}),(0,s.jsx)(J.p,{value:f[a]||"",onChange:e=>v({...f,[a]:e.target.value}),placeholder:"Value",autoFocus:0===t,type:j[a]?"text":"password",required:!0,name:a,minLength:1,autoComplete:"off",disabled:!P,size:"sm"}),(0,s.jsx)(_.N,{children:f[a]&&(0,s.jsx)(ei.Tooltip,{content:j[a]?"Hide":"Show",children:(0,s.jsx)(Y.P.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},type:"button",onClick:()=>b({...j,[a]:!j[a]}),className:"absolute right-2 top-8 text-gray-500",children:j[a]?(0,s.jsx)(es.X,{size:14}):(0,s.jsx)(ea.k,{size:14})},a)})})]})},a)}),T.some(e=>{let{alreadyExists:t}=e;return t})&&(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"* Environment variable already exists and will be updated."}),(0,s.jsxs)("span",{className:"flex items-center justify-between",children:[(0,s.jsx)("hr",{className:"border-border m-2 border-dashed py-2"}),(0,s.jsx)(ep.Q,{onClick:O,pending:y,disabled:!P,type:"submit",size:"sm",children:"Submit"})]})]})]},"value"),"cancelled"===I&&(0,s.jsx)(Y.P.div,{custom:N,variants:ex,initial:"enter",animate:"center",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-center",children:(0,s.jsx)("div",{className:"flex flex-col items-center text-center",children:(0,s.jsxs)("p",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:"Environment Variables Not Added"}),(0,s.jsx)(ei.Tooltip,{content:(0,s.jsx)("ul",{children:a.map(e=>(0,s.jsx)("li",{className:"flex items-center space-x-1",children:(0,s.jsx)("span",{children:e})},e))}),children:(0,s.jsx)("span",{className:"text-gray-500",children:(0,s.jsx)(er.$,{})})})]})})},"info")]}),(null==d?void 0:d.isAdminMode)?(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[(0,s.jsx)("span",{className:"font-medium",children:"Internal:"}),(0,s.jsxs)("p",{children:["Is most recent message:"," ",h?(0,s.jsx)("span",{children:"True"}):(0,s.jsx)("span",{children:"False"}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{children:["Is next message added env vars:"," ",g?(0,s.jsx)("span",{children:"True"}):(0,s.jsx)("span",{children:"False"})]}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{children:[" State: ",I]}),(0,s.jsx)("br",{}),(0,s.jsxs)("span",{children:[" Message ID: ",n]})]})]}):null]})}):(0,s.jsx)(Q.Zp,{className:"text-muted-foreground bg-muted w-full max-w-[360px] overflow-hidden shadow-sm",children:(0,s.jsx)(Q.Wu,{className:"my-0 p-2",children:(0,s.jsx)(eu.E,{className:"h-[130px] w-full"})})})}var ev=a(90434),ej=a(23914),eb=a(28148),ey=a.n(eb);let ew={0:"hsl(var(--red-600))",50:"hsl(var(--amber-600))",90:"hsl(var(--green-600))"},eN={tiny:20,small:32,medium:64,large:128},ek={tiny:3,small:2,medium:1,large:1};function eC(e){let{colors:t=ew,value:a,placeholder:n,className:l,arcPriority:i="primary",style:o,size:c,deprecatedSize:d,children:u,showValue:m=!1,...h}=e,x=void 0!==d?d:eN[c],[g,f]=(0,r.useMemo)(()=>{if("primary"in t)return[t.primary,t.secondary];let e=Object.keys(t).map(Number);if(0===e.length)return[void 0,void 0];let s=e.filter(e=>a>=e).pop();return[void 0!==s?t[s]:void 0,void 0]},[t,a]),{circleProps:v,circumference:j,offsetFactor:b,segmentGap:y,primaryStrokePercent:w,secondaryStrokePercent:N}=(0,r.useMemo)(()=>{let e=x<=eN.tiny?15:10,t=2*Math.PI*(50-e/2),s=Math.round(100/t*e)+ek[c];(0===a||a>=100)&&(s=0);let r=.5*("equal"===i),n=a-2*s*r,l=100-a-2*s*(1-r)-Math.max(1-n,0);return{circleProps:{cx:50,cy:50,r:50-e/2,strokeWidth:e,strokeDashoffset:0,strokeLinecap:"round",strokeLinejoin:"round"},circumference:t,segmentGap:s,primaryStrokePercent:n,secondaryStrokePercent:l,offsetFactor:r}},[i,x,c,a]);return(0,s.jsxs)("div",{className:(0,p.$)(ey().circle,l,{[ey().animate]:!n}),"data-geist-progress-circle":"","data-version":"v1",style:{...o,"--circle-size":"".concat(100,"px"),"--circumference":j,"--percent-to-px":"".concat(j/100,"px"),"--gap-percent":y,"--offset-factor":b},...h,children:[(0,s.jsxs)("svg",{fill:"none",height:x,strokeWidth:"2",viewBox:"0 0 ".concat(100," ").concat(100),width:x,children:[(0,s.jsx)("circle",{style:{opacity:N<0||100===a?0:1,"--stroke-percent":N},...v,className:ey().arcSecondary,stroke:f||"hsl(var(--alpha-400))"}),(0,s.jsx)("circle",{...v,className:ey().arc,"data-geist-progress-circle-fg":"",stroke:g||"var(--geist-foreground)",style:{opacity:+(0!==a),"--stroke-percent":Math.min(100-y,w)}})]}),u||m?(0,s.jsx)("div",{className:ey().content,children:u||(0,s.jsx)("div",{className:"text-[11px] font-medium text-gray-500",children:a})}):null]})}var eS=a(27559);let eI={firstContentfulPaint:[1.8,3],largestContentfulPaint:[2.5,4],totalBlockingTime:[200,600],cumulativeLayoutShift:[.1,.25]},eM=(e,t)=>{let a=parseFloat(e);return a<t[0]?"good":a<t[1]?"needsImprovement":"poor"};function ez(){return(0,s.jsxs)(Q.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:[(0,s.jsx)(Q.aR,{className:"flex p-3",children:(0,s.jsxs)(Q.ZB,{className:"mx-0.5 flex flex-col gap-1 text-sm font-medium text-gray-800",children:[(0,s.jsx)("span",{children:"Lighthouse Report"}),(0,s.jsx)(eu.E,{className:"h-4 w-16"})]})}),(0,s.jsxs)(Q.Wu,{className:"p-0",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3 p-3 pt-0 sm:grid-cols-2",children:Array.from({length:4}).map((e,t)=>(0,s.jsxs)("div",{className:"bg-background-subtle flex items-center gap-3 rounded-[6px]  border p-2",children:[(0,s.jsx)(eC,{value:0,size:"small",children:(0,s.jsx)(eS.I,{color:"hsl(var(--gray-500))",size:18,weight:"bold"})}),(0,s.jsx)(eu.E,{className:"h-4 w-16"})]},t))}),(0,s.jsxs)("div",{className:"flex flex-col border-t border-gray-200 p-3 text-gray-500",children:[(0,s.jsx)(eR,{label:"First Contentful Paint",isLoading:!0,hasMutedBackground:!0}),(0,s.jsx)(eR,{label:"Largest Contentful Paint",isLoading:!0}),(0,s.jsx)(eR,{label:"Total Blocking Time",isLoading:!0,hasMutedBackground:!0}),(0,s.jsx)(eR,{label:"Cumulative Layout Shift",isLoading:!0})]})]})]})}function eL(e){let{data:t,href:a}=e;if(!t)return(0,s.jsx)(Q.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:(0,s.jsx)(Q.Wu,{className:"p-3",children:(0,s.jsxs)("div",{className:"bg-muted flex flex-col items-center justify-center rounded-[6px] p-8",children:[(0,s.jsx)("div",{className:"mb-4 rounded-full border border-red-200 bg-red-50 p-2 text-red-600",children:(0,s.jsx)(o.$,{})}),(0,s.jsx)("h3",{className:"mb-2 font-medium text-gray-900",children:"Lighthouse Report Failed"}),(0,s.jsx)("p",{className:"max-w-96 text-center text-gray-500",children:"Something went wrong while analyzing the performance of the website. Please try again later."})]})})});let{categories:r,firstContentfulPaint:n,largestContentfulPaint:l,totalBlockingTime:i,cumulativeLayoutShift:c}=JSON.parse(decodeURIComponent(t));return(0,s.jsxs)(Q.Zp,{className:"not-prose w-full max-w-lg shadow-sm",children:[(0,s.jsx)(Q.aR,{className:"flex p-3",children:(0,s.jsxs)(Q.ZB,{className:"mx-0.5 flex flex-col gap-1 text-sm font-medium text-gray-800",children:[(0,s.jsx)("span",{children:"Lighthouse Report"}),(0,s.jsxs)("a",{href:a,className:"flex items-center font-normal hover:opacity-70",children:[a,(0,s.jsx)(ej.m,{})]})]})}),(0,s.jsxs)(Q.Wu,{className:"p-0",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3 p-3 pt-0 sm:grid-cols-2",children:Object.entries(r).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"bg-background-subtle flex items-center gap-3 rounded-[6px]  border p-2",children:[(0,s.jsx)(eC,{value:100*a.score,size:"small",placeholder:!1,showValue:!0}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-[14px] font-medium leading-[20px]",children:a.title})})]},t)})}),(0,s.jsxs)("div",{className:"flex flex-col border-t border-gray-200 p-3",children:[(0,s.jsx)(eR,{label:"First Contentful Paint",value:n.displayValue,thresholds:eI.firstContentfulPaint,hasMutedBackground:!0}),(0,s.jsx)(eR,{label:"Largest Contentful Paint",value:l.displayValue,thresholds:eI.largestContentfulPaint}),(0,s.jsx)(eR,{label:"Total Blocking Time",value:i.displayValue,thresholds:eI.totalBlockingTime,hasMutedBackground:!0}),(0,s.jsx)(eR,{label:"Cumulative Layout Shift",value:c.displayValue,thresholds:eI.cumulativeLayoutShift})]})]})]})}let eP=e=>{let{value:t}=e;return(0,s.jsx)("div",{className:"flex h-4 w-4 flex-row rounded-full p-1 ".concat("good"===t?"bg-green-100":"needsImprovement"===t?"bg-amber-100":"poor"===t?"bg-red-100":"bg-gray-100"),children:(0,s.jsx)("div",{className:"h-2 w-2 rounded-full ".concat("good"===t?"bg-green-600":"needsImprovement"===t?"bg-amber-600":"poor"===t?"bg-red-600":"bg-gray-400")})})};function eR(e){let{label:t,value:a,thresholds:r,hasMutedBackground:n,isLoading:l=!1}=e;return(0,s.jsxs)("div",{className:"flex flex-row justify-between rounded-[6px] p-2 ".concat(n?"bg-muted":""),children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsx)(eP,{value:l?"skeleton":eM(a,r)}),(0,s.jsx)("div",{className:"text-[14px] font-medium leading-[20px]",children:t})]}),(0,s.jsx)("div",{className:"text-[14px] leading-[20px] text-gray-500",children:l?(0,s.jsx)(eu.E,{className:"h-4 w-10"}):a})]})}var eD=a(26439),eE=a(95110);function eA(e){let{blockId:t}=e,{canWriteToChat:a}=(0,M.tZ)(),{isStreaming:n,isLoading:l,isContinuing:i}=(0,el.Pk)(),{history:o}=(0,eE.P6)({blockId:t}),c=o[0],d=(0,r.useMemo)(()=>(null==c?void 0:c.latestDeploymentInfo)||null,[null==c?void 0:c.latestDeploymentInfo]);return!a||n||l||i?null:(0,s.jsx)(Q.Zp,{className:"max-w-[400px] text-sm",children:(0,s.jsx)(eD.t$,{activeBlock:c,deployment:d,variant:"card",deployState:"idle",handleByPassDeployWarning:()=>{},deployWarning:null})})}function eT(){return(0,s.jsxs)(Q.Zp,{className:"max-w-[350px] text-sm",children:[(0,s.jsx)(Q.Wu,{className:"p-2 pb-3",children:(0,s.jsx)(eu.E,{className:"h-12 w-full rounded-md"})}),(0,s.jsx)(Q.wL,{className:"p-2 pt-0",children:(0,s.jsx)(eu.E,{className:"h-8 w-full rounded-md"})})]})}var eF=a(24806);function eO(e){let{children:t,isLoading:a,seconds:r}=e,n=void 0===r?void 0:Math.floor(r),l=(0,L.k)("messages");return(0,s.jsx)(eF.p,{forceOpen:a,text:a?l("thinking"):l("thoughtFor",n),isLoading:a,children:t})}var eU=a(96378),eV=a(23042),e_=a(60586),eB=a(81226),eH=a(46732),e$=a(76073),eq=a(31508),eW=a(88293),eZ=a(15765),eG=a(2115),eK=a(80775),eY=a(52014),eQ=a(53155),eJ=a(73769),eX=a(43665),e0=a(93925);let e1={supabase:"/chat-static/citation/supabase.svg",neon:"/chat-static/citation/neon.svg",upstash:"/chat-static/citation/upstash.svg","upstash-kv":"/chat-static/citation/upstash.svg"};function e5(e){var t,a;let{messageId:l,category:i,namesProp:o}=e,c=(0,r.useMemo)(()=>"string"==typeof o?[o]:o,[o]),d=(0,M.tZ)(),{chatId:u}=(0,el.xz)(),{activeScope:m}=(0,e$.k6)(),h=(0,eq._)(),p=null===(t=d.project)||void 0===t?void 0:t.vercelProjectId,{vercelProjectWithDashboard:x}=(0,ee.Ok)(null===(a=d.project)||void 0===a?void 0:a.projectId),{submit:g}=(0,et.yI)(),{expectUser:f}=(0,F.J)(),{setShowSignInDialog:v}=(0,eQ.AO)(),[j,b]=(0,r.useState)({}),y=(e,t)=>{b(a=>({...a,[e]:t}))},{connectedLinks:w,refetchLinks:N,isLoading:k}=(0,eZ.d)({source:"add-integration",messageId:l},async e=>{y(e[0].integrationId,"none"),e.forEach(e=>{(0,eG.u)("AddIntegration",{integration:e})});let t=e.some(e=>"Supabase"===e.integrationName||"Neon"===e.integrationName);await g({action:"new",attachments:[],input:"The integration".concat(e.length>1?"s":""," ").concat(eK.Y.format(e.map(e=>e.integrationName))," ").concat(e.length>1?"have":"has"," been added to the [Vercel Project](").concat(null==x?void 0:x.project.url,")."),type:"added-integration",workflowState:t?"add-sql-db":"add-nonsql-store"})}),{integrations:C,isLoading:S,error:I,refetch:z}=(0,eV.A)({integrationIds:eB.ud,isEnabled:!0}),{connections:L,stores:P,isLoading:R}=(0,e_.g)({projectId:null!=p?p:void 0,refreshInterval:0}),D=(0,r.useMemo)(()=>!p||R?[]:[...L.data.map(e=>e.slug),...P.data.map(e=>{var t;return null===(t=e.product)||void 0===t?void 0:t.slug}).filter(Boolean)],[L.data,P.data,R,p]),E=(0,r.useMemo)(()=>{if(S)return[];let e=null==c?void 0:c.filter(e=>e&&Object.keys(eB.yC).some(t=>t.toLowerCase()===e.toLowerCase()));return C.filter(t=>{let a="upstash-kv"===t.slug?"upstash":t.slug,s=!(null==e?void 0:e.length)||e.some(e=>e&&e.toLowerCase()===a.toLowerCase()),r=!i||!eB.yC[a]||eB.yC[a].includes(i.toLowerCase());return s&&r})},[C,i,S,c]),A=(0,r.useMemo)(()=>S||!w?[]:C.filter(e=>w.some(t=>t.connected&&t.integrationId===e.id)),[C,w,S]),T=S||k||void 0===w,O=(0,r.useMemo)(()=>T?[]:A.length>0?A:E,[A,E,T]),U=async(e,t,a,s)=>{(0,eG.u)("ClickAddIntegration",{integration:e}),y(e.slug,"linking_integration");try{let r=eB.Dk.some(t=>t.has(e.slug)&&D.find(e=>t.has(e))),n=await (0,eH.P)({integration:e,chatId:u||"",v0ProjectId:t||"",teamSlug:(0,eX.W)(m)?h||"":(null==m?void 0:m.slug)||"",dashboardProject:a,source:"add-integration",messageId:l,needPrefix:r});await N(),s&&(s.location.href=n)}catch(e){em.oR.error("Failed to add integration")}},V=!o||i?"supabase":o.length>0&&Array.isArray(o)&&o[0]in e1?o[0]:"supabase";return f?I||T?(0,s.jsx)(Q.Zp,{className:"max-w-[500px]",children:(0,s.jsx)(Q.Wu,{className:"p-4",children:(0,s.jsx)("div",{className:"@container space-y-4",children:(0,s.jsxs)("div",{className:"@[300px]:flex-row @[300px]:items-center @[300px]:justify-between @[300px]:space-y-0 flex flex-col space-y-3",children:[(0,s.jsx)("div",{className:"flex items-center gap-3",children:I?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md border",children:(0,s.jsx)(eY.V,{className:"size-4 !text-red-700"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsx)("p",{className:"m-0 text-sm font-medium ",children:"Error"}),(0,s.jsx)("p",{className:"m-0 text-xs text-gray-500",children:"Failed to fetch integration options."})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eu.E,{className:"h-8 w-8 rounded-md"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(eu.E,{className:"mb-1 h-5 w-24"}),(0,s.jsx)(eu.E,{className:"h-3 w-32"})]})]})}),I?(0,s.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>z(),children:"Retry"}):(0,s.jsx)(eu.E,{className:"@[300px]:w-18 h-8 rounded-md"})]})})})}):(0,s.jsx)(Q.Zp,{className:"max-w-[500px] shadow-sm",children:(0,s.jsx)(Q.Wu,{className:"p-4",children:(0,s.jsx)("div",{className:"@container space-y-4",children:O.map((e,t)=>{let a=D.includes(e.slug)||(null==w?void 0:w.some(t=>t.integrationId===e.id));return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)("div",{className:"@[300px]:flex-row @[300px]:items-center @[300px]:justify-between @[300px]:space-y-0 flex flex-col space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center overflow-hidden rounded-md",children:(0,s.jsx)(eU.default,{src:e.icon||"placeholder.svg",alt:"".concat(e.name," logo"),width:32,height:32})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsx)("p",{className:"m-0 text-sm font-medium ",children:e.name}),(0,s.jsx)("p",{className:"m-0 text-xs text-gray-500",children:e.description})]})]}),a?(0,s.jsx)(n.$,{size:"sm",disabled:!0,variant:"secondary",children:"Connected"}):(0,s.jsx)(eJ.V,{integration:e,onConnect:U,status:j[e.slug],vercelProjectId:null!=p?p:void 0,onStatusChange:y})]}),t<O.length-1&&(0,s.jsx)(eW.Separator,{className:"my-2"})]},e.id)})})})}):(0,s.jsx)(Q.Zp,{className:"max-w-[500px]",children:(0,s.jsx)(Q.Wu,{className:"p-4",children:(0,s.jsx)("div",{className:"@container space-y-4",children:(0,s.jsxs)("div",{className:"@[300px]:flex-row @[300px]:items-center @[300px]:justify-between @[300px]:space-y-0 flex flex-col space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-md border",children:V?(0,s.jsx)(eU.default,{src:e1[V]||"/placeholder.svg",alt:V,width:16,height:16}):(0,s.jsx)(e0.g,{className:"h-full min-w-[25px] -translate-x-px"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsx)("p",{className:"m-0 text-sm font-medium ",children:"Log in"}),(0,s.jsx)("p",{className:"m-0 text-xs text-gray-500",children:"You must be logged in to connect an integration."})]})]}),(0,s.jsx)(n.$,{size:"sm",variant:"secondary",onClick:()=>v({prompt:!1}),children:"Login"})]})})})})}function e3(e){let{options:t}=e,{submit:a}=(0,et.yI)(),r=async e=>{await a({action:"new",attachments:[],input:e})};return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("p",{className:"my-0 pl-0.5 text-sm text-gray-500",children:"Next Steps"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-3",children:t.map((e,t)=>(0,s.jsxs)(n.$,{size:"xs",variant:"outline",className:"bg-muted dark:bg-subtle hover:bg-alpha-200 h-7 gap-1 rounded-full border-none !pl-3 !pr-2 text-sm font-normal shadow-sm",onClick:()=>r(e.prompt),children:[e.title,(0,s.jsx)(ej.m,{height:16,width:16,color:"000000",className:"!text-gray-600"})]},t))})]})}var e2=a(22931);function e6(e){var t;let{integration:a}=e,r=null===(t=(0,M.tZ)().project)||void 0===t?void 0:t.vercelProjectId,{stores:l,isLoading:i,error:o}=(0,e_.g)({projectId:null!=r?r:void 0}),c=l.data.find(e=>{var t;return(null===(t=e.product)||void 0===t?void 0:t.slug)===a});if(i||!c||o)return(0,s.jsx)(Q.Zp,{className:"h-10 w-44",children:(0,s.jsxs)(Q.Wu,{className:"flex  h-full items-center gap-2 px-4 py-0 pl-3",children:[(0,s.jsx)(eu.E,{className:"h-5 w-5 rounded-md"}),i?(0,s.jsx)(eu.E,{className:"h-5 w-24"}):(0,s.jsx)("div",{className:"text-red-700",children:"No data found"})]})});let d="https://vercel.com/api/www/avatar/".concat(c.product.iconUrl),u="https://vercel.com/api/marketplace/sso?integrationConfigurationId=".concat(c.product.integrationConfigurationId,"&teamId=").concat(c.ownerId);return(0,s.jsx)("a",{href:u,target:"_blank",children:(0,s.jsxs)(n.$,{className:"gap-2 pl-3",variant:"outline",children:[(0,s.jsx)("div",{className:"flex h-5 w-5 items-center justify-center overflow-hidden rounded-md",children:(0,s.jsx)(eU.default,{src:d,alt:"".concat(c.product.name," logo"),width:20,height:20})}),"Open ",c.product.name]})})}let e4=(0,g.default)(()=>Promise.all([a.e(2411),a.e(1796)]).then(a.t.bind(a,31796,23)).then(e=>e.InlineMath)),e9=(0,g.default)(()=>Promise.all([a.e(2411),a.e(1796)]).then(a.t.bind(a,31796,23)).then(e=>e.BlockMath)),e8=(0,g.default)(()=>Promise.all([a.e(4438),a.e(9435),a.e(6796)]).then(a.bind(a,76796)).then(e=>e.Mermaid),{loadableGenerated:{webpack:()=>[76796]}}),e7=(0,g.default)(()=>Promise.all([a.e(9299),a.e(9713),a.e(3036)]).then(a.bind(a,33036)).then(e=>e.Table),{loadableGenerated:{webpack:()=>[33036]}}),te=String.fromCharCode(65535);function tt(e,t){if(void 0===e)return e;let a=e+"\0";for(;;)if(t>=65535)a+=te,t-=65535;else{a+=String.fromCharCode(t+1);break}return a}let ta=r.memo(function(e){let t,{messageId:a,role:r,streaming:n,rows:l,isLastMessage:i=!1,v3:o=!1}=e,{authorId:c,from:d}=(0,M.tZ)(),{user:u}=(0,F.J)(),m=!1,h=[],p=l.map((e,t)=>{let[l,c]=e,u=tt("",t);return 0===l?(m=!0,(0,s.jsx)(ts.Provider,{value:o,children:(0,s.jsx)(tn,{data:c,id:u,messageId:a,streaming:n,chatOrigin:d,isLastMessage:i})},u)):(1===l&&"assistant"===r&&c.context&&Array.isArray(c.context)&&c.context.length>0&&(h=c.context),null)});if(!m){if(0===h.length)return null;t=(0,s.jsx)(O.vg,{urls:h.map(e=>{let{url:t}=e;return t})})}let x=(0,s.jsxs)(s.Fragment,{children:[t,p]});return"assistant"===r?(0,s.jsx)(E,{messageId:a,readonly:!!c&&(null==u?void 0:u.id)!==c,streaming:n,children:x}):x}),ts=r.createContext(!1),tr=()=>r.use(ts);function tn(e){let t,{data:a,id:n,messageId:l,streaming:i,chatOrigin:o,isLastMessage:c}=e,d=a.map((e,r)=>{let o=tt(n,r);return"string"!=typeof e&&"Codeblock"===e[0]&&e[1].blockId&&c&&void 0===t&&(t=e[1].blockId),(0,s.jsx)(tl,{data:e,id:o,isLast:r===a.length-1,index:r,messageId:l,streaming:i,isLastMessage:c},o)});return t&&"vercel"===o&&d.push((0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)(eT,{}),children:(0,s.jsx)(eA,{blockId:t})})),d}function tl(e){let{data:t,id:a,index:n,messageId:l,isLast:i,streaming:o,isLastMessage:c}=e,d=function(e){let{id:t,content:a,type:s,props:n}=e,{animate:l}=(0,r.use)(P),i=(0,r.useRef)(null),o=(0,r.useRef)(a),[c,d]=(0,r.useState)(!1),u=(0,r.useId)();(0,r.useEffect)(()=>(k.c.set(u,{type:s,props:n}),()=>{k.c.delete(u)}));let m={"data-seg":u};return((0,r.useEffect)(()=>{if(D){let e=i.current;if(!e)return;e.style.transition="",d(!0),"string"==typeof a&&(e.textContent=a);return}if(o.current=a,!l||void 0===t)return;let e=setTimeout(()=>{l(t,i,o,()=>d(!0))},20);return()=>clearTimeout(e)},[l,t,a]),l&&void 0!==t)?(m.style={opacity:+!!c,transition:"opacity .5s ease"},m.ref=i,"string"==typeof a&&(m.children="\xa0")):"string"==typeof a&&(m.children=a),{elementProps:m}}({id:a,content:"string"==typeof t?t:void 0,type:"string"==typeof t?"text":t[0],props:"string"==typeof t?{}:t[1]}),u="string"!=typeof t&&"Codeblock"===t[0]&&t[1].blockId?t[1].source:void 0;if("string"==typeof t)return t;let[m,p,...g]=t;if(void 0===m)return null;let v=(0,s.jsx)(tn,{data:g,id:a,messageId:l,isLastMessage:c});switch(m){case"text":return(0,s.jsx)("span",{...d.elementProps,children:v});case"span":case"p":case"blockquote":case"strong":case"em":case"del":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"ul":case"ol":case"li":return(0,s.jsx)(m,{...d.elementProps,...p,children:v});case"code":if(1===g.length&&"string"==typeof g[0]&&(0,ev.TN)(g[0]))return(0,s.jsx)(ev.br,{...d.elementProps,value:g[0]});return(0,s.jsx)("code",{...d.elementProps,className:"rounded-[0.375rem] border bg-gray-100 px-[0.25rem] py-[0.15rem] font-mono text-xs font-normal before:hidden after:hidden",...p,children:v});case"a":let y=p.href;if("string"==typeof y&&y.startsWith("/"))return(0,s.jsx)("span",{...d.elementProps,children:v});if("string"==typeof y&&y.startsWith("#"))return(0,s.jsx)("a",{...d.elementProps,className:"font-normal text-blue-600 no-underline decoration-from-font underline-offset-2 transition-colors hover:text-blue-600",href:y,children:v});return(0,s.jsxs)("a",{...d.elementProps,className:"font-normal text-blue-600 no-underline decoration-from-font underline-offset-2 transition-colors hover:text-blue-600",href:p.href||"#",rel:"noopener noreferrer",target:"_blank",children:[v,(0,s.jsx)(A.i,{className:"mb-0.5 ml-0.5 inline h-3 w-3"})]});case"img":return(0,s.jsx)("img",{...d.elementProps,...p});case"hr":return(0,s.jsx)("hr",{...d.elementProps});case"table":return(0,s.jsx)("table",{...d.elementProps,className:"table-fixed",children:v});case"tr":return(0,s.jsx)("tr",{...d.elementProps,children:v});case"td":return(0,s.jsx)("td",{...d.elementProps,children:v});case"th":return(0,s.jsx)("th",{...d.elementProps,children:v});case"thead":return(0,s.jsx)("thead",{...d.elementProps,children:v});case"tbody":return(0,s.jsx)("tbody",{...d.elementProps,children:v});case"Codeblock":let w=u||g.join("");if(p.blockId&&p.meta.type&&!e2.kX.includes(p.meta.type))return(0,s.jsx)("div",{className:"block-preview flex flex-col gap-3 [&:not(:last-child)]:mb-4",...d.elementProps,children:(0,s.jsx)(b.Q,{blockId:p.blockId,closed:p.closed,language:p.lang,remoteInfo:p.remoteInfo,messageId:l,meta:p.meta,resultId:p.resultId,source:w,type:p.meta.type,latestDeploymentInfo:p.latestDeploymentInfo,isStreaming:o||!1},p.blockId)});if(!w)return(0,s.jsx)("div",{...d.elementProps});switch(p.lang){case"mermaid":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(r.Suspense,{fallback:null,children:(0,s.jsx)(e8,{source:w,title:p.meta.title})})});case"math":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(e9,{math:w})});case"csv":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)(f,{title:"Loading table..."}),children:(0,s.jsx)(e7,{source:w})})});case"toolcall":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(K,{source:w,streaming:o||!1})});default:return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(j,{language:p.lang,blockId:p.blockId,closed:p.closed,sqlExecutionState:p.meta.sqlExecutionState,transaction:p.meta.transaction,type:p.meta.type,children:w})})}case"InlineMath":return(0,s.jsx)("span",{...d.elementProps,children:(0,s.jsx)(e4,{math:g.join("")})});case"Math":return(0,s.jsx)("span",{...d.elementProps,children:(0,s.jsx)(e9,{math:g.join("")})});case"LinearProcessFlow":case"Steps":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(x,{children:v})});case"Thinking":case"DevThinking":case"V0Info":return(0,s.jsx)(eO,{isLoading:void 0===p.closed||!p.closed,seconds:p.chars?p.chars/170:void 0,children:(0,s.jsx)("div",{...d.elementProps,className:"[&>p:first-child]:mt-0 [&>p:last-child]:mb-0",children:v})});case"Solution":case"footnoteDefinition":default:return null;case"Quiz":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(h,{...p,children:v})});case"Spinner":let N=null,C=p.message||"Generating...";return C.toLowerCase().includes("search")?N=null:C.toLowerCase().startsWith("added")?N=null:n>0&&(N=(0,s.jsx)(U.y,{})),i&&o?(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsxs)("div",{className:"flex items-center justify-start gap-2",children:[N,(0,s.jsx)("span",{className:"animate-pulse",children:C})]})}):null;case"MathInstructions":case"MathBlock":return(0,s.jsx)("div",{...d.elementProps,children:v});case"footnoteReference":return(0,s.jsx)("span",{...d.elementProps,children:(0,s.jsx)(T.O,{idPrefix:"cite-".concat(l,"-"),label:p.label})});case"AddEnvironmentVariables":case"AddEnvironmentVariable":return(0,s.jsx)(ef,{names:p.names,messageId:l});case"AddIntegration":return(0,s.jsx)(e5,{category:p.category,namesProp:p.names,messageId:l});case"OpenExternalDashboard":return(0,s.jsx)(e6,{integration:p.integration});case"SuggestedNextSteps":return c?(0,s.jsx)(e3,{options:p.options}):null;case"LoadingLighthouse":return i?(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(ez,{})}):null;case"Lighthouse":case"LighthouseReport":return(0,s.jsx)("div",{...d.elementProps,children:(0,s.jsx)(eL,{...p})})}}function ti(e,t){let a=[];if(!Array.isArray(e)||!e.length)return a;if(0===e[0][0])for(let s of e[0][1])!function e(t,a){if(Array.isArray(t)){let[s,r,...n]=t;"string"==typeof s&&a(t),n.map(t=>e(t,a))}}(s,e=>{let[s,r,...n]=e;if("Codeblock"===s&&r.meta.type){let e=n.join(""),s=r.blockId;s&&a.push({id:s,meta:r.meta,type:r.meta.type,messageId:t,source:r.source||e,language:r.lang,resultId:r.resultId,remoteInfo:r.remoteInfo,closed:void 0!==r.closed&&!!r.closed,createdAt:r.createdAt,latestDeploymentInfo:void 0,forkedFromBlockId:void 0})}});return a}function to(e){return e&&0===e[0]?"markdown":e&&1===e[0]?"metadata":void 0}function tc(e){var t;let a,s,r,n,l,i;let o=[],c="",d=null===(t=e.find(e=>"metadata"===to(e)))||void 0===t?void 0:t[1];return d&&("context"in d&&void 0!==d.context&&Array.isArray(d.context)&&(o=d.context),"title"in d&&"string"==typeof d.title&&(c=d.title),"finishReason"in d&&(a=d.finishReason),"usage"in d&&(s=d.usage),"loadingText"in d&&"string"==typeof d.loadingText&&(i=d.loadingText),"relevantFiles"in d&&Array.isArray(d.relevantFiles)&&(n=d.relevantFiles),"notifications"in d&&Array.isArray(d.notifications)&&(l=d.notifications),"modelId"in d&&(r=d.modelId)),{docsContext:o,loadingText:i,title:c,modelId:r,finishReason:a,relevantFiles:n,notifications:l,usage:s}}},61934:(e,t,a)=>{"use strict";a.d(t,{y:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40e7b7912efc2f5a39b4890ee373b81c108008a65a",s.callServer,void 0,s.findSourceMapURL,"unlinkVercelProject")},63016:(e,t,a)=>{"use strict";a.d(t,{default:()=>w,t:()=>v});var s=a(7336),r=a(80644),n=a(48166),l=a(52220),i=a(98898),o=a(15066),c=a(10299),d=a(4495),u=a(76907),m=a(58659),h=a(48195),p=a(15993),x=a(60358),g=a(45453),f=a(20685);let v=e=>{let{name:t,onChange:a,errors:r,placeholder:n="New sidebar",disabled:i=!1}=e;return(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsxs)(o.Label,{className:(0,d.cn)((null==r?void 0:r.name)&&"text-red-500"),htmlFor:"name",children:["Name",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(l.p,{autoComplete:"off",className:(0,d.cn)((null==r?void 0:r.name)&&"border-red-500"),disabled:i,id:"name",maxLength:32,minLength:2,name:"name",onChange:a,placeholder:n,required:!0,value:t}),(null==r?void 0:r.name)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:r.name[0]})]})},j=e=>{let{description:t,onChange:a,errors:r}=e;return(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(o.Label,{className:(0,d.cn)((null==r?void 0:r.description)&&"text-red-500"),htmlFor:"description",children:"Description (optional)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.T,{asChild:!0,children:(0,s.jsx)(f.o,{autoComplete:"off",className:(0,d.cn)("pb-8",(null==r?void 0:r.description)&&"border-red-500"),id:"description",maxLength:5e3,name:"description",onChange:a,placeholder:"Describe what this project is going to be used for...",value:t,minHeight:120,maxHeight:384})}),(0,s.jsx)(m.j,{className:"absolute inset-x-1 bottom-2.5",count:t.length,max:5e3,message:"Description cannot be longer than 500 characters",messageThreshold:5e3})]}),(null==r?void 0:r.description)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:r.description[0]})]})},b=e=>{let{instructions:t,onChange:a,errors:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(o.Label,{className:(0,d.cn)((null==r?void 0:r.instructions)&&"text-red-500"),htmlFor:"instructions",children:"Context (optional)"})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.T,{asChild:!0,children:(0,s.jsx)(f.o,{autoComplete:"off",className:(0,d.cn)("pb-4",(null==r?void 0:r.instructions)&&"border-red-500"),id:"instructions",maxLength:5e3,name:"instructions",onChange:a,placeholder:"We're building a new sidebar for...",value:t,minHeight:120,maxHeight:384})}),(0,s.jsx)(m.j,{className:"absolute inset-x-1 bottom-2.5",count:t.length,max:5e3,message:"For larger context, consider using sources on the project page.",messageThreshold:5e3})]}),(null==r?void 0:r.instructions)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:r.instructions[0]})]}),(0,s.jsx)(o.Label,{className:"text-gray-500",children:"Guidelines or instructions the model will use to generate better responses to prompts."})]})},y=e=>{let{formData:t}=e,a=t.name.trim().length>0;return(0,s.jsx)(x.Q,{className:"self-start",disabled:!a,size:"sm",type:"submit","data-testid":"create-project-button",children:"Create Project"})};function w(e){let{randomIcon:t}=e,[a,l]=(0,r.useState)({}),[i,o]=(0,r.useState)({name:"",description:"",instructions:"",icon:t}),[d,m]=(0,r.useTransition)(),x=(0,c.useRouter)(),f=(0,r.useCallback)(e=>{let{name:t,value:a}=e.target;o(e=>({...e,[t]:a}))},[]),w=(0,r.useCallback)(e=>{e.preventDefault(),l({});let{name:t,description:a,instructions:s,icon:r}=i,n=u.H.safeParse({name:t,description:a,instructions:s,icon:r});if(!n.success){l(n.error.flatten().fieldErrors);return}m(async()=>{try{let{id:e,errors:n,success:i}=await (0,h.E)({name:t,description:a,instructions:s,icon:r});if(n){l(n);return}if(i&&e){p.oR.success("Project created successfully"),x.push("/chat/projects/".concat(e));return}l({name:["Failed to create project. Please try again."]})}catch(e){console.error("Failed to create project:",e),p.oR.error("An unexpected error occurred. Please try again."),l({name:["An unexpected error occurred. Please try again."]})}})},[i,x]);return(0,s.jsxs)("div",{className:"bg-background flex min-h-screen flex-col",children:[(0,s.jsx)(n.ProjectPageHeader,{canMakeProjectUpdates:!0}),(0,s.jsx)("main",{className:"bg-background flex flex-1 flex-col overflow-auto p-4 sm:p-6",children:(0,s.jsx)("div",{className:"grid w-full max-w-screen-2xl flex-1 auto-rows-min gap-4 lg:grid-cols-[600px_1fr] lg:gap-x-6 xl:gap-x-9",children:(0,s.jsxs)("form",{className:"flex flex-col gap-6",onSubmit:w,children:[(0,s.jsx)(g.R,{onSelect:e=>o(t=>({...t,icon:e})),isNewPage:!0,color:null,readOnly:!1,icon:t,projectId:""}),(0,s.jsx)(v,{errors:a,name:i.name,onChange:f}),(0,s.jsx)(j,{description:i.description,errors:a,onChange:f}),(0,s.jsx)(b,{errors:a,instructions:i.instructions,onChange:f}),(0,s.jsx)(y,{formData:i,isPending:d})]})})})]})}},64332:(e,t,a)=>{"use strict";a.d(t,{B:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40b7c0f46da6410e7f2920a531f1caa04f88212464",s.callServer,void 0,s.findSourceMapURL,"exportMessages")},64495:(e,t,a)=>{"use strict";a.d(t,{tg:()=>A,vX:()=>_,pN:()=>F,Co:()=>U,yI:()=>O});var s=a(80644),r=a(38917),n=a(64854),l=a(18730),i=a(15993),o=a(61202),c=a(19895),d=a(35339),u=a(10299),m=a(57748),h=a(85168),p=a(95852),x=a(3086),g=a(82399),f=a(88551),v=a(2115),j=a(5099),b=a(45419),y=a(34444),w=a(76073),N=a(43665);async function k(e){return new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{var a;t(null===(a=e.target)||void 0===a?void 0:a.result)},s.onerror=e=>a(e),s.readAsDataURL(e)})}var C=a(88860),S=a(59103),I=a(30009);let M=(0,I.createServerReference)("00c999f40e2986dd773956fd0a08f7a40e19d8c501",I.callServer,void 0,I.findSourceMapURL,"invalidateRouterCache");var z=a(61774);function L(e){if(!e||/[^0-9-\s]+/.test(e)||"0000000000000000"===e)return!1;let t=0,a=!1;e=e.replace(/\D/g,"");for(let s=e.length-1;s>=0;s--){let r=parseInt(e.charAt(s),10);a&&(r*=2)>9&&(r-=9),t+=r,a=!a}return t%10==0}var P=a(68627),R=a(22931),D=a(84758),E=a(40913);let A="opt-retry-message",T=[{name:"creditCardDetector",action:function(e){return(e.match(/\b(?:\d{4}[-\s]?){3}\d{4}\b/g)||[]).filter(L).length>0},confirm:"We've detected a credit card number in your message. Are you sure you want to continue?"}];async function F(e,t){let a=[];if(!e&&t){if(t instanceof FileList)for(let e of Array.from(t)){let{name:t,type:s,size:r}=e,n=await k(e);a.push({name:t,contentType:s,url:n,size:r})}else if(Array.isArray(t))for(let e of t){let{name:t,url:s,contentType:r,size:n,v0Type:l}=e;a.push({name:t,contentType:r,v0Type:l,url:s,size:n})}else throw Error(g.Jk)}return a}function O(){let{onSubmit:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeScope:t,user:a}=(0,w.k6)(),h=(0,c.y6)(),y=(0,c.oQ)(),{chatId:k,messages:I,chatIdToken:L,activeForkKey:A}=(0,l.Pk)(),O=(0,l.jo)(),{setMetadata:V}=(0,m.tZ)(),{setDraft:B}=(0,j.jh)(),{quote:H,setQuote:$}=(0,m.sC)(),{revalidate:q,setData:W}=(0,n.m)(),Z=(0,d.F)(e),G=(0,d.F)(I),[K,Y]=(0,x.d)(),{selectedProjectId:Q}=(0,b._t)(),{mutate:J}=(0,S.Ay)("text-area-value",null),X=function(){let e=(0,c.eu)();return function(e,t){let a=function(e){let t=(0,s.useRef)(),{data:a,mutate:r}=(0,S.Ay)(e);return(0,s.useEffect)(()=>{a||r(t)},[a,r]),a}(e);return(0,s.useEffect)(()=>{a&&(a.current=t)},[a,t]),a}("activeBlockIdRef",null==e?void 0:e.id)}(),{setBlockCreatedAt:ee}=(0,P.y)(),et=(0,u.useRouter)();return{submit:(0,s.useCallback)(async(e,s)=>{var n,l,c,d;for(let t of T)if("input"in e&&e.input&&t.action(e.input)&&!confirm(t.confirm))return;let u=(0,z.C)();if((null==a?void 0:a.id)||!u||(a={id:u,username:"anon",avatar:"",plan:"anon",email:"",name:"Anonymous",teams:[]}),!(null==a?void 0:a.id))return;let m=a.id,x=[...G.current],b=!1;try{let a,i;let d=G.current;await Y();let x=(0,C.vA)(k,()=>O({isLoading:!1,isStreaming:!1,isContinuing:!1})),f=await F(!!u,"attachments"in e?e.attachments:void 0),S=0===d.length||void 0!==s;s||null===(c=Z.current)||void 0===c||c.call(Z),O({isLoading:!0}),S?(window.history.pushState(null,"","/chat/".concat(k)),V({isEmpty:!1}),(0,j.hN)({chatId:void 0})):(0,j.hN)({chatId:k}),B(null);let I=U({input:"input"in e?e.input:void 0,chatSubmitData:e,quote:H,messages:d,activeForkKey:A,authorId:m});if(!I){O({isLoading:!1,isStreaming:!1,isContinuing:!1});return}$(null),O({prefillOptions:{query:void 0,projectId:void 0},isContinuing:"continue"===e.action,isLoading:"continue"!==e.action,isStreaming:"continue"===e.action}),"new"!==e.action&&"edit"!==e.action&&((null===(l=I.newUserMessage)||void 0===l?void 0:null===(n=l.attachments)||void 0===n?void 0:n.length)||0)>0&&f.push(...I.newUserMessage.attachments);let{action:z,continueAssistantMessage:P,newUserMessage:T,newActiveForkKey:K}=I,J=[...d];"type"in e&&T&&(T.type=e.type),T&&!I.isFromQParam&&J.push(T),O({messages:J,activeForkKey:I.newActiveForkKey});let et=document.getElementById(D.Q);et&&et.click();let ea={};if(s)a=s.readableStream.getReader(),ea=s.headers;else{let s=t&&!(0,N.W)(t)?t.slug:void 0,r=await fetch("/chat/api/chat",{method:"POST",body:JSON.stringify({message:(null==T?void 0:T.content)||void 0,messageId:null==T?void 0:T.id,forceResponse:"forceResponse"in e?e.forceResponse:void 0,chatId:k,chatIdToken:L,isNew:S,thinkingMode:"new"===e.action?e.thinkingMode:void 0,messageMode:"new"===e.action?e.messageMode:void 0,figmaContext:"figmaContext"in e?e.figmaContext:void 0,userMessageType:"type"in e?e.type:void 0,forkKey:null==K?void 0:K.slice(0,-1),...Q?{projectId:Q}:{},action:z,...f.length>0?{attachments:f}:{},team:s,..."workflowState"in e?{workflowState:e.workflowState}:{},..."new"===e.action&&void 0!==e.autopilot?{autopilot:e.autopilot}:{}}),headers:{"Content-Type":"application/json"},signal:x});if(!r.ok||!r.body){let e=await r.text();throw Error(e)}ea=Object.fromEntries(r.headers.entries()),a=r.body.getReader()}let es=ea["x-v0-url-attachments"]?JSON.parse(atob(ea["x-v0-url-attachments"])):void 0;es&&void 0!==T&&(J[J.length-1].attachments=[...J[J.length-1].attachments||[],...es||[]],O({messages:J}));let er=function(e,t){let a=e["x-v0-project-id"],s=e["x-v0-project-name-base64"],r=e["x-v0-project-color"],n=e["x-v0-project-icon"],l=e["x-v0-project-creator-id"],i=e["x-v0-project-vercel-project-id"]||null;if(a&&s)return{projectId:a,name:atob(s),settings:{color:r,icon:n},vercelProjectId:i,isCreator:t===l}}(ea,null==t?void 0:t.id);er&&V({project:er});let en=ea["x-v0-user-message-id"];if(!en)throw Error(g.RK);P&&(J=J.filter(e=>"assistant"!==e.role||e.id!==P.id));let el=!1,ei=new TextDecoder,eo=ea["x-v0-response-message-id"];if(!eo)throw Error(g.Og);let ec=_({responseMessageId:eo,action:z,newActiveForkKey:K,userMessageServerId:en}),ed=[],eu="continue"===e.action,em=()=>eu?null==P?void 0:P.content:ed;function w(t){x.throwIfAborted();try{var a;let s=JSON.parse(t);ed=(0,r.F)(ed,s),eu&&(null===(a=ed.find(e=>"markdown"===(0,o.h)(e)))||void 0===a?void 0:a[1])&&(eu=!1);let n=(0,o.sY)(ed,eo),l=(0,o.LU)(ed);if(!el&&"string"==typeof l.title&&l.title&&(el=!0,V({title:l.title}),S&&l.title&&W(e=>[{title:l.title,chatId:k,updatedAt:new Date,shareable:!1,privacy:"private",favorite:!1,optimistic:!0,authorId:m},...e.filter(e=>e.chatId!==k)],!1)),i={parentId:en,role:"assistant",content:em(),context:l.docsContext,id:eo,blocks:n.map(e=>e.id),loadingText:l.loadingText,streaming:!1===eu,finishReason:l.finishReason||null,relevantFiles:l.relevantFiles,notifications:l.notifications,usage:l.usage,modelId:l.modelId,continuingMessageId:null==P?void 0:P.id,type:"type"in e&&"added-integration"===e.type?"added-integration":"message"},O({messages:[...J,i],isLoading:!1,isStreaming:!0}),n.length>=1){let e=n[n.length-1];return e.id!==(null==X?void 0:X.current)||R.kX.includes(e.type)||h(e),n}}catch(e){(0,v.u)("ChatHookError",{chatId:k,errorCode:g.mB,errorMsg:"Failed to read row: ".concat(t)}),"production"!==E.env.VERCEL_ENV&&console.error(e,"Error reading row:",t)}}i={parentId:en,role:"assistant",content:em(),id:eo,streaming:void 0===P,finishReason:null,continuingMessageId:null==P?void 0:P.id,type:"message"},O({messages:[...J,i],activeForkKey:ec,saveLeafMessageId:!0}),b=!0;let eh="",ep=null;for(;;){x.throwIfAborted();let{done:e,value:t}=await a.read();if(e)break;let s=eh+(t instanceof Uint8Array?ei.decode(t):t),{isLlmError:r,isRetried:n,errorCategory:l="default"}=(0,p.c)(s);if(r)throw O({messages:[...J,{...i,finishReason:n?"retry_provider_server_error:".concat(l):"provider_server_error:".concat(l)}]}),Error(g.kR);let o=s.split("\n");for(let e=0;e<o.length-1;e++){let t=w(o[e]),a=(null==t?void 0:t.length)&&t[t.length-1].id!==ep;ep&&(null==X?void 0:X.current)!==ep||!a||(ee(t[t.length-1].id,new Date().toISOString()),ep=t[t.length-1].id,R.kX.includes(t[t.length-1].type)||y(!0,t[t.length-1]))}eh=o[o.length-1]}eh&&w(eh),O({messages:[...J,{...i,streaming:!1}],isStreaming:!1,isContinuing:!1,initialStreamPromise:void 0}),S&&(await M(),q()),(0,C.$p)(k)}catch(a){if(a instanceof Error&&"AbortError"===a.name)return;!b&&"onFailToPrompt"in e&&(null===(d=e.onFailToPrompt)||void 0===d||d.call(e)),O({isLoading:!1,isStreaming:!1,isContinuing:!1,initialStreamPromise:void 0,prefillOptions:{query:void 0,projectId:void 0},...b?{}:{activeForkKey:A,messages:x}}),(0,C.mU)(k),(0,f.z)(a,et,"Failed to submit message. Start a new chat, retry, or edit your message.",{scopeSlug:(0,N.W)(t)?void 0:null==t?void 0:t.slug,lastUserInput:"input"in e?e.input:void 0,chatId:k,projectId:Q||void 0})||i.oR.error("An unexpected error occurred. Please refresh the page and try again."),b||0!==x.length||et.push("/chat")}},[a,A,G,Y,k,O,B,H,$,Z,V,t,L,Q,W,X,h,y,et,q,J]),stopLlmResponse:(0,s.useCallback)(()=>{let e=G.current;if((0,C.mU)(k),e.length>0){let t=e[e.length-1];"assistant"===t.role&&O({messages:[...e.slice(0,-1),{...t,streaming:!1}]})}setTimeout(()=>O({isStreaming:!1,isLoading:!1}),0)},[k,G,O])}}function U(e){let{input:t,chatSubmitData:a,quote:s,messages:r,activeForkKey:n,authorId:l}=e;switch(a.action){case"continue":case"retry":{let e;if(!n)throw Error(g.R2);let t=a.assistantMessageId,s=r.find(e=>"id"in e&&e.id===t&&"assistant"===e.role);if(!s||"assistant"!==s.role||!s.parentId)throw Error(g.p2);"continue"===a.action&&(e={...s,continuingMessageId:t});let l="retry"===a.action?(0,h.Mb)(n,t,A+(0,y.Ok)()):n;return{action:{type:a.action,userMessageId:s.parentId,assistantMessageId:t},continueAssistantMessage:e,newActiveForkKey:l}}case"edit":{if(!t)throw Error(g.FD);if(!n)throw Error(g.tK);let e=t?V(t,s):null,l=a.userMessageId,i=r.find(e=>e.id===l);if((null==i?void 0:i.role)!=="user")throw Error(g.p2);let o=(0,y.Ok)(),c={role:"user",content:e,id:o,attachments:a.attachments,parentId:i.parentId,type:"message",authorId:i.authorId};return a.thinkingMode&&(c.thinkingMode=a.thinkingMode),{newUserMessage:c,action:{type:"edit",userMessageId:i.id},newActiveForkKey:(0,h.Mb)(n,i.id,o)}}case"fix-with-v0":{let e=t?V(t,s):null;if(!t)throw Error(g.FD);let a=(0,y.Ok)(),r=(0,h._z)(n,a);return{newUserMessage:{role:"user",content:e||"",id:a,attachments:[],parentId:(0,h.K1)(n),type:"fix-with-v0",authorId:l},newActiveForkKey:r,action:{type:"fix-with-v0"}}}case"new":{let e=t?V(t,s):null;if(1===r.length&&"user"===r[0].role)return{isFromQParam:!0,newUserMessage:r[0],newActiveForkKey:(0,h._z)(void 0,r[0].id)};if(!t&&(!a.attachments||0===a.attachments.length))throw Error(g.FD);let i=(0,y.Ok)(),o=(0,h._z)(n,i),c={role:"user",content:e||"",id:i,attachments:a.attachments,parentId:(0,h.K1)(n),type:"message",authorId:l};return a.thinkingMode&&(c.thinkingMode=a.thinkingMode),{newUserMessage:c,newActiveForkKey:o}}default:throw Error(g.dD)}}function V(e,t){return t?"".concat(t.split("\n").map(e=>"> "+e).join("\n"),"\n\n").concat(e):e}function _(e){let{responseMessageId:t,action:a,newActiveForkKey:s,userMessageServerId:r}=e;if((null==a?void 0:a.type)==="continue"||(null==a?void 0:a.type)==="retry")return(0,h.qQ)(s,t);let n=(0,h.qQ)(s,r);return(0,h._z)(n,t)}},65021:(e,t,a)=>{"use strict";a.d(t,{E:()=>r});var s=a(30009);let r=(0,s.createServerReference)("409b26bc728874775782922005696ecc8b2d5da103",s.callServer,void 0,s.findSourceMapURL,"updateBlockShareStatus")},65086:(e,t,a)=>{"use strict";a.d(t,{Ip:()=>v,X3:()=>j,eD:()=>g,ie:()=>b});var s=a(7336),r=a(80644),n=a(58356),l=a(69987),i=a.n(l),o=a(4495),c=a(24582),d=a(18742),u=a(8899),m=a(21414),h=a(39215),p=a(42394),x=a(23063);function g(e){switch(e){case"error":return"!text-red-700 bg-red-50 hover:bg-red-100";case"warn":return"text-amber-700 bg-amber-50 hover:bg-amber-100";default:return"text-gray-700 hover:bg-gray-100"}}function f(e){let{value:t}=e;return Array.isArray(t)?(0,s.jsx)("div",{className:"flex flex-col gap-2 font-mono text-[13px] leading-4 text-gray-900",children:[...t].map((e,t)=>{let[a,r]=e;return a.startsWith("image/")?(0,s.jsx)("img",{alt:"Attachment ".concat(t),src:"data:".concat(a,";base64,").concat(r)},t):a.startsWith("text/")||a.startsWith("application/")?(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:r},t):null})}):null}let v=(0,r.memo)(e=>{let{src:t,className:a,style:r}=e;return"string"==typeof t?(0,s.jsx)("span",{className:(0,o.cn)("whitespace-break-spaces break-all leading-[1.12] text-gray-900",a),children:(0,s.jsx)(i(),{children:t})}):(0,s.jsx)(n.Ay,{className:(0,o.cn)("leading-4 text-gray-900 [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",a),collapsed:1,editable:!1,enableClipboard:!1,src:t,theme:"default",style:r})});v.displayName="JsonRowView";let j=(0,r.memo)(e=>{let{value:t,className:a,inline:r}=e;return(0,s.jsx)("output",{"aria-label":"Code execution output",className:(0,o.cn)("codeblock not-prose relative flex w-full flex-col overflow-y-auto font-mono text-[13px]",a),children:t?"error"in t?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)(h.ErrorComponent,{error:Error(t.error,{cause:"code-execution-error"})})}):(0,s.jsxs)(s.Fragment,{children:[t.stdout.length?t.stdout.map((e,t)=>(0,s.jsx)(b,{inline:r,children:e.map((e,a)=>(0,s.jsx)(v,{src:e,className:"leading-normal"},"".concat(t,"-").concat(a,"-stdout")))},"".concat(t,"-stdout"))):null,t.stderr.length?t.stderr.map((e,t)=>(0,s.jsx)(b,{className:r?g("error"):void 0,inline:r,children:e.map((e,a)=>(0,s.jsx)(v,{className:(0,o.cn)("leading-normal [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",r&&"text-red-700"),src:e,style:{color:"rgb(192,27,93)"}},"".concat(t,"-").concat(a,"-stderr")))},"".concat(t,"-stderr"))):null,t.returned?(0,s.jsx)(b,{inline:r,children:"$$attachments"in t.returned?t.returned.$$attachments.length>0?(0,s.jsx)(f,{value:t.returned.$$attachments}):null:(0,s.jsx)(v,{className:"leading-normal [&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",src:t.returned})}):null]}):null})});function b(e){let{children:t,fileName:a,isCopied:r,handleCopy:n,handleDownload:l,handleFileOpen:i,inline:h,className:g}=e,{scp:f}=(0,x.D)();return null===t?null:(0,s.jsxs)("div",{className:(0,o.cn)("border-alpha-200 group/code-output-message flex w-full flex-col gap-2 border-b p-2 text-[13px] last:border-b-0",!h&&"pl-2.5",g),children:[(0,s.jsxs)("div",{className:"relative flex w-full items-baseline gap-3",children:[!h&&(0,s.jsx)("div",{"aria-hidden":!0,className:"select-none text-pink-700 dark:text-pink-500",children:(0,s.jsx)(d.c,{size:8})}),a?(0,s.jsx)("button",{className:"codeblock not-prose line-clamp-1 font-mono text-blue-700 underline",onClick:i,children:a}):t,f&&!h&&(0,s.jsx)("div",{className:(0,o.cn)("pointer-events-none absolute inset-y-0 right-0 z-10"),children:(0,s.jsxs)(p.Kn,{className:"pointer-events-auto sticky top-3 flex -translate-y-1.5 opacity-0 group-hover:opacity-100 has-[[data-state='delayed-open']]:opacity-100 has-[[data-state='instant-open']]:opacity-100 has-[[data-state=open]]:opacity-100 md:top-5 [[data-touch-active=true]_&]:opacity-100",children:[(0,s.jsx)(p.rc,{"aria-label":"Copy",onClick:n,tooltip:"Copy",children:(0,s.jsx)("span",{"aria-hidden":!0,children:r?(0,s.jsx)(c.J,{}):(0,s.jsx)(u.Q,{className:"pointer-events-none"})})}),(0,s.jsx)(p.Sl,{className:"author-action"}),(0,s.jsx)(p.rc,{"aria-label":"Download",onClick:l,tooltip:"Download",children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(m.f,{className:"pointer-events-none"})})})]})})]}),a&&(0,s.jsx)("div",{className:"pl-5",children:t})]})}j.displayName="CodeOutput"},65718:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var s=a(7336),r=a(4495),n=a(32921);function l(e){let{icon:t,size:a="sm",variant:l="default",className:i}=e;return(0,s.jsx)("div",{className:(0,r.cn)("bg-background-subtle relative flex size-8 shrink-0 items-center justify-center text-gray-500 after:absolute after:inset-0 after:mix-blend-darken dark:after:mix-blend-lighten",{"size-5 rounded-sm after:rounded-sm [&>svg]:size-2.5 text-base after:border":"xs"===a,"size-8 rounded-lg after:rounded-lg [&>svg]:size-4 text-base after:border":"sm"===a,"size-12 rounded-xl after:rounded-xl [&>svg]:size-4 text-xl shadow-sm":"lg"===a},"menu-item"===l&&"size-4 bg-transparent text-gray-600 after:hidden group-hover:text-gray-900 group-focus:text-gray-900 [&>svg]:size-4",i),children:(0,s.jsx)(n.n,{name:t})})}},66544:(e,t,a)=>{"use strict";a.d(t,{SR:()=>n});let s=["mermaid","math","csv","toolcall","local"],r=new Map([["mermaid","mermaid"],["math","math"],["csv","csv"],["toolcall","toolcall"],["local","local"],["abap","abap"],["astro","astro"],["bat","bat"],["cmd","bat"],["bib","bibtex"],["bibtex","bibtex"],["clj","clojure"],["cljs","clojure"],["cljc","clojure"],["clojure","clojure"],["coffee","coffeescript"],["coffeescript","coffeescript"],["c","c"],["h","c"],["cpp","cpp"],["cc","cpp"],["cxx","cpp"],["hpp","cpp"],["hh","cpp"],["hxx","cpp"],["cs","csharp"],["csharp","csharp"],["docker-composeyml","dockercompose"],["docker-composeyaml","dockercompose"],["dockercompose","dockercompose"],["css","css"],["cu","cuda-cpp"],["cuh","cuda-cpp"],["cuda-cpp","cuda-cpp"],["d","d"],["pas","pascal"],["pascal","pascal"],["diff","diff"],["patch","diff"],["dockerfile","dockerfile"],["erl","erlang"],["hrl","erlang"],["erlang","erlang"],["fs","fsharp"],["fsi","fsharp"],["fsx","fsharp"],["fsharp","fsharp"],["gitcommit","git-commit"],["git-commit","git-commit"],["gitrebase","git-rebase"],["git-rebase","git-rebase"],["go","go"],["groovy","groovy"],["gvy","groovy"],["gy","groovy"],["gsh","groovy"],["hbs","handlebars"],["handlebars","handlebars"],["haml","haml"],["hs","haskell"],["lhs","haskell"],["haskell","haskell"],["html","html"],["htm","html"],["ini","ini"],["java","java"],["mjs","javascript"],["cjs","javascript"],["js","javascript"],["javascript","javascript"],["jsx","javascriptreact"],["javascriptreact","javascriptreact"],["json","json"],["jsonc","jsonc"],["jl","julia"],["julia","julia"],["kt","kotlin"],["kts","kotlin"],["kotlin","kotlin"],["tex","latex"],["latex","latex"],["less","less"],["lua","lua"],["makefile","makefile"],["mk","makefile"],["md","markdown"],["mdx","markdown"],["markdown","markdown"],["m","objective-c"],["objective-c","objective-c"],["mm","objective-cpp"],["objective-cpp","objective-cpp"],["ml","ocaml"],["mli","ocaml"],["ocaml","ocaml"],["pl","perl"],["pm","perl"],["t","perl"],["perl","perl"],["p6","perl6"],["pl6","perl6"],["pm6","perl6"],["perl6","perl6"],["php","php"],["txt","plaintext"],["plaintext","plaintext"],["ps1","powershell"],["psm1","powershell"],["psd1","powershell"],["powershell","powershell"],["jade","jade"],["pug","pug"],["py","python"],["rpy","python"],["pyw","python"],["cpy","python"],["python","python"],["r","r"],["cshtml","razor"],["razor","razor"],["rb","ruby"],["rbx","ruby"],["rjs","ruby"],["gemspec","ruby"],["ruby","ruby"],["rs","rust"],["rust","rust"],["scss","scss"],["sass","sass"],["shader","shaderlab"],["shaderlab","shaderlab"],["sh","shellscript"],["bash","shellscript"],["zsh","shellscript"],["shellscript","shellscript"],["slim","slim"],["sql","sql"],["styl","stylus"],["stylus","stylus"],["svelte","svelte"],["swift","swift"],["ts","typescript"],["typescript","typescript"],["terraform","terraform"],["tf","terraform"],["hcl","terraform"],["tsx","typescriptreact"],["typescriptreact","typescriptreact"],["tex","tex"],["vb","vb"],["vue","vue"],["vue-html","vue-html"],["svg","xml"],["xml","xml"],["xsl","xsl"],["xslt","xsl"],["yaml","yaml"],["yml","yaml"]]);function n(e){var t;if(!e)return"plaintext";let a=null!==(t=r.get(e))&&void 0!==t?t:"plaintext";return s.includes(a)?"plaintext":a}new Map(Array.from(r.entries()).map(e=>{let[t,a]=e;return[a,t]})).set("typescriptreact","tsx")},66785:(e,t,a)=>{"use strict";a.d(t,{x:()=>j});var s=a(7336),r=a(81616),n=a(80644),l=a(2115),i=a(64495),o=a(19895),c=a(71279),d=a(20685),u=a(67952),m=a(52735),h=a(19461),p=a(99942),x=a(43190),g=a(9097),f=a(53155);function v(e){let{isSignedIn:t,disableAttachmentsButton:a,inputFileRef:l,isPromptFormDisabled:i,textAreaRef:o,onInputChange:c}=e,[d,u]=(0,n.useState)(!1),{setShowSignInDialog:m}=(0,f.AO)();return t?(0,s.jsx)(r.$,{asChild:!0,className:(0,g.cn)("size-8 hover:bg-gray-100 focus:bg-gray-50 focus-visible:bg-gray-100",(a||i)&&"pointer-events-none bg-gray-100 text-gray-400 ring-0"),disabled:a,size:"sm",tooltip:{content:"Attach Files",hidden:d},variant:"secondary",children:(0,s.jsxs)("label",{"data-id":"prompt-form-image-upload",htmlFor:"fileUpload",children:[(0,s.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:a,id:"fileUpload",multiple:!0,onChange:e=>{var t;c(e),null===(t=o.current)||void 0===t||t.focus()},onClick:()=>u(!0),ref:l,tabIndex:a?-1:0,type:"file"}),(0,s.jsx)(x.x,{}),(0,s.jsx)("span",{className:"sr-only",children:"Attach Files"})]})}):(0,s.jsxs)(r.$,{className:"size-8 text-gray-500",disabled:a,onClick:()=>{var e;m({prompt:(null===(e=o.current)||void 0===e?void 0:e.value)||""})},size:"sm",tooltip:"Attach Files",variant:"ghost",children:[(0,s.jsx)(x.x,{}),(0,s.jsx)("span",{className:"sr-only",children:"Attach Files"})]})}function j(e){let{handleCancel:t,initialText:a,messageId:x,type:g,content:f,initialAttachments:j,thinkingMode:b,v3Submit:y}=e,{submit:w}=(0,i.yI)(),N=(0,o.oQ)(),{formRef:k,onKeyDown:C}=(0,c.G)(),S=(0,n.useRef)(null),I=(0,u.k)("editPromptForm");(0,n.useEffect)(()=>{S.current&&(S.current.focus(),S.current.selectionStart=S.current.value.length,S.current.selectionEnd=S.current.value.length)},[]),(0,n.useEffect)(()=>{if(!S.current)return;let e=e=>{"Escape"===e.key&&(t(),e.stopPropagation())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t]);let{blobs:M,uploading:z,localFileInfos:L,isDraggingFile:P,inputFileRef:R,onInputChange:D,removeFile:E}=(0,h.Ay)({isSignedIn:!0,dragContainerRef:k,saveToDrafts:!1}),[A,T]=(0,n.useState)(j||[]);return(0,s.jsxs)("form",{className:"@container/form flex w-full flex-1 flex-col gap-3 overflow-hidden",onSubmit:e=>{var s;e.preventDefault();let r=null===(s=S.current)||void 0===s?void 0:s.value;if(!r||""===r.trim())return;let n=r;"refinement"===g&&(n=(0,m.i_)(f,n)),S.current.value="",N(!1),y?y({input:n,attachments:[...A,...M]}):Promise.all([w({action:"edit",input:n,userMessageId:x,type:g,attachments:[...A,...M],thinkingMode:b}),(0,l.u)("SubmitEditUserMessage",{messageId:x,oldText:a,newText:n})]),t()},ref:k,children:[(0,s.jsxs)("div",{className:"relative z-10 grid rounded-lg border bg-white",children:[(0,s.jsx)(d.o,{className:"w-full rounded-t-lg p-3 text-sm outline-none ring-0",defaultValue:a,id:"chat-edit-textarea",minHeight:96,name:"content",onKeyDown:C,placeholder:I("editYourMessage"),ref:S}),(0,s.jsxs)(p.q6,{className:"px-3",children:[(0,s.jsx)(v,{isSignedIn:!0,disableAttachmentsButton:z,inputFileRef:R,isPromptFormDisabled:!1,textAreaRef:S,onInputChange:D}),(0,s.jsx)(p.wJ,{files:L,removeFile:E,showDropzone:P,existingAttachments:A,removeExistingAttachment:e=>{T(t=>t.filter(t=>t.url!==e))}})]})]}),(0,s.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.$,{onClick:t,size:"sm",type:"button",variant:"secondary",children:I("cancel")}),(0,s.jsx)(r.$,{"data-testid":"edit-form-send-button",size:"sm",children:I("submit")})]})})]})}},67320:(e,t,a)=>{"use strict";a.d(t,{o:()=>i});var s=a(7336),r=a(403),n=a(96378),l=a(4495);function i(e){let{knowledgeSource:t,className:a}=e;switch(null==t?void 0:t.toLowerCase()){case"nextjs.org":return(0,s.jsx)(n.default,{alt:"Next.js Logo",className:a,height:16,src:"/chat-static/citation/nextjs.svg",width:16});case"vercel.com":case"sdk.vercel.ai":return(0,s.jsx)(n.default,{alt:"Vercel Logo",className:a,height:16,src:"/chat-static/citation/vercel.svg",width:16});case"turbo.build":return(0,s.jsx)(n.default,{alt:"Turbopack Logo",className:a,height:16,src:"/chat-static/citation/turbo.svg",width:16});case"flags-sdk.dev":return(0,s.jsx)(n.default,{alt:"Vercel Logo",className:a,height:16,src:"/chat-static/citation/flags.svg",width:16});case"svelte.dev":case"kit.svelte.dev":return(0,s.jsx)(n.default,{alt:"Svelte Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/svelte.svg",width:16});case"docs.stripe.com":return(0,s.jsx)(n.default,{alt:"Stripe Logo",className:(0,l.cn)(a,"rounded-none"),height:12,src:"/chat-static/citation/stripe.svg",width:12});case"remix.run":return(0,s.jsx)(n.default,{alt:"Remix Logo",className:(0,l.cn)(a,"rounded-none"),height:12,src:"/chat-static/citation/remix.svg",width:12});case"vuejs.org":return(0,s.jsx)(n.default,{alt:"Vue Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/vue.svg",width:16});case"react.dev":return(0,s.jsx)(n.default,{alt:"React Logo",className:(0,l.cn)(a,"rounded-none"),height:16,src:"/chat-static/citation/react.svg",width:16});case"typescriptlang.org":return(0,s.jsx)(n.default,{alt:"Typescript Logo",className:(0,l.cn)(a),height:16,src:"/chat-static/citation/ts.svg",width:16});case"github.com":return(0,s.jsx)(n.default,{alt:"Github Logo",className:a,height:16,src:"/chat-static/citation/github.svg",width:16});case"ui.shadcn.com":return(0,s.jsx)(n.default,{alt:"shadcn/ui Logo",className:(0,l.cn)(a),height:16,src:"/chat-static/citation/shadcn-ui.svg",width:16});case"radix-ui.com":return(0,s.jsx)(n.default,{alt:"Radix UI Logo",className:(0,l.cn)(a,"size-3.5 translate-x-0.5 rounded-none"),height:14,src:"/chat-static/citation/radix-ui.svg",width:14});case"orm.drizzle.team":return(0,s.jsx)(n.default,{alt:"Drizzle Logo",className:(0,l.cn)(a,"dark:invert"),height:22,src:"/chat-static/citation/drizzle.svg",width:22});case"supabase.com":return(0,s.jsx)(n.default,{alt:"Supabase Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/supabase.svg",width:14});case"www.prisma.io":return(0,s.jsx)(n.default,{alt:"Prisma Logo",className:(0,l.cn)(a,"dark:invert"),height:14,src:"/chat-static/citation/prisma.svg",width:14});case"playwright.dev":return(0,s.jsx)(n.default,{alt:"Playwright Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/playwright.svg",width:14});case"neon.tech":return(0,s.jsx)(n.default,{alt:"Neon Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/neon.svg",width:14});case"upstash.com":return(0,s.jsx)(n.default,{alt:"Upstash Logo",className:(0,l.cn)(a),height:14,src:"/chat-static/citation/upstash.svg",width:14});default:return(0,s.jsx)(r.q,{className:(0,l.cn)(a,"rounded-none"),size:16})}}},67437:(e,t,a)=>{"use strict";a.d(t,{k:()=>n});var s=a(15993),r=a(18342);function n(e){let{data:t,isLoading:a,error:n}=(0,r.A)(e||null,e=>fetch("/chat/api/chat/download?url=".concat(e)).then(e=>e.text()));return n&&s.oR.error("Failed to load file content"),{content:t,isLoading:a}}},68627:(e,t,a)=>{"use strict";a.d(t,{y:()=>l});var s=a(18730),r=a(59103),n=a(80644);function l(){let{chatId:e}=(0,s.xz)(),{data:t,mutate:a}=(0,r.Ay)(["block:createdAt",e]);return{getBlockCreatedAt:(0,n.useCallback)(e=>{var a;return null!==(a=null==t?void 0:t.get(e))&&void 0!==a?a:void 0},[t]),setBlockCreatedAt:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)))},[t,a])}}},68971:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var s=a(42975),r=a(59103),n=a(19895),l=a(80644),i=a(35339);function o(e){let{data:t,mutate:a}=(0,r.Ay)("browser-frame:canGoBack",{fallbackData:!1}),{data:o,mutate:c}=(0,r.Ay)("browser-frame:canGoForward",{fallbackData:!1}),{data:d,mutate:u}=(0,r.Ay)("browser-frame:href",{fallbackData:""}),{data:m,mutate:h}=(0,r.Ay)("browser-frame:iframe",{fallbackData:null}),{data:p,mutate:x}=(0,r.Ay)("browser-frame:loading",{fallbackData:!0}),{data:g,mutate:f}=(0,r.Ay)("browser-frame:temporalHref",{fallbackData:null}),v=(0,n.eu)(),j=(0,i.F)(d),b=(0,l.useMemo)(()=>e||(null==v?void 0:v.id),[e,v]),y=(0,l.useCallback)(()=>{m&&(m.contentDocument?m.contentDocument.location.reload():j.current?m.src=j.current:m.src=m.src,f(null),x(!0))},[m,j,x,f]);return(0,l.useEffect)(()=>{let e;if(!b)return;let t=(0,s.j)(b),r=document.getElementById(t),n=e=>{let{data:t}=e;if(t&&"object"==typeof t&&t.__v0_remote__)switch(t.type){case"location_change":u(e.data.href),a("boolean"==typeof e.data.canGoBack&&e.data.canGoBack),c("boolean"==typeof e.data.canGoForward&&e.data.canGoForward);break;case"app_navigation_state":x(e.data.loading)}};return window.addEventListener("message",n),r||(e=new MutationObserver(()=>{let a=document.getElementById(t);a&&(null==e||e.disconnect(),h(a))})).observe(document.body,{childList:!0,subtree:!0}),h(r),x(!0),()=>{window.removeEventListener("message",n);try{null==e||e.disconnect()}catch(e){}}},[b,u,x]),{canGoBack:t,setCanGoBack:a,canGoForward:o,setCanGoForward:c,href:d,setHref:u,iframe:m,latestHref:j,loading:p,setLoading:x,refresh:y,temporalHref:g,setTemporalHref:f}}},70584:(e,t,a)=>{"use strict";function s(e){if("user"===e.role)return!e.content&&(!e.attachments||0===e.attachments.length);let t=0===e.content.length,a=1===e.content.length&&1===e.content[0][0],s=e.content.length>0&&0===e.content[0][0]&&0===e.content[0][1].length;return t||a||s}function r(e){return"user"===e.role&&!e.content&&e.attachments&&e.attachments.length>0}function n(e){return"user"===e.role&&e.content&&e.content.startsWith("<v0_local_project_task>")}function l(e){return"user"===e.role&&e.content&&e.content.startsWith("<user_action ")}a.d(t,{Ne:()=>s,ZW:()=>r,pW:()=>l,pm:()=>n})},72464:(e,t,a)=>{"use strict";a.d(t,{c:()=>s,l:()=>l});let s=new Map;function r(e){if(e.nodeType===e.TEXT_NODE)return["#text",{}];if(e.nodeType!==e.ELEMENT_NODE)return["",{}];if("SPAN"===e.nodeName&&e.classList.contains("katex-html"))return["skip",{}];if("SPAN"===e.nodeName&&e.classList.contains("katex-mathml")){var t;return["#text",{},(null===(t=e.querySelector('annotation[encoding="application/x-tex"]'))||void 0===t?void 0:t.textContent)||""]}if("SPAN"===e.nodeName&&(e.classList.contains("linenumber")||e.classList.contains("react-syntax-highlighter-line-number")))return["skip",{}];let a=e.getAttribute("data-seg")||"";if("root"===a||"skip"===a)return[a,{}];let r=s.get(a);return[(null==r?void 0:r.type)||a,(null==r?void 0:r.props)||{}]}let n=new Set(["skip","footnoteReference"]);function l(e,t,a,s){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i="";function o(e,t,c,d){let[u,m,h]=r(e);if(n.has(u))return;if("#text"===u){c&&a&&l&&(i+="...");let t="string"==typeof h?h:e.textContent||"";i+=t,d&&s&&l&&(i+="...");return}let p={...t};switch(u){case"Codeblock":if(m.blockId){var x,g;i+=function(e){let{lang:t,project:a,file:s}=e;return"```".concat(t).concat(a?' project="'.concat(a,'"'):"").concat(s?' file="'.concat(s,'"'):"","\n")}({lang:m.lang,project:null===(x=m.meta)||void 0===x?void 0:x.project,file:null===(g=m.meta)||void 0===g?void 0:g.file})+"...\n```\n\n";return}i+="```".concat(m.lang||"","\n");break;case"code":i+="`";break;case"b":case"strong":i+="**";break;case"i":case"em":i+="*";break;case"del":i+="~~";break;case"hr":i+="---";break;case"Math":i+="$$";break;case"InlineMath":i+="$";break;case"li":if(t.ol){let e=m.index||"1";i+="".concat(e,". ")}else t.ul&&(i+="- ");break;case"ol":t.ol=!0;break;case"ul":t.ul=!0;break;case"h1":i+="# ";break;case"h2":i+="## ";break;case"h3":i+="### ";break;case"h4":i+="#### ";break;case"h5":i+="##### ";break;case"h6":i+="###### ";break;case"blockquote":i+="> ";break;case"tr":t.tableCols=0;break;case"th":case"td":t.tableCols=(t.tableCols||0)+1,p.tableCols=t.tableCols,t.tableCols>1&&(i+=" "),i+="| ";break;case"a":i+="["}let f=e.childNodes.length;for(let a=0;a<f;a++)o(e.childNodes[a],t,c&&0===a,d&&a===f-1);switch(u){case"Codeblock":i+="\n```\n\n";break;case"code":i+="`";break;case"b":case"strong":i+="**";break;case"i":case"em":i+="*";break;case"del":i+="~~";break;case"Math":i+="$$";break;case"InlineMath":i+="$";break;case"li":case"tr":i+="\n";break;case"p":case"table":case"hr":case"blockquote":case"ul":case"ol":case"img":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":i+="\n\n";break;case"thead":i+="|-----".repeat(t.tableCols||1)+"\n";break;case"a":i+="](".concat(m.href||"",")")}Object.assign(t,p)}return l?function t(a){let[s,n]=r(a);switch(s){case"ul":return o(e,{ol:!1,ul:!0},!0,!0);case"ol":return o(e,{ol:!0,ul:!1},!0,!0);case"Codeblock":i+="```".concat(n.lang||"","\n"),o(e,{ol:!1,ul:!1},!0,!0),i+="\n```";return;case"blockquote":o(e,{ol:!1,ul:!1},!0,!0),i=i.split("\n").map(e=>"> ".concat(e)).join("\n");return;case"del":i+="~~",o(e,{ol:!1,ul:!1},!0,!0),i+="~~";return;case"h1":return i+="# ",o(e,{ol:!1,ul:!1},!0,!0);case"h2":return i+="## ",o(e,{ol:!1,ul:!1},!0,!0);case"h3":return i+="### ",o(e,{ol:!1,ul:!1},!0,!0);case"h4":return i+="#### ",o(e,{ol:!1,ul:!1},!0,!0);case"h5":return i+="##### ",o(e,{ol:!1,ul:!1},!0,!0);case"h6":return i+="###### ",o(e,{ol:!1,ul:!1},!0,!0);case"table":case"root":case"img":case"Math":return o(e,{ol:!1,ul:!1},!0,!0)}if(a.parentNode){if(a.nodeType===a.ELEMENT_NODE){let t=document.createDocumentFragment(),s=a.cloneNode(!1);s.appendChild(e),t.appendChild(s),e=t}t(a.parentNode)}}(t):o(e,{ol:!1,ul:!1},!0,!0),i.trim()}},72704:(e,t,a)=>{"use strict";a.d(t,{f:()=>n});var s=a(75580),r=a.n(s);let n=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return a-e.getTime()<1e3?"Just now":"".concat(r()(a-e.getTime(),{long:!0})).concat(t?" ago":"")}},72775:(e,t,a)=>{"use strict";a.d(t,{P:()=>h,c:()=>m});var s=a(7336),r=a(34210),n=a(90062),l=a(61202),i=a(80912),o=a(80644),c=a(4495),d=a(70584),u=a(90434);let m=o.memo(function(e){var t;let{children:a,...r}=e;return a.length>1e4?(0,s.jsx)("p",{children:a}):(0,s.jsx)(n.o,{remarkPlugins:[u.QZ],...r,components:{pre:e=>(0,s.jsx)("pre",{...e,className:"bg-background border-alpha-400 text-foreground rounded-lg border p-2 px-[0.25rem] py-[0.15rem] font-mono text-xs font-normal [&_code]:border-none [&_code]:bg-transparent"}),code:e=>{let{children:t,...a}=e;return"string"==typeof t&&(0,u.TN)(t)?(0,s.jsx)(u.br,{value:t}):(0,s.jsx)("code",{...a,className:"rounded-[0.375rem] border bg-gray-100 px-[0.25rem] py-[0.15rem] font-mono text-xs font-normal before:hidden after:hidden",children:t})},...null!==(t=r.components)&&void 0!==t?t:{}},children:a})});function h(e){var t;let{message:a,className:n,isLastMessage:o=!1}=e,u=(0,r.B)(a);return"string"==typeof a.content?(0,s.jsx)(i.s,{className:(0,c.cn)("w-full",n),children:(0,s.jsx)(m,{children:a.content})},u):(0,d.Ne)(a)?null:(0,s.jsx)("div",{className:(0,c.cn)("flex-1 text-sm",n),children:(0,s.jsx)(l.A4,{isLastMessage:o,messageId:u,role:a.role,rows:null!==(t=a.content)&&void 0!==t?t:[],streaming:a.streaming})},u)}},73669:(e,t,a)=>{"use strict";a.d(t,{SidebarFavorites:()=>c});var s=a(7336),r=a(99876),n=a(11913),l=a(67921),i=a(22705),o=a(80644);function c(e){let{v3:t=!1,maxChats:a=10}=e;return(0,s.jsx)(o.Suspense,{fallback:(0,s.jsx)(m,{numChats:Math.floor(a/2)}),children:(0,s.jsx)(d,{maxChats:a,v3:t})})}function d(e){let{v3:t,maxChats:a}=e,{data:{favorites:o}}=(0,i.j)({},"getChats"),c=o.slice(0,a),d=c.length?(0,s.jsx)(s.Fragment,{children:c.map(e=>{let a=e.title||"Untitled Chat";return(0,s.jsxs)(r.SidebarListItem,{children:[(0,s.jsx)(r.SidebarListItemLink,{href:"/chat/".concat(t?"v3/":"").concat((0,l.D)(e.chatId,e.title)),children:(0,s.jsx)("span",{title:a,children:a})}),(0,s.jsx)(r.SidebarListItemAction,{children:(0,s.jsx)(n.ChatActions,{chat:e,side:"right",tooltip:{content:"",hidden:!0}})})]},e.chatId)})}):(0,s.jsx)(r.SidebarEmptyState,{children:"Favorite chats that you use often."});return(0,s.jsx)(u,{children:(0,s.jsx)(r.SidebarList,{children:d})})}function u(e){let{children:t}=e;return(0,s.jsxs)(r.SidebarSection,{children:[(0,s.jsx)(r.SidebarLabel,{children:"Favorite Chats"}),t]})}function m(e){let{numChats:t}=e;return(0,s.jsx)(u,{children:(0,s.jsx)(r.SidebarListSkeleton,{length:t})})}},73769:(e,t,a)=>{"use strict";a.d(t,{V:()=>S});var s=a(7336),r=a(81616),n=a(96378),l=a(63e3),i=a(17145),o=a(76989),c=a(15993),d=a(23063),u=a(59103),m=a(76073),h=a(43665),p=a(31508),x=a(4304),g=a(60586),f=a(57748),v=a(18730),j=a(3650),b=a(45419),y=a(38597),w=a(64495),N=a(81226),k=a(2115);let C={supabase:"/chat-static/citation/supabase.svg",neon:"/chat-static/citation/neon.svg",upstash:"/chat-static/citation/upstash.svg","upstash-kv":"/chat-static/citation/upstash.svg"};function S(e){var t;let{integration:a,onConnect:S,status:I,vercelProjectId:M,onStatusChange:z}=e,{es:L}=(0,d.D)(),{stores:P}=function(){let{activeScope:e,activeScopeSlug:t}=(0,m.k6)(),a=(0,p._)(),s=e&&(0,h.W)(e)?null!=a?a:"":null!=t?t:"",r=new URLSearchParams;r.set("teamSlug",s);let{data:n,error:l,isLoading:i,mutate:o}=(0,u.Ay)(s?"/chat/api/integrations/marketplace/storage?".concat(r.toString()):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch storage stores");return t.json()},{revalidateOnReconnect:!0});return{stores:{data:(null==n?void 0:n.stores)||[],isLoading:i,error:l||null,refetch:o},isLoading:i,error:l||null,refetch:async()=>{await Promise.all([o()])}}}(),{stores:R}=(0,g.g)({projectId:null!=M?M:void 0,refreshInterval:0}),D=(0,f.tZ)(),{chatId:E}=(0,v.xz)(),{vercelProjectWithDashboard:A,refetchVercelProject:T}=(0,b.Ok)(null===(t=D.project)||void 0===t?void 0:t.projectId),{submit:F}=(0,w.yI)(),O=async e=>{var t;if(null===(t=D.project)||void 0===t?void 0:t.projectId)return{projectId:D.project.projectId,vercelProjectWithDashboard:A};z(e,"creating_project");let a=await (0,j.g)({projectName:D.title,chatId:E||"",onSuccess:()=>{},includeSuccessToast:!1});if(!a.id)return c.oR.error("Failed to create project. Please add this chat to a project."),null;await D.setMetadata({...D,project:{projectId:a.id,vercelProjectId:a.vercelProjectId||null,name:D.title,settings:{icon:"icon-wand-sparkles",color:null},isCreator:!0}});let s=await T();return s?{projectId:a.id,vercelProjectWithDashboard:s}:(c.oR.error("Failed to fetch project data. Please try again."),null)},U=async e=>{try{z(a.slug,"linking_integration");let t=await O(a.slug);if(!t)throw Error("Failed to create project");let{projectId:s,vercelProjectWithDashboard:r}=t;if(!r||!s)throw Error("Failed to create project");if(!(await fetch("/chat/api/integrations/marketplace/storage/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:e,projectId:r.project.id})})).ok)throw Error("Failed to connect store");if(R.refetch(),(0,k.u)("ConnectExistingIntegration",{integrationId:a.id,integrationName:a.name,storeId:e,projectId:r.project.id}),c.oR.success("Integration connected successfully"),N.o0.includes(a.slug)){let t=await (0,y.W)({props:{language:"sql",source:"SQL_SCHEMA_QUERY",meta:{file:"",transaction:"false"},closed:!1,originalCode:void 0,isPreviewable:!1},projectId:s,initialVercelProjectId:null!=M?M:void 0,operationId:"".concat(e,"-").concat(s)});"error"in t?await F({action:"new",attachments:[],input:"The ".concat(a.name," instance has been connected to the [Vercel Project](").concat(r.project.url,"). We were unable to query the schema for the newly connected ").concat(a.name," instance."),type:"added-integration"}):await F({action:"new",attachments:[],input:"The ".concat(a.name," instance has been connected to the [Vercel Project](").concat(r.project.url,"). The schema for this instance is ").concat(t.stdout.join("\n")),type:"added-integration",workflowState:"explain-existing-sql-db"})}else await F({action:"new",attachments:[],input:"The ".concat(a.name," instance has been connected to the [Vercel Project](").concat(r.project.url,")."),type:"added-integration",workflowState:"add-nonsql-store"})}catch(e){c.oR.error("Failed to connect integration")}},V=P.data.filter(e=>e.product&&e.product.slug===a.slug);return"creating_project"===I?(0,s.jsx)(x.Q,{pending:!0,disabled:!0,variant:"secondary",size:"sm",children:"Creating project"}):"linking_integration"===I?(0,s.jsx)(x.Q,{pending:!0,disabled:!0,variant:"secondary",size:"sm",children:"Connecting"}):(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(r.$,{size:"sm",variant:"secondary",className:"w-full\n          ".concat(V.length>0&&L?"rounded-r-none border-r-0 w-[calc(100%-34px)]":"","\n        "),onClick:async()=>{var e;z(a.slug,"linking_integration");let t=window.open("","_blank","width=1200,height=800"),s=await O(a.slug);if(!s||!(null===(e=s.vercelProjectWithDashboard)||void 0===e?void 0:e.dashboardProject))throw Error("Failed to create project");await S(a,s.projectId,s.vercelProjectWithDashboard.dashboardProject,t)},children:"Connect"}),V.length>0&&L?(0,s.jsxs)(o.DropdownMenu,{children:[(0,s.jsx)(o.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(r.$,{size:"sm",variant:"secondary",className:"rounded-l-none px-2 w-[34px]",children:(0,s.jsx)(l.y,{className:"h-4 w-4"})})}),(0,s.jsxs)(o.DropdownMenuContent,{className:"max-h-[200px] overflow-y-auto p-1",align:"end",children:[(0,s.jsxs)(o.DropdownMenuItem,{onClick:async()=>{var e;z(a.slug,"linking_integration");let t=await O(a.slug);if(!t||!(null===(e=t.vercelProjectWithDashboard)||void 0===e?void 0:e.dashboardProject))throw Error("Failed to create project");await S(a,t.projectId,t.vercelProjectWithDashboard.dashboardProject,null)},className:"gap-3 px-3",children:[(0,s.jsx)(i.f,{className:"size-4"}),(0,s.jsx)("span",{children:"Create new"})]}),V.map(e=>(0,s.jsxs)(o.DropdownMenuItem,{className:"gap-3 px-3",onClick:()=>U(e.id),children:[(0,s.jsx)(n.default,{src:C[a.slug]||"/placeholder.svg",alt:a.slug,width:16,height:16}),(0,s.jsx)("span",{children:e.name||"Unnamed Instance"})]},e.id))]})]}):null]})}},74179:(e,t,a)=>{"use strict";a.d(t,{q:()=>r});var s=a(26939);function r(){let{user:e,expectUser:t}=(0,s.J)();return t&&!e?{isLoading:!0}:(t||e)&&((null==e?void 0:e.v0plan)!=="v0-enterprise"||e.isVercelian)?{canVote:!0,isLoading:!1}:{canVote:!1,isLoading:!1}}},76403:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var s=a(16081),r=a(46902);function n(e){for(let t=e.length-1;t>=0;t--)if("usage"in e[t]&&e[t].usage)return e[t].usage.totalTokens;return e.reduce((e,t)=>{if("attachments"in t){var a;null===(a=t.attachments)||void 0===a||a.forEach(t=>{var a;let s=t.contentType;s&&(0,r.Ye)(s)?e+=1600:(s&&(0,r.Lu)(s,null===(a=t.name)||void 0===a?void 0:a.split(".").pop()),e+=1e3)})}let n="string"==typeof t.content?t.content:"";return e+(0,s.bP)(n)},0)}},76907:(e,t,a)=>{"use strict";a.d(t,{H:()=>r});var s=a(72633);let r=s.z.object({name:s.z.string().min(2,"Name must be at least 2 characters").max(32,"Name cannot be longer than 32 characters"),description:s.z.string().max(5e3,"Description cannot be longer than 5000 characters").optional(),instructions:s.z.string().max(5e3,"Context cannot be longer than 5000 characters").optional()})},77177:(e,t,a)=>{"use strict";a.r(t),a.d(t,{TemplateImage:()=>u});var s=a(7336),r=a(50688),n=a(96378),l=a(59103),i=a(97947),o=a(43707),c=a(4495);function d(e){return fetch(e).then(e=>e.json())}function u(e){let{index:t,templateCanonId:a,src:u,alt:m,showScreenshotMessage:h=!1,className:p,...x}=e,{data:g}=(0,l.Ay)(u?null:"/chat/api/template-image/".concat(a),d,{refreshInterval:2e3});return u||(null==g?void 0:g.imageUrl)?(0,s.jsx)(n.default,{className:(0,c.cn)("object-cover object-top",p),fill:!0,loading:t&&t>4?"lazy":"eager",decoding:t&&t>4?"async":"sync",alt:m||"",src:u||(null==g?void 0:g.imageUrl),...x}):h?(0,s.jsx)("div",{className:"flex size-full flex-col items-center justify-center gap-3",children:(0,s.jsx)(i.Sv,{children:(0,s.jsxs)(i.HY,{children:[(0,s.jsx)(i.Ft,{children:(0,s.jsx)(o._,{})}),(0,s.jsxs)(i.Ou,{className:"font-medium",children:["We're grabbing a screenshot of your template, or",(0,s.jsx)("br",{}),"you can upload your own image."]})]})})}):(0,s.jsx)(r.E,{className:"h-full w-full"})}},78566:(e,t,a)=>{"use strict";a.d(t,{Y:()=>l});var s=a(26939),r=a(9097),n=a(59103);function l(){let{expectUser:e}=(0,s.J)(),{data:t,mutate:a}=(0,n.Ay)(e?"/chat/api/scopes/user":null,r.GO);return{user:t,mutate:a}}},80730:(e,t,a)=>{"use strict";a.d(t,{i:()=>k});var s=a(7336),r=a(81616),n=a(76989),l=a(37522),i=a(33190),o=a(83748),c=a(8899),d=a(95805),u=a(13870),m=a(39444),h=a(93125),p=a(30919),x=a(15993),g=a(45419),f=a(89021),v=a(2115),j=a(80644),b=a(4495),y=a(25109),w=a(97760),N=a(22705);function k(e){let{project:t,canMakeProjectUpdates:a,className:k,disableFetchOnHover:C=!1,side:S="bottom",hideFavoriteButton:I=!1}=e,[M,z]=(0,h.useDeleteProjectModal)(),{setProject:L}=(0,p.useRenameProjectModal)(),{vercelProjectWithDashboard:P,refetchVercelProject:R}=(0,g.Ok)(t.projectId),[D,E]=(0,j.useState)(!!t.favoritedAt),A=(0,j.useMemo)(()=>null==P?void 0:P.project.url,[P]),T=async()=>{try{await navigator.clipboard.writeText(t.projectId),x.oR.success("Project ID copied to clipboard")}catch(e){console.error("Failed to copy project ID:",e),x.oR.error("Failed to copy project ID")}},{data:F,mutate:O}=(0,N.j)({},"getProjects"),[U,V]=(0,j.useState)(!1),_=(0,j.useCallback)(async()=>{if(V(!0),D){(0,v.u)("UnfavoriteProject",{targetProjectId:t.projectId}),E(!1);let e=F.map(e=>e.projectId===t.projectId?{...e,favoritedAt:null}:e);await O({serverMutate:(0,y.j)(t.projectId).then(e=>{e.error&&x.oR.error("Failed to unfavorite project")}),optimisticData:(0,f.p)(e,"favoritedAt")})}else{(0,v.u)("FavoriteProject",{targetProjectId:t.projectId}),E(!0);let e=F.some(e=>e.projectId===t.projectId)?F.map(e=>e.projectId===t.projectId?{...e,favoritedAt:new Date}:e):[...F,{...t,chatCount:0,sourceCount:0,favoritedAt:new Date}];await O({serverMutate:(0,w.s)(t.projectId).then(e=>{e.error&&x.oR.error("Failed to favorite project")}),optimisticData:(0,f.p)(e,"favoritedAt")})}V(!1)},[D,O,t,F]);return(0,s.jsxs)(n.DropdownMenu,{children:[(0,s.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(r.$,{className:(0,b.cn)("size-7 rounded-md",k),"cmdk-item-actions":"","data-testid":"project-header-dropdown-button",size:"sm",variant:"ghost",onFocus:()=>{C||R()},onMouseEnter:()=>{C||R()},children:[(0,s.jsx)(l.a,{}),(0,s.jsx)("span",{className:"sr-only",children:"Open project actions"})]})}),(0,s.jsx)(n.DropdownMenuContent,{align:"bottom"===S?"end":"start",side:S,sideOffset:8,children:(0,s.jsxs)(n.DropdownMenuGroup,{children:[a&&(0,s.jsxs)(n.DropdownMenuItem,{"aria-label":"Rename project",onSelect:()=>L({projectId:t.projectId,projectName:t.name}),children:[(0,s.jsx)(i.Y,{}),(0,s.jsx)("span",{children:"Rename"})]}),(0,s.jsxs)(n.DropdownMenuItem,{"aria-label":"Copy project ID",onSelect:T,children:[(0,s.jsx)(c.Q,{}),(0,s.jsx)("span",{children:"Copy Project ID"})]}),I?null:(0,s.jsxs)(n.DropdownMenuItem,{variant:D?"gold":"default",disabled:U,onSelect:_,children:[D?(0,s.jsx)(m.e,{}):(0,s.jsx)(u.F,{}),(0,s.jsx)("span",{children:D?"Unfavorite":"Favorite"})]}),(0,s.jsx)(n.DropdownMenuItem,{disabled:!A,"aria-label":"View on Vercel",asChild:!0,children:(0,s.jsxs)("a",{href:A,target:"_blank",rel:"noopener noreferrer",children:[(0,s.jsx)(d.i,{}),(0,s.jsx)("span",{children:"View on Vercel"})]})}),a&&(0,s.jsxs)(n.DropdownMenuItem,{"aria-label":"Delete project",onSelect:()=>z(t.projectId),variant:"destructive",children:[(0,s.jsx)(o.l,{}),(0,s.jsx)("span",{children:"Delete"})]})]})})]})}},80743:(e,t,a)=>{"use strict";a.d(t,{q:()=>i});var s=a(26939),r=a(80644),n=a(18730),l=a(85168);function i(e){let{messageId:t}=e,{chatId:a,messages:i,activeForkKey:o}=(0,n.Pk)(),{user:c}=(0,s.J)(),{botText:d,userMessageId:u}=(0,r.useMemo)(()=>{let e={botText:void 0,userMessageId:void 0};if(!t||!o)return e;let a=i.findIndex(e=>"id"in e&&e.id===t);return a<0?e:{botText:i[a].content,userMessageId:(0,l.qR)(o,t)}},[i,t,o]);return{chatId:a,messageText:d,promptMessageId:u,messageId:t,userId:null==c?void 0:c.id}}},80775:(e,t,a)=>{"use strict";a.d(t,{e:()=>ee,Y:()=>X});var s=a(7336),r=a(80644),n=a(18730),l=a(51621);let i=r.memo(function(e){let{value:t,animate:a,onAnimationComplete:n}=e,{truncatedValue:i,duration:o,delayConstant:c,n:d}=(0,r.useMemo)(()=>{let e=.015,a=.03,s=Math.min(t.length,40);if(.045*s>300){let t=300/s;e=e/.045*t,a=a/.045*t}return{truncatedValue:t.length>40?t.slice(0,40)+"...":t,duration:e,delayConstant:a,n:s}},[t]);return(0,s.jsx)("div",{className:"truncate",children:i.split("").map((e,t)=>(0,s.jsx)(l.P.span,{animate:a?"animate":void 0,"aria-hidden":"true",initial:a?"initial":void 0,onAnimationComplete:()=>{t===d-1&&(null==n||n())},transition:{duration:o,ease:"easeIn",delay:t*c,staggerChildren:c},variants:{initial:{opacity:0,x:-100},animate:{opacity:1,x:0}},children:e},t))})});var o=a(26939),c=a(57748),d=a(27362),u=a(81616),m=a(67952),h=a(27337);function p(e){let{isAuthor:t}=e,a=(0,m.k)("chatOptionsDropdown"),{chatId:r}=(0,n.xz)(),{user:l}=(0,o.J)(),{title:p,isNew:x,authorId:g}=(0,c.tZ)(),{chatPrivacy:f}=(0,c.kM)(),{setUpdateChatTitleDialogForChatId:v}=(0,d.d)(),j=x&&!!p,b=t||(null==l?void 0:l.id)===g;return r&&p?(0,s.jsx)("h1",{className:"flex min-w-0 items-center gap-1.5 text-sm text-gray-900",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.$,{className:"!h-auto flex-1 truncate p-0 text-sm font-normal text-gray-900",name:"Rename Chat",onClick:()=>{b&&r&&v(r)},tooltip:r?a("renameChat"):void 0,variant:"link",children:(0,s.jsx)("div",{"aria-label":p,className:"truncate","data-testid":"chat-title",children:(0,s.jsx)(i,{animate:j,value:p},"".concat(r,"-").concat(j))})}),(0,s.jsx)(h.i,{chatId:r,privacy:f})]}):(0,s.jsx)("div",{className:"max-w-72 truncate","data-testid":"chat-title",children:p})}):(0,s.jsx)("div",{})}var x=a(3388),g=a(99887),f=a(4495),v=a(34481),j=a(38230),b=a.n(j),y=a(166),w=a(2115),N=a(93774),k=a(37522),C=a(33190),S=a(83748),I=a(64297),M=a(64826),z=a(20693),L=a(76989),P=a(11913),R=a(64854),D=a(99982),E=a(76073),A=a(35740),T=a(33508),F=a(7363),O=a(46732),U=a(43554),V=a(19895),_=a(17781),B=a(61202),H=a(15765),$=a(64495),q=a(45419),W=a(23063),Z=a(95687),G=a(45449),K=a(17777),Y=a(19291),Q=a(39695);function J(e){let{chatId:t,projectId:a,isAuthor:r,isFavorite:n,isVercelian:l}=e,{setDeleteDialogForChatId:i}=(0,N.v)(),{title:o}=(0,c.tZ)(),{setUpdateChatTitleDialogForChatId:h}=(0,d.d)(),p=(0,m.k)("chatOptionsDropdown"),{setData:x}=(0,R.m)();return(0,s.jsxs)(L.DropdownMenu,{children:[(0,s.jsx)(L.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(u.$,{size:"sm",className:"size-7 rounded-md",variant:"ghost",children:[(0,s.jsx)(k.a,{}),(0,s.jsx)("span",{className:"sr-only",children:p("moreOptions")})]})}),(0,s.jsx)(L.DropdownMenuContent,{align:"end",children:(0,s.jsxs)(L.DropdownMenuGroup,{children:[(0,s.jsx)(F.w,{isAuthor:r}),(0,s.jsx)(L.DropdownMenuItem,{className:(0,f.cn)("md:hidden",!a&&"hidden"),asChild:!0,children:(0,s.jsxs)(b(),{href:"/chat/projects/".concat(a),children:[(0,s.jsx)(I.z,{}),(0,s.jsx)("span",{children:p("viewProject")})]})}),(0,s.jsxs)(L.DropdownMenuItem,{onClick:()=>{t&&((0,w.u)("RenameChat",{targetChatId:t}),h(t))},children:[(0,s.jsx)(C.Y,{}),(0,s.jsx)("span",{children:p("renameChat")})]}),t&&(0,s.jsx)(P.$,{chat:{chatId:t,title:o||"",favorite:!!n,updatedAt:(null==n?void 0:n.updatedAt)||null},setChatHistoryData:x}),l&&(0,s.jsx)(b(),{href:"/chat/v3/".concat(t),children:(0,s.jsxs)(L.DropdownMenuItem,{children:[(0,s.jsx)(G.s,{}),(0,s.jsx)("span",{children:"Open in New Editor"}),(0,s.jsx)(K.E,{variant:"secondary",size:"sm",children:"Internal"})]})}),(0,s.jsxs)(L.DropdownMenuItem,{onClick:()=>{t&&i(t)},variant:"destructive",children:[(0,s.jsx)(S.l,{}),(0,s.jsx)("span",{children:p("deleteChat")})]})]})})]})}let X=new Intl.ListFormat("en",{style:"long",type:"conjunction"});function ee(e){let{isAuthor:t}=e,{project:a,title:l,canWriteToChat:i}=(0,c.tZ)(),{chatId:d}=(0,n.xz)(),{activeScope:h,user:j}=(0,E.k6)(),{expectUser:b}=(0,o.J)(),[N,k]=(0,r.useState)(!1),{gs:C}=(0,W.D)(),S=(null==j?void 0:j.isAdminMode)||t,{planSlug:I}=(0,A.N)(!0,null==h?void 0:h.id),L=null==j?void 0:j.isAdminMode,P=null==j?void 0:j.isVercelian,F="v0-level0"!==I||L||(null==j?void 0:j.isVercelian),{reassignPending:G,handleReassignProject:K}=(0,T.Z)(),{data:ee}=(0,R.r)(),et=(0,r.useMemo)(()=>null==ee?void 0:ee.find(e=>e.chatId===d),[ee,d]),{reopenLastBlock:ea}=(0,U.e)(),es=(0,V.eu)(),er=(0,_.$)(),{messages:en,activeForkKey:el}=(0,n.Pk)(),ei=(0,r.useMemo)(()=>en.filter(e=>null==el?void 0:el.includes(e.id)).some(e=>{var t;return(0,B.sY)(null!==(t=e.content)&&void 0!==t?t:"",e.id).length>0}),[en,el]),{submit:eo}=(0,$.yI)(),{vercelProjectWithDashboard:ec}=(0,q.Ok)(null==a?void 0:a.projectId),{refetchLinks:ed}=(0,H.d)({source:"settings"},async e=>{k(!1),e.forEach(e=>{(0,w.u)("AddIntegration",{integration:e})});let t=e.some(e=>"supabase"===e.integrationName||"neon"===e.integrationName);await eo({action:"new",attachments:[],input:"The integration".concat(e.length>1?"s":""," ").concat(X.format(e.map(e=>e.integrationName))," ").concat(e.length>1?"have":"has"," been added to the [Vercel Project](").concat(null==ec?void 0:ec.project.url,")."),type:"added-integration",workflowState:t?"add-sql-db":"add-nonsql-store"})}),eu=(0,Q.t)(),em=(0,m.k)("chatHeader"),eh=eu?(0,s.jsx)(Y.e,{mobileTriggerClassName:"mr-2"}):null,ep=(0,s.jsx)(g.NewChatButton,{className:"mr-4 sm:mr-2",variant:"logo"});return(0,s.jsxs)("header",{className:(0,f.cn)("bg-background @container/chat-header relative z-10 flex h-16 shrink-0 items-center justify-between gap-4 sm:h-12",eu?"px-4 sm:px-2":["ml-[54px] mr-4 w-[calc(100%-70px)] px-0 sm:mx-0 sm:w-full sm:pl-4 sm:pr-2",!b&&"ml-4 w-auto"]),children:[(0,s.jsxs)("nav",{className:"flex w-full min-w-0 flex-1 items-center sm:gap-1",children:[b?eh:ep,(0,s.jsxs)("div",{className:"flex min-w-0 items-center gap-1",children:[t&&((null==a?void 0:a.name)||F)&&(0,s.jsxs)("div",{"aria-label":"Breadcrumb",className:"hidden min-w-0 items-center gap-1 text-gray-500 sm:flex",children:[(0,s.jsx)(D.o,{quickCreate:!0,handleProjectSelect:K,variant:a?"show":void 0,className:"max-w-[140px]",triggerButton:(0,s.jsxs)("button",{disabled:G,className:"flex w-full items-center justify-start gap-1 text-sm text-gray-500 underline-offset-2 transition-all hover:text-gray-900 hover:underline",children:[a?null:(0,s.jsx)(M.F,{className:"size-3 shrink-0"}),(0,s.jsx)("div",{className:"truncate",children:(null==a?void 0:a.name)||(0,s.jsx)("span",{children:em("project")})})]}),disabled:G}),(0,s.jsx)("span",{"aria-hidden":!0,className:"text-gray-500",children:"/"})]}),(0,s.jsx)(p,{isAuthor:t})]})]}),b?S?(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[(0,s.jsx)("div",{className:"flex items-center gap-0.5",children:(null==j?void 0:j.isAdminMode)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"hidden sm:flex",children:(0,s.jsx)(y.v,{})}),(0,s.jsx)("span",{className:"hidden sm:flex",children:(0,s.jsx)(v.Z,{})})]})}),C?(0,s.jsx)(Z.zs,{projectId:null==a?void 0:a.projectId}):null,i?(0,s.jsx)(O.b,{v0ProjectId:null==a?void 0:a.projectId,chatTitle:l,isSheetOpen:N,onOpenChange:k,initiatePolling:ed}):null,(0,s.jsx)(J,{chatId:d,projectId:null==a?void 0:a.projectId,isAuthor:t,isFavorite:et,isVercelian:P}),!es&&!er&&ei&&(0,s.jsx)(u.$,{variant:"ghost",size:"sm",onClick:()=>ea(),title:"Reopen last block",className:"size-7 rounded-md",children:(0,s.jsx)(z.U,{className:"h-4 w-4"})}),(0,s.jsx)(g.NewChatButton,{className:"ml-2 inline-flex sm:hidden"})]}):null:(0,s.jsx)(x._,{})]})}},80912:(e,t,a)=>{"use strict";a.d(t,{s:()=>n});var s=a(7336),r=a(4495);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("prose prose-sm prose-gray min-w-0 break-words",t),...a})}},81049:(e,t,a)=>{"use strict";a.d(t,{L:()=>o});var s=a(18730),r=a(59103),n=a(80644),l=a(65021),i=a(15993);function o(){let{chatId:e}=(0,s.xz)(),{data:t,mutate:a}=(0,r.Ay)(["blocks-shared",e]),o=(0,n.useCallback)(e=>{var a;return null!==(a=null==t?void 0:t.get(e))&&void 0!==a&&a},[t]);return{getBlockShared:o,setBlockShared:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)));try{(0,l.E)({blockId:e,shared:s})}catch(e){(0,i.oR)("Failed to update block publish status")}},[t,a]),updateBlockInSharedMap:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)))},[t,a])}}},81226:(e,t,a)=>{"use strict";a.d(t,{Dk:()=>i,_5:()=>s,o0:()=>l,ud:()=>r,yC:()=>n});let s=2,r=["upstash","neon","supabase"],n={upstash:"database",neon:"database",supabase:"database"},l=["supabase","neon"],i=[new Set(l)]},81279:(e,t,a)=>{"use strict";a.d(t,{s:()=>n});var s=a(59103),r=a(45333);function n(e){let{blockId:t,fileName:a,originalCode:n,newCode:l}=e,{data:i,mutate:o}=(0,s.Ay)(["block:diffView:show",t],{fallbackData:!1}),{data:c}=(0,s.Ay)(["block:diffView",t,a],{fallbackData:n?(0,r.G)(n,l):[]});return{diffs:(null==c?void 0:c.find(e=>e.added||e.removed))&&c||null,showDiffs:i,setShowDiffs:o}}},81792:(e,t,a)=>{"use strict";a.d(t,{M:()=>r});var s=a(30009);let r=(0,s.createServerReference)("7c343c380f6bfcabb68df23417b8284e46f3433530",s.callServer,void 0,s.findSourceMapURL,"doExecution")},82420:(e,t,a)=>{"use strict";a.d(t,{Y:()=>o});var s=a(7336),r=a(30542),n=a(81616),l=a(35399),i=a(4495);function o(e){let{className:t,...a}=e,{setFeedbackDialog:o}=(0,l.f)();return(0,s.jsx)(n.$,{variant:"ghost",className:(0,i.cn)("size-7 rounded-md text-gray-600",t),tooltip:"Share Feedback",size:"sm",onClick:()=>o(!0),...a,children:(0,s.jsx)(r.v,{})})}},83030:(e,t,a)=>{"use strict";function s(e,t){var a;return!!((null===(a=e.data)||void 0===a?void 0:a.source)&&e.data.lang&&t.includes(e.data.lang))}a.d(t,{m:()=>s})},84758:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c,w:()=>d});var s=a(7336),r=a(39717),n=a(95057),l=a(4495),i=a(3086),o=a(67952);let c="scroll-down-button";function d(e){let{scrollToBottom:t,hidden:a,className:d,...u}=e,m=(0,o.k)("scrollDownButton"),{showBannerLimit:h,showBannerGeneral:p}=(0,i.f)();return(0,s.jsx)("div",{id:c,"aria-hidden":a,className:(0,l.cn)("animate-in fade-in slide-in-from-bottom absolute inset-x-0 -top-12 z-10 m-auto flex w-fit items-center justify-center",a&&"animate-out fade-out slide-out-to-bottom fill-mode-forwards pointer-events-none",(h||p)&&"-top-16",d),...u,children:(0,s.jsx)(n.Tooltip,{content:!a&&(0,s.jsx)(n.TooltipContent,{side:"top",sideOffset:14,children:m("scrollToBottom")}),children:(0,s.jsx)("button",{className:(0,l.cn)("animate-slowBounce shadow-base bg-background hover:bg-muted flex size-7 items-center justify-center rounded-full text-gray-500 drop-shadow-md",a&&"hidden"),onClick:e=>{e.stopPropagation(),t()},type:"button",children:(0,s.jsx)(r.D3D,{className:"size-5"})})})})}},85323:(e,t,a)=>{"use strict";a.d(t,{X:()=>r,z:()=>n});var s=a(2115);function r(e){let t=n(e),a=new Blob([t],{type:"text/plain"}),r=URL.createObjectURL(a),l=document.createElement("a");return l.download="output.txt",l.href=r,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),(0,s.u)("DownloadOutputExecutable",{output:t})}let n=e=>{if(!e)return"No output.";if("error"in e)return"Errored output. "+e.error;if(!Array.isArray(e.stdout)||!Array.isArray(e.stderr))return"Malformed output.";if(0===e.stdout.length&&0===e.stderr.length)return"Empty output.";let t=e.stdout.map(e=>e.map(e=>JSON.stringify(e,void 0,2)).join(" ")).join("\n"),a=e.stderr.map(e=>e.map(e=>JSON.stringify(e,void 0,2)).join(" ")).join("\n");return 0===e.stderr.length?t:0===e.stdout.length?"# stderr\n\n"+a:"# stdout\n\n"+t+"\n\n# stderr\n\n"+a}},85625:(e,t,a)=>{"use strict";a.d(t,{KI:()=>n,RN:()=>r});let s={"icon-alarm-clock":{tags:["alarm","clock","time"]},"icon-apple":{tags:["apple","fruit","brand"]},"icon-app-window-mac":{tags:["app","window","mac"]},"icon-atom":{tags:["atom","science","molecule"]},"icon-bar-chart":{tags:["bar-chart","data","analytics"]},"icon-blocks":{tags:["blocks","building","structure"]},"icon-book-text":{tags:["book","text","reading"]},"icon-briefcase":{tags:["briefcase","work","portfolio"]},"icon-bug":{tags:["bug","issue","error"]},"icon-calendar":{tags:["calendar","date","event"]},"icon-camera":{tags:["camera","photo","picture"]},"icon-code":{tags:["code","development","programming"]},"icon-fingerprint":{tags:["fingerprint","security","authentication"]},"icon-flame":{tags:["flame","fire","heat"]},"icon-flask-conical":{tags:["flask","science","experiment"]},"icon-folder-closed":{tags:["folder","closed","directory"]},"icon-gamepad":{tags:["gamepad","gaming","controller"]},"icon-github":{tags:["github","code","repository"]},"icon-gitlab":{tags:["gitlab","code","repository"]},"icon-globe":{tags:["globe","world","internet"]},"icon-heart":{tags:["heart","love","favorite"]},"icon-home":{tags:["home","house","dashboard"]},"icon-image":{tags:["image","picture","photo"]},"icon-key-square":{tags:["key","security","access"]},"icon-laptop":{tags:["laptop","computer","device"]},"icon-layers":{tags:["layers","stack","structure"]},"icon-lightbulb":{tags:["lightbulb","idea","innovation"]},"icon-link":{tags:["link","connection","hyperlink"]},"icon-lock":{tags:["lock","security","protection"]},"icon-mail":{tags:["mail","email","communication"]},"icon-message-square-text":{tags:["message","text","chat"]},"icon-palette":{tags:["palette","color","art"]},"icon-paint-roller":{tags:["paint","roller","art"]},"icon-pie-chart":{tags:["pie-chart","data","analytics"]},"icon-rocket":{tags:["rocket","launch","space"]},"icon-scroll-text":{tags:["scroll","text","document"]},"icon-settings":{tags:["settings","gear","preferences"]},"icon-shield-check":{tags:["shield","check","security"]},"icon-smartphone":{tags:["smartphone","mobile","device"]},"icon-siren":{tags:["siren","alert","alarm"]},"icon-sprout":{tags:["sprout","growth","nature"]},"icon-square-function":{tags:["function","math","calculation"]},"icon-traffic-cone":{tags:["traffic","cone","warning"]},"icon-trending-down":{tags:["trending-down","decrease","statistics"]},"icon-trending-up":{tags:["trending-up","increase","statistics"]},"icon-trophy":{tags:["trophy","award","achievement"]},"icon-user":{tags:["user","person","profile"]},"icon-wand-sparkles":{tags:["wand","magic","sparkles"]},"icon-wrench":{tags:["wrench","tool","repair"]},"icon-zap":{tags:["zap","lightning","electricity"]}},r=Object.keys(s);function n(e){return e&&e in s?e:"icon-flask-conical"}},86807:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>o,hl:()=>c});var s=a(7336),r=a(80644),n=a(84295),l=a(4495);let i=n.bL;n.Mz;let o=n.l9;n.bm;let c=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,withOverlay:o,...c}=e,d=(0,s.jsx)(n.UC,{align:r,className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 bg-background z-50 w-[21rem] overflow-hidden rounded-xl shadow-md outline-none",a),ref:t,sideOffset:i,...c});return(0,s.jsx)(n.ZL,{children:o?(0,s.jsx)("div",{className:"fixed inset-0 z-[2000]",children:d}):d})});c.displayName=n.UC.displayName},86991:e=>{e.exports={loading:"loading-dots_loading__XNw9B",blink:"loading-dots_blink__PxRH1"}},87608:(e,t,a)=>{"use strict";a.d(t,{N:()=>Q});var s=a(7336),r=a(80644),n=a(4495),l=a(11572),i=a(98335),o=a(81616),c=a(15993),d=a(23063),u=a(76073),m=a(38597),h=a(57748),p=a(30009);let x=(0,p.createServerReference)("6007cb6d2630c7a22e8bc93058c104c1426f404373",p.callServer,void 0,p.findSourceMapURL,"updateSqlExecutionStateAction");var g=a(97210),f=a(21491),v=a(52959),j=a(65086),b=a(59103),y=a(66818),w=a(26163),N=a(85323),k=a(67952),C=a(48963),S=a(99942),I=a(747),M=a(64495),z=a(78088),L=a(96378),P=a(60586),R=a(81226),D=a(18730);let E=(0,p.createServerReference)("604beecc8ed11c5483b623d3ac7cd516f2e150bc00",p.callServer,void 0,p.findSourceMapURL,"updateChatSqlExecProvider");var A=a(50688);function T(e){let{className:t,headerClassName:a,language:i,actions:o,syntax:p,blockId:g,source:f,file:v,closed:j,sqlExecutionState:z,transaction:L,inlineBlockType:A}=e,T=(0,k.k)("codeBlockActions"),{sqle:F}=(0,d.D)(),{submit:O}=(0,M.yI)(),U=F&&"inline-sql"===A,{activeScopeSlug:H}=(0,u.k6)(),{chatId:$}=(0,D.xz)(),{project:q,canWriteToChat:W}=(0,h.tZ)(),{projectId:Z,vercelProjectId:G}=null!=q?q:{},{stores:{data:K}}=(0,P.g)({projectId:null!=G?G:void 0,refreshInterval:0}),Y=(0,r.useMemo)(()=>K.filter(e=>e&&e.product&&R.o0.includes(e.product.slug)).map(e=>({id:e.id,slug:e.product.slug,name:e.product.name,icon:"upstash-kv"===e.product.slug?"https://vercel.com/api/www/avatar/".concat(e.product.integration.icon):"https://vercel.com/api/www/avatar/".concat(e.product.iconUrl)})),[K]),{sqlExecutionState:Q,updateSqlExecutionState:J}=(0,I.n)(g),[X,ee]=(0,r.useState)(!1),{sqlExecProvider:et,refetchSqlExecProvider:ea,isLoading:es}=function(e){let{data:t,isLoading:a,mutate:s,error:r}=(0,b.Ay)(e?["chat:sql-exec-provider",e]:null,async()=>{let t=await fetch("/chat/api/chat/sql-exec-provider?chatId=".concat(e)),{sqlExecProvider:a}=await t.json();return a});return{sqlExecProvider:t,isLoading:a,error:r,refetchSqlExecProvider:s}}(W?$:void 0),[er,en]=(0,r.useState)(null!=et?et:K.length>0?K[0].id:"");(0,r.useEffect)(()=>{W&&et&&en(et)},[W,et,en]);let el=X||!g||!f||!j||es,{data:ei,mutate:eo}=(0,b.Ay)(U?["block:output",g]:null),ec="applied"===Q||"error"===Q,ed="cancelled"===Q,eu="error"===Q||"error"in(null!=ei?ei:{}),em=!!(ei&&!eu&&ei.stderr.length>0);(0,r.useEffect)(()=>{U&&g&&z&&void 0===Q&&J(z)},[U,g,z,Q,J]);let{isCopied:eh,copyToClipboard:ep}=(0,y.C)({timeout:2e3}),{isCopied:ex,copyToClipboard:eg}=(0,y.C)({timeout:2e3}),{setPromptFormInput:ef}=(0,S.Q1)(),ev=async()=>{if(!g){c.oR.error("Error",{description:"Missing block ID"});return}try{ee(!1),J("cancelled");let e=await x(g,"cancelled");"error"in e&&J(Q)}catch(e){c.oR.error("Error",{description:"An unexpected error occurred"})}},ej=async()=>{if(!g||!f||!H||!Z||!$){let e=g?f?H?Z?"chat ID":"project ID":"active scope":"source":"block ID";c.oR.error("Error",{description:"Missing ".concat(e)});return}ee(!0);try{if(!et&&Y.length>=2){let e=await E($,er);if("error"in e){c.oR.error("Error",{description:e.error||"An error occurred while updating the SQL integration provider"});return}ea()}let e=await (0,m.W)({props:{language:"sql",blockId:g,source:f,meta:{file:v,transaction:L},closed:!1,originalCode:void 0,isPreviewable:!1},projectId:Z,initialVercelProjectId:null!=G?G:void 0,sqlExecProvider:null!=et?et:void 0});eo(e);let t="error"in e||e.stderr.length>0,a=t?"error"in e?e.error:e.stderr[0].join("\n"):void 0;ee(!1),J(t?"error":"applied"),t&&c.oR.error("SQL Execution Failed",{description:a});let s=await x(g,t?"error":"applied");if("error"in s&&J(Q),ec||!["CREATE","ALTER","DROP","TRUNCATE"].some(e=>RegExp("\\b".concat(e,"\\b"),"i").test(f)))return;t?await O({action:"new",attachments:[],input:"The SQL code block failed to execute. The error was: ".concat(a,". "),type:"message"}):await O({action:"new",attachments:[],input:"The SQL code block executed successfully.",type:"added-integration",workflowState:"create-database-tables"})}catch(e){ee(!1),J("error"),await x(g,"error"),c.oR.error("Error",{description:"An unexpected error occurred"})}},eb=async()=>{if(ex)return;let e=(0,N.z)(ei);await eg(e)},ey=(0,r.useMemo)(()=>Y.length<2||!W?null:(0,s.jsx)(B,{stores:Y,selectedStoreSlug:er,setSelectedStoreSlug:en,refetchSqlExecProvider:ea,isLoading:es}),[Y,er,en,ea,es,W]);return(0,s.jsxs)("div",{className:(0,n.cn)("codeblock relative flex size-full flex-col overflow-hidden rounded-lg border font-sans",!U||ec||ed?"border-alpha-400":"border-gray-500 ring-2 ring-gray-100",t),"data-seg":"root",children:[(0,s.jsxs)("div",{className:"group/inline-code-block relative flex size-full flex-col overflow-hidden",children:[!U&&(0,s.jsxs)("div",{className:(0,n.cn)("bg-muted flex h-10 w-full shrink-0 items-center justify-between rounded-t-lg border-b pl-2.5 pr-1.5",a),"data-seg":"skip",children:[i?(0,s.jsx)("span",{className:"text-gray-500",children:(0,s.jsx)(l.o,{lang:i})}):null,(0,s.jsx)("div",{className:"flex items-center space-x-1 text-gray-500",children:o})]}),U&&(0,s.jsx)(C.Z,{"aria-label":T("copy"),onClick:()=>f&&void ep(f),outline:!0,tooltip:T("copy"),className:"absolute right-1.5 top-1.5 z-10 hidden group-hover/inline-code-block:flex",children:(0,s.jsx)(w.U,{isCopied:eh,size:14})}),(0,r.cloneElement)(p,{className:(0,n.cn)(r.isValidElement(p)?p.props.className:void 0,U&&!ed&&"pb-8")}),"sql"===i&&U&&W&&(0,s.jsx)(V,{disabled:el,isExecuting:X,isCancelled:ed,hasExecuted:ec,isBlockOutputError:eu,isAnyStdErr:em,handleApplySql:ej,handleCancelSql:ev,handleFix:()=>{ef("The code:\n\n```\n".concat(f,"\n```\n\nProduced this output:\n\n").concat((0,N.z)(ei),"\n\nPlease fix it."))},sqlDatabaseSelector:ey})]}),U&&(0,s.jsx)(_,{blockOutput:ei,hasExecuted:ec,isCancelled:ed,isCopied:ex,onCopy:eb})]})}function F(e){let{className:t,showLineNumbers:a,actions:r,fileName:l,syntax:o}=e,{isPublished:c}=(0,i.usePublishedPage)();return c?(0,s.jsxs)("div",{className:(0,n.cn)("codeblock bg-muted flex size-full flex-col overflow-hidden rounded-lg pt-3",t),"data-seg":"root",children:[(0,s.jsxs)("div",{className:"z-10 mx-3 flex translate-y-px justify-between","data-seg":"skip",children:[(0,s.jsx)(O,{active:!0,fileName:l}),(0,s.jsx)("div",{className:"flex -translate-y-1.5 items-center gap-1",children:r})]}),(0,s.jsx)("div",{className:(0,n.cn)("border-alpha-400 bg-background relative flex flex-1 flex-col overflow-hidden border-t px-3 font-sans",a&&"px-0"),children:o})]}):(0,s.jsx)("div",{className:(0,n.cn)("codeblock bg-muted flex size-full flex-col",t),"data-seg":"root",children:(0,s.jsx)("div",{className:(0,n.cn)("relative flex flex-1 flex-col overflow-hidden px-3 font-sans",a&&"px-0"),children:o})})}function O(e){let{active:t,fileName:a,onClick:r}=e;return(0,s.jsxs)("button",{className:(0,n.cn)("font-regular border-alpha-400 pointer-events-none relative h-full whitespace-nowrap rounded-t-md border border-b-0 px-4 pb-1 pt-1.5 text-[13px] text-gray-500 transition-colors",t?"bg-background font-medium":"border-transparent bg-transparent hover:bg-gray-200"),onClick:r,children:[(0,s.jsx)(U,{active:t,side:"left"}),a,(0,s.jsx)(U,{active:t,side:"right"})]})}function U(e){let{active:t,side:a}=e;if(!t)return null;let r="left"===a;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,n.cn)("bg-muted absolute bottom-0 z-20 h-[4px] w-[4px] border-b border-gray-200",r?"right-[-4px] rounded-bl-[3px] border-l":"left-[-4px] rounded-br-[3px] border-r")}),(0,s.jsx)("div",{className:(0,n.cn)("bg-background absolute bottom-0 z-10 h-[4px] w-[4px]",r?"right-[-4px]":"left-[-4px]")})]})}function V(e){let{isExecuting:t,isCancelled:a,disabled:r,hasExecuted:l,isBlockOutputError:i,isAnyStdErr:c,handleCancelSql:d,handleApplySql:u,handleFix:m,sqlDatabaseSelector:h}=e;if(a)return null;let p=t||c?null:i?(0,s.jsx)("div",{className:"font-mono text-[13px] text-red-700",children:"Failed"}):l?(0,s.jsx)("div",{className:"font-mono text-[13px] text-gray-500",children:"Applied"}):(0,s.jsx)(o.$,{size:"sm",className:"h-7 rounded-md",disabled:r,variant:"outline",onClick:d,children:"Cancel"}),x=(0,s.jsxs)(o.$,{size:"sm",className:"h-7 rounded-md",onClick:u,disabled:r,variant:l?"outline":"default",children:[t?(0,s.jsx)(g.y,{size:16}):l?(0,s.jsx)(v._,{}):null,(0,s.jsx)("span",{children:t?"Applying":l?"Re-run":"Run Code"})," "]}),j=l&&c&&!t?(0,s.jsxs)(o.$,{onClick:m,size:"sm",className:"h-7 rounded-md",disabled:r,children:["Fix with ",(0,s.jsx)(f.o,{className:"-ml-0.5 mt-[1px]"})]}):null;return(0,s.jsxs)("div",{className:(0,n.cn)("from-background absolute bottom-0 z-10 flex h-10 w-full shrink-0 items-center rounded-b-lg bg-gradient-to-t to-transparent px-1.5",h?"justify-between":"justify-end"),children:[h,(0,s.jsxs)("div",{className:(0,n.cn)("flex items-center",l?"gap-3":"gap-1.5"),children:[p,x,j]})]})}function _(e){let{blockOutput:t,hasExecuted:a,isCancelled:r,isCopied:n,onCopy:l}=e;if(r)return null;let i=a&&t&&!("error"in t),o=i&&0===t.stdout.length&&0===t.stderr.length,c=i&&1===t.stdout.length&&1===t.stdout[0].length&&"[]"===t.stdout[0][0],d=i&&1===t.stdout.length&&1===t.stdout[0].length&&null===t.stdout[0][0];return i&&!(o||c||d)?(0,s.jsxs)("div",{className:"bg-muted group/sql-output relative flex w-full flex-col rounded-b-lg border-t",children:[(0,s.jsx)(C.Z,{"aria-label":"Copy",onClick:l,outline:!0,tooltip:"Copy",className:"absolute right-1.5 top-1.5 z-10 hidden group-hover/sql-output:flex",children:(0,s.jsx)(w.U,{isCopied:n,size:14})}),(0,s.jsx)(j.X3,{className:"h-full max-h-64",value:t,inline:!0})]}):null}function B(e){let{stores:t,selectedStoreSlug:a,setSelectedStoreSlug:n,refetchSqlExecProvider:l,isLoading:i}=e,{chatId:o}=(0,D.xz)(),d=(0,r.useMemo)(()=>t.find(e=>e.slug===a),[t,a]),u=async e=>{if(o){n(e);try{let t=await E(o,e);if("error"in t){c.oR.error("Error",{description:t.error||"An error occurred while updating the SQL integration provider"}),n(a);return}await l()}catch(e){c.oR.error("Error",{description:"An error occurred while updating the SQL integration provider"}),n(a)}}};return i?(0,s.jsx)(A.E,{className:"h-7 w-28 rounded-md"}):(0,s.jsx)("div",{children:(0,s.jsxs)(z.l6,{value:a,onValueChange:u,children:[(0,s.jsx)(z.bq,{className:"h-7 gap-2 pl-2 [&>svg]:!size-3",children:(0,s.jsx)(z.yv,{children:(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[(null==d?void 0:d.icon)?(0,s.jsx)(L.default,{src:d.icon,alt:d.name,width:16,height:16,className:"rounded-full"}):(0,s.jsx)("div",{className:"size-4 rounded-full bg-gray-100"}),null==d?void 0:d.name]})})}),(0,s.jsx)(z.gC,{children:t.map(e=>(0,s.jsx)(z.eb,{value:e.slug,children:(0,s.jsxs)("div",{className:"flex flex-row items-center gap-1.5",children:[(0,s.jsx)(L.default,{src:e.icon,alt:e.name,width:16,height:16,className:"rounded-full"}),e.name]})},e.slug))})]})})}var H=a(52295),$=a(11192);a(58139);var q=a(58978),W=a(81279),Z=a(8298),G=a(35339);let K=(0,$.default)(()=>Promise.all([a.e(1704),a.e(323),a.e(219),a.e(8861),a.e(3676),a.e(5206),a.e(2223)]).then(a.bind(a,42223)).then(e=>e.MonacoEditor),{loadableGenerated:{webpack:()=>[42223]},ssr:!1}),Y=(0,r.memo)(function(e){let t,{isQuickEdit:a,value:l,language:i,showLineNumbers:o,wrapLongLines:c,isTabbed:d,originalCode:u,fixingBadLines:m}=e,h=l,p=(0,H.Of)(i),x=(0,r.useMemo)(()=>{if(u)return u.split("\n")},[u]),g=(h.match(/\n/g)||[]).length;if((!h||0===g)&&u)g=(u.match(/\n/g)||[]).length,t=e=>({className:(0,n.cn)("opacity-50",1===e&&void 0===m&&"block w-full animate-pulse bg-gray-100 opacity-100",(null==m?void 0:m.includes(e+1))&&"block w-full animate-pulse bg-red-100 opacity-100")}),h=u;else if(x&&x.length>g-1){let e=h.lastIndexOf("\n"),a=(g=((h=h.slice(0,e>0?e:void 0)).match(/\n/g)||[]).length)+1,s=x.slice(g+1),r=s.join("\n");g+=s.length,t=e=>({className:(0,n.cn)(e===a&&"block w-full bg-blue-400/20",e>a&&"opacity-50")}),r&&(h=h+"\n"+r)}return(0,s.jsx)(Z.A,{PreTag:"div",customStyle:{display:"flex",margin:0,width:"max-content",height:"min-content",padding:d?"12px 12px 10px 12px":"8px 10px",textShadow:"none",borderRadius:"0 0 calc(var(--radius) - 2px) calc(var(--radius) - 2px)",WebkitOverflowScrolling:"touch",backgroundColor:"transparent",fontFamily:"var(--font-geist-mono)",lineHeight:"1.55",fontSize:"0.8125rem"},language:p,lineNumberContainerStyle:{userSelect:"none",whiteSpace:"break-spaces",textAlign:"right",display:"flex",flexDirection:"column"},lineNumberStyle:{display:"inline-block",minWidth:"".concat(Math.max(g.toString().length,2),"ch"),padding:0,margin:"0 12px 0 0",color:"hsl(var(--gray-400))",userSelect:"none"},lineProps:t,showLineNumbers:o,useInlineStyles:!1,wrapLines:!0,wrapLongLines:c,children:h})}),Q=(0,r.memo)(e=>{let{language:t,value:a,blockId:l,originalCode:i,allowQuoting:o=!1,allowCopyCode:c=!0,allowDownloadCode:d=!0,allowClose:u=!1,closeHandler:m=null,className:h,headerClassName:p,fixingBadLines:x,codeWrapperClassName:g,fileName:f="file.txt",showLineNumbers:v=!1,wrapLongLines:j=!1,additionalHeaderActions:b,caller:y,editable:w,showQuickEditAnimation:N,closed:k,onEdit:C,editValue:S,type:I,onExecutionComplete:M,sqlExecutionState:z,transaction:L}=e,P="inline"!==y,R=(0,G.F)(C),D=(0,r.useCallback)(e=>{if(void 0!==e){var t;null===(t=R.current)||void 0===t||t.call(R,e)}},[R]),{diffs:E,showDiffs:A}=(0,W.s)({blockId:l,fileName:f,originalCode:i,newCode:a}),O=(0,H.Of)(t),U=k&&null!=S?S:a,V=(0,s.jsx)(q.C,{additionalHeaderActions:b,allowClose:u,allowCopyCode:c,allowDownloadCode:d,originalCode:i,blockId:l,closed:k,caller:y,closeHandler:m,fileName:f,isTabbed:P,value:U,isExecutable:"script"===I,language:t,onExecutionComplete:M}),_=(0,s.jsx)(K,{language:O,value:U,diffOriginalCode:A?i:null,closed:k,onEdit:D,disabled:!w}),B=i&&N||"inline"===y?(0,s.jsx)("div",{className:(0,n.cn)("group size-full overflow-scroll","inline-sql"===I,g),children:(0,s.jsx)("div",{className:"size-full text-gray-500 group-has-[.language-text]:text-black group-has-[.token]:text-black","data-seg":o?"code-root":void 0,children:(0,s.jsx)(Y,{isQuickEdit:N,isTabbed:P,originalCode:i,fixingBadLines:x,language:t,showLineNumbers:v,value:a,wrapLongLines:j})})}):_,$={className:h,headerClassName:p,language:t,showLineNumbers:v,fileName:f,actions:V,syntax:B};return P?(0,s.jsx)(F,{...$}):(0,s.jsx)(T,{...$,blockId:l,source:a,file:f,closed:k,sqlExecutionState:z,transaction:L,inlineBlockType:I})});Q.displayName="CodeBlock"},88293:(e,t,a)=>{"use strict";a.d(t,{Separator:()=>i});var s=a(7336),r=a(80644),n=a(66830),l=a(4495);let i=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:i=!0,...o}=e;return(0,s.jsx)(n.b,{className:(0,l.cn)("bg-border shrink-0","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),decorative:i,orientation:r,ref:t,...o})});i.displayName=n.b.displayName},88860:(e,t,a)=>{"use strict";a.d(t,{$p:()=>l,mU:()=>n,vA:()=>r});let s=new Map;function r(e,t){let a=s.get(e);a&&a.abort();let r=new AbortController;s.set(e,r);let n=r.signal;return n.onabort=()=>{s.delete(e),null==t||t()},n}function n(e){let t=s.get(e);t&&(t.abort(),s.delete(e))}function l(e){s.delete(e)}},89021:(e,t,a)=>{"use strict";function s(e,t){return e.toSorted((e,a)=>null===e[t]?1:null===a[t]?-1:new Date(a[t]).getTime()-new Date(e[t]).getTime())}a.d(t,{p:()=>s})},89222:(e,t,a)=>{"use strict";a.d(t,{e:()=>M,A:()=>A});var s=a(7336),r=a(80644),n=a(87580),l=a.n(n),i=a(38559),o=a(30009);let c=(0,o.createServerReference)("60ed9b4661c381a39e1fdc2a6c5d42b6a434f5ebdc",o.callServer,void 0,o.findSourceMapURL,"createChatFromZip");var d=a(15993),u=a(10299),m=a(53616),h=a(77936),p=a(46334),x=a(81616),g=a(47587),f=a(51621),v=a(79822),j=a(4495),b=a(7393),y=a(95057),w=a(19461),N=a(97947),k=a(59246),C=a(59103),S=a(2115),I=a(67952);function M(e){let{onClose:t,attachment:a}=e,[n,o]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!1),[g,f]=(0,r.useState)([]),[v,j]=(0,r.useState)(new Set),[y,C]=(0,r.useState)(null),[M,z]=(0,r.useState)(a),L=(0,u.useRouter)(),{showZipModal:P,setShowZipModal:D}=A(),T=(0,I.k)("uploadZipModal");async function F(e,t){return await (0,b.Se)(t,e,{access:"public",handleUploadUrl:"/chat/api/chat/upload",clientPayload:JSON.stringify({component:"zip-file",fileType:"application/zip",extension:"zip"}),contentType:"application/zip"})}(0,r.useEffect)(()=>{z(a)},[a]),(0,r.useEffect)(()=>{P&&M&&"object"==typeof M.content&&"byteLength"in M.content&&(h(!0),O(M.content).finally(()=>{h(!1)}))},[P,M]);let O=async e=>{try{let t=await l().loadAsync(e),a=new Set,s=[];t.forEach((e,t)=>{let r=e.split("/").filter(Boolean),n=s;r.forEach((e,s)=>{let l=s===r.length-1,i=n.find(t=>t.name===e);if(i)l&&!t.dir&&(i.isDirectory=!1),n=i.children||[];else{let i={name:e,path:r.slice(0,s+1).join("/"),isDirectory:!l||t.dir,children:t.dir?[]:void 0};R(i.path)||a.add(i.path),n.push(i),l||(n=i.children||[])}})});let r=e=>{for(let t=e.length-1;t>=0;t--){let a=e[t];a.children&&(r(a.children)?a.children=void 0:0===a.children.length&&(a.children=void 0))}return 0===e.length};r(s),f(s),j(a),C(t)}catch(e){console.error("Error loading zip contents:",e),d.oR.error("Failed to load zip contents")}},U=e=>{let t=[];return e.isDirectory||t.push(e.path),e.children&&e.children.forEach(e=>{t.push(...U(e))}),t},V=async()=>{if(y&&M){o(!0);try{let t=new(l());for(let e of v){if(R(e)){console.warn("File is disabled: ".concat(e));continue}let a=y.files[e];if(!a){console.warn("File not found in original zip: ".concat(e));continue}if(a.dir)t.folder(e);else{let s=await a.async("uint8array");t.file(e,s)}}let a=await t.generateAsync({type:"blob"});if(a.size>3145728){d.oR.error("Selected files must be under 3MB.");return}let s=await F(a,M.name||"Untitled.zip");(0,S.u)("CreateChatFromZip",{folderName:M.name,folderSize:M.content&&ArrayBuffer.isView(M.content)?M.content.byteLength:0,selectedFiles:Array.from(v),totalFiles:Object.keys(y.files).length});let r=await c(M.name||"Untitled.zip",s.url);if("string"!=typeof r){var e;d.oR.error(null!==(e=r.error)&&void 0!==e?e:"Failed to create chat");return}D(!1),L.push("/chat/".concat(r))}catch(e){console.error(e),d.oR.error("An error occurred while creating the chat.")}finally{o(!1),null==t||t()}}},_=(0,r.useRef)(null),{inputFileRef:B,onInputChange:H,uploading:$,isDraggingFile:q}=(0,w.Ay)({isSignedIn:!0,disablePaste:!0,disableDrag:!P,dragContainerRef:_,saveToDrafts:!1,onSuccess:(e,t)=>{var a;if(1!==t.length&&P){d.oR.error("Only one zip folder is supported.");return}let s=t[0];if((null===(a=s.name.split(".").pop())||void 0===a?void 0:a.toLowerCase())!=="zip"&&P){d.oR.error("Only zip folders are supported.");return}z(s)},projectId:void 0,onFinish:()=>{}}),W=(0,r.useMemo)(()=>q?(0,s.jsx)("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center gap-2 rounded-lg border border-dashed border-blue-600 bg-blue-100 shadow-none",children:(0,s.jsx)(N.Ou,{className:"text-sm text-blue-600",children:T("emptyStateDragging")})}):null,[q,T]);return(0,s.jsxs)(i.Modal,{open:P,onOpenChange:D,children:[(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsx)(i.ModalHeader,{className:"flex justify-start",children:(0,s.jsx)("div",{className:"flex w-full flex-col items-start gap-4",children:(0,s.jsxs)("div",{className:"flex flex-col items-start gap-1.5",children:[(0,s.jsx)(i.ModalTitle,{className:"text-xl font-semibold",children:T("title")}),(0,s.jsx)(i.ModalDescription,{children:M?T("descriptionFileAttached",M.name):T("descriptionNoFileAttached")})]})})}),(0,s.jsx)(i.ModalContent,{children:M?(0,s.jsx)("div",{className:"overflow-y-auto",children:m||$?(0,s.jsx)("div",{className:"bg-muted border-alpha-200 flex h-60 rounded-md border"}):(0,s.jsx)(E,{files:g,selectedFiles:v,onSelectFile:(e,t,a)=>{j(s=>{let r=new Set(s);if(a){let a=t=>{for(let s of t){if(s.path===e)return s;if(s.children){let e=a(s.children);if(e)return e}}},s=a(g);s&&U(s).forEach(e=>{t&&!R(e)?r.add(e):r.delete(e)})}else t?r.add(e):r.delete(e);return r})}})}):(0,s.jsxs)("div",{className:"relative transition-all",ref:_,children:[W,(0,s.jsx)(k.pp,{className:"h-60",subtitle:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,s.jsx)("span",{children:(0,s.jsx)(p.g,{className:"h-4 w-4"})}),(0,s.jsxs)("p",{children:[T("emptyStateDescription")," ",(0,s.jsx)("button",{onClick:()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.click()},className:"text-blue-600 hover:underline",children:T("emptyStateAction")})]})]})})]})}),(0,s.jsx)(i.ModalFooter,{className:"border-border bg-muted border-t !p-4",children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[M&&(0,s.jsx)("div",{className:"text-muted-foreground text-sm",children:T("filesSelected",v.size)}),(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,s.jsx)(i.ModalClose,{asChild:!0,children:(0,s.jsx)(x.$,{variant:"secondary",onClick:()=>{z(null),D(!1),null==t||t()},size:"sm",children:T("cancel")})}),M?(0,s.jsx)(x.$,{onClick:V,disabled:n||0===v.size,size:"sm",autoFocus:!0,children:n?T("creatingChat"):T("startChat")}):(0,s.jsx)(x.$,{variant:"secondary",size:"sm",disabled:!0,children:T("startChat")})]})]})})]}),(0,s.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",ref:B,type:"file",accept:".zip",onChange:e=>{H(e)}})]})}let z=[".gitignore",".git","package.json","tsconfig.json","node_modules",".next","__MACOSX",".DS_Store","Thumbs.db","desktop.ini","npm-debug.log","yarn-error.log","yarn.lock","package-lock.json","pnpm-lock.yaml","repomix-output.txt","repomix-output.json","repomix-output.xml","v0-user-next.config.js","placeholder-logo.svg","placeholder-logo.png","placeholder-user.jpg","placeholder.jpg","placeholder.svg","next-env.d.ts",".png",".jpg",".gif",".jpeg"],L=["lib/utils.ts","lib/utils.js","components.json","ui/accordion.tsx","ui/alert-dialog.tsx","ui/alert.tsx","ui/aspect-ratio.tsx","ui/avatar.tsx","ui/badge.tsx","ui/breadcrumb.tsx","ui/button.tsx","ui/calendar.tsx","ui/card.tsx","ui/carousel.tsx","ui/chart.tsx","ui/checkbox.tsx","ui/collapsible.tsx","ui/combobox.tsx","ui/command.tsx","ui/context-menu.tsx","ui/data-table.tsx","ui/date-picker.tsx","ui/dialog.tsx","ui/drawer.tsx","ui/dropdown-menu.tsx","ui/form.tsx","ui/hover-card.tsx","ui/input-otp.tsx","ui/input.tsx","ui/label.tsx","ui/menubar.tsx","ui/navigation-menu.tsx","ui/pagination.tsx","ui/popover.tsx","ui/progress.tsx","ui/radio-group.tsx","ui/resizable.tsx","ui/scroll-area.tsx","ui/select.tsx","ui/separator.tsx","ui/sheet.tsx","ui/sidebar.tsx","ui/skeleton.tsx","ui/slider.tsx","ui/sonner.tsx","ui/switch.tsx","ui/table.tsx","ui/tabs.tsx","ui/textarea.tsx","ui/toast.tsx","ui/toaster.tsx","ui/toggle-group.tsx","ui/toggle.tsx","ui/tooltip.tsx","use-mobile.tsx","use-mobile.ts","use-toast.ts","use-toast.tsx"],P=new Map;function R(e){if(P.has(e))return P.get(e);let t=z.some(t=>e===t||e.endsWith(t))||L.some(t=>e.endsWith(t))||e.includes(".env")||e.includes("node_modules")||e.includes("__MACOSX")||e.startsWith("public/");return P.set(e,t),t}function D(e){var t;let{file:a,selectedFiles:n,onSelectFile:l,level:i=0}=e,[o,c]=r.useState(!R(a.path)&&!(null===(t=a.children)||void 0===t?void 0:t.every(e=>R(e.path)))),d=a.isDirectory&&a.children&&a.children.length>0,u=(0,r.useMemo)(()=>{var e;return R(a.path)||(null===(e=a.children)||void 0===e?void 0:e.every(e=>R(e.path)))},[a]),p=r.useMemo(()=>!!a.isDirectory&&!!a.children&&(function e(t){let a=[];return t.isDirectory||a.push(t.path),t.children&&t.children.forEach(t=>{a.push(...e(t))}),a})(a).every(e=>n.has(e)),[a,n]),x=(0,s.jsx)(g.Checkbox,{id:a.path,checked:a.isDirectory?p:n.has(a.path),onCheckedChange:e=>{u||l(a.path,e,a.isDirectory)},disabled:u,className:"data-[state=checked]:border-none data-[state=checked]:bg-black"}),b=(0,s.jsxs)("div",{className:(0,j.cn)("flex items-center gap-2 p-1",u&&"opacity-50"),children:[(0,s.jsxs)("div",{className:"flex flex-1 items-center",children:[d&&(0,s.jsx)("button",{onClick:()=>{c(!o)},className:"hover:bg-accent flex h-4 w-4 items-center justify-center rounded text-gray-500",disabled:u,children:(0,s.jsx)(f.P.div,{initial:!1,animate:{rotate:90*!!o},transition:{duration:.2},children:(0,s.jsx)(m.b,{className:"h-4 w-4"})})}),(0,s.jsx)("div",{className:"text-gray-500",children:a.isDirectory?null:(0,s.jsx)(h.Z,{className:"h-4 w-4"})}),(0,s.jsx)("label",{htmlFor:a.path,className:(0,j.cn)("flex-1 cursor-pointer select-none text-sm",u&&"cursor-not-allowed",a.isDirectory?"ml-1":"ml-2"),children:a.name})]}),u?(0,s.jsx)(y.Tooltip,{disableHoverableContent:!0,content:(0,s.jsxs)("p",{children:["This ",a.isDirectory?(0,s.jsx)("span",{children:"folder"}):(0,s.jsx)("span",{children:"file"}),(0,s.jsx)("span",{children:" is not supported at this time"})]}),side:"top",children:x}):x]});return(0,s.jsxs)("li",{children:[b,(0,s.jsx)(v.N,{initial:!1,children:d&&o&&(0,s.jsxs)(f.P.ul,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"flex overflow-hidden",children:[(0,s.jsx)("div",{className:"flex w-6 justify-center",children:(0,s.jsx)("div",{className:"bg-alpha-400 w-px"})}),(0,s.jsx)("div",{className:"flex-1",children:a.children.map(e=>(0,s.jsx)(D,{file:e,selectedFiles:n,onSelectFile:l,level:i+1,files:a.children||[]},e.path))})]})})]})}function E(e){let t=(0,r.useMemo)(()=>[...e.files].sort((e,t)=>e.isDirectory&&!t.isDirectory?-1:!e.isDirectory&&t.isDirectory?1:e.name.localeCompare(t.name)),[e.files]);return(0,s.jsx)("div",{className:"bg-muted border-alpha-200 flex max-h-60 overflow-y-auto rounded-md border",children:(0,s.jsx)("ul",{className:"w-full p-2",children:t.map(t=>(0,s.jsx)(D,{file:t,...e},t.path))})})}function A(){let{data:e,mutate:t}=(0,C.Ay)("showZipModal",null);return{showZipModal:e,setShowZipModal:t}}},90098:(e,t,a)=>{"use strict";a.d(t,{SidebarScopeSwitcher:()=>P,W:()=>R});var s=a(7336),r=a(80644),n=a(76989),l=a(81616),i=a(4495),o=a(76073),c=a(79822),d=a(51621),u=a(24582),m=a(70608),h=a(94828),p=a(46556),x=a(22854),g=a(57942),f=a(10299),v=a(1665),j=a(50688),b=a(97210),y=a(72244),w=a(2115),N=a(95559),k=a(4461),C=a(80060),S=a(49388),I=a(77011),M=a(42161),z=a(28089),L=a(7407);function P(){let{scopes:e,activeScope:t,setActiveScope:a,isActiveScopeReady:i,user:c}=(0,o.k6)(),[d]=(0,S.Q3)(t,300),u=(0,r.useMemo)(()=>e?(0,L.n)(e,(e,t)=>(e.id===(null==d?void 0:d.id)?-1:0)-(t.id===(null==d?void 0:d.id)?-1:0)):[],[e,null==d?void 0:d.id]),{setCreateTeamDialogOpen:m}=(0,C.F)(),{setUpgradePromptOpen:h}=(0,I.g)(),[p,x]=(0,r.useState)(!1),{setTeamUpgradeDialog:f}=(0,M.L)(),{setTeamRequestAccessDialog:v}=(0,z._)(),b=(0,r.useCallback)(e=>!!i&&e===(null==d?void 0:d.id),[null==d?void 0:d.id,i]),y=(0,r.useCallback)(e=>{x(!1),v(e)},[v]),w=(0,r.useCallback)(async e=>{await a(e),x(!1)},[a]),P=(0,r.useCallback)(e=>{x(!1),f(e)},[f]),R=(0,r.useCallback)(()=>{x(!1),h(!0)},[h]);return t&&d&&c&&u?(0,s.jsxs)(n.DropdownMenu,{modal:!0,open:p,onOpenChange:x,children:[(0,s.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(l.$,{"aria-label":"Profile Menu",className:"hover:bg-gray-150 focus-visible:bg-gray-150 data-[state=open]:bg-gray-150 active:bg-gray-150 relative h-8 w-fit max-w-full overflow-hidden px-1.5","data-testid":"user-menu-toggle",variant:"ghost",children:(0,s.jsx)(N.Xh,{isTrigger:!0,scope:t,user:c,children:(0,s.jsx)(g.X,{className:"!text-gray-500"})})})}),(0,s.jsx)(n.DropdownMenuContent,{align:"start",className:"w-[224px]",side:"top",sideOffset:8,children:(0,s.jsx)(D,{onUpgradeActiveScope:R,activeScope:d,user:c,children:(0,s.jsx)(k.rX,{className:"max-h-[200px] gap-1 overflow-y-auto",children:u.map(e=>(0,s.jsx)(E,{user:c,scope:e,isOpen:!0,isCurrentlyActive:b(e.id),onSelect:w,onRequestAccess:y,onUpgradeTeam:P},"menu-item-".concat(e.id)))})})})]}):(0,s.jsx)(j.E,{className:"h-8 w-32 rounded-lg"})}function R(){let{activeScope:e,isActiveScopeReady:t,user:a}=(0,o.k6)(),r=!e||!a||!t,n=r?(0,s.jsx)(j.E,{className:"mt-0.5 h-3 w-40 rounded-lg"}):(0,s.jsx)("div",{className:"truncate",children:a.email}),l=r?(0,s.jsx)(N.Gb,{}):(0,s.jsx)(N.Xh,{scope:e,user:a});return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("div",{className:"flex min-w-0 items-center px-2 py-1.5 text-start text-sm font-medium leading-none text-gray-500",children:n}),(0,s.jsx)("div",{className:"px-1.5 py-1",children:l})]})}function D(e){let{activeScope:t,onUpgradeActiveScope:a,user:l,children:i}=e,{scopeSlug:o,scopePlan:c}=(0,N.fo)(t,l),d=(0,r.useMemo)(()=>{if("v0-level0"===c||"v0-level3"===c||"v0-platinum"===c)return null;let e="v0-enterprise"===c?(0,s.jsx)(k.xG,{label:"Contact Support",Icon:(0,s.jsx)(h.l,{}),sameTab:!1,href:"https://vercel.com/contact/sales"}):(0,s.jsx)(k.Dr,{onSelect:a,children:(0,s.jsx)(k.sW,{label:"Upgrade to Enterprise",Icon:(0,s.jsx)(h.l,{})})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.mB,{}),(0,s.jsxs)(k.rX,{children:[(0,s.jsx)(k.xG,{label:"Team Billing",Icon:(0,s.jsx)(m.y,{}),sameTab:!1,href:"https://vercel.com/".concat(o,"/~/settings/invoices")}),(0,s.jsx)(k.xG,{label:"Manage Members",Icon:(0,s.jsx)(x.z,{}),sameTab:!1,href:"https://vercel.com/".concat(o,"/~/settings/members")}),e]})]})},[a,c,o]);return(0,s.jsxs)(s.Fragment,{children:[i,d]})}function E(e){let{onRequestAccess:t,onUpgradeTeam:a,user:l,scope:o,onSelect:d,isCurrentlyActive:m,isOpen:h,className:x}=e,[g,j]=(0,r.useTransition)(),y=(0,f.useRouter)(),k=(0,v.sJ)(o),{scopeMembershipRole:C,hasV0Seat:S,accessRequested:I,scopeSlug:M,scopePlan:z}=(0,N.fo)(o,l),L=h||m,P=e=>"".concat(o.id,"-").concat(e),R=(0,r.useMemo)(()=>h&&m?"check":k?"locked":g?"loading":null,[h,m,k,g]),D=(0,r.useCallback)(e=>{if(e.preventDefault(),k){(0,v.qm)({slug:M,push:y.push});return}if(S){j(()=>d(o));return}"OWNER"===C?((0,w.u)("OpenTeamUpgradeModal",{teamId:o.id}),a(o)):I||((0,w.u)("OpenRequestAccessModal",{teamId:o.id}),t(o))},[k,S,C,I,M,y.push,d,o,a,t]);return l&&(k||z||"OWNER"===C)?(0,s.jsx)("div",{className:(0,i.cn)("relative flex h-[44px] cursor-pointer items-center justify-between transition-[opacity,filter] duration-150",!h&&"pointer-events-none",x),style:{opacity:+!!L,filter:"blur(".concat(.5*!L,"px)")},children:(0,s.jsx)(n.DropdownMenuItem,{className:(0,i.cn)("bg-background-subtle h-[44px] cursor-pointer"),disabled:I,onSelect:D,children:(0,s.jsx)(N.Xh,{scope:o,user:l,children:(0,s.jsxs)(c.N,{mode:"wait",children:["locked"===R?(0,s.jsx)(A,{children:(0,s.jsx)(p.C,{})},P("locked")):null,"check"===R?(0,s.jsx)(A,{children:(0,s.jsx)(u.J,{})},P("check")):null,"loading"===R?(0,s.jsx)(A,{children:(0,s.jsx)(b.y,{size:16})},P("loading")):null]})})})}):null}function A(e){let{children:t}=e;return(0,s.jsx)(d.P.div,{exit:{opacity:0,transition:{duration:.1}},initial:{opacity:0,filter:"blur(1px)",scale:.9},animate:{opacity:1,scale:1,filter:"blur(0px)"},className:"text-gray-500",transition:{duration:.3},children:t})}(0,y.G)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.7071 2.39644C8.31658 2.00592 7.68341 2.00592 7.29289 2.39644L4.46966 5.21966L3.93933 5.74999L4.99999 6.81065L5.53032 6.28032L7.99999 3.81065L10.4697 6.28032L11 6.81065L12.0607 5.74999L11.5303 5.21966L8.7071 2.39644ZM5.53032 9.71966L4.99999 9.18933L3.93933 10.25L4.46966 10.7803L7.29289 13.6035C7.68341 13.9941 8.31658 13.9941 8.7071 13.6035L11.5303 10.7803L12.0607 10.25L11 9.18933L10.4697 9.71966L7.99999 12.1893L5.53032 9.71966Z" fill="currentColor"/>')},90352:(e,t,a)=>{"use strict";a.d(t,{Kx:()=>c});var s=a(72633);s.z.object({id:s.z.string(),title:s.z.string(),description:s.z.string().min(3,"Please provide a description.").max(1e3,"Description cannot be longer than 1000 characters"),source:s.z.object({title:s.z.string(),url:s.z.string(),description:s.z.string().optional()}),code:s.z.string(),createdAt:s.z.string().or(s.z.number()),meta:s.z.object({project:s.z.string(),file:s.z.string()})}).pick({id:!0,title:!0,description:!0,source:!0,code:!0,createdAt:!0,meta:!0});let r=s.z.enum(["registry:style","registry:lib","registry:example","registry:block","registry:component","registry:ui","registry:hook","registry:theme","registry:page","registry:file","registry:internal"]),n=s.z.discriminatedUnion("type",[s.z.object({path:s.z.string(),content:s.z.string().optional(),type:s.z.enum(["registry:file","registry:page"]),target:s.z.string()}),s.z.object({path:s.z.string(),content:s.z.string().optional(),type:r.exclude(["registry:file","registry:page"]),target:s.z.string().optional()})]),l=s.z.object({config:s.z.object({content:s.z.array(s.z.string()).optional(),theme:s.z.record(s.z.string(),s.z.any()).optional(),plugins:s.z.array(s.z.string()).optional()}).optional()}),i=s.z.object({light:s.z.record(s.z.string(),s.z.string()).optional(),dark:s.z.record(s.z.string(),s.z.string()).optional()}),o=s.z.object({$schema:s.z.string().optional(),name:s.z.string(),type:r,title:s.z.string().optional(),author:s.z.string().min(2).optional(),description:s.z.string().optional(),dependencies:s.z.array(s.z.string()).optional(),devDependencies:s.z.array(s.z.string()).optional(),registryDependencies:s.z.array(s.z.string()).optional(),files:s.z.array(n).optional(),tailwind:l.optional(),cssVars:i.optional(),meta:s.z.record(s.z.string(),s.z.any()).optional(),docs:s.z.string().optional(),categories:s.z.array(s.z.string()).optional()});s.z.object({version:s.z.literal(2),id:s.z.string(),payload:o,source:s.z.object({title:s.z.string(),url:s.z.string(),description:s.z.string().optional()}),createdAt:s.z.string().or(s.z.number()),meta:s.z.object({project:s.z.string(),file:s.z.string()})}).pick({id:!0,version:!0,payload:!0,source:!0,createdAt:!0,meta:!0}),o.extend({meta:s.z.object({blockId:s.z.string().optional(),templateId:s.z.string().optional(),images:s.z.array(s.z.object({url:s.z.string(),name:s.z.string(),size:s.z.number()})).optional(),author:s.z.string().min(2,"Author is required and must be at least 2 characters long."),env:s.z.array(s.z.object({name:s.z.string(),url:s.z.string().optional()})).optional()})}),s.z.object({filename:s.z.string().min(1).max(100),file:s.z.instanceof(ArrayBuffer).refine(e=>e.byteLength>0).refine(e=>e.byteLength/1048576<=5)});let c=1e4;s.z.object({blockId:s.z.string(),description:s.z.string().max(c,"Description must be less than ".concat(c," characters.")).optional(),imageUrl:s.z.string().url("Please upload an image for your template.").optional().or(s.z.literal("")),category:s.z.enum(["apps","blocks","components","games","sites"],{required_error:"Category is required",invalid_type_error:"Category is invalid"}),envVarKeys:s.z.array(s.z.string()).optional()}).extend({imageUrl:s.z.string().url("Please upload an image for your template.").nullable().optional()})},90434:(e,t,a)=>{"use strict";a.d(t,{QZ:()=>o,TN:()=>l,br:()=>i});var s=a(7336),r=a(1105);let n=/^#([0-9a-f]{6}|[0-9a-f]{8})$/i;function l(e){return n.test(e)}function i(e){let{value:t,...a}=e;return(0,s.jsxs)("code",{...a,className:"font-mono font-normal before:hidden rounded-[0.375rem] border bg-gray-100 px-[0.15rem] h-5 after:hidden inline-flex items-center gap-0.5 align-middle",children:[(0,s.jsx)("span",{className:"inline-block size-3 rounded-[0.2rem] border",style:{backgroundColor:t}}),t]})}function o(){function e(e){if(-1===e.indexOf("#")||!n.test(e))return e;let t=[];for(;;){let a=n.exec(e);if(!a)break;let s=a[0],r=a.index;r>0&&t.push({type:"text",value:e.substring(0,r)}),t.push({type:"inlineCode",value:s}),e=e.substring(r+s.length)}return e.length>0&&t.push({type:"text",value:e}),t}return t=>{(0,r.T)(t,[[/#([0-9a-f]{6}|[0-9a-f]{8})\b/gi,e]],{ignore:["html","link","linkReference","image","imageReference","code","inlineCode"]})}}},91042:(e,t,a)=>{"use strict";a.d(t,{NewProjectButton:()=>j});var s=a(7336),r=a(81616),n=a(4495),l=a(38230),i=a.n(l),o=a(94828),c=a(77011),d=a(67952),u=a(35740),m=a(50688),h=a(76073),p=a(37644),x=a(22931),g=a(3650),f=a(80644),v=a(4304);function j(e){let{variant:t,onAfterClick:a,className:l,numProjects:j,quickCreate:b=!1,projectName:y,onSuccess:w,assignToChatId:N,...k}=e,{setUpgradePromptOpen:C}=(0,c.g)(),S=(0,d.k)("project.createDialog"),{activeScope:I}=(0,h.k6)(),{planSlug:M}=(0,u.N)(!0,null==I?void 0:I.id),[z,L]=(0,f.useState)(!1),P=M&&("v0-level0"!==M||j<x.AB),{setShowQuickProjectCreateDialog:R}=(0,p.A)(),D=(0,f.useCallback)(async()=>{if(y){L(!0);try{await (0,g.g)({projectName:y,onSuccess:w,chatId:N})}finally{L(!1)}}},[y,w,N]);return P||void 0!==M?P?b&&y?(0,s.jsx)(v.Q,{className:(0,n.cn)(l),pending:z,onClick:D,size:"sm",variant:t,...k,children:S("newProjectButton")}):b?(0,s.jsx)(r.$,{className:(0,n.cn)(l),onClick:()=>{R(!0)},size:"sm",variant:t,...k,children:S("newProjectButton")}):(0,s.jsx)(r.$,{className:(0,n.cn)(l),size:"sm",variant:t,...k,asChild:!0,children:(0,s.jsx)(i(),{className:(0,n.cn)(l),href:"/chat/projects/new",onClick:a,children:S("newProjectButton")})}):(0,s.jsxs)(r.$,{className:(0,n.cn)(l),"data-testid":"new-project-upgrade-button",onClick:()=>{C(!0),null==a||a()},size:"sm",type:"button",children:[(0,s.jsx)(o.l,{}),S("upgradePlan")]}):(0,s.jsx)(m.E,{className:(0,n.cn)("h-8 w-32",l)})}},91227:(e,t,a)=>{"use strict";a.d(t,{H:()=>z,DownvoteDialog:()=>M});var s=a(7336),r=a(80644),n=a(81616),l=a(98898),i=a(15993),o=a(99625),c=a(15066),d=a(7877),u=a(55330),m=a(29050),h=a(2115),p=a(18730),x=a(4495),g=a(80743),f=a(38559),v=a(77299),j=a(70289);function b(){return(0,s.jsx)(v.Dp,{variants:{hover:{y:2,x:-1,rotate:12}},children:(0,s.jsx)(j.t,{"aria-hidden":!0})})}var y=a(85168),w=a(67952),N=a(59103),k=a(74179),C=a(20685);function S(){let{data:e,mutate:t}=(0,N.Ay)("downvote-dialog-data",null,{fallbackData:null});return{downvoteDialogState:e,setDownvoteDialogState:t}}function I(e){let{children:t,value:a,reasons:r}=e;return(0,s.jsx)(d.a,{className:"is-mobile:text-xs",onClick:()=>r.toggle(a),selected:r.has(a),children:t})}function M(){let{activeForkKey:e}=(0,p.Pk)(),{downvoteDialogState:t,setDownvoteDialogState:a}=S(),{messageId:d,quote:v}=(0,r.useMemo)(()=>t||{},[t]),{formRef:j,onKeyDown:b}=(0,o.w)(),{chatId:N,messageText:k,promptMessageId:M,userId:z}=(0,g.q)({messageId:d}),[L,P]=(0,r.useState)(""),R=(0,u.L)(),D=(0,w.k)("downvoteDialog"),E=(0,r.useCallback)(()=>{P(""),R.clear(),a(null)},[R,a]),A=(0,r.useCallback)(async t=>{t.preventDefault();let a=(0,y.K1)(e);if(M&&k&&d&&a)try{(0,i.oR)(D("successToast")),await Promise.all([E(),(0,h.u)("SubmitDownvote",{messageId:d,leafMessageId:a,messageText:JSON.stringify({text:k}),quote:v,reasons:R.values,freeformFeedback:L}),(0,m.p)({feedback:L,quote:v,reasons:R.values,chatId:N,leafMessageId:a,promptMessageId:M,messageId:d,userId:z,type:"downvote"})])}catch(e){console.error(e),i.oR.error("Failed to send feedback. Please try again later.")}},[M,E,d,k,e,v,R.values,L,N,z,D]),T=(0,r.useMemo)(()=>(0,s.jsxs)("form",{className:(0,x.cn)("flex flex-col","is-mobile:gap-3 is-not-mobile:gap-6"),onSubmit:A,ref:j,children:[v&&(0,s.jsxs)("div",{className:(0,x.cn)("bg-muted flex items-center gap-2 text-ellipsis py-3 text-sm text-gray-900","is-mobile:-mx-3 is-mobile:px-3 is-not-mobile:-mx-6 is-not-mobile:px-6"),children:[(0,s.jsx)("div",{className:"w-1 shrink-0 self-stretch rounded-full bg-gray-300"}),(0,s.jsx)("span",{className:"line-clamp-2",children:v})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:"grid w-full grid-cols-2 items-center justify-start gap-2",children:[(0,s.jsx)(I,{reasons:R,value:"inaccurate",children:D("options.incorrectInformation")}),(0,s.jsx)(I,{reasons:R,value:"off-topic",children:D("options.instructionsIgnored")}),(0,s.jsx)(I,{reasons:R,value:"lazy",children:D("options.beingLazy")}),(0,s.jsx)(I,{reasons:R,value:"style",children:D("options.dontLikeStyle")}),(0,s.jsx)(I,{reasons:R,value:"bad-recommendation",children:D("options.badRecommendation")}),(0,s.jsx)(I,{reasons:R,value:"other",children:D("options.other")})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)(c.Label,{className:"text-sm font-normal text-gray-500",htmlFor:"downvote-feedback",children:[D("howCanWeImprove")," ",(0,s.jsx)("span",{className:"text-gray-400",children:D("optional")})]}),(0,s.jsx)(l.T,{asChild:!0,children:(0,s.jsx)(C.o,{id:"downvote-feedback",name:"feedback",onChange:e=>P(e.target.value),onKeyDown:b,placeholder:"Your feedback...",minHeight:80,maxHeight:192,value:L})})]}),(0,s.jsxs)("div",{className:"is-mobile:flex-col-reverse is-not-mobile:flex-row flex w-full items-center justify-end gap-2",children:[(0,s.jsx)(n.$,{className:"is-mobile:w-full",onClick:e=>{e.preventDefault(),E()},size:"sm",variant:"secondary",children:D("cancel")}),(0,s.jsx)(n.$,{className:"is-mobile:w-full",size:"sm",type:"submit",children:D("submit")})]})]}),[A,j,v,R,D,b,L,E]);return(0,s.jsx)(f.Modal,{onClose:E,onOpenChange:e=>{e||E()},open:!!t,children:(0,s.jsxs)("div",{className:"overflow-auto",children:[(0,s.jsxs)(f.ModalHeader,{children:[(0,s.jsx)(f.ModalTitle,{children:D("title")}),(0,s.jsx)(f.ModalDescription,{children:D("description",v)})]}),(0,s.jsx)(f.ModalContent,{children:T})]})})}function z(e){let{variant:t,messageId:a,quoteRef:r,tooltip:l,...i}=e,{messages:o}=(0,p.Pk)(),{setDownvoteDialogState:c}=S(),{isLoading:d,canVote:u}=(0,k.q)();if(d||!u)return null;function m(){var e;return JSON.stringify(null===(e=o.find(e=>"id"in e&&e.id===a))||void 0===e?void 0:e.content)}return"quote"===t?(0,s.jsx)(n.$,{"aria-label":"Downvote",className:"text-muted-foreground hover:text-foreground rounded-md p-0 text-sm",onClick:()=>{var e,t;(0,h.u)("OpenDownvote",{quote:null==r?void 0:null===(e=r.current)||void 0===e?void 0:e.call(r),messageId:a,messageText:m()}),c({messageId:a,quote:null==r?void 0:null===(t=r.current)||void 0===t?void 0:t.call(r)})},size:"xs",variant:"ghost",children:(0,s.jsx)(b,{"aria-hidden":!0})}):(0,s.jsx)(n.$,{"aria-label":"Downvote Response",onClick:async()=>{(0,h.u)("OpenDownvote",{messageId:a,messageText:m()}),await c({messageId:a})},size:"xs",tooltip:l,variant:"ghost",...i,children:(0,s.jsx)(b,{})})}},91302:(e,t,a)=>{"use strict";a.d(t,{P:()=>s});let s=["ts","typescript","typescriptreact","tsx","javascript","javascriptreact","jsx"]},93004:(e,t,a)=>{"use strict";a.d(t,{t:()=>l});var s=a(18730),r=a(59103),n=a(80644);function l(){let{chatId:e}=(0,s.xz)(),{data:t,mutate:a}=(0,r.Ay)(["block:forked-from",e]);return{getBlockForked:(0,n.useCallback)(e=>{var a;return null!==(a=null==t?void 0:t.get(e))&&void 0!==a?a:void 0},[t]),setBlockForked:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)))},[t,a])}}},93874:(e,t,a)=>{"use strict";a.d(t,{Dm:()=>T,oL:()=>A,f8:()=>_,e$:()=>F,KF:()=>V});var s=a(7336),r=a(33769),n=a(82954),l=a(23938),i=a(63443),o=a(48256),c=a(72633);c.z.object({error:c.z.object({message:c.z.string().optional().default(""),code:c.z.string().optional().default("")})});var d=function(e){return e.Plain="plain",e.Secret="secret",e.System="system",e.Encrypted="encrypted",e.Sensitive="sensitive",e}({}),u=a(81616),m=a(80644),h=a(37522),p=a(93911),x=a(4194),g=a(10299),f=a(1808),v=a(61934),j=a(76073),b=a(38559),y=a(15067),w=a(97947),N=a(4495),k=a(76989),C=a(52220),S=a(10722),I=a(79822),M=a(51621),z=a(30009);let L=(0,z.createServerReference)("60148ec832851e1866020ee344da50bf0398d6b98b",z.callServer,void 0,z.findSourceMapURL,"createNewVercelProject");var P=a(15993),R=a(60358),D=a(26939),E=a(50688);function A(e){let{envVar:t}=e;return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Key"}),(0,s.jsx)("p",{className:"text-muted-foreground break-all",children:null==t?void 0:t.key})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Value"}),(0,s.jsx)("p",{className:"text-muted-foreground break-all",children:(null==t?void 0:t.type)===d.Encrypted?t.decrypted?t.value:"*** Encrypted ***":null==t?void 0:t.value})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Targets"}),(0,s.jsx)("p",{className:"text-muted-foreground break-words",children:Array.isArray(null==t?void 0:t.target)?t.target.join(", "):null==t?void 0:t.target})]}),(null==t?void 0:t.comment)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Comment"}),(0,s.jsx)("p",{className:"text-muted-foreground break-words",children:t.comment})]})]})}function T(e){let{v0ProjectId:t,onClose:a,open:r,onProjectCreated:n}=e,[l,i]=(0,m.useState)(""),{activeScopeSlug:o}=(0,j.k6)(),c=(0,g.useRouter)();return t?(0,s.jsx)(b.Modal,{onOpenChange:a,open:r,children:(0,s.jsxs)("form",{action:async()=>{try{let e=await L(t,l);if(!e.id){P.oR.error("Failed to create project");return}await (0,f.t)({v0ProjectId:t,vercelProjectId:e.id}),n({id:e.id,name:l,url:"https://vercel.com/".concat(o,"/").concat(l),env:[]}),P.oR.success("Project created and linked successfully"),c.refresh()}catch(e){P.oR.error("Failed to create project")}a()},children:[(0,s.jsx)(b.ModalHeader,{children:(0,s.jsx)(b.ModalTitle,{children:"Create New Vercel Project"})}),(0,s.jsx)(b.ModalContent,{children:(0,s.jsx)(C.p,{autoFocus:!0,onChange:e=>i(e.target.value),placeholder:"Project Name",required:!0,value:l})}),(0,s.jsxs)(b.ModalFooter,{children:[(0,s.jsx)(b.ModalClose,{asChild:!0,children:(0,s.jsx)(u.$,{onClick:a,size:"sm",variant:"secondary",children:"Cancel"})}),(0,s.jsx)(R.Q,{size:"sm",variant:"default",children:"Create"})]})]})}):null}function F(e){let{filteredProjects:t,searchQuery:a,setSearchQuery:i,isLoading:o,selectedProject:c,handleLinkProject:d,setShowCreateModal:m,onCreateModalOpen:h}=e,{user:p}=(0,D.J)(),g=(null==p?void 0:p.v0plan)==="v0-enterprise";return(0,s.jsxs)("div",{className:"flex size-full flex-col",children:[!g&&(0,s.jsxs)("div",{className:"border-border flex w-full items-center border-b py-1.5 pl-4 pr-3.5",children:[(0,s.jsx)("span",{className:"text-gray-500",children:(0,s.jsx)(x.e,{})}),(0,s.jsx)(C.p,{className:"flex-1 border-none bg-inherit",onChange:e=>i(e.target.value),placeholder:"Search projects...",value:a}),(0,s.jsx)(I.N,{mode:"wait",children:a&&(0,s.jsx)(M.P.button,{animate:{opacity:1},className:"sp-1 text-gray-500 hover:text-gray-700 focus:outline-none",exit:{opacity:0},initial:{opacity:0},onClick:()=>i(""),children:(0,s.jsx)(S.A,{size:16})})})]}),!g&&(0,s.jsx)("div",{className:"relative flex max-h-[225px] min-h-[225px] flex-1 flex-col overflow-y-auto p-2",onWheel:e=>{e.stopPropagation()},onTouchMove:e=>{e.stopPropagation()},children:(0,s.jsx)(I.N,{children:o?(0,s.jsx)(U,{}):0===t.length?(0,s.jsx)(O,{title:"No Projects Found"}):t.map(e=>(0,s.jsxs)(k.DropdownMenuItem,{className:(0,N.cn)("group flex items-center justify-between md:px-2","w-full rounded-md p-2 hover:bg-gray-100 md:w-auto"),onClick:()=>d((null==c?void 0:c.id)===e.id?null:e),children:[(0,s.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,s.jsx)(r.A,{className:"size-4"}),(0,s.jsx)("span",{className:"max-w-[200px] truncate",children:e.name})]}),(null==c?void 0:c.id)===e.id?(0,s.jsxs)("span",{className:"flex shrink-0 items-center text-gray-500",children:[(0,s.jsx)(n.A,{className:"h-4 w-4 group-hover:hidden"}),(0,s.jsx)("span",{className:"hidden group-hover:inline",children:"Unlink"})]}):(0,s.jsx)("span",{className:"hidden shrink-0 font-medium text-gray-500 group-hover:inline",children:"Link"})]},e.id))})}),g&&(0,s.jsx)("div",{className:"flex flex-col gap-2 p-4 text-center text-sm",children:(0,s.jsx)("span",{className:"font-medium text-gray-500",children:"Enterprise customers can't connect existing Vercel projects at the moment."})}),(0,s.jsx)("div",{className:"sticky bottom-0 w-full border-t p-1.5",children:(0,s.jsxs)(u.$,{onClick:()=>{m(!0),null==h||h()},className:"w-full gap-0.5",variant:"secondary",children:[(0,s.jsx)(l.A,{className:"size-4 shrink-0"}),(0,s.jsx)("span",{className:"px-1.5",children:"New Project"})]})})]})}function O(e){let{title:t}=e;return(0,s.jsx)(w.Sv,{className:"bg-muted flex-1 rounded-lg",children:(0,s.jsx)(w.HY,{children:(0,s.jsx)(w.cz,{className:"text-sm text-gray-500",children:t})})})}function U(){return(0,s.jsx)(s.Fragment,{children:Array.from({length:10}).map((e,t)=>(0,s.jsx)(k.DropdownMenuItem,{className:(0,N.cn)("group flex items-center justify-between md:px-2","w-full rounded-md p-2 hover:bg-gray-100 md:w-auto"),disabled:!0,children:(0,s.jsxs)("span",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,s.jsx)(r.A,{className:"size-4"}),(0,s.jsx)(E.E,{className:"h-4 w-full"})]})},t))})}function V(e){let{v0ProjectId:t,currentProject:a,projects:r,readOnly:n,size:l="default",alias:c,children:d}=e,[x,j]=(0,m.useState)(a),[b,y]=(0,m.useState)(""),[w,C]=(0,m.useState)(!1),[S,I]=(0,m.useState)(!1),[M,z]=(0,m.useState)(!1),L=(0,g.useRouter)(),R=async e=>{if(!n){if(!e)return D();C(!0);try{let a=await (0,f.t)({v0ProjectId:t,vercelProjectId:e.id});"error"in a||!a.success||(j(e),P.oR.success("Project linked successfully"))}catch(e){P.oR.error("Failed to link project. Please try again.")}finally{I(!1),C(!1),L.refresh()}}},D=async()=>{if(!n){C(!0),j(void 0);try{let e=await (0,v.y)({v0ProjectId:t});"error"in e||!e.success?(j(a),P.oR.error("Failed to unlink project. Please try again.")):P.oR.success("Project unlinked successfully")}catch(e){j(a),P.oR.error("Failed to unlink project. Please try again.")}finally{I(!1),C(!1),L.refresh()}}},E=r.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())),A=x?(0,s.jsx)("div",{className:"rounded-lg p-2 text-sm sm:p-0",children:(0,s.jsxs)("div",{className:"bg-muted flex flex-col rounded-lg text-sm",children:[d,(0,s.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm hover:underline",children:[(0,s.jsx)("span",{className:"font-medium",children:x.name}),(0,s.jsx)(p.F,{className:"size-4"})]}),c?(0,s.jsx)("a",{href:(0,N.sT)(c),target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground flex items-center gap-1 text-sm hover:underline",children:c}):null]}),(0,s.jsxs)(k.DropdownMenu,{children:[(0,s.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(u.$,{className:"relative size-8",size:"sm",variant:"ghost",disabled:n,tooltip:n?"You don't have permission to modify this project":void 0,children:[(0,s.jsx)(h.a,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Open project actions"})]})}),(0,s.jsx)(k.DropdownMenuContent,{align:"end",side:"bottom",sideOffset:8,children:(0,s.jsxs)(k.DropdownMenuGroup,{children:[(0,s.jsx)(k.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[(0,s.jsx)(i.A,{}),(0,s.jsx)("span",{children:"View on Vercel"})]})}),(0,s.jsxs)(k.DropdownMenuItem,{variant:"destructive",onClick:D,disabled:n,children:[(0,s.jsx)(o.A,{}),(0,s.jsx)("span",{children:"Unlink Vercel Project"})]})]})})]})]})]})}):(0,s.jsx)("div",{className:"p-2 md:p-0",children:(0,s.jsx)(u.$,{className:"w-full","aria-label":"Add a Vercel Project",variant:"outline",disabled:w||n,size:l,children:(0,s.jsx)("span",{children:"Add Vercel Project"})})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{v0ProjectId:t,onClose:()=>z(!1),open:M,onProjectCreated:e=>{j(e),I(!1)}}),(0,s.jsx)("div",{className:"w-full min-w-0",children:x?A:n?A:(0,s.jsxs)(k.DropdownMenu,{onOpenChange:I,open:S,children:[(0,s.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:A}),(0,s.jsx)(k.DropdownMenuContent,{align:"center",className:"w-[400px]",side:"bottom",children:(0,s.jsx)(F,{filteredProjects:E,searchQuery:b,setSearchQuery:y,isLoading:w,selectedProject:x,handleLinkProject:R,setShowCreateModal:z,onCreateModalOpen:()=>I(!1)})})]})})]})}function _(e){let{v0ProjectId:t,readOnly:a,size:r="sm"}=e,{projects:n,isReady:l}=(0,y.D)();return l?(0,s.jsx)(V,{v0ProjectId:t,currentProject:void 0,projects:n||[],readOnly:a,size:r}):(0,s.jsx)(u.$,{disabled:!0,size:r,children:"Add Vercel Project"})}},93881:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(66544),r=a(22931);function n(e){let{source:t,blockType:a,blockId:n}=e,l=t.split("\n"),i=null,o=[],c=r.Vr[a],d=!1;for(let e of l)if(e.startsWith(c)){let t;let[a,...r]=e.slice(c.length).trim().split(":"),l=function(e){let t;if(!e)return{};let a=/(\w+)=["']([^"']*)["']|(\w+)/g,s={};for(;null!==(t=a.exec(e));)t[1]?s[t[1]]=t[2]:t[3]&&(s[t[3]]="true");return s}(r.join(":"));if(l.file&&"true"!==l.file)d=!1;else{d=!0;continue}i&&o.push({...i});try{t=l.fixingBadLines.split(",").map(Number)}catch(e){t=void 0}l.url&&!l.url.startsWith("https://")&&delete l.url,i={lang:(0,s.SR)(a),meta:l,isEdit:!!l.isEdit,isAttachmentQuickEdit:!!l.isAttachmentQuickEdit,isLocked:!!l.isLocked,isQuickEdit:!!l.isQuickEdit,isTerminated:!!l.isTerminated,isDeleted:!!l.isDeleted,isFixed:!!l.isFixed,isMoved:!!l.isMoved,isMovedFrom:l.isMovedFrom,fixingBadLines:t,blockId:n,source:"",isMerged:!!l.isMerged,blobUrl:l.url}}else i&&!d&&(i.source+=e+"\n",i.blobUrl&&i.source.trim().length>0&&(i.blobUrl=void 0));return i&&o.push(i),o}},93925:(e,t,a)=>{"use strict";a.d(t,{g:()=>r});var s=a(7336);function r(e){return(0,s.jsxs)("svg",{fill:"currentColor",viewBox:"0 0 40 20",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,s.jsx)("path",{d:"M23.3919 0H32.9188C36.7819 0 39.9136 3.13165 39.9136 6.99475V16.0805H36.0006V6.99475C36.0006 6.90167 35.9969 6.80925 35.9898 6.71766L26.4628 16.079C26.4949 16.08 26.5272 16.0805 26.5595 16.0805H36.0006V19.7762H26.5595C22.6964 19.7762 19.4788 16.6139 19.4788 12.7508V3.68923H23.3919V12.7508C23.3919 12.9253 23.4054 13.0977 23.4316 13.2668L33.1682 3.6995C33.0861 3.6927 33.003 3.68923 32.9188 3.68923H23.3919V0Z"}),(0,s.jsx)("path",{d:"M13.7688 19.0956L0 3.68759H5.53933L13.6231 12.7337V3.68759H17.7535V17.5746C17.7535 19.6705 15.1654 20.6584 13.7688 19.0956Z"})]})}},95110:(e,t,a)=>{"use strict";a.d(t,{DK:()=>S,Mu:()=>C,P6:()=>k,f8:()=>I});var s=a(7336),r=a(80644),n=a(18730),l=a(61202),i=a(19895),o=a(59103),c=a(24849),d=a(10380),u=a(72704),m=a(68627),h=a(78088),p=a(81616),x=a(88293),g=a(5778),f=a(85168),v=a(4495),j=a(22748),b=a(403),y=a(99256),w=a(67952),N=a(22931);let k=e=>{let t,{blockId:a,searchAll:s=!1}=e,{messages:i,activeForkKey:c,chatId:d}=(0,n.Pk)(),{data:u,mutate:m}=(0,o.Ay)(["blocks:overrides",d]),{allBlocks:h,activeProject:p,activeBlockIndex:x,activeVersionIndex:g,projectBlocks:f,history:v}=(0,r.useMemo)(()=>{let e,t;if(!a)return{allBlocks:[],activeProject:void 0,activeBlockIndex:-1,activeVersionIndex:-1,projectBlocks:[],history:[]};let r={},n=[],o=-1,d=new Set(c);for(let c of i)if((s||d.has(c.id))&&"assistant"===c.role){let s=(0,l.sY)(c.content,c.id);for(let l of(c.isContentLoading&&c.loadingBlocks&&(s=c.loadingBlocks),s)){let s=null==u?void 0:u[l.id],i={...l,...s||{}};if(N.kX.includes(i.type))continue;let c=i.meta.project||"";r[c]||(r[c]=[]),i.id===a&&(e=c,t=i.meta.file,o=r[c].length),n.push(i),r[c].push(i)}}let m=[],h=-1,p=r[e||""];for(let s=0;s<(p?p.length:0);s++){let n=r[e||""][s];n.id===a&&(h=m.length),n.meta.file===t&&m.push(n)}return{allBlocks:n,activeProject:e,activeBlockIndex:o,activeVersionIndex:h,projectBlocks:r[e||""]||[],history:m}},[a,c,i,s,u]),j=(0,r.useCallback)(e=>{let{blockId:t,data:a}=e;m(e=>({...e,[t]:{...a}}))},[m]);return a&&u&&u[a]&&(t=u[a].source),{history:v,allBlocks:h,latestSource:t,projectBlocks:f,projectBlockIndex:x,project:p,currentBlockIndex:g,updateBlockData:j}};function C(e){let{blockId:t,separator:a=!0}=e,{history:l,currentBlockIndex:o}=k({blockId:t,searchAll:!0}),{messages:c,activeForkKey:N}=(0,n.Pk)(),C=(0,n.jo)(),S=(0,i.y6)(),{getBlockCreatedAt:M}=(0,m.y)(),z=(0,i.eu)(),{setPulsePreview:L}=I(),{getBlockDeployed:P}=(0,j.G)(),[R,D]=(0,r.useState)(!1),[E,A]=(0,r.useState)(Date.now()),T=(0,r.useCallback)(e=>{D(e),A(Date.now())},[]),{scrollToHash:F}=(0,g.r)(),O=(0,w.k)("blockHistory");return l.length<=1?(0,s.jsx)("div",{className:"no-block-history hidden"}):(0,s.jsxs)(s.Fragment,{children:[a?(0,s.jsx)(x.Separator,{className:"mx-1.5 h-[22px]",orientation:"vertical"}):null,(0,s.jsx)("div",{className:"block-history flex gap-1",onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:(0,s.jsxs)(h.l6,{open:R,onOpenChange:T,value:null==z?void 0:z.id,onValueChange:e=>{let t=l.find(t=>t.id===e);if((null==t?void 0:t.isLoading)||(S(t),!(null==t?void 0:t.messageId)))return;let a=c.map((e,t)=>({...e,parentId:e.parentId||null,createdAt:new Date(t),messageId:e.id})),s=(0,f.n1)(a,t.messageId);N&&!N.includes(t.messageId)&&C({activeForkKey:s}),L({blockId:t.id}),F(t.messageId,150,!0,s)},children:[(0,s.jsx)(p.$,{variant:"ghost",size:"sm",className:"h-7 rounded-md px-1.5",asChild:!0,children:(0,s.jsx)(h.bq,{hideChevron:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(d.Q,{className:"size-4"}),(0,s.jsxs)("span",{children:[O("version")," ",o+1]})]})})}),(0,s.jsx)(h.gC,{align:"end",className:"max-h-[280px] w-[245px]",children:l.toReversed().map((e,t)=>{let a=null==N?void 0:N.includes(e.messageId);return(0,s.jsx)(h.eb,{iconOnRight:!0,value:e.id,disabled:e.isLoading,className:(0,v.cn)("px-2 py-1.5",!a&&!e.isLoading&&"text-gray-500 hover:text-gray-500 focus:text-gray-500"),children:(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsxs)("div",{className:(0,v.cn)("flex items-center gap-2 font-medium"),children:[(0,s.jsxs)("div",{children:["Version ",l.length-t]}),P(e.id)?(0,s.jsxs)(y.E,{children:[(0,s.jsx)(b.q,{size:12})," Deployed"]}):null]}),(0,s.jsx)("div",{className:(0,v.cn)("text-[13px] text-gray-500",!a&&!e.isLoading&&"text-gray-400"),children:M(e.id)?(0,u.f)(new Date(M(e.id)),!0,E):"Just now"})]})},e.id)})})]})})]})}function S(e){let{blockId:t}=e,{data:a}=(0,o.Ay)(["pulse-preview",t],null,{fallbackData:!1});return{pulsePreview:null!=a&&a}}function I(){return{setPulsePreview:(0,r.useCallback)(e=>{let{blockId:t}=e;(0,c.k)(["pulse-preview",t],!0),setTimeout(()=>(0,c.k)(["pulse-preview",t],!1),2e3)},[])}}},95559:(e,t,a)=>{"use strict";a.d(t,{Gb:()=>x,Xh:()=>h,fo:()=>p});var s=a(7336),r=a(1665),n=a(24607),l=a(43665),i=a(67952),o=a(1510),c=a(50688),d=a(35740),u=a(80644),m=a(80391);function h(e){let{scope:t,user:a,showEmail:l=!1,isTrigger:i=!1,children:o}=e,c=(0,r.sJ)(t),{scopeIsUser:d,scopePlan:u,scopeMembershipRole:m,hasV0Seat:h,accessRequested:x,isLoading:f}=p(t,a),v=c?null:(0,s.jsx)(g,{emailToShow:l?null==a?void 0:a.email:void 0,isLoading:f,role:m,scopePlan:u,scopeIsUser:d,v0Access:h,accessRequested:x});return i?(0,s.jsxs)("div",{className:"flex min-w-0 items-center justify-between gap-1",children:[(0,s.jsx)(n.AvatarUser,{size:"xs",className:"mr-1 size-5",teamId:d?void 0:t.id,userId:null==a?void 0:a.id}),(0,s.jsx)("div",{className:"w-full truncate text-start text-sm font-medium leading-[20px] text-gray-900",children:d?t.username:t.name}),o]}):(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,s.jsx)(n.AvatarUser,{teamId:d?void 0:t.id,userId:null==a?void 0:a.id}),(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start",children:[(0,s.jsx)("div",{className:"w-full truncate text-start text-sm font-medium leading-[20px] text-gray-900",children:d?t.username:t.name}),v]}),o]})}function p(e,t){let a=(0,l.W)(e),{planSlug:s,isLoading:r}=(0,d.N)(!!a||!e.limited,e.id),n=a?void 0:e.membership.role,i=!!(a&&s)||!!(!a&&t&&(0,o.f)(e,t)),c=a?e.username:e.slug,u=!!(!a&&e.accessRequested);return{scopeIsUser:a,scopePlan:s||(a?void 0:e.activeTrialPlan),scopeSlug:c,scopeMembershipRole:n,user:t,hasV0Seat:i,accessRequested:u,isLoading:r}}function x(){return(0,s.jsxs)("div",{className:"flex w-full justify-between gap-2 py-0.5",children:[(0,s.jsx)(c.E,{className:"size-8 rounded-lg"}),(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start justify-between pb-px pt-0.5",children:[(0,s.jsx)(c.E,{className:"h-3 w-24 rounded-lg"}),(0,s.jsx)(c.E,{className:"h-3 w-12 rounded-lg"})]})]})}function g(e){let{isLoading:t,scopePlan:a,scopeIsUser:r,role:n,v0Access:l,accessRequested:o,emailToShow:d}=e,h=(0,i.k)("billingPlans"),p=l&&a,x=(0,u.useMemo)(()=>d||(p?(0,s.jsx)(m.U3,{type:a}):"OWNER"===n?h("startTeamPlan"):o?h("accessRequested"):h("requestAccess")),[d,p,a,n,h,o]);return t||r&&!a?(0,s.jsx)(c.E,{className:"h-4 w-20 rounded-lg "}):(0,s.jsx)("div",{className:"h-4 w-full truncate text-start text-[13px] font-medium leading-[16px] text-gray-500",children:x})}},95687:(e,t,a)=>{"use strict";a.d(t,{Ne:()=>k,zs:()=>L});var s=a(7336),r=a(80644),n=a(78088),l=a(15066),i=a(19895),o=a(15993),c=a(59103),d=a(39717),u=a(34112),m=a(57748),h=a(57122),p=a.n(h),x=a(45419),g=a(14167),f=a(81616),v=a(38559),j=a(3650),b=a(18730),y=a(4495);function w(e){let{className:t,...a}=e;return(0,s.jsxs)("svg",{className:(0,y.cn)("h-4 w-4",t),width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[(0,s.jsxs)("g",{"clip-path":"url(#clip0_4850_58055)",children:[(0,s.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.661 0.452632C9.82859 0.159465 8.93301 0 8 0C3.58 0 0 3.57879 0 7.99729C0 11.5361 2.29 14.5251 5.47 15.5847C5.87 15.6547 6.02 15.4148 6.02 15.2049C6.02 15.1389 6.01879 15.0197 6.01722 14.8643C6.01426 14.5724 6.01 14.1524 6.01 13.7154C4 14.0852 3.48 13.2255 3.32 12.7757C3.23 12.5458 2.84 11.836 2.5 11.6461C2.22 11.4961 1.82 11.1262 2.49 11.1162C3.12 11.1062 3.57 11.696 3.72 11.936C4.44 13.1455 5.59 12.8057 6.05 12.5957C6.12 12.0759 6.33 11.726 6.56 11.5261C4.78 11.3262 2.92 10.6364 2.92 7.57743C2.92 6.70773 3.23 5.98797 3.74 5.42816C3.66 5.22823 3.38 4.40851 3.82 3.30888C3.82 3.30888 4.49 3.09895 6.02 4.1286C6.66 3.94866 7.34 3.85869 8.02 3.85869C8.7 3.85869 9.38 3.94866 10.02 4.1286C10.1201 4.06061 10.2164 3.99802 10.3092 3.94039C10.1106 3.50109 10 3.01346 10 2.5C10 1.73554 10.2451 1.02832 10.661 0.452632ZM13.5 6C14.2646 6 14.972 5.7548 15.5478 5.33875C15.8407 6.17042 16 7.06517 16 7.99729C15.9996 9.67293 15.4735 11.3062 14.4958 12.6673C13.5182 14.0284 12.1381 15.0488 10.55 15.5847C10.15 15.6647 10 15.4148 10 15.2049C10 15.1146 10.0011 14.9584 10.0026 14.7505C10.0056 14.3366 10.01 13.7176 10.01 13.0056C10.01 12.2558 9.76 11.776 9.47 11.5261C11.25 11.3262 13.12 10.6464 13.12 7.57743C13.12 6.92744 12.9508 6.37022 12.6566 5.89772C12.9268 5.96454 13.2092 6 13.5 6Z",fill:"currentColor"}),(0,s.jsx)("circle",{cx:"13.5",cy:"2.5",r:"2.5",className:"fill-green-600"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_4850_58055",children:(0,s.jsx)("rect",{width:"16",height:"16",fill:"currentColor"})})})]})}function N(){let{data:e,mutate:t}=(0,c.Ay)("connectRepoDialogState",null,{fallbackData:!1});return{connectRepoDialogState:e,setConnectRepoDialogState:t}}function k(){let{project:e}=(0,m.tZ)(),{connectRepoDialogState:t,setConnectRepoDialogState:a}=N(),n=(0,r.useCallback)(()=>{a(!1)},[a]);return(0,s.jsx)(v.Modal,{open:!!t,onOpenChange:e=>{e||a(!1)},children:(0,s.jsx)(C,{project:e,onClose:n})})}function C(e){var t;let{project:a,onClose:n}=e,{refetchVercelProject:l,vercelProjectWithDashboard:d}=(0,x.Ok)(null==a?void 0:a.projectId),u=null==d?void 0:null===(t=d.dashboardProject)||void 0===t?void 0:t.link,{namespaces:h,needsAuth:g,isLoading:f}=function(){let{data:e,error:t,isLoading:a,mutate:s}=(0,c.Ay)("github:active-namespaces",async()=>{try{let e=new URLSearchParams({provider:"github"}),t=await fetch("/chat/api/git/search-namespaces?".concat(e.toString()));if(!t.ok)throw Error("Failed to search orgs");return await t.json()}catch(e){return[]}},{revalidateOnFocus:!0,revalidateOnMount:!0});return{namespaces:e||[],needsAuth:(null==e?void 0:e.length)===0,revalidate:s,isLoading:a,error:t}}(),[v,j]=(0,r.useState)(u?"success":"info"),[b,y]=(0,r.useState)(!1),[w,N]=(0,r.useState)(null),k=u?"https://github.com/".concat(u.org,"/").concat(u.repo):null,[C,L]=(0,r.useState)(),P=(0,i.eu)(),{title:R}=(0,m.tZ)();(0,r.useEffect)(()=>{!f&&g&&j("connect")},[g,f]);let D=(0,r.useCallback)(async()=>{let e=null==P?void 0:P.id,t=null==a?void 0:a.projectId;if(!t){o.oR.error("Chat needs to be in a project");return}if(!(C&&C.name&&C.ownerType)){o.oR.error("Repo owner not specified");return}y(!0),N(null);let s={owner:C.name,repoName:p()(R),blockId:e,projectId:t};try{let e=await fetch("/chat/api/git/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok){let t=await e.json(),a="Failed to create repository.";throw"repo_alr_exists"===t.error&&(a="Repository already exists. Try a new name."),Error(a)}o.oR.success("Success creating repository"),await l(),j("success")}catch(t){let e=t instanceof Error?t.message:"Failed to create repository";N(e),o.oR.error(e)}finally{y(!1)}},[null==P?void 0:P.id,C,R,l]),E=(0,r.useMemo)(()=>e=>{let t=h.find(t=>"".concat(t.id)===e);t?L(t):console.error("Namespaces with ID ".concat(e," not found"))},[h]);return(0,r.useMemo)(()=>{switch(v){case"connect":return(0,s.jsx)(S,{onClose:n,onSuccess:()=>{j("info")}});case"info":return(0,s.jsx)(I,{onCreateRepo:()=>j("make"),onClose:n,project:a});case"make":return(0,s.jsx)(M,{namespaces:h,setOwnerById:E,handleCreateRepo:D,isCreating:b,error:w});case"success":return(0,s.jsx)(z,{remoteUrl:k,onClose:n});default:return null}},[v,n,a,h,E,D,b,w,k])}function S(e){let{onClose:t,onSuccess:a}=e,n="/chat/git/connected",l=window.location.origin+n,{open:i}=function(e){let{url:t,width:a=600,height:s=700,title:n="Authentication",onClose:l,onMessage:i,onPoll:o}=e,[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(!1),h=(0,r.useCallback)(()=>({left:window.screenX+(window.outerWidth-a)/2,top:window.screenY+(window.outerHeight-s)/2}),[a,s]),p=(0,r.useCallback)(()=>{if(c&&!c.closed){c.focus();return}let{left:e,top:r}=h(),l=window.open(t,n,"width=".concat(a,",height=").concat(s,",left=").concat(e,",top=").concat(r,",resizable=yes,scrollbars=yes,status=yes"));l?(d(l),m(!0)):console.error("Failed to open popup. It might have been blocked by the browser.")},[t,n,a,s,c,h]),x=(0,r.useCallback)(()=>{c&&!c.closed&&c.close(),d(null),m(!1)},[c]);return(0,r.useEffect)(()=>{let e=e=>{var t;i&&i(e),(null===(t=e.data)||void 0===t?void 0:t.type)==="auth-complete"&&x()};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[x,i]),(0,r.useEffect)(()=>{if(!c)return;let e=setInterval(()=>{c.closed&&(clearInterval(e),m(!1),d(null),l&&l())},500);return()=>{clearInterval(e)}},[c,l]),(0,r.useEffect)(()=>{if(!c||!o)return;let e=setInterval(()=>{try{o(c)}catch(t){console.warn("Error accessing popup window location, may be cross-origin:",t),clearInterval(e)}},500);return()=>{clearInterval(e)}},[c,o]),{isOpen:u,open:p,close:x,popupWindow:c}}({url:"https://vercel.com/api/registration/login-with-github?next=".concat(encodeURIComponent(l)),onPoll:e=>{e.location.pathname===n&&(a(),e.close())}});return(0,r.useEffect)(()=>{i()},[i]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.ModalHeader,{children:(0,s.jsx)(v.ModalTitle,{children:"Connect to GitHub Repository"})}),(0,s.jsx)(v.ModalContent,{children:"Create a new repository on GitHub to sync changes to. v0 will create branches and watch for changes in this repository."}),(0,s.jsxs)(P,{children:[(0,s.jsx)(f.$,{size:"sm",onClick:t,variant:"outline",children:"Cancel"}),(0,s.jsxs)(f.$,{size:"sm",onClick:i,children:[(0,s.jsx)(d.ERf,{className:"mr-2 h-5 w-5"}),"Connect GitHub Account"]})]})]})}function I(e){let{onCreateRepo:t,onClose:a,project:n}=e,{title:l}=(0,m.tZ)(),{chatId:i}=(0,b.Pk)(),[o,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),p=(0,r.useCallback)(async()=>{if(n)null==t||t();else{c(!0),h(null);let e="Fork of ",a=l;a.startsWith(e)&&(a=a.slice(e.length));try{await (0,j.g)({projectName:a,onSuccess:()=>{},chatId:i,includeSuccessToast:!1}),c(!1),null==t||t()}catch(e){h(e instanceof Error?e.message:"Failed to create project"),c(!1)}}},[i,t,n,l]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.ModalHeader,{children:(0,s.jsx)(v.ModalTitle,{children:"Connect to GitHub Repository"})}),(0,s.jsxs)(v.ModalContent,{children:[(0,s.jsx)("p",{className:"mb-4",children:"Create a new repository on GitHub to sync changes to. v0 will create branches and watch for changes in this repository."}),d&&(0,s.jsx)("div",{className:"mt-4 rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:d})]}),(0,s.jsxs)(P,{children:[(0,s.jsx)(f.$,{size:"sm",onClick:a,variant:"outline",disabled:o,children:"Cancel"}),(0,s.jsx)(f.$,{size:"sm",onClick:p,disabled:o,children:o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Project..."]}):"Create Repository"})]})]})}function M(e){let{namespaces:t,setOwnerById:a,handleCreateRepo:r,isCreating:i=!1,error:o=null}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.ModalHeader,{children:(0,s.jsx)(v.ModalTitle,{children:"Connect to GitHub Repository"})}),(0,s.jsxs)(v.ModalContent,{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{htmlFor:"owner",children:"Select your GitHub organization"}),(0,s.jsxs)(n.l6,{onValueChange:a,disabled:i,children:[(0,s.jsx)(n.bq,{id:"owner",children:(0,s.jsx)(n.yv,{placeholder:"Select your org"})}),(0,s.jsx)(n.gC,{children:t.map(e=>(0,s.jsx)(n.eb,{value:"".concat(e.id),children:e.slug},e.id))})]})]})}),o&&(0,s.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:o})]}),(0,s.jsx)(P,{children:(0,s.jsx)("div",{className:"flex justify-center pt-2",children:(0,s.jsx)(f.$,{size:"sm",onClick:r,disabled:i,children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Repository..."]}):"Create Repository"})})})]})}function z(e){let{remoteUrl:t,onClose:a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.ModalHeader,{children:(0,s.jsx)(v.ModalTitle,{children:"Connected to GitHub"})}),(0,s.jsx)(v.ModalContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{children:"New deployments will be pushed to this repository."}),t&&(0,s.jsx)(g.o,{className:"font-mono",displayLink:t,link:t})]})}),(0,s.jsxs)(P,{children:[(0,s.jsx)(f.$,{size:"sm",onClick:a,variant:"outline",children:"Cancel"}),(0,s.jsx)(f.$,{size:"sm",onClick:()=>window.open(t,"_blank","noopener"),children:"View on GitHub"})]})]})}function L(e){var t,a;let{projectId:r}=e,{setConnectRepoDialogState:n}=N(),l=null===(a=(0,x.Ok)(r).vercelProjectWithDashboard)||void 0===a?void 0:null===(t=a.dashboardProject)||void 0===t?void 0:t.link;return(0,s.jsxs)(f.$,{disabled:!1,onClick:()=>n(!0),className:"size-7 rounded-md",size:"sm",tooltip:{side:"bottom",content:l?"Connected to ".concat(l.org,"/").concat(l.repo):"Connect to GitHub"},variant:"ghost",children:[l?(0,s.jsx)(w,{className:"size-4"}):(0,s.jsx)(d.ERf,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Eject to GitHub"})]})}function P(e){let{children:t}=e;return(0,s.jsx)("div",{className:"bg-muted border-alpha-400 flex w-full items-center justify-end gap-2 border-t p-4",children:t})}},95813:(e,t,a)=>{"use strict";a.d(t,{I:()=>m});var s=a(7336),r=a(80644),n=a(18730),l=a(19895),i=a(10299),o=a(57748),c=a(84758),d=a(6723),u=a.n(d);function m(e){let{count:t,pushToBottom:a}=e,d=(0,r.useRef)(null),m=(0,r.useRef)(null),h=(0,r.useRef)(null),{messages:p,hashMessageId:x,activeForkKey:g}=(0,n.Pk)(),f=(0,l.I4)(),v=(0,i.usePathname)(),{setMetadata:j}=(0,o.tZ)(),{chatId:b}=(0,n.xz)(),[y,w]=(0,r.useState)(!1),[N,k]=(0,r.useState)(!0),C=(0,r.useCallback)((e,a,s)=>{var r;let n=!s&&e>=(null!=a?a:t)-1;null===(r=h.current)||void 0===r||r.scrollToIndex(e,{align:n?"end":"start"}),setTimeout(()=>{n&&m.current&&(m.current.scrollTop=m.current.scrollHeight-m.current.clientHeight+1)},0)},[t]),S=(0,r.useRef)(null),I=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(!a){if(S.current===e)return;S.current=e}let r=new Set(null!=s?s:g||[]),n=p.filter(e=>r.has(e.id)).findIndex(t=>t.id===e);-1!==n&&setTimeout(()=>C(n,null==s?void 0:s.length,a),t)},[p,C,g]),M=(0,r.useCallback)(()=>!!h.current&&h.current.scrollOffset+h.current.viewportSize+20>h.current.scrollSize,[]),z=(0,r.useCallback)(()=>{k(M())},[M]),L=u()(z,100);(0,r.useEffect)(()=>{let e=e=>{e.preventDefault();let t=window.location.hash.slice(1);t&&I(t)},t=e=>{var t;let a=e.target.closest("a");if(a&&(null===(t=a.getAttribute("href"))||void 0===t?void 0:t.startsWith("#"))){e.preventDefault(),e.stopPropagation();let t=a.getAttribute("href").slice(1);window.history.pushState(null,"","".concat(v,"#").concat(t)),window.scrollTo(0,0),I(t)}},a=d.current;window.addEventListener("hashchange",e),null==a||a.addEventListener("click",t);let s=m.current?new ResizeObserver(L):void 0;return null==s||s.observe(m.current),window.location.hash?I(window.location.hash.slice(1),250*!!f):x&&I(x,0),()=>{window.removeEventListener("hashchange",e),null==a||a.removeEventListener("click",t),null==s||s.disconnect()}},[f,v,I,j,x,L]);let P=(0,r.useCallback)(()=>{C(t-1),setTimeout(()=>{C(t)},150)},[t,C]),R=(0,r.useRef)(!0),D=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!h.current||!R.current||window.location.hash&&S.current!==window.location.hash)return;let e="".concat(t,"-").concat(b);D.current!==e&&(D.current=e,C(t))},[t,b,C]),(0,r.useEffect)(()=>{var e;a&&(null===(e=h.current)||void 0===e||e.scrollToIndex(t,{align:"end"}))},[t,a]),{containerRef:m,vlistRef:h,scrollToBottom:P,scrollToHash:I,scrollDownButton:(0,s.jsx)(c.w,{hidden:N||y,scrollToBottom:()=>{w(!0),C(t-1),w(!1)}}),handleScroll:z}}},95852:(e,t,a)=>{"use strict";a.d(t,{c:()=>r});var s=a(22931);function r(e){var t,a,r;let n={isLlmError:!1,isRetried:!1,errorCategory:void 0};if("string"==typeof e)n.isLlmError=e.startsWith(s.EQ),n.isRetried=e.endsWith(s.oP),n.errorCategory=null!==(a=e.split(":")[1])&&void 0!==a?a:"default";else if(null===(t=e.finishReason)||void 0===t?void 0:t.includes("provider_server_error")){let t=e.finishReason.startsWith("retry_provider_server_error"),a=t||!!e.finishReason.startsWith("provider_server_error");n.isLlmError=a,n.isRetried=t,a&&(n.errorCategory=null!==(r=e.finishReason.split(":")[1])&&void 0!==r?r:"default")}return n}},96668:(e,t,a)=>{"use strict";let s;a.d(t,{NonPaymentBanner:()=>x});var r=a(7336),n=a(76073),l=a(35740),i=a(47492);{let{Agent:e}=a(82329);s=new e({keepAlive:!0})}var o=a(40913);let c=null;new Proxy({},{get(e,t){if(!c){if(!o.env.KV_REST_API_URL||!o.env.KV_REST_API_TOKEN)throw Error("@vercel/kv: Missing required environment variables KV_REST_API_URL and KV_REST_API_TOKEN");let e=(c=(0,i.UU)({url:o.env.KV_REST_API_URL,token:o.env.KV_REST_API_TOKEN,enableAutoPipelining:!0,...s?{agent:s}:{}})).hmset;c.hmset=(async(t,a)=>{let s=Object.fromEntries(Object.entries(a).filter(e=>{let[,t]=e;return void 0!==t}));return e.call(c,t,s)}).bind(c);let t=c.hmget;c.hmget=(async function(e){for(var a=arguments.length,s=Array(a>1?a-1:0),r=1;r<a;r++)s[r-1]=arguments[r];let n=await t.call(c,e,...s),l=null==n?void 0:n.prompt;return l&&"object"==typeof l&&(n.prompt=JSON.stringify(l)),n}).bind(c);let a=c.hgetall;c.hgetall=(async e=>{let t=await a.call(c,e),s=null==t?void 0:t.prompt;return s&&"object"==typeof s&&(t.prompt=JSON.stringify(s)),t}).bind(c);let r=c.pipeline;c.pipeline=()=>new Proxy(r.call(c),{get(e,t){if("exec"===t){let t=e.exec;return async function(){return(await t.call(e)).map(e=>((null==e?void 0:e.prompt)&&"object"==typeof e.prompt&&(e.prompt=JSON.stringify(e.prompt)),e))}}return Reflect.get(e,t)}})}return Reflect.get(c,t)}});var d=a(38230),u=a.n(d),m=a(52014),h=a(22931),p=a(4495);function x(e){var t;let{className:a}=e,{user:s,activeScope:i}=(0,n.k6)(),{planInfo:o,planSlug:c}=(0,l.N)(!0,null==i?void 0:i.id),d=(null==o?void 0:o.current)&&"payment"in o.current?o.current.payment:null,x=null==d?void 0:null===(t=d.openInvoices[0])||void 0===t?void 0:t.url;return o&&x&&c&&"v0-level0"!==c&&"paid"!==d.status&&"processing"!==d.status?(0,r.jsxs)("div",{className:(0,p.cn)("border-alpha-200 relative z-10 hidden h-9 items-center justify-center gap-2 border-b bg-red-100 px-3 py-2 text-sm font-medium text-red-700 sm:flex",a),children:[(0,r.jsx)(m.V,{}),(0,r.jsxs)("div",{className:"flex items-center gap-1 ",children:["Your payment method",(0,r.jsxs)("span",{className:"hidden sm:inline",children:["for the ",h.Md[c]," plan"]})," ","failed."]}),(0,r.jsxs)(u(),{className:"text-red-900 dark:text-red-300",href:x,children:["Pay ",(0,r.jsx)("span",{className:"hidden sm:inline",children:"Open"})," Invoice"]})]}):null}},97237:(e,t,a)=>{"use strict";a.d(t,{Lb:()=>o});var s=a(30009);let r=(0,s.createServerReference)("40d0de4d37d178934e65658f171f6968f05766cbfa",s.callServer,void 0,s.findSourceMapURL,"uploadAssetAction");var n=a(80644),l=a(15993);let i=["png","jpg","jpeg","webp"],o=e=>{let{initialImages:t,disableDrag:a=!1}=e,s=n.useRef(null),[o,d]=n.useState(!1),[u,m]=n.useState(!1),[h,p]=n.useState(()=>{var e;return null!==(e=null==t?void 0:t.map(e=>({id:crypto.randomUUID(),file:new File([],e.name),size:e.size,status:"success",url:e.url})))&&void 0!==e?e:[]}),x=n.useCallback(e=>{p(e.map(e=>({id:crypto.randomUUID(),file:new File([],e.name),size:e.size,status:"success",url:e.url})))},[]),g=n.useCallback(async e=>{if(h.length+e.length>1)return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.oR.error("File limit exceeded",{description:"You can only upload up to ".concat(1," images.")});if(e.find(e=>{var t;let a=null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();return!a||!i.includes(a)}))return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.oR.error("Invalid file type",{description:"Allowed file types: ".concat(i.join(", "))});let t=e.find(e=>e.size>1048576);if(t)return e.forEach(e=>{URL.revokeObjectURL(URL.createObjectURL(e))}),l.oR.error("File too large",{description:"The file ".concat(t.name," is larger than ").concat("1 MB",".")});d(!0);let a=e.map(e=>({id:crypto.randomUUID(),file:e,status:"pending",url:URL.createObjectURL(e),size:e.size}));for(let e of(p(e=>[...e,...a]),a)){p(t=>t.map(t=>t.id===e.id?{...t,status:"uploading"}:t));try{let t=new FormData;t.append("file",e.file,e.file.name);let a=await r(t);if(a.error){p(t=>t.map(t=>t.id===e.id?{...t,status:"error",error:a.error}:t)),l.oR.error("Failed to upload file",{description:a.error});continue}let s=a.url;p(t=>t.map(t=>t.id===e.id?{...t,status:"success",url:s}:t))}catch(t){p(t=>t.map(t=>t.id===e.id?{...t,status:"error",error:"Upload failed"}:t))}}d(!1)},[h.length]),f=n.useCallback(async e=>{if(m(!1),o||(e.preventDefault(),e.stopPropagation(),!e.dataTransfer))return;let{files:t}=e.dataTransfer;c(t)&&await g(Array.from(t))},[g,o]);n.useEffect(()=>{if(a)return;let e=()=>m(!0),t=()=>m(!1),s=e=>{e.preventDefault(),e.stopPropagation()};return window.addEventListener("dragenter",e),document.documentElement.addEventListener("mouseleave",t),window.addEventListener("dragover",s),window.addEventListener("drop",f),()=>{window.removeEventListener("dragenter",e),document.documentElement.removeEventListener("mouseleave",t),window.removeEventListener("dragover",s),window.removeEventListener("drop",f)}},[a,f,g]);let v=async e=>{c(e.target.files)&&e.target.files&&await g(Array.from(e.target.files))},j=n.useCallback(e=>{p(t=>{let a=t.find(t=>t.id===e);return(null==a?void 0:a.url)&&URL.revokeObjectURL(a.url),t.filter(t=>t.id!==e)})},[]);return{files:h,setFiles:p,setInitialFiles:x,uploading:o,isDraggingFile:u,inputFileRef:s,onInputChange:v,removeFile:j}};function c(e){if(!(null==e?void 0:e.length))return!1;if(e.length>1)return l.oR.error("File limit exceeded",{description:"You can only upload up to ".concat(1," images at a time.")}),!1;for(let t of e)if(!t.type.startsWith("image/"))return l.oR.error("Invalid file type",{description:"Please upload image files only"}),!1;return!0}n.createContext({hasUploadedFile:!1,isUploadingFile:!1})},97629:(e,t,a)=>{"use strict";a.d(t,{r:()=>i,u:()=>o});var s=a(7336),r=a(80644),n=a(4495);let l=(0,a(15122).F)("pointer-events-none flex select-none items-center justify-center rounded-sm text-xs font-normal tabular-nums tracking-tight",{variants:{variant:{default:"bg-alpha-white-400 text-white",secondary:"bg-alpha-400 text-gray-900",ghost:"bg-transparent text-gray-900"},size:{default:"h-4 px-1",sm:"h-4 px-1 text-[0.6875rem]"}},defaultVariants:{variant:"default",size:"default"}}),i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("kbd",{className:(0,n.cn)("flex items-center gap-1",a),ref:t,...r})});i.displayName="KbdGroup";let o=r.forwardRef((e,t)=>{let{className:a,variant:r,size:i,children:o,...c}=e,d="string"==typeof o&&1===o.length;return(0,s.jsx)("kbd",{className:(0,n.cn)(l({variant:r,size:i,className:a}),d&&"w-4 px-0"),ref:t,...c,children:o})});o.displayName="Kbd"},97760:(e,t,a)=>{"use strict";a.d(t,{s:()=>r});var s=a(30009);let r=(0,s.createServerReference)("40911230ce4f9e51eee35ec3fef4305670597b172f",s.callServer,void 0,s.findSourceMapURL,"favoriteProject")},97947:(e,t,a)=>{"use strict";a.d(t,{Ft:()=>o,HY:()=>i,Ou:()=>d,Sv:()=>l,cz:()=>c});var s=a(7336),r=a(80644),n=a(4495);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex items-center justify-center",a),ref:t,...r})});l.displayName="Empty";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col items-center gap-4 text-center",a),ref:t,...r})});i.displayName="EmptyContent";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("shadow-base bg-background flex size-8 items-center justify-center rounded-sm text-gray-500 [&>svg]:size-4 [&>svg]:!text-gray-500",a),ref:t,...r})});o.displayName="EmptyIcon";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("text-base font-medium",a),ref:t,...r})});c.displayName="EmptyTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("-mt-2 text-sm text-gray-500",a),ref:t,...r})});d.displayName="EmptyDescription"},98335:(e,t,a)=>{"use strict";a.r(t),a.d(t,{PublishedPageProvider:()=>l,usePublishedPage:()=>i});var s=a(7336),r=a(80644);let n=(0,r.createContext)(!1);function l(e){let{children:t}=e;return(0,s.jsx)(n.Provider,{value:!0,children:t})}function i(){return{isPublished:(0,r.use)(n)||!1}}},99256:(e,t,a)=>{"use strict";a.d(t,{E:()=>$,Q:()=>W});var s=a(7336),r=a(19895),n=a(80644),l=a(4495),i=a(2115),o=a(11572),c=a(95110),d=a(51665),u=a(57942),m=a(53616),h=a(61607),p=a(403),x=a(15961),g=a(84274),f=a(81049),v=a(67952),j=a(55556),b=a(97210),y=a(20172),w=a(22748),N=a(8871),k=a(18730),C=a(95057),S=a(43554),I=a(93004),M=a(59103),z=a(61202),L=a(81616),P=a(15993),R=a(30009);let D=(0,R.createServerReference)("7e37a7d8d855ca3f30187ea37b7df30b55b3a481b6",R.callServer,void 0,R.findSourceMapURL,"restoreBlock");var E=a(88551),A=a(4304),T=a(10299),F=a(5778),O=a(51621),U=a(79822),V=a(26939),_=a(57748),B=a(24806),H=a(55074);function $(e){let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("bg-gray-150 flex h-5 items-center gap-1 rounded-md px-1 text-[12px] text-gray-600",a),children:t})}function q(e){let{closed:t,isStreaming:a,finishReason:r,language:n,isBlob:l}=e;return l?(0,s.jsx)(h.b,{className:"size-4 text-gray-500"}):t&&!a&&"stop"===r?(0,s.jsx)(o.o,{lang:n||"plaintext",fill:"fill-gray-500"}):t&&!a&&"length"===r?(0,s.jsx)(C.Tooltip,{content:"v0 cannot output enough tokens to complete the block",children:(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(g.N,{})})}):t||!a||r?(0,s.jsx)(o.o,{lang:n||"plaintext",fill:"fill-gray-500"}):(0,s.jsx)(b.y,{size:16})}function W(e){let{type:t,blockId:a,messageId:o,isStreaming:h,...g}=e,C=(0,r.I4)(),R=(0,r.eu)(),W=(0,z.PQ)(),G=(0,r.oQ)(),{currentBlockIndex:K,history:Y,projectBlocks:Q,latestSource:J}=(0,c.P6)({blockId:a,searchAll:!0}),{getBlockShared:X}=(0,f.L)(),{getBlockDeployed:ee}=(0,w.G)(),et=(0,v.k)("blockPreview"),ea=(0,y.RQ)(a),es=(0,N.g)({blockId:a}),{getBlockForked:er}=(0,I.t)(),{getBlockTemplateId:en}=function(){let{chatId:e}=(0,k.xz)(),{data:t,mutate:a}=(0,M.Ay)(["block:template-ids",e]);return{getBlockTemplateId:(0,n.useCallback)(e=>{var a;return null!==(a=null==t?void 0:t.get(e))&&void 0!==a?a:void 0},[t]),setBlockTemplateId:(0,n.useCallback)((e,s)=>{a(new Map(null==t?void 0:t.set(e,s)))},[t,a])}}(),[el,ei]=(0,n.useTransition)(),eo=(0,T.useRouter)(),{scrollToBottom:ec}=(0,F.r)(),{pulsePreview:ed}=(0,c.DK)({blockId:a}),eu=J||g.source,{messages:em,activeForkKey:eh}=(0,k.Pk)(),ep=(0,k.jo)(),ex=(0,n.useMemo)(()=>em.find(e=>e.id===o&&"assistant"===e.role),[em,o]),eg=null==ex?void 0:ex.finishReason,{chatId:ef}=(0,k.xz)(),ev=C&&(null==R?void 0:R.id)===a,[ej,eb]=(0,n.useState)(!1),[ey,ew]=(0,n.useState)(ev||!g.closed);(0,n.useEffect)(()=>eb(!0),[]);let eN="Untitled",ek=t;g.meta.project&&(eN=g.meta.project),g.meta.file&&(ek=g.meta.file||t),"local"===t&&(eN=g.meta.title),/[_-]/.test(eN)&&(eN=eN.split(/[_-]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "));let eC=Q.find(e=>e.id===a),eS=null==eC?void 0:eC.latestDeploymentInfo,eI=(0,n.useRef)(null),{saveLastOpenedBlock:eM}=(0,S.e)(),{user:ez}=(0,V.J)(),{authorId:eL}=(0,_.tZ)(),eP=(0,n.useCallback)(()=>{var e;(0,i.u)("ClickBlockPreview",{blockId:a});let{templateVersionId:s,templateCanonId:r}=null!==(e=en(a))&&void 0!==e?e:{},n={id:a,meta:g.meta,remoteInfo:g.remoteInfo,messageId:o,type:t,language:g.language,source:eu,resultId:g.resultId,closed:!!g.closed,hasSourceBeenEdited:!!(null==R?void 0:R.hasSourceBeenEdited),latestDeploymentInfo:eS,templateVersionId:s,templateCanonId:r,forkedFromBlockId:er(a)};if(ef&&W){let{setActiveBlock:e}=(0,H.Cs)(ef);e(n);return}G(!0,n),eM(a),eI.current&&(ea("code"),es(eI.current),eI.current=null,setTimeout(()=>{let e=document.querySelector('[data-active-tab="true"]');e&&e.scrollIntoView({block:"start"})},0))},[a,en,g.meta,g.remoteInfo,g.language,g.resultId,g.closed,o,t,eu,null==R?void 0:R.hasSourceBeenEdited,eS,er,ef,W,G,eM,ea,es]),eR=(0,n.useMemo)(()=>X(a)||ee(a),[a,X,ee]),eD=!g.closed&&!h&&("other"===eg||!eg),eE="local"===t?(0,s.jsx)(x.H,{className:"size-4 text-gray-500 [&_path]:fill-current"}):(0,s.jsx)(q,{closed:g.closed,isStreaming:h,finishReason:eg,language:g.language,isBlob:!!g.meta.url}),eA=(0,n.useCallback)(()=>{if(ev&&!eI.current)return;eP();let e=new URL(window.location.href),t=new URLSearchParams(e.search);t.delete("b"),e.search=t.toString(),window.history.replaceState({},"",e.toString())},[ev,eP]),eT=(0,n.useMemo)(()=>"local"===t||"code-project"===t?(0,j.A2)({source:eu,blockType:t,blockId:a}).filter(e=>!e.isMerged&&!(e.isDeleted&&e.isMoved)):[],[eu,t,a]),eF=o===(null==eh?void 0:eh[eh.length-1]),eO=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=null==eh?void 0:eh.findIndex(e=>e===Y[K].messageId);if(void 0===t||t<0||!eh||!ef){P.oR.error("Could not find the message in the chat");return}let a=Y[K].meta.project,s=Y[K].messageId;if(!a||!s){P.oR.error("Something went wrong.");return}ei(async()=>{let{error:e,newAssistantMessageId:t}=await D(a,s,ef,K,Y.length,eh);e||!t?(0,E.z)(e)||P.oR.error("Something went wrong. Please try again."):(P.oR.success("Restored successfully"),ep(()=>({isLoading:!0,isRestoring:!0})),eo.push("#".concat(t)),ec())})},[eh,ef,K,Y,eo,ec,ep]),eU=eL&&(null==ez?void 0:ez.id)===eL,eV=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),ew(e=>!e)},[]);if("code-project"===t){let e=W?null:(0,s.jsxs)("div",{className:(0,l.cn)("@container/block-preview-header flex h-9 w-full items-center justify-between gap-3 p-2",ey&&"border-alpha-200 border-b"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-900",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap text-[13px] font-medium text-gray-800",children:[(0,s.jsx)(L.$,{onClick:eV,variant:"ghost",className:"size-5 rounded-sm",size:"mini",children:ey?(0,s.jsx)(u.X,{}):(0,s.jsx)(m.b,{})}),"Version ",K+1]}),eR?(0,s.jsxs)($,{className:"@[19rem]/block-preview-header:flex hidden",children:[(0,s.jsx)(p.q,{size:12})," ",et("deployed")]}):null,eD?(0,s.jsx)($,{className:"@[19rem]/block-preview-header:flex hidden",children:"STOPPED"}):null]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[eF||!eU?null:(0,s.jsx)(A.Q,{variant:"ghost",className:"h-5 rounded-sm px-1.5 text-xs text-gray-600 hover:text-gray-900 [&_svg]:size-4",size:"sm",pending:el,innerClassName:"gap-1.5",onClick:eO,children:"Restore"}),eF?(0,s.jsx)(L.$,{variant:"ghost",className:"pointer-events-none h-5 rounded-sm px-1.5 text-xs text-gray-600",size:"sm",children:"Latest"}):null,(0,s.jsx)(L.$,{variant:"secondary",disabled:ev,className:"h-5 rounded-sm px-1.5 text-xs",size:"sm",children:ev?"Viewing":"View"})]})]}),t=ey&&eT.length>0?(0,s.jsx)(O.P.div,{initial:!!ej&&{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"spring",stiffness:300,damping:30},className:"bg-muted overflow-hidden",children:(0,s.jsx)("div",{className:(0,l.cn)("flex w-full flex-col overflow-hidden rounded-md py-1.5 pl-2 pr-2.5 text-left text-gray-500"),children:eT.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsxs)("div",{className:"flex h-5 w-full min-w-0 items-center gap-2 text-[13px]",children:[(0,s.jsx)("div",{className:"flex size-5 shrink-0 items-center justify-center",children:g.closed||t!==eT.length-1?(0,s.jsx)(d.a,{className:"size-3 text-gray-400"}):(0,s.jsx)(b.y,{size:14})}),(0,s.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-2",children:[(0,s.jsx)("button",{onClick:t=>{if(e.isDeleted)return t.stopPropagation();eI.current=e.meta.file},className:(0,l.cn)("flex-1 cursor-pointer truncate text-left",e.isDeleted?"hover:cursor-auto":"hover:underline"),children:g.closed||t!==eT.length-1?e.meta.file:(0,s.jsx)(B.W,{className:"text-[13px]",children:e.meta.file})}),(0,s.jsx)(Z,{file:e,active:!!(!g.closed&&t===eT.length-1)})]})]},t),t!==eT.length-1&&(0,s.jsx)("div",{className:"flex h-3 w-5 items-center justify-center",children:(0,s.jsx)("div",{className:"h-full w-[1px] bg-gray-300"})})]},"block-edit-"+t))})}):null;return(0,s.jsxs)("div",{"data-testid":"block-preview",className:(0,l.cn)("not-prose group/block-preview bg-background flex w-full max-w-full cursor-pointer select-none flex-col justify-between overflow-hidden rounded-md border shadow-[0px_2px_3px_-1px_hsla(0,0%,0%,0.04)] transition-all ease-in-out md:w-[400px]",ev?"ring-alpha-400 border-gray-500 ring-2":"hover:ring-alpha-400 border-alpha-400 hover:border-alpha-600",ev&&ed?"animate-pulse-border":""),onClick:eA,children:[e,(0,s.jsx)(U.N,{children:t})]})}return(0,s.jsxs)("div",{"data-testid":"block-preview",className:(0,l.cn)("not-prose bg-background flex w-full max-w-full cursor-pointer select-none items-start justify-between gap-2 rounded-[10px] border p-1.5 transition-all duration-200 ease-in-out hover:brightness-[97%] md:w-[400px]",ev?"ring-alpha-400 border-gray-500 ring-2":"border-gray-200"),onClick:eA,children:[(0,s.jsx)("div",{className:"flex size-10 shrink-0 items-center justify-center overflow-hidden rounded-sm bg-gray-100 px-3 text-gray-500 transition-all duration-200 ease-in-out",children:eE}),(0,s.jsx)("div",{className:"flex w-full min-w-0 flex-row items-center justify-between",children:(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start leading-5",children:[(0,s.jsxs)("div",{className:"@container/block-preview-header my-0 flex w-full min-w-0 max-w-full items-center justify-between gap-2 text-sm font-medium text-gray-900",children:[(0,s.jsx)("div",{className:"min-w-0 shrink truncate",children:eN}),(0,s.jsxs)("div",{className:"flex shrink-0 gap-1",children:[eF||!eU?null:(0,s.jsx)(A.Q,{variant:"ghost",className:"h-5 rounded-sm px-1.5 text-xs text-gray-600 hover:text-gray-900 [&_svg]:size-4",size:"sm",pending:el,innerClassName:"gap-1.5",onClick:eO,children:"Restore"}),eR?(0,s.jsxs)($,{className:"@[17rem]/block-preview-header:flex hidden",children:[(0,s.jsx)(p.q,{size:12})," ",et("deployed")]}):null,eD?(0,s.jsx)($,{className:"@[17rem]/block-preview-header:flex hidden",children:"STOPPED"}):null,(0,s.jsxs)($,{className:"font-mono",children:["v",K+1]}),"local"===t?(0,s.jsx)($,{className:"bg-lime-100 dark:bg-lime-900",children:"LOCAL"}):null]})]}),"local"!==t?(0,s.jsxs)("p",{className:"my-0 max-w-full truncate text-sm text-gray-500 ",children:[ek,(null==R?void 0:R.hasSourceBeenEdited)?(0,s.jsx)("span",{children:" (edited)"}):null]}):(0,s.jsx)("ul",{className:"my-0 w-full max-w-full truncate text-left text-gray-500",children:eT.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center gap-1.5 truncate",children:[e.meta.file,t!==eT.length-1||g.closed?null:(0,s.jsx)("span",{children:(0,s.jsx)(b.y,{size:14})})]},t))})]})})]})}function Z(e){let{file:t,active:a}=e,r=t.blobUrl?"Added":t.isDeleted?"Deleted":t.isLocked?"Locked":t.isMoved&&t.isMovedFrom?"Moved":t.isEdit||t.isAttachmentQuickEdit?t.isFixed?a?"Fixing":"Fixed":a?"Editing":"Edited":t.meta.isUserEdit?"Created":a?t.isFixed?"Fixing":"Generating":"Generated";return(0,s.jsx)("div",{className:"font-mono text-xs text-gray-500",children:r})}},99625:(e,t,a)=>{"use strict";a.d(t,{w:()=>n});var s=a(80644),r=a(3879);function n(e){return{formRef:(0,s.useRef)(null),onKeyDown:(0,s.useCallback)(t=>{let a=t.currentTarget.value.trim(),s=""===a&&(null==e?void 0:e.localFileInfos)&&e.localFileInfos.length>0;if("Enter"===t.key&&!t.shiftKey&&!t.nativeEvent.isComposing){if(r.nr&&r.xl&&229===t.keyCode)return;t.preventDefault(),s?e.submitMessage():a.length>0&&(null==e||e.submitMessage())}},[e])}}},99876:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Sidebar:()=>I,SidebarContent:()=>R,SidebarEmptyState:()=>W,SidebarFooter:()=>D,SidebarHeader:()=>P,SidebarLabel:()=>A,SidebarList:()=>F,SidebarListItem:()=>O,SidebarListItemAction:()=>B,SidebarListItemButton:()=>_,SidebarListItemLink:()=>V,SidebarListMoreButton:()=>H,SidebarListSkeleton:()=>$,SidebarLogo:()=>q,SidebarMobile:()=>S,SidebarPopover:()=>M,SidebarSection:()=>E,SidebarSeparator:()=>T,SidebarTrigger:()=>z});var s=a(7336),r=a(80644),n=a(4495),l=a(29381),i=a(81616),o=a(45028),c=a(99887),d=a(10299),u=a(88293),m=a(36602),h=a(96668),p=a(54851),x=a(25071),g=a(86358),f=a(26939),v=a(58365),j=a(53349),b=a(9097);let y=e=>{let{openDelay:t=100,closeDelay:a=150,...r}=e;return(0,s.jsx)(j.bL,{openDelay:t,closeDelay:a,...r})};y.displayName=j.bL.displayName;let w=j.l9,N=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:n=4,...l}=e;return(0,s.jsx)(j.UC,{ref:t,align:r,sideOffset:n,style:{transformOrigin:"var(--radix-hover-card-content-transform-origin)"},className:(0,b.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 bg-background z-50 w-[21rem] overflow-hidden rounded-xl shadow-md outline-none","data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1","data-[side=bottom]:slide-out-to-top-1 data-[side=left]:slide-out-to-left-1 data-[side=right]:slide-out-to-right-1 data-[side=top]:slide-out-to-bottom-1",a),...l})});N.displayName=j.UC.displayName;var k=a(39695),C=a(76073);let S=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e,{sheetOpen:c,setSheetOpen:d,actionChatId:u}=(0,l.e)();return(0,s.jsx)("aside",{ref:t,...o,children:(0,s.jsx)(v.cj,{onOpenChange:e=>{if(!u)return d(e)},open:c,ref:t,...o,children:(0,s.jsxs)(v.h,{side:"left",onEscapeKeyDown:()=>{var e;return null===(e=document.getElementById("sidebar-trigger"))||void 0===e?void 0:e.focus()},showClose:!1,className:(0,n.cn)("bg-muted mt-0 flex max-h-svh w-full flex-col items-stretch gap-0 rounded-none p-0 sm:hidden",a),children:[(0,s.jsx)(v.Fm,{className:"sr-only",children:(0,s.jsx)(v.qp,{className:"sr-only",children:"Menu"})}),(0,s.jsx)(P,{className:"h-[3.25rem] flex-row items-center justify-start border-b border-gray-200 px-3 sm:hidden",children:(0,s.jsx)(v.kN,{asChild:!0,children:(0,s.jsxs)(i.$,{className:"size-7 rounded-md",size:"sm",variant:"ghost",children:[(0,s.jsx)(g.F,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close Menu"})]})})}),r]})})})});S.displayName="SidebarMobile";let I=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e,{hidden:o}=(0,l.e)();if(o)return null;let c=(0,s.jsx)("aside",{className:(0,n.cn)("bg-muted peer sticky top-0 hidden max-h-svh flex-col items-stretch border-r border-gray-200 sm:flex",a),"data-fixed-sidebar":!0,style:{width:240},"data-state":"expanded",ref:t,...i,children:r});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{children:r}),c,(0,s.jsx)(h.NonPaymentBanner,{className:"mt-16 flex border-t sm:hidden"})]})});I.displayName="Sidebar";let M=r.forwardRef((e,t)=>{let{children:a,isv3:l=!1,className:i,...o}=e,[d,u]=r.useState(!1),[m,h]=r.useState(!1),{user:p}=(0,C.k6)();return(0,s.jsxs)(y,{openDelay:200,closeDelay:150,open:d&&!m,onOpenChange:u,children:[(0,s.jsx)("div",{onMouseEnter:()=>h(!1),children:(0,s.jsx)(w,{asChild:!0,children:(0,s.jsx)(c.NewChatButton,{v3:l,className:(0,n.cn)((null==p?void 0:p.isAdminMode)&&"bg-blue-200 ring-2 ring-blue-700 hover:bg-blue-600/50 hover:ring-blue-900 focus:bg-blue-600/50 focus:ring-blue-900",i),onMouseDownCapture:()=>{u(!1),h(!0)},ref:t,variant:"v3-logo",...o})})}),(0,s.jsx)(N,{tabIndex:1,className:"max-w-[250px]",side:"bottom",align:"start",children:a})]})});M.displayName="SidebarPopover";let z=r.forwardRef((e,t)=>{let{className:a,isv3:r=!1,...o}=e,{setSheetOpen:c,hidden:d}=(0,l.e)(),u=(0,k.t)(),{expectUser:m}=(0,f.J)();return m&&(u||r)?(0,s.jsxs)(i.$,{className:(0,n.cn)("size-7 rounded-md",d?null:"sm:hidden",a),size:"sm",variant:"ghost",ref:t,id:"sidebar-trigger",onClick:()=>c(!0),...o,children:[(0,s.jsx)(x.P,{className:"size-4 shrink-0"}),(0,s.jsx)("span",{className:"sr-only",children:"Show Menu"})]}):null});z.displayName="SidebarTrigger";let L="flex flex-col items-stretch p-2",P=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(L,"gap-3",a),ref:t,...r})});P.displayName="SidebarHeader";let R=e=>{let{className:t,...a}=e,{showTopBorder:r,containerRef:l,showBottomBorder:i,topRef:o,bottomRef:c}=(0,p.Y)();return(0,s.jsx)("div",{className:(0,n.cn)(L,"flex-1 overflow-y-auto border-y border-transparent transition-[border-color]",{"border-t-gray-200":r,"border-b-gray-200":i},t),ref:l,...a,children:(0,s.jsxs)("div",{className:"relative flex h-fit w-full flex-col gap-4",children:[(0,s.jsx)("div",{ref:o,className:"absolute inset-x-0 top-0 h-px w-full"}),a.children,(0,s.jsx)("div",{ref:c,className:"absolute inset-x-0 bottom-0 h-px w-full"})]})})},D=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(L,"gap-3 py-3",a),ref:t,...r})});D.displayName="SidebarFooter";let E=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex w-full min-w-0 flex-col items-stretch gap-0.5",a),ref:t,...r})});E.displayName="SidebarSection";let A=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h2",{className:(0,n.cn)("h-[1.875rem] content-center px-2 text-[0.8125rem] font-medium text-gray-500",a),ref:t,...r})});A.displayName="SidebarLabel";let T=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(u.Separator,{className:(0,n.cn)("mx-2 w-auto border-b border-dashed bg-transparent",a),ref:t,...r})});T.displayName="SidebarSeparator";let F=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("ul",{className:(0,n.cn)("flex w-full min-w-0 flex-col gap-0.5",a),ref:t,...r})});F.displayName="SidebarList";let O=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("li",{className:(0,n.cn)("hover:bg-alpha-200 has-[[data-current=true]]:bg-alpha-200 has-[[data-state=open]]:bg-alpha-200 focus-within:bg-alpha-200 active:bg-alpha-200 group relative flex h-8 list-none items-center rounded-md text-gray-600",a),ref:t,...r})});O.displayName="SidebarListItem";let U="focus-visible:ring-offset-background rounded-md group-has-[.item-action]:pr-8 flex [&_svg]:shrink-0 [&_div]:truncate [&_span]:truncate min-w-0 items-center justify-center gap-2 whitespace-nowrap flex size-full min-w-0 items-center justify-start gap-2 px-2 text-sm font-normal outline-none text-gray-600 focus-within:text-gray-900 hover:text-gray-900 focus:text-gray-900 group-hover:text-gray-900 data-[current=true]:text-gray-900 ring-blue-600 focus-visible:ring-2 focus-visible:ring-offset-1",V=r.forwardRef((e,t)=>{var a;let{className:r,asChild:i=!1,href:c,children:u,unavailable:h,noActive:p,...x}=e,{setSheetOpen:g}=(0,l.e)(),f=(0,n.u6)((0,d.usePathname)()),v=i?o.DX:h?"a":m.PrefetchLinkAndRefreshOnHover;return(0,s.jsx)(v,{className:(0,n.cn)(U,h&&"pointer-events-none",r),"data-current":(f===c||(null===(a=x.altmatches)||void 0===a?void 0:a.includes(f)))&&!p,href:c,onClick:()=>g(!1),ref:t,...x,children:u})});V.displayName="SidebarListItemLink";let _=r.forwardRef((e,t)=>{let{className:a,children:r,onClick:i,...o}=e,{setSheetOpen:c}=(0,l.e)();return(0,s.jsx)("button",{className:(0,n.cn)(U,a),onClick:e=>(null==i||i(e),c(!1)),ref:t,...o,children:r})});_.displayName="SidebarListItemButton";let B=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.DX,{className:(0,n.cn)("touch:opacity-100 item-action hover:bg-alpha-200 data-[state=open]:bg-alpha-200 focus-visible:bg-alpha-200 active:bg-alpha-200 absolute right-2 size-5 rounded-sm bg-transparent text-gray-600 opacity-0 transition-all hover:text-gray-900 focus:text-gray-900 focus-visible:opacity-100 group-focus-within:opacity-100 group-hover:opacity-100 group-has-[[data-current=true]]:opacity-100 data-[state=open]:opacity-100",a),ref:t,...r})});B.displayName="SidebarListItemAction";let H=r.forwardRef((e,t)=>{let{className:a,...r}=e,{setSheetOpen:o}=(0,l.e)();return(0,s.jsx)(i.$,{asChild:!0,className:(0,n.cn)("touch:active:text-gray-900 touch:active:bg-alpha-200 flex !h-8 w-full justify-start !px-2.5 text-[0.8125rem] font-normal text-gray-500 hover:text-gray-900 focus:text-gray-900 focus-visible:text-gray-900",a),onClick:()=>o(!1),ref:t,size:"sm",variant:"link",...r})});H.displayName="SidebarListMoreButton";let $=r.forwardRef((e,t)=>{let{length:a,className:r,...l}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex w-full min-w-0 flex-col gap-0.5",r),ref:t,...l,children:Array.from({length:a}).map((e,t)=>(0,s.jsx)("div",{className:"flex h-8 w-full items-center justify-start px-2",children:(0,s.jsx)("div",{className:"bg-alpha-300 h-5 w-[--width] animate-pulse rounded-md",style:{"--width":["80%","100%","90%","70%","100%","80%","40%"][t%7]}})},t))})});$.displayName="SidebarListSkeleton";let q=r.forwardRef((e,t)=>{let{className:a,...r}=e,{setSheetOpen:i}=(0,l.e)();return(0,s.jsx)(c.NewChatButton,{className:(0,n.cn)("size-8",a),onButtonClick:()=>i(!1),ref:t,variant:"logo",...r})});q.displayName="SidebarLogo";let W=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("mx-2 h-16 content-center rounded-lg border border-dashed px-8 text-center text-xs text-gray-500",a),ref:t,...r})});W.displayName="SidebarEmptyState"},99887:(e,t,a)=>{"use strict";a.d(t,{NewChatButton:()=>p});var s=a(7336),r=a(2115),n=a(64495),l=a(93925),i=a(64826),o=a(81616),c=a(36602),d=a(80644),u=a(4495),m=a(67952),h=a(99876);let p=(0,d.forwardRef)(function(e,t){let{variant:a="text",className:p,buttonVariant:x,onButtonClick:g,v3:f=!1,...v}=e,j=(0,m.k)("newChatButton"),{stopLlmResponse:b}=(0,n.yI)(),y=(0,d.useCallback)(()=>{b(),(0,r.u)("ClickNewChat"),null==g||g()},[b,g]);return"logo"===a?(0,s.jsx)(o.$,{asChild:!0,className:(0,u.cn)("size-8 border-none hover:bg-transparent focus:bg-transparent focus-visible:bg-transparent has-[>svg]:p-0 [&>svg]:size-8",p),variant:"ghost",ref:t,...v,children:(0,s.jsxs)(c.PrefetchLinkAndRefreshOnHover,{"data-testid":"header-logo",href:f?"/chat/v3":"/",onClick:y,children:[(0,s.jsx)(l.g,{"aria-hidden":!0,className:"size-10"}),(0,s.jsx)("span",{className:"sr-only",children:j("newChat")})]})}):"v3-logo"===a?(0,s.jsx)(o.$,{asChild:!0,className:(0,u.cn)("size-8 w-auto rounded-md py-1.5 has-[>svg]:px-1 [&>svg]:size-7",p),size:"sm",variant:"ghost",ref:t,...v,children:(0,s.jsxs)(c.PrefetchLinkAndRefreshOnHover,{"data-testid":"header-logo",href:f?"/chat/v3":"/",onClick:y,children:[(0,s.jsx)(l.g,{"aria-hidden":!0,className:"size-10 translate-x-[-0.5px]"}),(0,s.jsx)("span",{className:"sr-only",children:j("newChat")})]})}):"icon"===a?(0,s.jsx)(o.$,{asChild:!0,className:(0,u.cn)("hover:bg-gray-150 size-8 shadow-[0px_1px_2px_0px_hsla(0,0%,0%,0.04)] has-[>svg]:px-0",p),tooltip:{side:"right",content:j("newChat"),sideOffset:8},variant:"secondary",ref:t,...v,children:(0,s.jsxs)(c.PrefetchLinkAndRefreshOnHover,{href:f?"/chat/v3":"/chat",onClick:y,children:[(0,s.jsx)("span",{"aria-hidden":!0,children:(0,s.jsx)(i.F,{})}),(0,s.jsx)("span",{className:"sr-only",children:j("newChat")})]})}):"ghost"===a?(0,s.jsx)(o.$,{asChild:!0,className:(0,u.cn)("size-7 rounded-md",p),tooltip:"New Chat",variant:"ghost",size:"sm",ref:t,...v,children:(0,s.jsx)(c.PrefetchLinkAndRefreshOnHover,{href:f?"/chat/v3":"/chat",onClick:y,children:(0,s.jsx)(i.F,{})})}):"sidebar"===a?(0,s.jsx)(o.$,{asChild:!0,variant:"secondary",className:(0,u.cn)("border-none shadow-sm",p),size:"sm",ref:t,...v,children:(0,s.jsx)(c.PrefetchLinkAndRefreshOnHover,{className:"flex flex-row items-center gap-2.5",href:f?"/chat/v3":"/chat",onClick:y,children:"New Chat"})}):"sidebar-item"===a?(0,s.jsx)(h.SidebarListItem,{children:(0,s.jsxs)(h.SidebarListItemLink,{href:f?"/chat/v3":"/chat",onClick:y,children:[(0,s.jsx)(i.F,{}),(0,s.jsx)("span",{children:"New Chat"})]})}):"collapsible"===a?(0,s.jsx)(o.$,{asChild:!0,className:(0,u.cn)("collapsed:w-8 hover:bg-gray-150 focus:bg-gray-150 focus-visible:bg-gray-150 bg-background transition-sidebar relative h-8 w-full overflow-hidden border-none px-2 text-gray-900 shadow-sm",p),size:"sm",ref:t,...v,children:(0,s.jsx)(c.PrefetchLinkAndRefreshOnHover,{href:f?"/chat/v3":"/chat",onClick:y,children:(0,s.jsxs)("div",{className:"collapsed:left-0 collapsed:translate-x-2 transition-sidebar absolute inset-2 left-[calc((var(--sidebar-width)-128px)/2)] flex w-fit items-center justify-center gap-2 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"collapsed:opacity-100 transition-sidebar opacity-0 ease-in-out",children:(0,s.jsx)(i.F,{})}),(0,s.jsx)("span",{children:j("newChat")})]})})}):(0,s.jsx)(o.$,{asChild:!0,className:p,size:"sm",variant:x,ref:t,...v,children:(0,s.jsx)(c.PrefetchLinkAndRefreshOnHover,{href:f?"/chat/v3":"/chat",onClick:y,children:j("newChat")})})});p.displayName="NewChatButton"},99942:(e,t,a)=>{"use strict";a.d(t,{wJ:()=>eF,BW:()=>eD,q6:()=>eE,Q1:()=>e_});var s=a(7336),r=a(99625),n=a(80644),l=a(4495),i=a(64615),o=a(79822),c=a(51621),d=a(18730),u=a(2115),m=a(64495),h=a(1471),p=a(61607),x=a(94828),g=a(3816),f=a(43190),v=a(53101),j=a(87354),b=a(19461),y=a(53155),w=a(81616),N=a(86358),k=a(77936),C=a(17145),S=a(37328),I=a(96378),M=a(97210),z=a(50688),L=a(59103),P=a(64854),R=a(57748),D=a(20685),E=a(3086),A=a(5099),T=a(67952),F=a(99982),O=a(76403),U=a(50809),V=a(16081),_=a(9097),B=a(77011),H=a(45419),$=a(26939),q=a(44900),W=a(61774),Z=a(14416),G=a(15993),K=a(1191),Y=a(23063),Q=a(35740),J=a(76073),X=a(10299);let ee=e=>{let{isSignedIn:t,userOnFree:a,uploadFiles:s,isFigmaUrl:r,handleFigmaImport:l,showSignInDialog:i}=e,{setImportFigmaModalOpen:o}=(0,K.C)();return(0,n.useCallback)(async e=>{let n=e.clipboardData.getData("text");if(!n)return;if(r(n)){if(!t){i();return}if(a)return}if(r(n)){(0,u.u)("FigmaUrlPaste",{url:n,valid:!0}),e.preventDefault(),o(null),await new Promise(e=>setTimeout(e,0)),l(n);return}let c=n.split("\n").length,d=n.length;if(c>200||d>2e4){e.preventDefault();let a=function(e){let t=(e,t)=>e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").toLowerCase()+t;if(!e)return null;let a=e.includes("<")&&e.includes(">"),s="typescript";for(let r of((e.includes("def ")||e.includes("class ")&&e.includes(":\n"))&&(s="python"),({typescript:[{regex:/export\s+default\s+function\s+(\w+)/,extension:".tsx"},{regex:/export\s+default\s+(\w+)/,extension:".tsx"},{regex:/export\s+function\s+(\w+)/,extension:".tsx"},{regex:/export\s+const\s+(\w+)\s*=/,extension:".tsx"},{regex:/export\s+class\s+(\w+)/,extension:".tsx"},{regex:/class\s+(\w+)/,extension:a?".tsx":".ts"},{regex:/function\s+(\w+)/,extension:a?".tsx":".ts"},{regex:/const\s+(\w+)\s*=/,extension:a?".tsx":".ts"}],python:[{regex:/class\s+(\w+)\s*[:(]/,extension:".py"},{regex:/def\s+(\w+)\s*\(/,extension:".py"}]})[s])){let a=e.match(r.regex);if(a&&a[1])return t(a[1],r.extension)}let r=e.match(/^\s*(?:const|let|var|function|class)\s+(\w+)/m);return r?t(r[1],"python"===s?".py":a?".tsx":".ts"):e.includes("<html")?"index.html":null}(n),r=a&&t?prompt('The pasted text will be saved as a file named "'.concat(a,'". Please enter a new file name or press OK to continue.'),a):"snippet.txt";if(r&&!r.includes(".")&&(r+=".txt"),null===r)return;s([new File([new Blob([n],{type:"text/plain"})],r,{type:"text/plain"})])}},[l,r,t,o,s,a])};var et=a(67437),ea=a(31342),es=a(30313),er=a.n(es),en=a(97015),el=a(82399),ei=a(22931);function eo(e){let{disabled:t,isSignedIn:a,reachedRateLimit:r,planSlug:n,currentPrompt:l,setPrompt:i,setLoading:o,hasEnhancedCurrentPrompt:c,handleRevert:d,recentUserMessages:m}=e,{setShowSignInDialog:h}=(0,y.AO)(),{setUpgradePromptOpen:p}=(0,B.g)(),{complete:x,isLoading:g}=(0,en.sQ)({api:"/chat/api/prompt-enhancement",onResponse:()=>{o(!0)},onError:e=>{try{let t=JSON.parse(e.message);if("error"in t&&t.error===el.oO){G.oR.error("Invalid prompt");return}G.oR.error(e.message||"Something went wrong")}catch(e){G.oR.error("Something went wrong")}o(!1)},streamProtocol:"text",body:{prev:m},onFinish:(e,t)=>{o(!1);let a=JSON.parse(t);i(a.prompt),(0,u.u)("EnhancePromptSuccess",{originalPromptLength:e.length,enhancedPromptLength:a.prompt.length})}}),f=l.length>ei.EA,v=l.length<ei.A1,j=t||g||!l||f||v;return c?(0,s.jsxs)(w.$,{className:"group h-7 w-7 md:w-auto",size:"sm",variant:"ghost",type:"button",onClick:d,children:[(0,s.jsx)(ed,{}),(0,s.jsx)("span",{className:"sr-only md:not-sr-only",children:"Undo"})]}):(0,s.jsx)(w.$,{className:"group size-7 rounded-md data-[loading=true]:bg-gray-100",disabled:j||g,"data-loading":g,size:"sm",type:"button",tooltip:{className:"pr-1.5",side:"bottom",content:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center gap-1",children:f?(0,s.jsxs)("span",{className:"text-gray-100",children:["Prompt is too long. Max length is ",ei.EA," ","characters."]}):v?(0,s.jsx)("span",{className:"text-gray-100",children:"This prompt is too short to enhance."}):(0,s.jsx)("span",{className:"text-gray-100",children:"Enhance prompt"})})},variant:"ghost",onClick:()=>a?r&&"v0-enterprise"!==n?p(!0):l?void((0,u.u)("EnhancePrompt",{promptLength:l.length}),o(!0),x(l)):void 0:h({prompt:l}),children:(0,s.jsx)(ec,{isLoading:g})})}function ec(e){let{className:t,isLoading:a}=e;return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,s.jsx)("path",{d:"M12.8281 1C12.8281 2.10747 11.7632 3.17235 10.6558 3.17235C11.7632 3.17235 12.8281 4.23724 12.8281 5.34471C12.8281 4.23724 13.893 3.17235 15.0005 3.17235C13.893 3.17235 12.8281 2.10747 12.8281 1Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"12.8281px 3.17235px",animation:"twinkle1 0.6s ease-in-out infinite"}:void 0}),(0,s.jsx)("path",{d:"M13 12C13 12.5098 12.5098 13 12 13C12.5098 13 13 13.4902 13 14C13 13.4902 13.4902 13 14 13C13.4902 13 13 12.5098 13 12Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"13px 13px",animation:"twinkle2 0.7s ease-in-out infinite 0.2s"}:void 0}),(0,s.jsx)("path",{d:"M5.10285 3.89648C5.10285 5.98837 3.0914 7.99982 0.999512 7.99982C3.0914 7.99982 5.10285 10.0113 5.10285 12.1032C5.10285 10.0113 7.1143 7.99982 9.20619 7.99982C7.1143 7.99982 5.10285 5.98837 5.10285 3.89648Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:a?{transformOrigin:"5.10285px 7.99982px",animation:"twinkle3 0.8s ease-in-out infinite 0.4s"}:void 0}),a&&(0,s.jsx)(er(),{id:"73931606915e20c4",children:"@-webkit-keyframes twinkle1{0%,100%{-webkit-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.7)rotate(20deg);transform:scale(.7)rotate(20deg);opacity:.7}}@-moz-keyframes twinkle1{0%,100%{-moz-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-moz-transform:scale(.7)rotate(20deg);transform:scale(.7)rotate(20deg);opacity:.7}}@-o-keyframes twinkle1{0%,100%{-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-o-transform:scale(.7)rotate(20deg);transform:scale(.7)rotate(20deg);opacity:.7}}@keyframes twinkle1{0%,100%{-webkit-transform:scale(1)rotate(0deg);-moz-transform:scale(1)rotate(0deg);-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.7)rotate(20deg);-moz-transform:scale(.7)rotate(20deg);-o-transform:scale(.7)rotate(20deg);transform:scale(.7)rotate(20deg);opacity:.7}}@-webkit-keyframes twinkle2{0%,100%{-webkit-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.6)rotate(-25deg);transform:scale(.6)rotate(-25deg);opacity:.6}}@-moz-keyframes twinkle2{0%,100%{-moz-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-moz-transform:scale(.6)rotate(-25deg);transform:scale(.6)rotate(-25deg);opacity:.6}}@-o-keyframes twinkle2{0%,100%{-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-o-transform:scale(.6)rotate(-25deg);transform:scale(.6)rotate(-25deg);opacity:.6}}@keyframes twinkle2{0%,100%{-webkit-transform:scale(1)rotate(0deg);-moz-transform:scale(1)rotate(0deg);-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.6)rotate(-25deg);-moz-transform:scale(.6)rotate(-25deg);-o-transform:scale(.6)rotate(-25deg);transform:scale(.6)rotate(-25deg);opacity:.6}}@-webkit-keyframes twinkle3{0%,100%{-webkit-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.75)rotate(-18deg);transform:scale(.75)rotate(-18deg);opacity:.8}}@-moz-keyframes twinkle3{0%,100%{-moz-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-moz-transform:scale(.75)rotate(-18deg);transform:scale(.75)rotate(-18deg);opacity:.8}}@-o-keyframes twinkle3{0%,100%{-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-o-transform:scale(.75)rotate(-18deg);transform:scale(.75)rotate(-18deg);opacity:.8}}@keyframes twinkle3{0%,100%{-webkit-transform:scale(1)rotate(0deg);-moz-transform:scale(1)rotate(0deg);-o-transform:scale(1)rotate(0deg);transform:scale(1)rotate(0deg);opacity:1}50%{-webkit-transform:scale(.75)rotate(-18deg);-moz-transform:scale(.75)rotate(-18deg);-o-transform:scale(.75)rotate(-18deg);transform:scale(.75)rotate(-18deg);opacity:.8}}"})]})}function ed(e){let{className:t}=e;return(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.46967 9.09099L5 9.62132L6.06066 8.56066L5.53033 8.03033L3.56063 6.06063H10.125C11.989 6.06063 13.5 7.57167 13.5 9.43563C13.5 11.2996 11.989 12.8106 10.125 12.8106H4.5H3.75V14.3106H4.5H10.125C12.8174 14.3106 15 12.128 15 9.43563C15 6.74324 12.8174 4.56063 10.125 4.56063H3.56069L5.53033 2.59099L6.06066 2.06066L5 1L4.46967 1.53033L1.21967 4.78033C0.926777 5.07322 0.926777 5.5481 1.21967 5.84099L4.46967 9.09099Z",fill:"currentColor"})})}var eu=a(76989),em=a(17777),eh=a(89222),ep=a(73268),ex=a(48400);function eg(e){let{content:t,actionLabel:a,onAction:r,onDismiss:n,showDismiss:i=!0,className:o}=e;return(0,s.jsxs)("div",{className:(0,l.cn)("banner flex items-center justify-between gap-2 py-1.5 pl-3 pr-2 text-xs text-gray-900 md:text-sm",o),children:[(0,s.jsx)("div",{children:t}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(w.$,{className:"h-5 text-xs md:text-sm",onClick:r,size:"sm",variant:"link","data-testid":"banner-action",children:a}),i&&n&&(0,s.jsxs)(w.$,{"aria-label":"Close banner",className:"aspect-square h-5 px-0 text-gray-500 has-[>svg]:px-0",onClick:n,variant:"ghost",children:[(0,s.jsx)(ex.a,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close banner"})]})]})]})}function ef(e){let{almostAtLimit:t,reachedLimit:a,isAnonymous:r}=e,[l]=(0,E.d)(),{dismissBannerLimit:i,dismissBannerGeneral:o,userOnFree:c}=(0,E.f)(),{setUpgradePromptOpen:d}=(0,B.g)(),u=(0,T.k)("rateLimit"),{user:m}=(0,$.J)(),{ml:h}=(0,Y.D)(),p=(0,n.useCallback)(()=>{if(!l)return null;if(r&&a)return u("reachedLimitAnonymous");if(!m)return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"block sm:hidden",children:u("bannerTextMobile")}),(0,s.jsx)("span",{className:"hidden sm:block",children:u("bannerTextDesktop")})]});let e=new Date(l.reset),n=c&&h;return a?u("reachedLimit",{resetTime:n?(0,ep.GP)(e,"MMMM d h:mm a"):(0,ep.GP)(e,"h:mm a"),free:c}):t?u("almostAtLimit",{count:Math.max(l.remaining,0),plural:l.remaining>1,free:c}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"block sm:hidden",children:u("bannerTextMobile")}),(0,s.jsx)("span",{className:"hidden sm:block",children:u("bannerTextDesktop")})]})},[l,r,a,m,c,h,t,u]);return l?(0,s.jsx)(eg,{content:p(),actionLabel:u("upgradeButtonText"),onAction:()=>d(!0),onDismiss:a?void 0:t?i:o,showDismiss:!a}):null}var ev=a(30009);let ej=(0,ev.createServerReference)("6027cac7da4d58fe546dbd42406a0dd6c3b64b79b3",ev.callServer,void 0,ev.findSourceMapURL,"forkMostRecentBlock");var eb=a(19176);function ey(e){let{activeForkKey:t,currentMessages:a}=e,{lcw:r}=(0,Y.D)(),l=(0,T.k)("longContextBanner"),{canWriteToChat:i}=(0,R.tZ)(),{chatId:o}=(0,d.xz)(),c=(0,X.useRouter)();if(a.length<100)return null;let u=(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1",children:[(0,s.jsx)(eb.f,{className:"!text-gray-600"}),(0,s.jsx)("span",{className:"block sm:hidden",children:l("bannerTextMobile")}),(0,s.jsx)("span",{className:"hidden sm:block",children:l("bannerTextDesktop")})]});return r&&i&&o?(0,s.jsx)(eg,{content:u,className:"pl-2 pr-2.5",actionLabel:(0,s.jsx)("span",{className:"text-gray-900",children:l("forkChat")}),onAction:()=>{(0,n.startTransition)(async()=>{let e=await ej(o,t);if(!e){G.oR.error("Failed to fork chat");return}if("string"!=typeof e){G.oR.error(e.error);return}c.push("/chat/".concat(e))})},onDismiss:void 0,showDismiss:!1}):null}function ew(e){let{className:t,...a}=e;return(0,s.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.65625 2.40625C4.65625 1.80219 5.14594 1.3125 5.75 1.3125C6.35406 1.3125 6.84375 1.80219 6.84375 2.40625V4.375C6.84375 5.46231 5.96231 6.34375 4.875 6.34375V7.65625C6.68718 7.65625 8.15625 6.18718 8.15625 4.375V2.40625C8.15625 1.80219 8.64594 1.3125 9.25 1.3125C9.85406 1.3125 10.3438 1.80219 10.3438 2.40625C10.3438 2.60656 10.2905 2.79244 10.1978 2.95265C10.0163 3.26638 10.1236 3.66782 10.4373 3.8493C10.751 4.03079 11.1525 3.92358 11.3339 3.60985C11.4252 3.4521 11.499 3.28302 11.5529 3.10542C12.1159 3.25322 12.5312 3.7656 12.5312 4.375C12.5312 4.66418 12.4382 4.93116 12.2795 5.14826C12.1859 5.12155 12.0905 5.09917 11.9936 5.08136C11.6371 5.01588 11.295 5.25177 11.2295 5.60825C11.1641 5.96472 11.4 6.30678 11.7564 6.37226C12.5706 6.52181 13.1875 7.23624 13.1875 8.09338C13.1875 9.05988 12.404 9.84338 11.4375 9.84338C11.328 9.84338 11.2215 9.83341 11.1186 9.8145C10.7621 9.74903 10.42 9.98492 10.3545 10.3414C10.2891 10.6979 10.525 11.0399 10.8814 11.1054C11.0622 11.1386 11.2481 11.1559 11.4375 11.1559C11.6502 11.1559 11.8578 11.1342 12.0582 11.0929C11.8835 12.0013 11.0844 12.6875 10.125 12.6875C9.03769 12.6875 8.15625 11.8061 8.15625 10.7188V10.5C8.15625 9.41269 9.03769 8.53125 10.125 8.53125V7.21875C8.31282 7.21875 6.84375 8.68782 6.84375 10.5V10.7188C6.84375 11.8061 5.96231 12.6875 4.875 12.6875C3.91563 12.6875 3.11654 12.0013 2.94177 11.0929C3.14222 11.1342 3.34983 11.1559 3.5625 11.1559C3.75186 11.1559 3.93776 11.1386 4.11856 11.1054C4.47503 11.0399 4.71093 10.6979 4.64545 10.3414C4.57997 9.98492 4.23791 9.74903 3.88144 9.8145C3.7785 9.83341 3.67195 9.84338 3.5625 9.84338C2.596 9.84338 1.8125 9.05988 1.8125 8.09338C1.8125 7.23624 2.42938 6.52181 3.24356 6.37226C3.60003 6.30678 3.83593 5.96472 3.77045 5.60825C3.70497 5.25177 3.36291 5.01588 3.00644 5.08136C2.90945 5.09917 2.81406 5.12155 2.7205 5.14826C2.56182 4.93116 2.46875 4.66418 2.46875 4.375C2.46875 3.7656 2.88406 3.25321 3.44708 3.10542C3.50096 3.28302 3.57481 3.4521 3.66606 3.60985C3.84755 3.92358 4.24899 4.03079 4.56272 3.8493C4.87645 3.66782 4.98365 3.26638 4.80217 2.95265C4.7095 2.79244 4.65625 2.60656 4.65625 2.40625ZM13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14C3.06282 14 1.59375 12.5309 1.59375 10.7188C1.59375 10.6279 1.59746 10.5377 1.60476 10.4485C0.929711 9.88675 0.5 9.04025 0.5 8.09338C0.5 7.16693 0.911134 6.33702 1.56087 5.77559C1.30484 5.37039 1.15625 4.88986 1.15625 4.375C1.15625 3.04512 2.14519 1.94622 3.42778 1.77359C3.70556 0.751575 4.64001 0 5.75 0C6.43951 0 7.06129 0.290015 7.5 0.754716C7.93871 0.290015 8.56049 0 9.25 0C10.36 0 11.2944 0.751577 11.5722 1.7736C12.8548 1.94622 13.8438 3.04512 13.8438 4.375C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559Z",fill:"currentColor"})})}function eN(e){let{className:t,...a}=e;return(0,s.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.75 1.3125C5.14594 1.3125 4.65625 1.80219 4.65625 2.40625C4.65625 2.60656 4.7095 2.79244 4.80217 2.95265C4.98365 3.26638 4.87645 3.66782 4.56272 3.8493C4.24899 4.03079 3.84755 3.92358 3.66606 3.60985C3.57481 3.4521 3.50096 3.28302 3.44708 3.10542C2.88406 3.25321 2.46875 3.7656 2.46875 4.375C2.46875 4.66418 2.56182 4.93116 2.7205 5.14826C2.81406 5.12155 2.90945 5.09917 3.00644 5.08136C3.36291 5.01588 3.70497 5.25177 3.77045 5.60825C3.83593 5.96472 3.60003 6.30678 3.24356 6.37226C2.42938 6.52181 1.8125 7.23624 1.8125 8.09338C1.8125 9.05988 2.596 9.84338 3.5625 9.84338C3.67195 9.84338 3.7785 9.83341 3.88144 9.8145C4.23791 9.74903 4.57997 9.98492 4.64545 10.3414C4.71093 10.6979 4.47503 11.0399 4.11856 11.1054C3.93776 11.1386 3.75186 11.1559 3.5625 11.1559C3.34983 11.1559 3.14222 11.1342 2.94177 11.0929C3.11654 12.0013 3.91563 12.6875 4.875 12.6875C5.96231 12.6875 6.84375 11.8061 6.84375 10.7188V10.5C6.84375 8.68782 8.31282 7.21875 10.125 7.21875V8.53125C9.03769 8.53125 8.15625 9.41269 8.15625 10.5V10.7188C8.15625 11.8061 9.03769 12.6875 10.125 12.6875C11.0844 12.6875 11.8835 12.0013 12.0582 11.0929C11.8578 11.1342 11.6502 11.1559 11.4375 11.1559C11.2481 11.1559 11.0622 11.1386 10.8814 11.1054C10.525 11.0399 10.2891 10.6979 10.3545 10.3414C10.42 9.98492 10.7621 9.74903 11.1186 9.8145C11.2215 9.83341 11.328 9.84338 11.4375 9.84338C12.404 9.84338 13.1875 9.05988 13.1875 8.09338C13.1875 7.23624 12.5706 6.52181 11.7564 6.37226C11.4 6.30678 11.1641 5.96472 11.2295 5.60825C11.295 5.25177 11.6371 5.01588 11.9936 5.08136C12.0905 5.09917 12.1859 5.12155 12.2795 5.14826C12.4382 4.93116 12.5312 4.66418 12.5312 4.375H13.8438C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14C3.06282 14 1.59375 12.5309 1.59375 10.7188C1.59375 10.6279 1.59746 10.5377 1.60476 10.4485C0.929711 9.88675 0.5 9.04025 0.5 8.09338C0.5 7.16693 0.911134 6.33702 1.56087 5.77559C1.30484 5.37039 1.15625 4.88986 1.15625 4.375C1.15625 3.04512 2.14519 1.94622 3.42778 1.77359C3.70556 0.751575 4.64001 0 5.75 0C6.43951 0 7.06129 0.290015 7.5 0.754716C7.93871 0.290015 8.56049 0 9.25 0H9.6875V1.3125H9.25C8.64594 1.3125 8.15625 1.80219 8.15625 2.40625V4.375C8.15625 6.18718 6.68718 7.65625 4.875 7.65625V6.34375C5.96231 6.34375 6.84375 5.46231 6.84375 4.375V2.40625C6.84375 1.80219 6.35406 1.3125 5.75 1.3125ZM12.75 3.5V3.0625C12.75 2.57925 13.1418 2.1875 13.625 2.1875H14.0625V1.75V1.3125H13.625C13.1418 1.3125 12.75 0.920749 12.75 0.4375V0H12.3125H11.875V0.4375C11.875 0.920749 11.4832 1.3125 11 1.3125H10.5625V1.75V2.1875H11C11.4832 2.1875 11.875 2.57925 11.875 3.0625V3.5H12.75Z",fill:"currentColor"})})}function ek(e){let{className:t,...a}=e;return(0,s.jsx)("svg",{className:(0,l.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 15 14",width:"16",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.65625 2.40625C4.65625 1.80219 5.14594 1.3125 5.75 1.3125C6.35406 1.3125 6.84375 1.80219 6.84375 2.40625V4.375C6.84375 5.46231 5.96231 6.34375 4.875 6.34375V7.65625C6.68718 7.65625 8.15625 6.18718 8.15625 4.375V2.40625C8.15625 1.80219 8.64594 1.3125 9.25 1.3125H9.6875V0H9.25C8.56049 0 7.93871 0.290015 7.5 0.754716C7.06129 0.290015 6.43951 0 5.75 0C4.64001 0 3.70556 0.751575 3.42778 1.77359C2.14519 1.94622 1.15625 3.04512 1.15625 4.375C1.15625 4.88986 1.30484 5.37039 1.56087 5.77559C0.911134 6.33702 0.5 7.16692 0.5 8.09338V8.74957H1.8125V8.09338C1.8125 7.23624 2.42938 6.52181 3.24356 6.37226C3.60003 6.30678 3.83593 5.96472 3.77045 5.60825C3.70497 5.25177 3.36291 5.01588 3.00644 5.08136C2.90945 5.09917 2.81406 5.12155 2.7205 5.14826C2.56182 4.93116 2.46875 4.66418 2.46875 4.375C2.46875 3.7656 2.88406 3.25321 3.44708 3.10542C3.50096 3.28302 3.57481 3.4521 3.66606 3.60985C3.84755 3.92358 4.24899 4.03079 4.56272 3.8493C4.87645 3.66782 4.98365 3.26638 4.80217 2.95265C4.7095 2.79244 4.65625 2.60656 4.65625 2.40625ZM4.875 12.6875C5.96231 12.6875 6.84375 11.8061 6.84375 10.7188V10.5C6.84375 8.68782 8.31282 7.21875 10.125 7.21875V8.53125C9.03769 8.53125 8.15625 9.41269 8.15625 10.5V10.7188C8.15625 11.8061 9.03769 12.6875 10.125 12.6875C11.0844 12.6875 11.8835 12.0013 12.0582 11.0929C11.8578 11.1342 11.6502 11.1559 11.4375 11.1559C11.2481 11.1559 11.0622 11.1386 10.8814 11.1054C10.525 11.0399 10.2891 10.6979 10.3545 10.3414C10.42 9.98492 10.7621 9.74903 11.1186 9.8145C11.2215 9.83341 11.328 9.84338 11.4375 9.84338C12.404 9.84338 13.1875 9.05988 13.1875 8.09338C13.1875 7.23624 12.5706 6.52181 11.7564 6.37226C11.4 6.30678 11.1641 5.96472 11.2295 5.60825C11.295 5.25177 11.6371 5.01588 11.9936 5.08136C12.0905 5.09917 12.1859 5.12155 12.2795 5.14826C12.4382 4.93116 12.5312 4.66418 12.5312 4.375H13.8438C13.8438 4.88986 13.6952 5.37039 13.4391 5.77559C14.0889 6.33702 14.5 7.16693 14.5 8.09338C14.5 9.04025 14.0703 9.88675 13.3952 10.4485C13.4025 10.5377 13.4062 10.6279 13.4062 10.7188C13.4062 12.5309 11.9372 14 10.125 14C9.05164 14 8.09865 13.4846 7.5 12.6878C6.90135 13.4846 5.94836 14 4.875 14V12.6875ZM12.75 3.0625V3.5H11.875V3.0625C11.875 2.57925 11.4832 2.1875 11 2.1875H10.5625V1.75V1.3125H11C11.4832 1.3125 11.875 0.920749 11.875 0.4375V0H12.3125H12.75V0.4375C12.75 0.920749 13.1418 1.3125 13.625 1.3125H14.0625V1.75V2.1875H13.625C13.1418 2.1875 12.75 2.57925 12.75 3.0625ZM2.6875 8.75V9.1875C2.6875 10.154 1.904 10.9375 0.9375 10.9375H0.5V11.375V11.8125H0.9375C1.904 11.8125 2.6875 12.596 2.6875 13.5625V14H3.125H3.5625V13.5625C3.5625 12.596 4.346 11.8125 5.3125 11.8125H5.75V11.375V10.9375H5.3125C4.346 10.9375 3.5625 10.154 3.5625 9.1875V8.75H2.6875Z",fill:"currentColor"})})}function eC(e){let t,a,{thinkingMode:r,setThinkingMode:i}=e,{tme:o}=(0,Y.D)(),c=(0,n.useCallback)(()=>{o&&(null===r?i("medium"):"medium"===r?i("high"):i(null))},[o,r,i]);return o?(t="medium"===r?(0,s.jsx)(eN,{}):"high"===r?(0,s.jsx)(ek,{}):(0,s.jsx)(ew,{}),a="medium"===r?"Think hard":"high"===r?"Think harder":"Thinking",(0,s.jsxs)(w.$,{type:"button",className:(0,l.cn)("h-7 w-min rounded-md !bg-gray-100 !px-1.5 text-[13px] text-gray-500 hover:!bg-gray-200 hover:!text-gray-900",null!==r&&"!bg-blue-100 text-blue-700 hover:!bg-blue-200 hover:!text-blue-800"),onClick:c,variant:"ghost",children:[t,(0,s.jsx)("span",{children:a})]})):null}var eS=a(82954),eI=a(85328),eM=a(22913),ez=a(92461);function eL(e){let{onChange:t}=e,[a,r]=(0,n.useState)("build"),[l,i]=(0,n.useState)(!1),o=(0,eI.al)(),c=(0,T.k)("message"),d=[{icon:eM.L2,text:c("buildText"),description:c("buildDescription"),value:"build"},{icon:ez.Q,text:c("askText"),description:c("askDescription"),value:"ask"}],u=(0,n.useMemo)(()=>{var e;return null!==(e=d.find(e=>e.value===a))&&void 0!==e?e:d[0]},[a]),m=(0,s.jsx)(w.$,{"aria-label":"Select mode",className:"flex h-7 max-w-[200px] justify-start pl-1.5 transition-colors has-[>svg]:pr-3",size:"sm",variant:"secondary",children:(0,s.jsxs)("span",{className:"flex gap-2 items-center",children:[(0,s.jsx)(u.icon,{}),u.text]})}),h=(0,s.jsx)("div",{className:"p-1",children:(0,s.jsx)("div",{className:"max-h-[400px] space-y-2 overflow-y-auto text-left",children:d.map(e=>(0,s.jsxs)("button",{className:"flex w-full gap-3 items-center justify-between rounded-md px-2 py-2.5 hover:bg-gray-100",onClick:()=>{r(e.value),null==t||t(e.value),i(!1)},children:[(0,s.jsx)("span",{className:"flex min-w-0 flex-1 items-center",children:(0,s.jsxs)("span",{className:"flex gap-3 items-center",children:[(0,s.jsx)(e.icon,{}),(0,s.jsxs)("span",{className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"block text-sm",children:e.text}),(0,s.jsx)("span",{className:"block text-gray-500 text-xs",children:e.description})]})]})}),a===e.value&&(0,s.jsx)("span",{className:"flex shrink-0 items-center text-gray-500",children:(0,s.jsx)(eS.A,{className:"h-4 w-4 group-hover:hidden"})})]},e.value))})});return(0,s.jsx)("div",{className:"hidden w-full min-w-0 md:block",children:(0,s.jsxs)(eu.DropdownMenu,{onOpenChange:e=>i(e),open:l&&!o,children:[(0,s.jsx)(eu.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:m}),(0,s.jsx)(eu.DropdownMenuContent,{align:"start",side:"bottom",sideOffset:4,children:(0,s.jsx)(eu.DropdownMenuGroup,{children:h})})]})})}var eP=a(44999),eR=a(15066);function eD(e){var t;let{submit:a,stop:m,scrollDownButton:p,isMobile:g,isNewChat:f,isHome:N,isSignedIn:k,isAnonymous:C,className:S,clearOnSubmit:I=!0,placeholder:M,dragContainerRef:q,onInputChange:et,maxLength:ea,isPending:es,isTemplateLoading:er=!1}=e,{showZipModal:en,setShowZipModal:el}=(0,eh.A)(),{publishBlockDialogOpen:ei}=(0,eP.ed)(),[ec,ed]=(0,n.useState)(void 0),{blobs:eu,reset:em,localFileInfos:ep,removeFile:ex,isDraggingFile:eg,inputFileRef:ev,onInputChange:ej,uploading:eb,uploadFiles:ew}=(0,b.Ay)({isSignedIn:k,dragContainerRef:q,disableDrag:ei||en,onSuccess:(e,t)=>{let a=t.filter(e=>"application/zip"===e.contentType);if(a.length>1){G.oR.error("Only one zip file is supported.");return}let s=a[0];s&&(ed(s),el(!0))}}),{initialStreamPromise:eN,activeForkKey:ek,isLoading:eS,isStreaming:eI,messages:eM,isContinuing:ez}=(0,d.Pk)(),eD=(0,n.useMemo)(()=>eM.filter(e=>null==ek?void 0:ek.includes(e.id)),[eM,ek]),{quote:eF,setQuote:eO}=(0,R.sC)(),eU=(0,n.useRef)(null),eH=(0,n.useRef)(()=>{}),{setShowSignInDialog:e$}=(0,y.AO)(),{showBannerLimit:eq,showBannerGeneral:eW}=(0,E.f)(),eZ=eq&&k,eG=eW&&k,eK=eZ||eG,{handleSavePromptDraft:eY,draft:eQ}=(0,A.jh)(),[eJ,eX]=(0,n.useState)(!0),{selectedProjectId:e0}=(0,H._t)(),{project:e1,canWriteToChat:e5}=(0,R.tZ)(),{user:e3,expectUser:e2}=(0,$.J)(),{activeScope:e6}=(0,J.k6)(),{planSlug:e4}=(0,Q.N)(!0,null==e6?void 0:e6.id),{fi:e9,pe:e8,mpe:e7,mme:te,ape:tt}=(0,Y.D)(),[ta,ts]=(0,n.useState)(!1),[tr,tn]=(0,n.useState)(!1),[tl,ti]=(0,n.useState)(),[to,tc]=(0,n.useState)(""),td="";(null==eQ?void 0:eQ.source)!=="cookie"||eQ.isMessageTrimmed||(td=eQ.message);let{data:tu,mutate:tm}=(0,L.Ay)("text-area-value",null),{autopilotEnabled:th,setAutopilotEnabled:tp}=function(){let{data:e,mutate:t}=(0,L.Ay)("state:autopilot",{fallbackData:!1});return{autopilotEnabled:e,setAutopilotEnabled:t}}(),[tx,tg]=(0,n.useState)((null===(t=eD.findLast(e=>"user"===e.role))||void 0===t?void 0:t.thinkingMode)||null),tf="v0-level0"===e4&&!(null==e3?void 0:e3.isV0Admin)&&!(null==e3?void 0:e3.isVercelian)&&!(null==e3?void 0:e3.hasPremiumOverride),tv=ep.length>0,{tokenUsage:tj,percentage:tb,exceededCharCount:ty,onlyImageFiles:tw,onlyTextFiles:tN}=function(e){let{localFiles:t}=e,a=(0,U.f)(),{messages:s,activeForkKey:r,chatId:l}=(0,d.Pk)(),i=(0,n.useMemo)(()=>s.filter(e=>null==r?void 0:r.includes(e.id)),[s,r]),{tokens:o,isLoading:c}=function(e,t,a){let{isEmpty:s}=(0,R.tZ)(),{data:r,isLoading:n}=(0,L.Ay)(s||a?null:"/chat/api/chat/cstu?chatId=".concat(e,"&messageId=").concat(t),_.GO,{shouldRetryOnError:!1});return{tokens:r,isLoading:n}}(l,(0,n.useMemo)(()=>{var e;return null===(e=i[i.length-1])||void 0===e?void 0:e.id},[i]),0===t.length),u=(0,n.useMemo)(()=>t.reduce((e,t)=>e+(t.tokens||0),0),[t]),m=(0,n.useMemo)(()=>c?0:o&&o>0?o:(0,O.Z)(i),[i,o,c]),h=(0,n.useMemo)(()=>m+u,[m,u]),p=t.every(e=>e.isImage),x=t.every(e=>void 0!==e.content),g=(0,n.useMemo)(()=>{if(h<=a.contextWindow)return 0;let e=h-a.contextWindow;return(0,V.Cy)(e)},[h,a.contextWindow]);return{total:a.contextWindow,used:h,available:a.contextWindow-h,percentage:Math.round(h/a.contextWindow*100),onlyImageFiles:p,onlyTextFiles:x,exceededCharCount:g,tokenUsage:m}}({localFiles:ep}),tk=tv&&tb>80,tC=tv&&tb>100,tS=(0,n.useMemo)(()=>{var e;return null===(e=function(e,t){for(let a=e.length-1;a>=0;a--)if(t(e[a]))return e[a]}(eD,e=>"user"===e.role))||void 0===e?void 0:e.content},[eD]),tI=(0,d.Pk)().chatId,tM=(0,W.C)(),tz=(0,n.useCallback)(function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r?a:(null===(e=eU.current)||void 0===e?void 0:e.value)||a;tm(n),eX(!n),null==et||et(n),s&&eY({message:n,inputHeight:(null===(t=eU.current)||void 0===t?void 0:t.style.height)?parseInt(eU.current.style.height):void 0})},[eY,et,tm]),[tL]=(0,E.d)(),tP=!!((null==tL?void 0:tL.remaining)!==void 0&&tL.remaining<=0),tR=eS||eI||es,tD=eJ&&0===ep.length&&!(null==eQ?void 0:eQ.message),tE=tR||eb||tD||er||e2&&!e3||tC||ta;(0,n.useEffect)(()=>{tE&&tz(void 0,!1)},[]);let tA=eg&&!en,{showHistoryPopover:tT}=function(){let{revalidate:e}=(0,P.m)(),{data:t,mutate:a}=(0,L.Ay)("showHistoryPopover",null,{fallbackData:!1});return{showHistoryPopover:t,setShowHistoryPopover:(0,n.useCallback)(t=>{e(),a(t)},[a,e])}}(),{promptFormInput:tF,setPromptFormInput:tO}=e_(),{setImportFigmaModalOpen:tU}=(0,K.C)();(0,n.useEffect)(()=>{if(!eU.current||void 0===tF)return;let e=eU.current;e.value=e.value?"".concat(e.value,"\n").concat(tF):tF,tO(void 0),e.style.height="".concat(e.scrollHeight,"px"),e.focus(),tz()},[tF,tO,tz]);let tV=(null==eQ?void 0:eQ.source)==="cookie"&&eQ.isMessageTrimmed;(0,n.useEffect)(()=>{if("string"==typeof(null==eQ?void 0:eQ.message)&&"localStorage"===eQ.source&&eQ.message&&eU.current){if(eU.current.value!==eQ.message&&!eQ.isExpandedDraft){tz();return}let e=eU.current;tm(eQ.message),e.style.height="".concat(eQ.inputHeight,"px"),e.scrollTop=1e7,e.focus(),e.setSelectionRange(eQ.message.length,eQ.message.length),eQ.quote&&eO(eQ.quote)}},[tO,tm,eQ,tz,eO]),(0,n.useEffect)(()=>{let e=eU.current;e&&ep.length>0&&e.focus()},[ep]),(0,n.useEffect)(()=>{let e=eU.current;if(!e)return;let t=t=>{"/"===t.key&&!(t.target&&(["INPUT","TEXTAREA"].includes(t.target.nodeName)||"contentEditable"in t.target&&"true"===t.target.contentEditable))&&(t.preventDefault(),t.stopPropagation(),e.focus())},a=t=>{"Escape"===t.key&&""===e.value.trim()&&eO(null)},s=t=>{!f&&!tR&&"ArrowUp"===t.key&&""===e.value.trim()&&tS&&(0,n.startTransition)(()=>{e.value=String(tS),requestAnimationFrame(()=>e.select())})};return document.addEventListener("keydown",t),e.addEventListener("keydown",s),e.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",t),e.removeEventListener("keydown",s),e.removeEventListener("keydown",a)}},[m,tS,f,tR,eO]);let t_=(0,T.k)("promptForm"),[tB,tH]=(0,n.useState)(void 0),{setUpgradePromptOpen:t$}=(0,B.g)(),tq=(0,n.useCallback)((e,t)=>{var s,r,n;if(e&&e.preventDefault(),tR&&!t)return;let l=null!==(r=null!==(s=null==t?void 0:t.trim())&&void 0!==s?s:null==tu?void 0:tu.trim())&&void 0!==r?r:"";if(l||0!==ep.length){if(tP){C?e$({prompt:l}):t$(!0);return}(!tE||t)&&(a({action:"new",input:l,attachments:eu,figmaContext:tB,thinkingMode:tx,onFailToPrompt:()=>tz(l,!0,!1),messageMode:tl,autopilot:tt&&th}),(0,u.u)("SubmitNewUserMessage",{text:l,index:eM.length,imageOnly:ep.length>0&&""===l.trim(),projectId:f?e0:null!==(n=null==e1?void 0:e1.projectId)&&void 0!==n?n:null,anonId:tM}),I&&(k||C)&&(eU.current&&(eU.current.value="",eH.current()),em(),eX(!0),tn(!1),tm(""),tc("")))}},[tR,tu,ep.length,tP,tE,a,eu,tB,tx,tl,eM.length,f,e0,null==e1?void 0:e1.projectId,tM,I,k,C,e$,t$,tz,em,tm]),{formRef:tW,onKeyDown:tZ}=(0,r.w)({localFileInfos:ep,submitMessage:tq});(0,n.useEffect)(()=>{eF&&tW.current&&tW.current.content&&tW.current.content.focus()},[tW,eF]);let tG=(0,n.useCallback)(e=>{g||tZ(e)},[g,tZ]),{handleFigmaUrl:tK,isFigmaUrl:tY,isLoading:tQ,getNodeContext:tJ}=(0,Z.q)(eU);(0,n.useEffect)(()=>{let e;return tQ&&(e=G.oR.loading("Fetching image from Figma")),()=>{e&&G.oR.dismiss(e)}},[tQ]);let tX=(0,n.useCallback)(async e=>{if(!tY(e))return;let[t,a]=await Promise.all([tK(e),tJ(e)]);if(!t.success)return;let s=a.nodes.colors.map(e=>"".concat(e.hex,")")).join(", ")||"",r=a.nodes.designTokens.map(e=>"".concat(e.hex,")")).join(", ")||"";tH([s&&"Colors: ".concat(s),r&&"Design tokens: ".concat(r)].filter(Boolean).join(", "));let{base64:n,originalUrl:l,fileName:i}=t.data,o=i.replace(/[^a-zA-Z0-9.]/g,"_"),c=n.split(",")[1],d=window.atob(c),u=new Uint8Array(d.length);for(let e=0;e<d.length;e++)u[e]=d.charCodeAt(e);let m=new File([new Blob([u],{type:"image/png"})],"".concat(o,".png"),{type:"image/png"});m.isFigmaFile=!0,m.figmaUrl=l,m.v0Type="figma",await ew([m])},[tY,tK,tJ,ew]),t0=(0,X.useSearchParams)();(0,n.useEffect)(()=>{if(!e9)return;let e=t0.get("figma_connected"),t="import"===t0.get("from");if("true"!==e||t||tU({open:!0,onImport:tX}),"true"===e){let e=new URL(window.location.href);e.searchParams.delete("figma_connected"),e.searchParams.delete("from"),window.history.replaceState({},"",e)}},[t0,e9,tU,tX]);let t1=ee({isSignedIn:k,userOnFree:tf,uploadFiles:ew,isFigmaUrl:tY,handleFigmaImport:tX,showSignInDialog:()=>e$({prompt:!1})}),t5=!f,t3=eD[eD.length-1],t2=t3&&Array.isArray(t3.content)&&t3.content.some(e=>!!Array.isArray(e)&&0===e[0]);return(0,s.jsxs)("div",{className:(0,l.cn)("content-center",S),children:[(0,s.jsx)(eh.e,{attachment:ec,onClose:()=>{ed(void 0),(null==ec?void 0:ec.id)&&ex(ec.id)}}),(0,s.jsxs)("div",{className:(0,l.cn)("relative z-10 flex w-full flex-col",!f&&"bg-background mx-auto max-w-3xl px-2 pb-2 sm:px-3 sm:pb-3 md:px-4 md:pb-4",t5&&"pb-0 sm:pb-0 md:pb-0"),children:[(0,s.jsxs)(o.N,{mode:"sync",children:[!eK&&e5&&(0,s.jsx)(c.P.div,{animate:{opacity:1,height:"auto"},className:"peer relative rounded-t-xl bg-gray-100 text-gray-600",exit:{opacity:0,height:0},initial:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)(ey,{currentMessages:eD,activeForkKey:ek})},"rate-limit"),eK?(0,s.jsx)(c.P.div,{animate:{opacity:1,height:"auto"},className:"peer relative rounded-t-xl bg-gray-100 text-gray-600",exit:{opacity:0,height:0},initial:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)(ef,{almostAtLimit:eZ,reachedLimit:tP,isAnonymous:C})},"rate-limit"):null]}),(0,s.jsx)("div",{className:"rounded-b-xl peer-has-[.banner]:bg-gray-100",children:(0,s.jsxs)("form",{className:(0,l.cn)("focus-within:border-alpha-600 bg-background-subtle border-alpha-400 relative rounded-xl border shadow-[0_2px_2px_rgba(0,0,0,0.04),0_8px_8px_-8px_rgba(0,0,0,0.04)] transition-shadow"),onSubmit:tq,ref:tW,children:[(0,s.jsx)(eV,{message:eD.find(e=>!!(ek&&ek[ek.length-1]===e.id)),isContinuing:ez,isLoading:eS,isStreaming:eI}),f?null:p,(0,s.jsxs)(o.N,{mode:"sync",children:[eF?(0,s.jsx)(c.P.div,{animate:{opacity:1,height:"auto"},className:"bg-muted relative rounded-t-xl border-b text-gray-600",exit:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)(eA,{className:(0,l.cn)(tv&&"pb-1"),onClose:()=>void eO(null),quote:eF,shouldNotAnimate:(null==eQ?void 0:eQ.quote)===eF},"quote-component-".concat(eF))},"quote-animate-".concat(eF)):null,tv||tA?(0,s.jsxs)(c.P.div,{animate:{opacity:1,height:"auto"},className:"bg-muted relative rounded-t-xl text-gray-600",exit:{opacity:0,height:0},initial:((null==eQ?void 0:eQ.localFileInfos.length)||0)>0?{opacity:1,height:"auto"}:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:[(0,s.jsx)(eT,{files:ep,removeFile:ex,showDropzone:tA}),tk?(0,s.jsxs)("p",{className:(0,l.cn)("flex items-center gap-1 p-3 pt-0 text-xs text-gray-600",tC?"text-red-700":"text-gray-600"),children:[(0,s.jsx)(i.R,{className:"size-3.5"}),function(e){let{exceedsContextWindow:t,isNewChat:a,onlyTextFiles:s,onlyImageFiles:r,exceededCharCount:n,tokenUsage:l,numAttachments:i}=e,o=null==n?void 0:n.toLocaleString(),c=1===i?"":"s",d="Your message and attachment".concat(c," ").concat(t?"exceed":"are close to exceeding"," ").concat(a?"the chat context window":"the context window for this chat");return s&&t?d+=" by an estimated ".concat(o," character").concat(1===n?"":"s","."):d+=".",l>5e4&&!a?d+=" Try starting a new chat.":r?d+=" Try resizing or removing attached images.":s?d+=" Try uploading a smaller snippet of your attachment".concat(c,"."):d+=" Try reducing the size of your attachment".concat(c,"."),d}({exceedsContextWindow:tC,isNewChat:f,onlyTextFiles:tN,onlyImageFiles:tw,exceededCharCount:ty,tokenUsage:tj,numAttachments:ep.length})]}):null]},"attachments-".concat(tA,"-").concat(ep.length)):null]}),(0,s.jsxs)("div",{className:"@container/textarea bg-background-subtle relative z-10 grid min-h-[100px] rounded-xl",children:[(0,s.jsx)("label",{className:"sr-only",htmlFor:"chat-main-textarea",children:t_("chatInput")}),tV&&eQ.inputHeight?(0,s.jsx)("div",{className:"flex w-full flex-col gap-0 px-3",style:{height:"".concat(eQ.inputHeight,"px")},children:Array.from({length:Math.floor((eQ.inputHeight-12)/20)}).map((e,t)=>(0,s.jsx)("div",{className:(0,l.cn)("flex h-5 items-center justify-center",0===t?"mt-3":""),style:{width:"".concat([45,35,50,60,42,70,48][t%7],"%")},children:(0,s.jsx)(z.E,{className:"h-3 w-full"},t)},"prompt-skeleton-"+t))}):(0,s.jsx)(D.o,{value:tu,resizeFunctionRef:eH,autoFocus:!g&&!tT,"data-enhancing":ta,className:"data-[enhancing=true]:text-shimmer data-[enhancing=true]:animate-shimmer-text w-full flex-1 bg-transparent p-3 pb-1.5 text-sm outline-none ring-0 placeholder:text-gray-500",id:"chat-main-textarea",maxLength:ea,name:"content",onChange:e=>{tm(e.target.value),tn(!1),tz(e.target.value)},onKeyDown:tG,onPaste:t1,placeholder:M||t_(f?"ask"===tl?"askQuestion":"askBuild":"askFollowup"),ref:eU,style:{height:void 0!==td&&(null==eQ?void 0:eQ.inputHeight)?"".concat(eQ.inputHeight,"px"):"42px",caretColor:td?"transparent":void 0},spellCheck:!1},tI),(0,s.jsxs)(eE,{className:"p-3",children:[(0,s.jsxs)("div",{className:"flex gap-1",children:[N&&(0,s.jsx)("div",{className:"shrink-1 min-w-0 grow-0",children:te?(0,s.jsx)(eL,{onChange:e=>{var t;ti(e),null===(t=eU.current)||void 0===t||t.focus()}}):(0,s.jsx)(F.o,{onLoggedOutClick:k?void 0:()=>{var e;e$({prompt:(null===(e=eU.current)||void 0===e?void 0:e.value)||""})},disabled:tP})}),(0,s.jsx)(eC,{thinkingMode:tx,setThinkingMode:tg}),e7&&(0,s.jsx)(w.$,{variant:"outline",className:(0,l.cn)("focus:bg-muted size-7 hover:bg-gray-100 focus-visible:bg-gray-100"),size:"sm",tooltip:{content:null==e3?void 0:e3.modelPreview,side:"bottom"},disabled:!0,children:(0,s.jsx)(j.n,{})})]}),(0,s.jsxs)("div",{className:"ml-auto flex items-center gap-1",children:[(0,s.jsxs)(o.N,{children:[e8&&(0,s.jsx)(c.P.div,{animate:{opacity:1},className:(0,l.cn)("flex items-center gap-2",ta?"animate-pulse":""),exit:{opacity:0},initial:{opacity:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)(eo,{disabled:tR||ta||tr||tP,currentPrompt:tu||"",isSignedIn:k,planSlug:e4,reachedRateLimit:tP,setPrompt:e=>{tr||tc(tu||""),tz(e,!0,!0),tn(!0);let t=eU.current;if(!t)return;let a=Math.min(20*Math.floor(e.length/40)+42,200);t.style.height="".concat(a,"px"),t.scrollTop=1e7,t.focus(),t.setSelectionRange(e.length,e.length)},hasEnhancedCurrentPrompt:tr,setLoading:ts,handleRevert:()=>{let e=eU.current;if(!e)return;let t=Math.min(20*Math.floor(to.length/40)+42,200);e.style.height="".concat(t,"px"),e.scrollTop=1e7,e.focus(),e.setSelectionRange(to.length,to.length),tz(to,!0,!0),tn(!1)},recentUserMessages:eD.filter(e=>"user"===e.role&&e.content).slice(-3).map(e=>e.content)})},"enhance-prompt"),tt&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(eR.Label,{htmlFor:"autopilot-toggle",className:"sr-only",children:"Autopilot Mode"}),(0,s.jsx)("div",{className:"flex items-center space-x-1",children:(0,s.jsx)(w.$,{onClick:e=>{e.preventDefault(),tp(!th)},variant:"ghost",type:"button",className:"size-7 p-0 transition-all duration-300",tooltip:{className:"pr-1.5",side:"bottom",content:(0,s.jsx)("div",{className:"flex flex-col items-center justify-center gap-1",children:(0,s.jsxs)("span",{className:"text-gray-100",children:["Cook mode"," ",th?(0,s.jsx)("span",{children:"enabled"}):(0,s.jsx)("span",{children:"disabled"})]})})},children:(0,s.jsx)("span",{className:"text-lg transition-all duration-300 ".concat(th?"":"grayscale"),children:"\uD83E\uDDD1‍\uD83C\uDF73"})})})]})]}),(0,s.jsx)(eB,{disabled:tR||tP||er,onFileChange:e=>{var t,a;ej(e),null===(t=eU.current)||void 0===t||t.focus(),(0,u.u)("AttachFiles",{count:null===(a=e.target.files)||void 0===a?void 0:a.length,fileNames:Array.from(e.target.files||[]).map(e=>e.name)})},handleFigmaImport:tX,isFigmaLoading:tQ,inputFileRef:ev,textAreaRef:eU,uploadFiles:ew,isGenerating:tR||!1,isSignedIn:k,isAnonymous:C}),tR?(0,s.jsxs)(w.$,{className:"ml-auto h-7 shrink-0 rounded-md",disabled:void 0!==eN||eS||es||!t2,onClick:e=>{e.preventDefault(),m()},size:"sm",type:"button",children:[(0,s.jsx)(v.X,{})," ",t_("stop"),(0,s.jsx)("span",{className:"sr-only",children:t_("stopGeneration")})]}):tP&&!C?(0,s.jsxs)(w.$,{className:"h-7 rounded-md","data-testid":"prompt-form-upgrade-button",onClick:()=>t$(!0),size:"sm",type:"submit",children:[(0,s.jsx)(x.l,{}),t_("upgradePlan")]}):(0,s.jsxs)(w.$,{className:"ml-1 size-7 rounded-md","data-testid":"prompt-form-send-button",disabled:tE,size:"sm",type:"submit",children:[(0,s.jsx)(h.D,{}),(0,s.jsx)("span",{className:"sr-only",children:t_("sendMessage")})]})]})]})]})]})}),t5?(0,s.jsx)("p",{className:"py-2 text-center text-xs text-gray-500",children:t_("disclaimer")}):null]})]})}function eE(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex items-center gap-2",t),...a})}function eA(e){let{quote:t,onClose:a,className:r,shouldNotAnimate:n}=e,i=(0,T.k)("promptForm");return(0,s.jsx)("div",{className:(0,l.cn)("p-3",r),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-1 shrink-0 self-stretch rounded-full bg-gray-300"}),(0,s.jsx)("div",{className:(0,l.cn)(n?"":"mask-animation","line-clamp-2 flex-1 whitespace-pre-wrap text-sm text-gray-600"),title:t,children:t},"quote-".concat(n)),(0,s.jsxs)(w.$,{className:"m-[3px]",onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:i("removeQuote"),variant:"secondary",children:[(0,s.jsx)(N.F,{}),(0,s.jsx)("span",{className:"sr-only",children:i("remove")})]})]})})}function eT(e){let{files:t,removeFile:a,showDropzone:r}=e,n=(0,T.k)("promptForm");return(0,s.jsxs)("div",{className:"no-scrollbar h-16 overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 p-3 transition-opacity",style:{opacity:+!!r,pointerEvents:r?"auto":"none"},children:(0,s.jsx)("div",{className:"flex h-10 flex-col items-center justify-center gap-1 rounded-md border border-dashed border-gray-300 p-3 text-center text-xs text-gray-400",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 font-medium text-gray-500",children:[(0,s.jsx)(C.f,{className:"size-3.5"})," ",n("dropFilesHere")]})})}),t.length?(0,s.jsx)("div",{className:"flex items-center gap-3 overflow-x-auto p-3 transition-opacity",style:{opacity:+!r},children:t.slice().reverse().map(e=>(0,s.jsx)(eU,{file:e,onRemoveButtonClicked:()=>a(e.id)},e.id))}):null]})}function eF(e){let{files:t,removeFile:a,showDropzone:r,existingAttachments:l,removeExistingAttachment:i}=e,d=(0,T.k)("promptForm"),u=(0,n.useMemo)(()=>(l?t.length+l.length:t.length)>0,[t,l]);return(0,s.jsx)("div",{className:"no-scrollbar h-16 w-full overflow-hidden",children:(0,s.jsx)(o.N,{initial:!1,children:r?(0,s.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full p-3",children:(0,s.jsx)("div",{className:"flex h-10 flex-col items-center justify-center gap-1 rounded-md border border-dashed border-gray-300 p-3 text-center text-xs text-gray-400",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 font-medium text-gray-500",children:[(0,s.jsx)(C.f,{className:"size-3.5"})," ",d("dropFilesHere")]})})},"dropzone"):u?(0,s.jsxs)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"flex items-center gap-3 overflow-x-auto p-3",children:[l&&eO(l).map(e=>(0,s.jsx)(eU,{file:e,onRemoveButtonClicked:()=>null==i?void 0:i(e.url)},e.id)),[...t].reverse().map(e=>(0,s.jsx)(eU,{file:e,onRemoveButtonClicked:()=>a(e.id)},e.id))]},"attachments"):null})})}let eO=e=>(null==e?void 0:e.map(e=>{var t;return{id:(0,q.$C)(),name:e.name||"Unnamed file",url:e.url,status:"done",size:e.size,v0Type:e.v0Type,isImage:(null===(t=e.contentType)||void 0===t?void 0:t.startsWith("image/"))||!1,isSavedDraft:!0}}))||[];function eU(e){let{file:t,onRemoveButtonClicked:a,className:r}=e,i="uploading"===t.status,o="compressing"===t.status,[c,d]=(0,n.useState)(!i&&!t.isSavedDraft&&!o),[u,m]=(0,n.useState)(0),[h,p]=(0,n.useState)(0),[x,f]=(0,n.useState)(null),{content:v}=(0,et.k)(x),[j,b]=(0,n.useState)(!1),y=(0,l.QY)(t.name,18),C=(0,T.k)("promptForm"),z=(0,s.jsx)(k.Z,{});i||o?z=(0,s.jsx)(M.y,{size:16}):"figma"===t.v0Type?(z=(0,s.jsx)(g.Y,{}),y=y.split(".png")[0]):t.isImage&&(z=(0,s.jsx)(I.default,{alt:t.name,className:"border-alpha-400 aspect-square rounded-sm border object-cover",fill:!0,src:t.url}));let L=(0,l.v7)(t.size);i?L=C("uploading"):o&&(L=C("compressing"));let P=(0,s.jsx)(w.$,{asChild:!0,className:"w-full gap-1 py-1 pl-1 pr-3 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100",variant:"secondary",onClick:e=>{b(!0),v||(e.preventDefault(),f(t.url))},children:(0,s.jsxs)("div",{tabIndex:0,children:[(0,s.jsx)("div",{className:"flex size-8 shrink-0 -translate-x-px items-center justify-center overflow-hidden rounded-sm bg-gray-100 text-gray-500",children:z}),(0,s.jsxs)("div",{className:"grid flex-1 gap-1 py-0.5 text-xs leading-none text-gray-500",children:[(0,s.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:y}),(0,s.jsx)("div",{className:"line-clamp-1 font-normal",children:L})]})]})});return(0,s.jsxs)("div",{className:(0,l.cn)("relative h-10 w-[150px] shrink-0",r),children:[t.isImage?(0,s.jsxs)(S.jc,{closeDelay:0,onOpenChange:d,open:c,openDelay:0,children:[(0,s.jsx)(S.d0,{asChild:!0,children:P}),(0,s.jsx)(S.Et,{className:"text-muted w-fit overflow-hidden rounded-xl bg-black p-0.5 text-xs",side:"top",sideOffset:8,children:(0,s.jsx)(I.default,{alt:t.name,className:"h-auto max-h-[300px] w-auto max-w-[300px] rounded-lg object-contain",src:t.url,width:300,height:300,onLoad:e=>{let t=e.target,a=t.naturalWidth/t.naturalHeight,s=.8*window.innerWidth,r=.8*window.innerHeight,n=r*a,l=r;a>1&&(n=s,l=s/a),m(n),p(l)}})})]},t.id):P,(0,s.jsxs)(w.$,{className:(0,l.cn)("absolute right-0 top-0 -translate-y-1/3 translate-x-1/3 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100",i&&"invisible"),onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:C("remove"),variant:"secondary",children:[(0,s.jsx)(N.F,{}),(0,s.jsx)("span",{className:"sr-only",children:C("remove")})]}),j?(0,s.jsx)(ea.pj,{setOpen:b,attachment:t,open:j,width:u,height:h,content:v}):null]})}function eV(e){let{message:t,isContinuing:a,isLoading:r,isStreaming:n}=e,{submit:l}=(0,m.yI)(),i=(0,T.k)("promptForm"),[o]=(0,E.d)(),c=!!((null==o?void 0:o.remaining)!==void 0&&o.remaining<=0),d=a||r||n;return t&&"assistant"===t.role&&("length"===t.finishReason||a)&&!c?(0,s.jsxs)(w.$,{"aria-label":i("continueGeneratingMessage"),className:"absolute -top-10 right-0 flex w-min items-center",disabled:d,onClick:()=>{Promise.all([l({action:"continue",assistantMessageId:t.id}),(0,u.u)("ContinueMessage",{messageId:t.id})])},size:"sm",children:[d&&(0,s.jsx)(M.y,{size:16}),i("continueGenerating"),(0,s.jsx)("span",{className:"sr-only",children:i("continueGeneratingMessage")})]}):null}function e_(){let e=(0,d.Pk)().chatId,{data:t,mutate:a}=(0,L.Ay)([e,"prompt-form-input"],null);return{promptFormInput:t,setPromptFormInput:(0,n.useCallback)(e=>{a(e)},[a]),chatId:e}}function eB(e){let{disabled:t,onFileChange:a,inputFileRef:r,textAreaRef:n,handleFigmaImport:i,isFigmaLoading:o,isGenerating:c,isSignedIn:d,isAnonymous:m}=e,{setShowSignInDialog:h}=(0,y.AO)(),{setUpgradePromptOpen:x}=(0,B.g)(),{planSlug:v}=(0,Q.N)(!0,void 0),[j]=(0,E.d)(),b=!!((null==j?void 0:j.remaining)!==void 0&&j.remaining<=0),{setImportFigmaModalOpen:N}=(0,K.C)(),k=()=>{var e;h({prompt:(null===(e=n.current)||void 0===e?void 0:e.value)||"",customMessage:m?"To upload files to your chat, create a Vercel account or log into an existing one.":void 0})};return(0,s.jsxs)(eu.DropdownMenu,{children:[(0,s.jsx)(eu.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(w.$,{asChild:!0,className:(0,l.cn)("focus:bg-muted hover:text-foreground ml-[-2px] h-7 w-7 rounded-md hover:bg-gray-100 focus-visible:bg-gray-100",t&&"pointer-events-none bg-gray-100 text-gray-400 ring-0"),disabled:t,size:"sm",tooltip:{content:"Attach images, Figma files, etc.",side:"bottom"},variant:"ghost",children:(0,s.jsx)("span",{children:(0,s.jsx)(f.x,{className:"size-4"})})})}),(0,s.jsx)(eu.DropdownMenuContent,{side:"bottom",align:"end",children:(0,s.jsxs)(eu.DropdownMenuGroup,{children:[(0,s.jsxs)(eu.DropdownMenuItem,{className:"h-8 justify-between px-2 py-1.5",onClick:()=>{if(!d){k();return}if(b&&"v0-enterprise"!==v){x(!0);return}(0,u.u)("FigmaModalOpen",{source:"button"}),N({open:!0,onImport:i})},children:[(0,s.jsxs)("div",{className:"mr-2 flex items-center gap-3",children:[o?(0,s.jsx)(M.y,{size:16}):(0,s.jsx)(g.Y,{}),(0,s.jsx)("span",{children:"Add from Figma"})]}),(0,s.jsx)(em.E,{variant:"teal",size:"sm",children:"Premium"})]}),(0,s.jsx)(eu.DropdownMenuItem,{className:"h-8 px-2 py-1.5",onClick:()=>{var e;if(!d){k();return}null===(e=r.current)||void 0===e||e.click()},children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(p.b,{}),"Upload from computer"]})})]})}),(0,s.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:c||b,ref:r,type:"file",multiple:!0,onChange:a})]})}},99982:(e,t,a)=>{"use strict";a.d(t,{o:()=>M});var s=a(7336),r=a(80644),n=a(76989),l=a(82954),i=a(81616),o=a(91042),c=a(69780),d=a(57942),u=a(19093),m=a(64297),h=a(84237),p=a(97947),x=a(4495),g=a(38559),f=a(45419),v=a(2115),j=a(67952),b=a(32921),y=a(85328),w=a(91064),N=a(85625),k=a(7407),C=a(57748),S=a(19895);function I(e){var t;let{onClose:a,quickCreate:r=!1}=e,n=(0,j.k)("project.dropdown"),{title:l}=(0,C.tZ)(),i=(0,S.eu)();return(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-1 sm:p-2",children:(0,s.jsx)(p.Sv,{className:"bg-muted w-full rounded-md border border-gray-200 p-2",children:(0,s.jsxs)(p.HY,{className:"flex flex-col items-center space-y-4 p-4",children:[(0,s.jsxs)("span",{className:"flex flex-col items-center justify-between space-y-4",children:[(0,s.jsx)(p.Ft,{className:"bg-background mx-auto text-gray-400",children:(0,s.jsx)(m.z,{})}),(0,s.jsxs)("span",{className:"flex flex-col items-center space-y-2",children:[(0,s.jsx)(p.cz,{children:n("noProjects")}),(0,s.jsx)(p.Ou,{className:"text-balance text-center text-gray-400",children:n("createProject")})]})]}),(0,s.jsx)(o.NewProjectButton,{onAfterClick:a,numProjects:0,quickCreate:r,projectName:null!==(t=null==i?void 0:i.meta.title)&&void 0!==t?t:l})]})})})}function M(e){let{projectName:t,chatId:a,disabled:m,onLoggedOutClick:p,modalClassName:C,triggerButton:S,handleProjectSelect:M,variant:z,className:L,quickCreate:P=!1,onSuccess:R,align:D="start"}=e,{projects:E,selectedProjectId:A,setSelectedProjectId:T}=(0,f._t)(),[F,O]=(0,r.useState)(!1),[U,V]=(0,r.useState)(!1),_=(0,y.al)(),B=(0,j.k)("project"),[H,$]=(0,r.useState)("list"),q=()=>{O(!1),V(!1)},W=e=>{T((null==e?void 0:e.projectId)||null),q(),(0,v.u)("SelectProject",{projectId:(null==e?void 0:e.projectId)||null}),null==M||M(e?{projectId:e.projectId,name:e.name,settings:{icon:e.icon||void 0,color:e.color||void 0},vercelProjectId:e.vercelProjectId,creatorId:e.creatorId}:null)},Z=A&&E.find(e=>e.projectId===A),G=S||(0,s.jsx)(i.$,{"aria-label":"Select project",className:(0,x.cn)("flex h-7 max-w-[200px] justify-start gap-0.5 rounded-md border-none bg-gray-100 pl-2 pr-1.5 text-[13px] transition-colors hover:bg-gray-200 hover:text-gray-900",{"text-gray-500":!Z}),disabled:m,size:"sm",variant:"secondary",children:Z?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.n,{name:(0,N.KI)(Z.icon)}),(0,s.jsx)("span",{className:"ml-1 truncate",children:Z.name}),(0,s.jsx)(d.X,{})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:B("noProjectSelected")}),(0,s.jsx)(d.X,{})]})}),K=(0,r.useMemo)(()=>(0,k.n)(E,(e,t)=>e.projectId===A?-1:+(t.projectId===A)),[E,A]),Y=(0,s.jsxs)("div",{className:"p-1",children:[(0,s.jsx)("div",{className:"max-h-[400px] space-y-2 overflow-y-auto text-left",children:K.map(e=>(0,s.jsxs)("button",{className:"flex w-full items-center justify-between rounded-md px-2 py-2.5 hover:bg-gray-100",onClick:()=>W(A===e.projectId?null:e),children:[(0,s.jsxs)("span",{className:"flex min-w-0 flex-1 items-center",children:[(0,s.jsx)("div",{className:"[&>svg]:size-4",children:(0,s.jsx)(b.n,{name:(0,N.KI)(e.icon)})}),(0,s.jsx)("span",{className:"ml-2 max-w-[200px] truncate",children:e.name})]}),A===e.projectId?(0,s.jsxs)("span",{className:"flex shrink-0 items-center text-gray-500",children:[(0,s.jsx)(l.A,{className:"h-4 w-4 group-hover:hidden"}),(0,s.jsx)("span",{className:"hidden group-hover:inline",children:B("dropdown.unselect")})]}):(0,s.jsx)("span",{className:"hidden shrink-0 text-gray-500 group-hover:inline",children:B("dropdown.select")})]},e.projectId))}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(o.NewProjectButton,{assignToChatId:a,className:"w-full",onAfterClick:q,size:"sm",variant:"secondary",numProjects:E.length,quickCreate:P,projectName:t,onSuccess:e=>{null==R||R(e),q()}})})]}),Q=0===E.length?(0,s.jsx)(I,{onClose:q,quickCreate:P}):Y,J=(0,s.jsx)(n.DropdownMenuContent,{align:D,className:(0,x.cn)("w-[350px]"),side:"bottom",sideOffset:4,children:0===E.length?(0,s.jsx)(I,{onClose:q,quickCreate:P}):(0,s.jsxs)(s.Fragment,{children:["show"===z?(0,s.jsx)(n.DropdownMenuGroup,{className:"-mb-2",children:(0,s.jsxs)(n.DropdownMenuItem,{onClick:e=>{e.preventDefault(),$("show")},className:"flex w-full items-center justify-start gap-2 p-2 text-xs text-gray-500 hover:underline",children:[(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)(u.J,{className:"size-3"})}),(0,s.jsx)("span",{children:"Back"})]})}):null,(0,s.jsx)(n.DropdownMenuGroup,{className:(0,x.cn)("max-h-[225px] overflow-y-auto"),children:(0,k.n)(E,(e,t)=>(e.projectId===A?-1:0)-(t.projectId===A?-1:0)).map(e=>(0,s.jsxs)(n.DropdownMenuItem,{className:"group pl-2 pr-3",onClick:()=>W(A===e.projectId?null:e),children:[(0,s.jsxs)("span",{className:"flex w-full max-w-[200px] items-center",children:[(0,s.jsx)(b.n,{name:(0,N.KI)(e.icon)}),(0,s.jsx)("span",{className:"ml-3 min-w-0 flex-1",children:(0,s.jsx)("span",{className:"block truncate","data-testid":"project-option",children:e.name})})]}),A===e.projectId?(0,s.jsxs)("span",{className:"ml-auto flex shrink-0 items-center text-gray-500",children:[(0,s.jsx)(l.A,{className:"h-4 w-4 group-hover:hidden"}),(0,s.jsx)("span",{className:"hidden group-hover:inline",children:B("dropdown.unselect")})]}):(0,s.jsx)("span",{className:"ml-auto hidden shrink-0 text-gray-500 group-hover:inline",children:B("dropdown.select")})]},e.projectId))}),(0,s.jsx)(n.mB,{}),(0,s.jsx)(n.DropdownMenuGroup,{className:"bg-muted",children:(0,s.jsx)(o.NewProjectButton,{onAfterClick:q,size:"sm",variant:"secondary",className:"w-full",numProjects:E.length,quickCreate:P,projectName:t,onSuccess:e=>{null==R||R(e),q()}})})]})}),X=(0,s.jsx)(n.DropdownMenuContent,{align:"start",side:"bottom",sideOffset:4,children:(0,s.jsxs)(n.DropdownMenuGroup,{children:[(0,s.jsx)(n.DropdownMenuItem,{asChild:!0,children:(0,s.jsxs)(w.N,{href:"/chat/projects/".concat(A),children:[(0,s.jsx)(h.B,{}),(0,s.jsx)("span",{children:B("viewProject")})]})}),(0,s.jsxs)(n.DropdownMenuItem,{onClick:e=>{e.preventDefault(),$("list")},children:[(0,s.jsx)(c.f,{}),(0,s.jsx)("span",{children:B("switchProject")})]})]})});return p?(0,s.jsx)("div",{onClick:p,children:G}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,x.cn)("w-full min-w-0 md:hidden",L),children:(0,s.jsx)(g.Modal,{onOpenChange:O,open:F&&_,trigger:G,className:C,children:(0,s.jsx)(g.ModalContent,{className:(0,x.cn)("max-h-[80vh]",{"overflow-y-auto":E.length>0}),children:Q})})}),(0,s.jsx)("div",{className:(0,x.cn)("hidden w-full min-w-0 md:block",L),children:(0,s.jsxs)(n.DropdownMenu,{onOpenChange:e=>{z&&e&&$("show"),V(e)},open:U&&!_,children:[(0,s.jsx)(n.DropdownMenuTrigger,{asChild:!0,className:"max-w-[200px]",children:G}),"show"===H&&"show"===z?X:J]})})]})}}}]);